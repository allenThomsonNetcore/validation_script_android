2025-11-21 17:23:07,146 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:10000
 * Running on http://172.16.20.190:10000
2025-11-21 17:23:07,146 - INFO - [33mPress CTRL+C to quit[0m
2025-11-21 17:23:07,151 - INFO -  * Restarting with stat
2025-11-21 17:23:07,272 - WARNING -  * Debugger is active!
2025-11-21 17:23:07,281 - INFO -  * Debugger PIN: 804-181-670
2025-11-21 17:23:12,495 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Cache-Control: max-age=0
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831


2025-11-21 17:23:12,496 - INFO - Body: b''
2025-11-21 17:23:12,497 - INFO - URL: http://localhost:10000/push-notification
2025-11-21 17:23:12,497 - INFO - Method: GET
2025-11-21 17:23:12,497 - INFO - Endpoint: push_notification
2025-11-21 17:23:12,506 - INFO - Response: b'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>FCM Push Notification Sender</title>\n    <link rel="icon" type="image/png" href="/static/favicon.png">\n    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">\n    <style>\n        :root {\n            --primary-color: #e35502;\n            --header-bg: #230f2e;\n        }\n        #addPayloadPair{\n            color: #d1d1d1;\n            background-color: #230f2e;\n        }\n        .bg-info {\n            background-color: #230f2e !important;\n            color: #230f2e;\n        }\n       \n        .container { margin-top: 30px; }\n        .form-label { font-weight: 600; color: #333; }\n        \n        /* Header styling */\n        .navbar {\n            background-color: var(--header-bg) !important;\n        }\n        \n        .navbar-brand, .navbar-nav .nav-link {\n            color: white !important;\n        }\n        \n        .navbar-brand img {\n            height: 40px;\n            width: auto;\n            filter: brightness(0) invert(1);\n        }\n        \n        @media (max-width: 768px) {\n            .navbar-brand img {\n                height: 30px;\n            }\n            .navbar-brand span {\n                font-size: 0.9rem;\n            }\n        }\n        \n        .navbar-toggler {\n            border-color: rgba(255,255,255,0.5);\n        }\n        \n        .navbar-toggler-icon {\n            background-image: url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 30 30\'%3e%3cpath stroke=\'rgba%28255, 255, 255, 0.75%29\' stroke-linecap=\'round\' stroke-miterlimit=\'10\' stroke-width=\'2\' d=\'M4 7h22M4 15h22M4 23h22\'/%3e%3c/svg%3e");\n        }\n        \n        /* Button styling */\n        .btn-primary {\n            background-color: var(--primary-color) !important;\n            border-color: var(--primary-color) !important;\n        }\n        \n        .btn-primary:hover {\n            background-color: #c64802 !important;\n            border-color: #c64802 !important;\n        }\n        \n        .btn-outline-primary {\n            color: white !important;\n            border-color: white !important;\n        }\n        \n        .btn-outline-primary:hover {\n            background-color: rgba(255,255,255,0.1) !important;\n        }\n        \n        .alert {\n            border-radius: 5px;\n        }\n        \n        .status-success {\n            background-color: #d4edda;\n            color: #155724;\n            border: 1px solid #c3e6cb;\n            padding: 12px;\n            border-radius: 5px;\n            margin-top: 10px;\n        }\n        \n        .status-error {\n            background-color: #f8d7da;\n            color: #721c24;\n            border: 1px solid #f5c6cb;\n            padding: 12px;\n            border-radius: 5px;\n            margin-top: 10px;\n        }\n        \n        .status-info {\n            background-color: #d1ecf1;\n            color: #0c5460;\n            border: 1px solid #bee5eb;\n            padding: 12px;\n            border-radius: 5px;\n            margin-top: 10px;\n        }\n\n        .payload-key,\n        .payload-value {\n            font-size: 0.9rem;\n        }\n\n        .remove-pair {\n            font-size: 0.85rem;\n            padding: 0.3rem 0.5rem;\n        }\n    </style>\n</head>\n<body>\n    <!-- Navbar matching main page -->\n    <nav class="navbar navbar-expand-lg navbar-light bg-light">\n        <div class="container-fluid">\n            <a class="navbar-brand d-flex align-items-center" href="/">\n                <img src="/static/netcore_logo.png" alt="Netcore Logo" height="40" class="me-2">\n                <span> Notifications</span>\n            </a>\n            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">\n                <span class="navbar-toggler-icon"></span>\n            </button>\n            <div class="collapse navbar-collapse" id="navbarNav">\n                <ul class="navbar-nav ms-auto">\n                    <li class="nav-item">\n                        <a class="btn btn-primary" href="/">\xe2\x86\x90 Back to Validation</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </nav>\n\n    <div class="container">\n        <h2>\xf0\x9f\x93\xb1 FCM Push Notification Sender</h2>\n        \n        <div class="card mb-4">\n            <div class="card-body">\n                <form id="fcmForm" enctype="multipart/form-data">\n                    <div class="row">\n                        <div class="col-md-6">\n                            <div class="mb-3">\n                                <label for="privateKeysFile" class="form-label">\n                                    Firebase Private Key (JSON)\n                                    <span id="credentialsUploadedBadge" class="badge bg-success ms-2" style="display: none;background-color: #230f2e !important; color: #f9f9f9;">\xe2\x9c\x93 Uploaded</span>\n                                </label>\n                                <input type="file" class="form-control" id="privateKeysFile" name="private_keys" accept=".json">\n                                <small class="form-text text-muted">Upload your Firebase service account JSON file</small>\n                                <div id="credentialsStatus" class="mt-2"></div>\n                            </div>\n                        </div>\n                        <div class="col-md-6">\n                            <div class="mb-3">\n                                <label for="fcmToken" class="form-label">FCM Device Token</label>\n                                <input type="text" class="form-control" id="fcmToken" name="fcm_token" placeholder="e.g., eW8C5Nx8u5I:..." required>\n                                <small class="form-text text-muted">Firebase Cloud Messaging token from your device</small>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="mb-3">\n                        <label for="notificationTemplate" class="form-label">Notification Template</label>\n                        <select class="form-control" id="notificationTemplate" required>\n                            <option value="">-- Select a template --</option>\n                            <option value="rating">Rating Push Notification</option>\n                            <option value="simple">Simple Push Notification</option>\n                        </select>\n                    </div>\n\n                    <!-- Simple Template Fields -->\n                    <div id="simpleTemplateFields" style="display: none;">\n                        <div class="row">\n                            <div class="col-md-6">\n                                <div class="mb-3">\n                                    <label for="notificationTitle" class="form-label">Title</label>\n                                    <input type="text" class="form-control" id="notificationTitle" placeholder="Enter notification title">\n                                </div>\n                            </div>\n                            <div class="col-md-6">\n                                <div class="mb-3">\n                                    <label for="notificationMessage" class="form-label">Message</label>\n                                    <input type="text" class="form-control" id="notificationMessage" placeholder="Enter notification message">\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <!-- Common Fields for all templates -->\n                    <div id="commonTemplateFields" style="display: none;">\n                        <div class="mb-3">\n                            <label for="deeplinkUrl" class="form-label">Deep Link URL (Optional)</label>\n                            <input type="text" class="form-control" id="deeplinkUrl" placeholder="e.g., myapp://screen/product/123">\n                            <small class="form-text text-muted">URL to navigate to when notification is clicked</small>\n                        </div>\n\n                        <div class="mb-3">\n                            <label for="imageLink" class="form-label">Image Link (Optional)</label>\n                            <input type="text" class="form-control" id="imageLink" placeholder="e.g., https://example.com/image.png">\n                            <small class="form-text text-muted">URL to the notification image</small>\n                        </div>\n\n                        <div class="mb-3">\n                            <label class="form-label">Custom Payload (Optional)</label>\n                            <div id="payloadKeyValuePairs" class="mb-3">\n                                <!-- Key-value pairs will be added here dynamically -->\n                            </div>\n                            <button type="button" class="btn btn-sm btn-success" id="addPayloadPair">\n                                <i class="bi bi-plus"></i> Add Key-Value Pair\n                            </button>\n                            <div id="formPayloadError" class="alert alert-danger mt-2" style="display: none;"></div>\n                        </div>\n                    </div>\n\n                    <div class="mb-3">\n                        <button type="submit" class="btn btn-primary">Send Push Notification</button>\n                        <div id="pushNotificationStatus" class="mt-3"></div>\n                        <div id="fcmResponseDetails" class="mt-3" style="display: none;">\n                            <div class="card border-info">\n                                <div class="card-header bg-info text-white">\n                                    <h6 class="mb-0">FCM Response Details</h6>\n                                </div>\n                                <div class="card-body">\n                                    <div class="row">\n                                        <div class="col-md-6">\n                                            <p class="mb-2"><strong>Message ID:</strong></p>\n                                            <p id="messageId" class="text-monospace" style="font-family: monospace; word-break: break-all;">-</p>\n                                        </div>\n                                        <div class="col-md-6">\n                                            <p class="mb-2"><strong>Template Type:</strong></p>\n                                            <p id="templateType">-</p>\n                                        </div>\n                                    </div>\n                                    <div class="row">\n                                        <div class="col-md-6">\n                                            <p class="mb-2"><strong>Device Token:</strong></p>\n                                            <p id="deviceToken" class="text-monospace" style="font-family: monospace; word-break: break-all;">-</p>\n                                        </div>\n                                        <div class="col-md-6">\n                                            <p class="mb-2"><strong>Timestamp:</strong></p>\n                                            <p id="timestamp">-</p>\n                                        </div>\n                                    </div>\n                                    <div class="row">\n                                        <div class="col-12">\n                                            <p class="mb-2"><strong>Status:</strong></p>\n                                            <p id="deliveryStatus" class="badge bg-success">Sent Successfully</p>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </form>\n            </div>\n        </div>\n\n        <!-- Template Information -->\n        <!-- <div class="card mb-4">\n            <div class="card-body">\n                <h5 class="card-title">\xf0\x9f\x93\x8b Available Templates</h5>\n                <div class="row">\n                    <div class="col-md-6">\n                        <h6>Rating Push Notification</h6>\n                        <p class="text-muted small">Sends an in-app rating request with customizable UI. Includes deep link support for navigation and automatic 30-day message expiry.</p>\n                    </div>\n                    <div class="col-md-6">\n                        <h6>Simple Push Notification</h6>\n                        <p class="text-muted small">Standard notification with title and message. Supports deep links and custom payload data for flexible app integration.</p>\n                    </div>\n                </div>\n            </div>\n        </div> -->\n    </div>\n\n    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>\n    <script>\n        $(document).ready(function() {\n            // ==================== LOCAL STORAGE PERSISTENCE ====================\n            \n            // Load saved FCM token and key-value pairs on page load\n            function loadSavedData() {\n                const savedFcmToken = localStorage.getItem(\'fcm_token\');\n                const savedKeyValuePairs = localStorage.getItem(\'fcm_custom_payload_pairs\');\n                \n                if (savedFcmToken) {\n                    $(\'#fcmToken\').val(savedFcmToken);\n                }\n                \n                // Load saved key-value pairs\n                if (savedKeyValuePairs) {\n                    try {\n                        const pairs = JSON.parse(savedKeyValuePairs);\n                        for (const [key, value] of Object.entries(pairs)) {\n                            addPayloadPair(key, value);\n                        }\n                    } catch (e) {\n                        console.error(\'Failed to load saved payload pairs:\', e);\n                    }\n                }\n            }\n            \n            // Save data to localStorage (excludes sensitive credentials)\n            function saveToLocalStorage() {\n                const fcmToken = $(\'#fcmToken\').val();\n                if (fcmToken) {\n                    localStorage.setItem(\'fcm_token\', fcmToken);\n                }\n                \n                // Save key-value pairs\n                const formPayload = getFormPayloadAsJson();\n                if (Object.keys(formPayload).length > 0) {\n                    localStorage.setItem(\'fcm_custom_payload_pairs\', JSON.stringify(formPayload));\n                }\n            }\n            \n            // Track if credentials are uploaded to server\n            let credentialsUploadedToServer = localStorage.getItem(\'credentialsUploadedToServer\') === \'true\';\n            \n            // Update credential status display on page load\n            function updateCredentialStatusDisplay() {\n                if (credentialsUploadedToServer) {\n                    // $(\'#credentialsStatus\').html(\'<div class="status-success">\xe2\x9c\x93 Firebase credentials uploaded and validated successfully</div>\');\n                    $(\'#credentialsUploadedBadge\').show();\n                }\n            }\n            \n            // Save private key when file is selected\n            $(\'#privateKeysFile\').change(function() {\n                const file = this.files[0];\n                if (!file) {\n                    // If file is cleared, hide badge but keep the flag for next upload\n                    $(\'#credentialsUploadedBadge\').hide();\n                    return;\n                }\n\n                const reader = new FileReader();\n                reader.onload = function(e) {\n                    const credentials = e.target.result;\n                    \n                    const statusDiv = $(\'#credentialsStatus\');\n                    statusDiv.html(\'<div class="status-info">Uploading and validating credentials...</div>\');\n\n                    $.ajax({\n                        url: \'/validate-fcm-credentials\',\n                        method: \'POST\',\n                        data: JSON.stringify({ credentials: credentials }),\n                        contentType: \'application/json\',\n                        success: function(response) {\n                            if (response.valid) {\n                                credentialsUploadedToServer = true;\n                                localStorage.setItem(\'credentialsUploadedToServer\', \'true\');\n                                statusDiv.html(\'<div class="status-success">\xe2\x9c\x93 Firebase credentials uploaded and validated successfully</div>\');\n                                $(\'#credentialsUploadedBadge\').show();\n                            } else {\n                                credentialsUploadedToServer = false;\n                                localStorage.setItem(\'credentialsUploadedToServer\', \'false\');\n                                statusDiv.html(\'<div class="status-error">\xe2\x9c\x97 \' + (response.message || \'Validation failed\') + \'</div>\');\n                                $(\'#credentialsUploadedBadge\').hide();\n                            }\n                        },\n                        error: function(xhr, status, error) {\n                            credentialsUploadedToServer = false;\n                            localStorage.setItem(\'credentialsUploadedToServer\', \'false\');\n                            const errorMsg = xhr.responseJSON?.message || error || \'Unknown error\';\n                            statusDiv.html(\'<div class="status-error">\xe2\x9c\x97 Error: \' + errorMsg + \'</div>\');\n                            $(\'#credentialsUploadedBadge\').hide();\n                        }\n                    });\n                };\n                reader.readAsText(file);\n            });\n            \n            // Save token on blur\n            $(\'#fcmToken\').on(\'blur\', function() {\n                saveToLocalStorage();\n            });\n            \n            // Save key-value pairs whenever they change\n            $(document).on(\'change\', \'.payload-key, .payload-value\', function() {\n                saveToLocalStorage();\n            });\n            \n            // ==================== CUSTOM PAYLOAD KEY-VALUE FORM ====================\n            \n            let payloadPairCount = 0;\n            \n            // Add new key-value pair\n            $(\'#addPayloadPair\').click(function() {\n                addPayloadPair();\n            });\n            \n            function addPayloadPair(key = \'\', value = \'\') {\n                payloadPairCount++;\n                const pairId = \'pair-\' + payloadPairCount;\n                \n                const pairHtml = `\n                    <div class="row mb-2" id="${pairId}">\n                        <div class="col-md-5">\n                            <input type="text" class="form-control payload-key" placeholder="Key" value="${key}">\n                        </div>\n                        <div class="col-md-5">\n                            <input type="text" class="form-control payload-value" placeholder="Value" value="${value}">\n                        </div>\n                        <div class="col-md-2">\n                            <button type="button" class="btn btn-sm btn-danger remove-pair" data-pair-id="${pairId}">Remove</button>\n                        </div>\n                    </div>\n                `;\n                \n                $(\'#payloadKeyValuePairs\').append(pairHtml);\n            }\n            \n            // Remove key-value pair\n            $(document).on(\'click\', \'.remove-pair\', function() {\n                const pairId = $(this).data(\'pair-id\');\n                $(\'#\' + pairId).remove();\n            });\n            \n            // Convert form payload to JSON\n            function getFormPayloadAsJson() {\n                const pairs = {};\n                $(\'#payloadKeyValuePairs .row\').each(function() {\n                    const key = $(this).find(\'.payload-key\').val().trim();\n                    const value = $(this).find(\'.payload-value\').val().trim();\n                    \n                    if (key) {\n                        pairs[key] = value;\n                    }\n                });\n                return pairs;\n            }\n            \n            // ==================== TEMPLATE SELECTION ====================\n            \n            // Toggle template-specific fields based on selection\n            $(\'#notificationTemplate\').change(function() {\n                const template = $(this).val();\n                if (template) {\n                    $(\'#simpleTemplateFields\').toggle(template === \'simple\');\n                    $(\'#commonTemplateFields\').show();\n                } else {\n                    $(\'#simpleTemplateFields\').hide();\n                    $(\'#commonTemplateFields\').hide();\n                }\n            });\n            \n            // ==================== FORM SUBMISSION ====================\n            \n            // Handle form submission\n            $(\'#fcmForm\').submit(function(e) {\n                e.preventDefault();\n\n                const template = $(\'#notificationTemplate\').val();\n                if (!template) {\n                    alert(\'Please select a notification template\');\n                    return;\n                }\n\n                // Check if credentials are uploaded\n                if (!credentialsUploadedToServer) {\n                    alert(\'Please upload Firebase private key file first\');\n                    return;\n                }\n\n                // Get custom payload from form\n                const formPayload = getFormPayloadAsJson();\n                let customPayload = \'\';\n                \n                if (Object.keys(formPayload).length > 0) {\n                    customPayload = JSON.stringify(formPayload);\n                }\n\n                const fcmToken = $(\'#fcmToken\').val();\n                if (!fcmToken) {\n                    alert(\'Please enter FCM device token\');\n                    return;\n                }\n                \n                // Save token to localStorage\n                saveToLocalStorage();\n                \n                // Build request payload (NO credentials sent)\n                const requestPayload = {\n                    template_type: template,\n                    fcm_token: fcmToken,\n                    deeplink: $(\'#deeplinkUrl\').val().trim() || \'\',\n                    image_link: $(\'#imageLink\').val().trim() || \'\'\n                };\n\n                // Add template-specific fields\n                if (template === \'simple\') {\n                    requestPayload.title = $(\'#notificationTitle\').val().trim();\n                    requestPayload.message = $(\'#notificationMessage\').val().trim();\n                }\n\n                // Add custom payload if present\n                if (customPayload) {\n                    requestPayload.custom_payload = customPayload;\n                }\n\n                const statusDiv = $(\'#pushNotificationStatus\');\n                statusDiv.html(\'<div class="status-info">Sending push notification...</div>\');\n\n                $.ajax({\n                    url: \'/send-push-notification\',\n                    method: \'POST\',\n                    data: JSON.stringify(requestPayload),\n                    contentType: \'application/json\',\n                    success: function(response) {\n                        if (response.success) {\n                            statusDiv.html(\'<div class="status-success">\xe2\x9c\x93 Push notification sent successfully!</div>\');\n                            \n                            // Display detailed FCM response\n                            $(\'#messageId\').text(response.message_id || \'N/A\');\n                            $(\'#templateType\').text(response.template_type || template);\n                            $(\'#deviceToken\').text(response.device_token ? response.device_token.substring(0, 30) + \'...\' : fcmToken.substring(0, 30) + \'...\');\n                            $(\'#timestamp\').text(response.timestamp || new Date().toISOString());\n                            $(\'#deliveryStatus\').text(response.status || \'Sent Successfully\').removeClass(\'bg-danger bg-warning\').addClass(\'bg-success\');\n                            $(\'#fcmResponseDetails\').show();\n                        } else {\n                            statusDiv.html(\'<div class="status-error">\xe2\x9c\x97 \' + (response.message || \'Failed to send notification\') + \'</div>\');\n                            $(\'#fcmResponseDetails\').hide();\n                        }\n                    },\n                    error: function(xhr, status, error) {\n                        const errorMsg = xhr.responseJSON?.message || error || \'Unknown error\';\n                        statusDiv.html(\'<div class="status-error">\xe2\x9c\x97 Error: \' + errorMsg + \'</div>\');\n                        $(\'#fcmResponseDetails\').hide();\n                    }\n                });\n            });\n            \n            // Load saved data on page load\n            loadSavedData();\n            updateCredentialStatusDisplay();\n        });\n    </script>\n</body>\n</html>'
2025-11-21 17:23:12,506 - INFO - 127.0.0.1 - - [21/Nov/2025 17:23:12] "GET /push-notification HTTP/1.1" 200 -
2025-11-21 17:23:12,574 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: no-cors
Sec-Fetch-Dest: empty
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831


2025-11-21 17:23:12,575 - INFO - Body: b''
2025-11-21 17:23:12,575 - INFO - URL: http://localhost:10000/.well-known/appspecific/com.chrome.devtools.json
2025-11-21 17:23:12,575 - INFO - Method: GET
2025-11-21 17:23:12,576 - INFO - Endpoint: None
2025-11-21 17:23:12,578 - ERROR - Page not found: http://localhost:10000/.well-known/appspecific/com.chrome.devtools.json
2025-11-21 17:23:12,580 - INFO - Response: b'{\n  "error": "Not found",\n  "url": "http://localhost:10000/.well-known/appspecific/com.chrome.devtools.json"\n}\n'
2025-11-21 17:23:12,590 - INFO - 127.0.0.1 - - [21/Nov/2025 17:23:12] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-21 17:23:12,592 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua-Platform: "macOS"
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Sec-Ch-Ua-Mobile: ?0
Accept: image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: no-cors
Sec-Fetch-Dest: image
Referer: http://localhost:10000/push-notification
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831
If-None-Match: "1760083224.4597292-6435-2328635141"
If-Modified-Since: Fri, 10 Oct 2025 08:00:24 GMT


2025-11-21 17:23:12,592 - INFO - Body: b''
2025-11-21 17:23:12,593 - INFO - URL: http://localhost:10000/static/netcore_logo.png
2025-11-21 17:23:12,593 - INFO - Method: GET
2025-11-21 17:23:12,593 - INFO - Endpoint: static
2025-11-21 17:23:12,604 - INFO - Response: [File Response] Content-Type: image/png, Headers: {'Content-Disposition': 'inline; filename=netcore_logo.png', 'Content-Type': 'image/png', 'Content-Length': '6435', 'Last-Modified': 'Fri, 10 Oct 2025 08:00:24 GMT', 'Cache-Control': 'no-cache', 'ETag': '"1760083224.4597292-6435-2328635141"', 'Date': 'Fri, 21 Nov 2025 11:53:12 GMT'}
2025-11-21 17:23:12,605 - INFO - 127.0.0.1 - - [21/Nov/2025 17:23:12] "[36mGET /static/netcore_logo.png HTTP/1.1[0m" 304 -
2025-11-21 17:23:12,680 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua-Platform: "macOS"
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Sec-Ch-Ua-Mobile: ?0
Accept: image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: no-cors
Sec-Fetch-Dest: image
Referer: http://localhost:10000/push-notification
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831
If-None-Match: "1760083224.4566805-889-3395757291"
If-Modified-Since: Fri, 10 Oct 2025 08:00:24 GMT


2025-11-21 17:23:12,680 - INFO - Body: b''
2025-11-21 17:23:12,680 - INFO - URL: http://localhost:10000/static/favicon.png
2025-11-21 17:23:12,680 - INFO - Method: GET
2025-11-21 17:23:12,680 - INFO - Endpoint: static
2025-11-21 17:23:12,687 - INFO - Response: [File Response] Content-Type: image/png, Headers: {'Content-Disposition': 'inline; filename=favicon.png', 'Content-Type': 'image/png', 'Content-Length': '889', 'Last-Modified': 'Fri, 10 Oct 2025 08:00:24 GMT', 'Cache-Control': 'no-cache', 'ETag': '"1760083224.4566805-889-3395757291"', 'Date': 'Fri, 21 Nov 2025 11:53:12 GMT'}
2025-11-21 17:23:12,688 - INFO - 127.0.0.1 - - [21/Nov/2025 17:23:12] "[36mGET /static/favicon.png HTTP/1.1[0m" 304 -
2025-11-21 17:23:15,752 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Content-Length: 2512
Sec-Ch-Ua-Platform: "macOS"
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept: */*
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Content-Type: application/json
Sec-Ch-Ua-Mobile: ?0
Origin: http://localhost:10000
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/push-notification
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831


2025-11-21 17:23:15,753 - INFO - Body: b'{"credentials":"{\\n  \\"type\\": \\"service_account\\",\\n  \\"project_id\\": \\"android-project-ecomapp\\",\\n  \\"private_key_id\\": \\"98faa67ef71a81fd31a8d1d638e449d1715574c0\\",\\n  \\"private_key\\": \\"-----BEGIN PRIVATE KEY-----\\\\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC2j9OBNqCK1xoN\\\\nHwJjKUHjtGTdy39E+SJSS5Xido8P3cLLAWRBxIEoH9hc3EKD1E5V71y+KOLuUZcy\\\\nIiPxXuk5roqgERhuXpprr8U7cPganZ8jFne4mlWPnjLitxT9SP7ZkEMgz559+ZM+\\\\nW/Pbf6MejbP+qGJeABYOVmK4LQwpFvCxCZHrVJpNpOH+dnBrF9TOzWNiq4Mw8Apn\\\\ntbPmFDHU5QZwd4nE5+o5ekLCn6TyyjN/qeDxQYpi3FPcYVLB7/niM0ilIEFewfkv\\\\nxI9w5OYBnjjQOoFKuiX4lqFh00l2TJqOxT/k+xaT4My6wLiOimuCvEE0drdoVnvW\\\\nzKY8Ja/DAgMBAAECggEALZs4hysSaBzcUTLR8du4rh2+pPnVTXG/dTeUtgJQMvJ/\\\\nWx954EQqz89Eyc3sf+plt2oYjRjBuC+ByfBlckL3mIVV9C7RH6FailRavUK3eE6w\\\\nFp/iQKetgDdRFvoNsEiwAcHcQzIasfXLJuTpwofcRCG6OX/vMvRqjiJefwwh4ZGB\\\\nel2E3vBrM9c2fP3wkGWiWoTXZKtuyKV9RAbRwg5LqVNTpxhufSXgzScagDY8nLR1\\\\nrJ/83zd2EzP6p7cYFS6Uq88b0w9hWVHHwUrfTGhGYhNX6qVVl57icGgHadLXIqdT\\\\nI5+K7qHMoz6BcLrPHlEnc5uJ2rk0nmrbVKl7QJuAYQKBgQDd/yVRpS6Wtz5cV9QT\\\\n1/BEbfa98uqXnxu5fn3ddJw6uQzqQt+KcGaEg+ko/bQNkgiLgauM0JuVEP90a19T\\\\nHx/yTaP9Uo4d/GATkCX6j4eXoHAoeBnCMYuQXRlLA1tc+6hIngjDWejsZELnPLEL\\\\nFwyKWSFgAkCoUfOucHhN72fe9QKBgQDShmAajT4vjZs2Nuu0GjgYeb6JRG1+HP1Q\\\\n8ylclx7PhfAMwQNNHMV6rV/x8DDBDM2guEqccWPDvejqREKcjyGventJCXecxlgf\\\\nfi3NXtaJ8vJ9NJUT9UXxv5o8gjWcNZ2Jf1yAUxS9lxS5CMiww5sPj0H6rfEExfXR\\\\n+RyeMX2w1wKBgQCGUmlcO1wzKXD8ItBZqWDhpr+TMzYqw8TcueKianpVNb7Qx+HG\\\\nPDhrmf0sJkYZp/CvqKgKLfbVfVF0ObuV6dFEpSHCl38SObBQZfn033+liRgUBIdh\\\\nbuUJVquFLeTMICE0vxqCSRacYhXxIFHnaezWkROWqgZBUkTlmXvRfDgXOQKBgEu6\\\\nFlu2rsXANDKeMs7IF6GGOWl6+b/BgcVakmhB281eKmkMDLnyPX7RWo/WjFME3fqQ\\\\nEBaSGwbQCzYpc6SJP961Oh+dji8QkaZSZvtWv+lDQMKU5YMWWSCKgVp+o/Yaux44\\\\nd/eY6v7/l26voDElS2OfbmZTpzzGUJRE/WxR9RplAoGAUXLvWs1fqYugbSnTAbMq\\\\ni0XNQm4wtCQOjx/z2ovy4DGIyfzZGNuC76ySDcIqpyJeCtfqkq6ag05jXK3lFmGm\\\\ngeYP9vdl6VSsBj8GaYJ7kLK57dh8100Nc07JsmNZx73YRqabCBvw/1nxQzOMKkPQ\\\\nxhlHt2R1kN/+ZaOC7+xFwpM=\\\\n-----END PRIVATE KEY-----\\\\n\\",\\n  \\"client_email\\": \\"firebase-adminsdk-rep6g@android-project-ecomapp.iam.gserviceaccount.com\\",\\n  \\"client_id\\": \\"116662145837078911094\\",\\n  \\"auth_uri\\": \\"https://accounts.google.com/o/oauth2/auth\\",\\n  \\"token_uri\\": \\"https://oauth2.googleapis.com/token\\",\\n  \\"auth_provider_x509_cert_url\\": \\"https://www.googleapis.com/oauth2/v1/certs\\",\\n  \\"client_x509_cert_url\\": \\"https://www.googleapis.com/robot/v1/metadata/x509/firebase-adminsdk-rep6g%40android-project-ecomapp.iam.gserviceaccount.com\\",\\n  \\"universe_domain\\": \\"googleapis.com\\"\\n}\\n"}'
2025-11-21 17:23:15,753 - INFO - URL: http://localhost:10000/validate-fcm-credentials
2025-11-21 17:23:15,753 - INFO - Method: POST
2025-11-21 17:23:15,753 - INFO - Endpoint: validate_fcm_credentials
2025-11-21 17:23:15,989 - INFO - Firebase initialized successfully with /var/folders/q0/crpf2_g53vd_p40scnm76q7w0000gq/T/tmp_bupgtba.json
2025-11-21 17:23:15,989 - INFO - FCM credentials validated and stored server-side
2025-11-21 17:23:15,989 - INFO - Response: b'{\n  "message": "Credentials validated and stored",\n  "valid": true\n}\n'
2025-11-21 17:23:15,989 - INFO - 127.0.0.1 - - [21/Nov/2025 17:23:15] "POST /validate-fcm-credentials HTTP/1.1" 200 -
2025-11-21 17:23:25,106 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Content-Length: 350
Sec-Ch-Ua-Platform: "macOS"
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept: */*
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Content-Type: application/json
Sec-Ch-Ua-Mobile: ?0
Origin: http://localhost:10000
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/push-notification
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831


2025-11-21 17:23:25,108 - INFO - Body: b'{"template_type":"rating","fcm_token":"draY6WCzSciniCqnb8utwO:APA91bFzD_gJpEMuQkU3ybBTSoI2Udp1tr102HQpRxyiEz6kooBpXfl2YhdahmGjy0GCHq2SXv4M9o0qaURF_5WilcX8QyQaEkqOmWZO9uNrra2p04XXU-4","deeplink":"sampleDeeplink","image_link":"https://samplelib.com/lib/preview/jpeg/sample-clouds-400x300.jpg","custom_payload":"{\\"key1\\":\\"value1\\",\\"key2\\":\\"key3\\"}"}'
2025-11-21 17:23:25,109 - INFO - URL: http://localhost:10000/send-push-notification
2025-11-21 17:23:25,109 - INFO - Method: POST
2025-11-21 17:23:25,109 - INFO - Endpoint: send_push_notification
2025-11-21 17:23:25,112 - INFO - Deleted existing Firebase app instance
2025-11-21 17:23:25,214 - INFO - Firebase initialized successfully with /var/folders/q0/crpf2_g53vd_p40scnm76q7w0000gq/T/tmpw5ne6sz8.json
2025-11-21 17:23:25,214 - INFO - ================================================================================
2025-11-21 17:23:25,214 - INFO - COMPLETE PAYLOAD BEING SENT:
2025-11-21 17:23:25,214 - INFO - ================================================================================
2025-11-21 17:23:25,214 - INFO - Template Type: rating
2025-11-21 17:23:25,214 - INFO - FCM Token: draY6WCzSciniCqnb8utwO:APA91bFzD_gJpEMuQkU3ybBTSoI2Udp1tr102HQpRxyiEz6kooBpXfl2YhdahmGjy0GCHq2SXv4M9o0qaURF_5WilcX8QyQaEkqOmWZO9uNrra2p04XXU-4
2025-11-21 17:23:25,214 - INFO - Full Payload (JSON):
{
  "smtSrc": "Smartech",
  "data": {
    "actionButton": [],
    "attrParams": {},
    "carousel": [],
    "customPayload": {
      "key1": "value1",
      "key2": "key3"
    },
    "deeplink": "sampleDeeplink",
    "expiry": 1766318005,
    "image": "https://samplelib.com/lib/preview/jpeg/sample-clouds-400x300.jpg",
    "message": "Rating Push Notification",
    "publishedDate": "2025-11-21T17:23:25.214181",
    "sound": true,
    "status": "sent",
    "subtitle": "",
    "title": "Rating Push Notification",
    "trid": "175567-591-13872-0-20251121172325-T",
    "type": "Image"
  },
  "trid": "175567-591-13872-0-20251121172325-T",
  "smtUi": {
    "flid": 1,
    "lid": 1,
    "rat": {
      "cbt": "Submit",
      "dl": "",
      "sc": 5,
      "si": "https://cdna.netcoresmartech.com/14340/1680080201.png",
      "ty": 1,
      "ui": "https://cdna.netcoresmartech.com/14340/1680076013.png"
    }
  },
  "smtCustomPayload": {
    "key1": "value1",
    "key2": "key3"
  }
}
2025-11-21 17:23:25,214 - INFO - ================================================================================
2025-11-21 17:23:25,214 - INFO - ================================================================================
2025-11-21 17:23:25,214 - INFO - FCM MESSAGE DATA (converted to strings):
2025-11-21 17:23:25,214 - INFO - ================================================================================
2025-11-21 17:23:25,214 - INFO - Data Dict (JSON):
{
  "smtSrc": "Smartech",
  "trid": "175567-591-13872-0-20251121172325-T",
  "data": "{\"actionButton\": [], \"attrParams\": {}, \"carousel\": [], \"customPayload\": {\"key1\": \"value1\", \"key2\": \"key3\"}, \"deeplink\": \"sampleDeeplink\", \"expiry\": 1766318005, \"image\": \"https://samplelib.com/lib/preview/jpeg/sample-clouds-400x300.jpg\", \"message\": \"Rating Push Notification\", \"publishedDate\": \"2025-11-21T17:23:25.214181\", \"sound\": true, \"status\": \"sent\", \"subtitle\": \"\", \"title\": \"Rating Push Notification\", \"trid\": \"175567-591-13872-0-20251121172325-T\", \"type\": \"Image\"}",
  "smtUi": "{\"flid\": 1, \"lid\": 1, \"rat\": {\"cbt\": \"Submit\", \"dl\": \"\", \"sc\": 5, \"si\": \"https://cdna.netcoresmartech.com/14340/1680080201.png\", \"ty\": 1, \"ui\": \"https://cdna.netcoresmartech.com/14340/1680076013.png\"}}",
  "smtCustomPayload": "{\"key1\": \"value1\", \"key2\": \"key3\"}"
}
2025-11-21 17:23:25,214 - INFO - ================================================================================
2025-11-21 17:23:25,778 - INFO - Successfully sent notification to draY6WCzSciniCqnb8utwO:APA91bFzD_gJpEMuQkU3ybBTSoI2Udp1tr102HQpRxyiEz6kooBpXfl2YhdahmGjy0GCHq2SXv4M9o0qaURF_5WilcX8QyQaEkqOmWZO9uNrra2p04XXU-4. Message ID: projects/android-project-ecomapp/messages/0:1763726005749414%6c8bbd1a6c8bbd1a
2025-11-21 17:23:25,779 - INFO - push_notification_sent: {"template": "rating", "device": "draY6WCzSciniCqnb8ut...", "message_id": "projects/android-project-ecomapp/messages/0:1763726005749414%6c8bbd1a6c8bbd1a", "timestamp": "2025-11-21T17:23:25.779093"}
2025-11-21 17:23:25,779 - INFO - Response: b'{\n  "device_token": "draY6WCzSciniCqnb8utwO:APA91bFzD_gJpEMuQkU3ybBTSoI2Udp1tr102HQpRxyiEz6kooBpXfl2YhdahmGjy0GCHq2SXv4M9o0qaURF_5WilcX8QyQaEkqOmWZO9uNrra2p04XXU-4",\n  "message": "Push notification sent successfully",\n  "message_id": "projects/android-project-ecomapp/messages/0:1763726005749414%6c8bbd1a6c8bbd1a",\n  "status": "Sent Successfully",\n  "status_color": "bg-success",\n  "success": true,\n  "template_type": "rating",\n  "timestamp": "2025-11-21T17:23:25.779321"\n}\n'
2025-11-21 17:23:25,780 - INFO - 127.0.0.1 - - [21/Nov/2025 17:23:25] "POST /send-push-notification HTTP/1.1" 200 -
2025-11-21 17:28:38,287 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:10000/push-notification
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831


2025-11-21 17:28:38,290 - INFO - Body: b''
2025-11-21 17:28:38,290 - INFO - URL: http://localhost:10000/
2025-11-21 17:28:38,290 - INFO - Method: GET
2025-11-21 17:28:38,291 - INFO - Endpoint: index
2025-11-21 17:28:38,305 - INFO - Response: b'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Event Validation Tool</title>\n    <link rel="icon" type="image/png" href="/static/favicon.png">\n    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">\n    <link href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" rel="stylesheet">\n    <style>\n        :root {\n            --primary-color: #e35502;\n            --header-bg: #230f2e;\n        }\n        \n        .container { margin-top: 30px; }\n        .table-container { margin-top: 20px; }\n        .filter-container { margin: 20px 0; }\n        .hidden { display: none; }\n        .first-event { color: blue; }\n        \n        /* Header styling */\n        .navbar {\n            background-color: var(--header-bg) !important;\n        }\n        \n        .navbar-brand, .navbar-nav .nav-link {\n            color: white !important;\n        }\n        \n        .navbar-brand img {\n            height: 40px;\n            width: auto;\n            filter: brightness(0) invert(1); /* Makes logo white for dark background */\n        }\n        \n        /* Responsive logo sizing */\n        @media (max-width: 768px) {\n            .navbar-brand img {\n                height: 30px;\n            }\n            .navbar-brand span {\n                font-size: 0.9rem;\n            }\n        }\n        \n        .navbar-toggler {\n            border-color: rgba(255,255,255,0.5);\n        }\n        \n        .navbar-toggler-icon {\n            background-image: url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 30 30\'%3e%3cpath stroke=\'rgba%28255, 255, 255, 0.75%29\' stroke-linecap=\'round\' stroke-miterlimit=\'10\' stroke-width=\'2\' d=\'M4 7h22M4 15h22M4 23h22\'/%3e%3c/svg%3e");\n        }\n        \n        /* Button styling */\n        .btn-primary {\n            background-color: var(--primary-color) !important;\n            border-color: var(--primary-color) !important;\n        }\n        \n        .btn-primary:hover {\n            background-color: #c64802 !important;\n            border-color: #c64802 !important;\n        }\n        \n        .btn-outline-primary {\n            color: white !important;\n            border-color: white !important;\n        }\n        \n        .btn-outline-primary:hover {\n            background-color: rgba(255,255,255,0.1) !important;\n        }\n        .null-value { background-color: yellow; }\n        .valid-status { color: green; }\n        .invalid-status { color: red; }\n        .empty-status { color: orange; }\n        .not-present { color: darkolivegreen; }\n        .extra-key { color: rgb(24, 214, 185); }\n        .type-mismatch { background-color: #ffe6e6; }\n        .download-section {\n            margin: 20px 0;\n            text-align: right;\n        }\n        /* Status color coding */\n        .status-valid { background-color: #d4edda !important; color: #155724 !important; }\n        .status-invalid { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-empty { background-color: #fff3cd !important; color: #856404 !important; }\n        .status-extra { background-color: #d1ecf1 !important; color: #0c5460 !important; }\n        .status-notpresent { background-color: #042508 !important; color: #7f7b97 !important; }\n        .status-csv { background-color: #e2e3e5 !important; color: #383d41 !important; }\n        .status-extra-event { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-extra-field { background-color: #fff3cd !important; color: #856404 !important; }\n        .validation-status {\n            font-weight: bold;\n        }\n        .status-valid {\n            color: #28a745;\n        }\n        .status-invalid {\n            color: #dc3545;\n        }\n        .status-empty {\n            color: #ffc107;\n        }\n        .status-extra {\n            color: #17a2b8;\n        }\n        .status-extra-event {\n            color: #dc3545;\n        }\n        .status-extra-field {\n            color: #ffc107;\n        }\n        .filter-section {\n            background-color: #f8f9fa;\n            padding: 15px;\n            margin-bottom: 20px;\n            border-radius: 5px;\n        }\n        .sort-header {\n            cursor: pointer;\n        }\n        .sort-header:hover {\n            background-color: #e9ecef;\n        }\n        .sort-icon {\n            margin-left: 5px;\n        }\n        .filter-dropdown {\n            position: relative;\n            display: inline-block;\n        }\n        .filter-content {\n            display: none;\n            position: absolute;\n            background-color: #f9f9f9;\n            min-width: 200px;\n            max-height: 300px;\n            overflow-y: auto;\n            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\n            z-index: 1000;\n            padding: 10px;\n        }\n        .filter-content.show {\n            display: block;\n        }\n        .filter-checkbox {\n            margin: 5px 0;\n        }\n        .filter-checkbox label {\n            display: block;\n            padding: 5px;\n            cursor: pointer;\n        }\n        .filter-checkbox label:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-header {\n            display: flex;\n            align-items: center;\n            cursor: pointer;\n            padding: 5px;\n        }\n        .filter-header:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-icon {\n            margin-left: 5px;\n        }\n        .filter-actions {\n            margin-top: 10px;\n            padding-top: 10px;\n            border-top: 1px solid #ddd;\n        }\n    </style>\n</head>\n<body>\n    <nav class="navbar navbar-expand-lg navbar-light bg-light">\n        <div class="container-fluid">\n            <a class="navbar-brand d-flex align-items-center" href="#">\n                <img src="/static/netcore_logo.png" alt="Netcore Logo" height="40" class="me-2">\n                <span> Payload Validator</span>\n            </a>\n            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">\n                <span class="navbar-toggler-icon"></span>\n            </button>\n            <div class="collapse navbar-collapse" id="navbarNav">\n                <ul class="navbar-nav ms-auto">\n                    <li class="nav-item">\n                        <a class="btn btn-info me-2" href="/push-notification" style="background-color:#c64802 !important; border-color: #c64802 !important;">\xf0\x9f\x93\xb1 Push Notification</a>\n                    </li>\n                    <li class="nav-item">\n                        <a class="btn btn-primary" href="https://contact-api-via-csv-7e94e.web.app/" target="_blank">Trigger Activity API</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </nav>\n\n    <div class="container">\n        <h2>Event Validation Tool</h2>\n        \n        <div class="card mb-4">\n            <div class="card-body">\n                <div class="mb-3">\n                    <label class="form-label">Validation Mode</label>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="regularMode" value="regular" checked>\n                        <label class="form-check-label" for="regularMode">\n                            Android and iOS Event (Single Event/Event Payload format)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteMode" value="website">\n                        <label class="form-check-label" for="websiteMode">\n                            Website Logs Validation (JSON lines format with eventname and payload)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteV2Mode" value="website-v2">\n                        <label class="form-check-label" for="websiteV2Mode">\n                            Website Logs V2 Validation (JSON lines format with event key and system fields excluded)\n                        </label>\n                    </div>\n                    <!-- Webhook mode removed -->\n                </div>\n                \n                <form id="uploadForm" enctype="multipart/form-data">\n                    <div class="mb-3">\n                        <label for="csvFile" class="form-label">CSV File (Validation Rules)</label>\n                        <input type="file" class="form-control" id="csvFile" name="csv_file" accept=".csv" required>\n                        <div class="mt-2">\n                            <a href="/download_template" class="btn btn-outline-secondary btn-sm" download>\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"></path>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"></path>\n                                </svg>\n                                Download Sample CSV Template\n                            </a>\n                        </div>\n                    </div>\n                    <div class="mb-3" id="logInputContainer">\n                        <label class="form-label">Event Logs Input</label>\n                        <div class="form-check form-check-inline">\n                            <input class="form-check-input" type="radio" name="logInputMode" id="logInputFile" value="file" checked>\n                            <label class="form-check-label" for="logInputFile">Upload TXT File</label>\n                        </div>\n                        <div class="form-check form-check-inline">\n                            <input class="form-check-input" type="radio" name="logInputMode" id="logInputPaste" value="paste">\n                            <label class="form-check-label" for="logInputPaste">Paste Logs Manually</label>\n                        </div>\n                        <div id="txtFileInputWrapper" class="mt-2">\n                            <label for="txtFile" class="form-label">TXT File (Event Logs)</label>\n                            <input type="file" class="form-control" id="txtFile" name="txt_file" accept=".txt">\n                            <div class="mt-2 sample-downloads">\n                                <!-- Regular mode sample -->\n                                <button class="btn btn-outline-secondary btn-sm sample-download regular-mode download-btn" data-mode="regular">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"></path>\n                                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"></path>\n                                    </svg>\n                                    Download Regular Sample Log\n                                </button>\n                                <!-- Website mode sample -->\n                                <button class="btn btn-outline-secondary btn-sm sample-download website-mode download-btn" data-mode="website" style="display: none;">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"></path>\n                                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"></path>\n                                    </svg>\n                                    Download Website Sample Log\n                                </button>\n                                <!-- Website V2 mode samples -->\n                                <div class="v2-mode-downloads" style="display: none;">\n                                    <button class="btn btn-outline-secondary btn-sm mb-1 download-btn" data-mode="website-v2" data-multiline="false">\n                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                            <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"></path>\n                                            <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"></path>\n                                        </svg>\n                                        Download Website V2 Sample Log\n                                    </button>\n                                    <br>\n                                    <button class="btn btn-outline-secondary btn-sm download-btn" data-mode="website-v2" data-multiline="true">\n                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                            <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"></path>\n                                            <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"></path>\n                                        </svg>\n                                        Download Website V2 Multiline Sample\n                                    </button>\n                                </div>\n                                <div id="downloadError" class="alert alert-danger mt-2" style="display: none;"></div>\n                            </div>\n                        </div>\n                        <div id="manualLogInputWrapper" class="mt-2" style="display:none;">\n                            <label for="manualLogInput" class="form-label">Paste Event Logs Here</label>\n                            <textarea class="form-control" id="manualLogInput" name="manual_log" rows="8" placeholder="Paste logs here, e.g. Event Payload: {...}"></textarea>\n                        </div>\n                    </div>\n                    <!-- Webhook controls removed -->\n                    <button type="submit" class="btn btn-primary">Validate</button>\n                </form>\n            </div>\n        </div>\n\n        <div class="filter-section" id="filterSection" style="display: none;">\n            <div class="row mb-3">\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Summary</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>CSV Events:</strong></p>\n                                    <p class="text-primary" id="csvEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Log Events:</strong></p>\n                                    <p class="text-success" id="logEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Details</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Missing Events:</strong></p>\n                                    <p class="text-warning" id="missingEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Extra Events:</strong></p>\n                                    <p class="text-info" id="extraEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <h4>Filters</h4>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="eventName">\n                            Event Name <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="eventNameFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="eventNameSelectAll" checked>\n                                <label for="eventNameSelectAll">Select All</label>\n                            </div>\n                            <input type="text" id="eventNameSearch" class="form-control mb-2" placeholder="Search events...">\n                            <div id="eventNameOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'eventName\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'eventName\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="status">\n                            Status <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="statusFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="statusSelectAll" checked>\n                                <label for="statusSelectAll">Select All</label>\n                            </div>\n                            <div id="statusOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'status\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'status\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="expectedType">\n                            Expected Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="expectedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="expectedTypeSelectAll" checked>\n                                <label for="expectedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="expectedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'expectedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'expectedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="receivedType">\n                            Received Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="receivedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="receivedTypeSelectAll" checked>\n                                <label for="receivedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="receivedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'receivedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'receivedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-secondary" id="clearFilters">Clear All Filters</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-success" id="downloadResults">Download Results</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-info" id="downloadValidEvents">Download Valid Events</button>\n                </div>\n            </div>\n        </div>\n\n        <div id="fullyValidEventsSection" class="alert alert-success" style="display:none;">\n            <strong>Events with all payloads valid:</strong>\n            <ul id="fullyValidEventsList" style="margin-bottom:0;"></ul>\n        </div>\n\n        <div class="table-container">\n            <table class="table table-striped" id="resultsTable">\n                <thead>\n                    <tr>\n                        <th class="sort-header" data-sort="eventName">Event Name <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="key">Key <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="value">Value <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="expectedType">Expected Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="receivedType">Received Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="validationStatus">Status <span class="sort-icon">\xe2\x86\x95</span></th>\n                    </tr>\n                </thead>\n                <tbody id="resultsBody"></tbody>\n            </table>\n        </div>\n    </div>\n\n    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/moment/moment.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>\n    <script>\n        let currentResults = [];\n        let currentSummary = {};\n        let currentSort = { field: null, order: \'asc\' };\n        let activeFilters = {\n            eventName: [],\n            status: [],\n            expectedType: [],\n            receivedType: []\n        };\n\n        $(\'#dateRange\').daterangepicker({\n            autoUpdateInput: false,\n            locale: {\n                cancelLabel: \'Clear\'\n            }\n        });\n\n        $(\'#dateRange\').on(\'apply.daterangepicker\', function(ev, picker) {\n            $(this).val(picker.startDate.format(\'MM/DD/YYYY\') + \' - \' + picker.endDate.format(\'MM/DD/YYYY\'));\n            applyFilters();\n        });\n\n        $(\'#dateRange\').on(\'cancel.daterangepicker\', function(ev, picker) {\n            $(this).val(\'\');\n            applyFilters();\n        });\n\n        // Handle validation mode changes\n        $(\'input[name="validationMode"]\').change(function() {\n            const mode = $(this).val();\n            // Hide all sample download buttons and file inputs first\n            $(\'.sample-download, .v2-mode-downloads\').hide();\n            const $txtFileInput = $(\'#txtFile\');\n            const $txtFileContainer = $txtFileInput.closest(\'.mb-3\');\n            // Show appropriate elements based on mode\n            if (mode === \'regular\') {\n                $(\'.sample-download.regular-mode\').show();\n                $txtFileContainer.show();\n            } else if (mode === \'website\') {\n                $(\'.sample-download.website-mode\').show();\n                $txtFileContainer.show();\n            } else if (mode === \'website-v2\') {\n                $(\'.v2-mode-downloads\').show();\n                $txtFileContainer.show();\n            }\n        });\n\n        // Toggle between file and manual log input\n        $(\'input[name="logInputMode"]\').change(function() {\n            if ($(this).val() === \'file\') {\n                $(\'#txtFileInputWrapper\').show();\n                $(\'#manualLogInputWrapper\').hide();\n                $(\'#txtFile\').prop(\'required\', true);\n                $(\'#manualLogInput\').prop(\'required\', false);\n            } else {\n                $(\'#txtFileInputWrapper\').hide();\n                $(\'#manualLogInputWrapper\').show();\n                $(\'#txtFile\').prop(\'required\', false);\n                $(\'#manualLogInput\').prop(\'required\', true);\n            }\n        });\n\n        $(\'#uploadForm\').on(\'submit\', function(e) {\n            e.preventDefault();\n            const formData = new FormData();\n            const validationMode = $(\'input[name="validationMode"]:checked\').val();\n            let endpoint = \'/upload\';\n            if (validationMode === \'website\') {\n                endpoint = \'/validate-website-logs\';\n            } else if (validationMode === \'website-v2\') {\n                endpoint = \'/validate-website-logs-v2\';\n            }\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + endpoint;\n\n            // Always append CSV file\n            const csvFile = $(\'#csvFile\')[0].files[0];\n            if (csvFile) {\n                formData.append(\'csv_file\', csvFile);\n            }\n\n            // Check log input mode\n            const logInputMode = $(\'input[name="logInputMode"]:checked\').val();\n            if (logInputMode === \'file\') {\n                const txtFile = $(\'#txtFile\')[0].files[0];\n                if (txtFile) {\n                    formData.append(\'txt_file\', txtFile);\n                }\n            } else if (logInputMode === \'paste\') {\n                const manualLog = $(\'#manualLogInput\').val();\n                if (manualLog && manualLog.trim().length > 0) {\n                    formData.append(\'manual_log\', manualLog);\n                }\n            }\n\n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: formData,\n                processData: false,\n                contentType: false,\n                success: function(response) {\n                    // ...existing code...\n                    currentResults = [];\n                    currentSummary = {\n                        csv_events_count: 0,\n                        log_events_count: 0,\n                        csv_events: [],\n                        log_events: []\n                    };\n                    window.originalLogs = {};\n                    // ...existing code...\n                    if (response && response.results && Array.isArray(response.results)) {\n                        currentResults = response.results;\n                        if (response.summary) {\n                            currentSummary = response.summary;\n                        }\n                        if (response.original_logs) {\n                            window.originalLogs = response.original_logs;\n                        }\n                    } else if (Array.isArray(response)) {\n                        currentResults = response;\n                    } else {\n                        console.error(\'Invalid response format:\', response);\n                    }\n                    updateEventSummary();\n                    updateFilters();\n                    displayResults(currentResults);\n                    $(\'#filterSection\').show();\n                    if (response.fully_valid_events && response.fully_valid_events.length > 0) {\n                        $(\'#fullyValidEventsList\').empty();\n                        response.fully_valid_events.forEach(function(eventName) {\n                            $(\'#fullyValidEventsList\').append(\'<li>\' + eventName + \'</li>\');\n                        });\n                        $(\'#fullyValidEventsSection\').show();\n                    } else {\n                        $(\'#fullyValidEventsSection\').hide();\n                    }\n                },\n                error: function(xhr) {\n                    console.error(\'Upload error:\', xhr);\n                    alert(\'Error uploading files: \' + xhr.responseText);\n                }\n            });\n        });\n\n        // Webhook functionality removed\n\n        // Initialize filter dropdowns\n        // Handle sample file downloads\n        $(\'.download-btn\').click(function() {\n            const mode = $(this).data(\'mode\');\n            const multiline = $(this).data(\'multiline\') || false;\n            let url = `/download_sample_log/${mode}`;\n            if (mode === \'website-v2\' && multiline) {\n                url += \'?multiline=true\';\n            }\n\n            // Show loading state\n            $(this).prop(\'disabled\', true);\n            $(this).html(\'<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Downloading...\');\n            const button = $(this);\n\n            fetch(url)\n                .then(response => {\n                    if (!response.ok) {\n                        return response.json().then(err => Promise.reject(err));\n                    }\n                    return response.blob();\n                })\n                .then(blob => {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    let filename = \'sample_log.txt\';\n                    if (mode === \'website\') {\n                        filename = \'sample_website_logs.txt\';\n                    } else if (mode === \'website-v2\') {\n                        filename = multiline ? \'sample_website_logs_v2_multiline.txt\' : \'sample_website_logs_v2.txt\';\n                    }\n                    a.href = url;\n                    a.download = filename;\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                    $(\'#downloadError\').hide();\n                })\n                .catch(error => {\n                    console.error(\'Download error:\', error);\n                    $(\'#downloadError\').text(error.error || \'Error downloading file. Please try again.\').show();\n                })\n                .finally(() => {\n                    // Restore button state\n                    button.prop(\'disabled\', false);\n                    const svg = button.find(\'svg\').prop(\'outerHTML\');\n                    button.html(svg + \' Download \' + (mode === \'website-v2\' ? \n                        (multiline ? \'Website V2 Multiline Sample\' : \'Website V2 Sample Log\') : \n                        (mode === \'website\' ? \'Website Sample Log\' : \'Regular Sample Log\')));\n                });\n        });\n\n        $(document).ready(function() {\n            $(\'.filter-header\').click(function(e) {\n                e.stopPropagation();\n                const filterId = $(this).data(\'filter\');\n                console.log(\'Clicked filter:\', filterId);\n                $(`#${filterId}Filter`).toggleClass(\'show\');\n            });\n\n            // Close filter dropdowns when clicking outside\n            $(document).click(function(e) {\n                if (!$(e.target).closest(\'.filter-dropdown\').length) {\n                    $(\'.filter-content\').removeClass(\'show\');\n                }\n            });\n        });\n\n        function updateEventSummary() {\n            // Update event count displays\n            $(\'#csvEventsCount\').text(currentSummary.csv_events_count || 0);\n            $(\'#logEventsCount\').text(currentSummary.log_events_count || 0);\n            \n            // Calculate missing and extra events\n            const csvEvents = new Set(currentSummary.csv_events || []);\n            const logEvents = new Set(currentSummary.log_events || []);\n            \n            const missingEvents = csvEvents.size - new Set([...csvEvents].filter(x => logEvents.has(x))).size;\n            const extraEvents = logEvents.size - new Set([...logEvents].filter(x => csvEvents.has(x))).size;\n            \n            $(\'#missingEventsCount\').text(missingEvents);\n            $(\'#extraEventsCount\').text(extraEvents);\n        }\n\n        function updateFilters() {\n            const eventNames = new Set();\n            const expectedTypes = new Set();\n            const receivedTypes = new Set();\n            const statuses = new Set();\n            \n            currentResults.forEach(result => {\n                if (result.eventName) eventNames.add(result.eventName);\n                if (result.expectedType) expectedTypes.add(result.expectedType);\n                if (result.receivedType) receivedTypes.add(result.receivedType);\n                if (result.validationStatus) statuses.add(result.validationStatus);\n            });\n\n            console.log(\'Available statuses:\', Array.from(statuses));\n\n            updateFilterOptions(\'eventName\', eventNames);\n            updateFilterOptions(\'status\', statuses);\n            updateFilterOptions(\'expectedType\', expectedTypes);\n            updateFilterOptions(\'receivedType\', receivedTypes);\n        }\n\n        function updateFilterOptions(filterId, values) {\n            const container = $(`#${filterId}Options`);\n            container.empty();\n            \n            // Store all values for search filtering\n            if (!window.allFilterValues) window.allFilterValues = {};\n            window.allFilterValues[filterId] = Array.from(values).sort();\n\n            function renderOptions(filterValues) {\n                container.empty();\n                filterValues.forEach(value => {\n                    if (value) {\n                        const checkboxId = `${filterId}_${value.replace(/[^a-zA-Z0-9]/g, \'_\')}`;\n                        container.append(`\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="${checkboxId}" value="${value}" checked>\n                                <label for="${checkboxId}">${value}</label>\n                            </div>\n                        `);\n                    }\n                });\n            }\n\n            renderOptions(window.allFilterValues[filterId]);\n\n            // Update select all checkbox\n            $(`#${filterId}SelectAll`).prop(\'checked\', true);\n\n            // Add search functionality for eventName filter\n            if (filterId === \'eventName\') {\n                $(\'#eventNameSearch\').off(\'input\').on(\'input\', function() {\n                    const search = $(this).val().toLowerCase();\n                    const filtered = window.allFilterValues[\'eventName\'].filter(v => v.toLowerCase().includes(search));\n                    renderOptions(filtered);\n                });\n            }\n        }\n\n        function getSelectedValues(filterId) {\n            return $(`#${filterId}Options input:checked`).map(function() {\n                return $(this).val();\n            }).get();\n        }\n\n        function applyFilter(filterId) {\n            activeFilters[filterId] = getSelectedValues(filterId);\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function clearFilter(filterId) {\n            $(`#${filterId}Options input`).prop(\'checked\', false);\n            $(`#${filterId}SelectAll`).prop(\'checked\', false);\n            activeFilters[filterId] = [];\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function applyFilters() {\n            const filters = {\n                eventName: activeFilters.eventName,\n                validationStatus: activeFilters.status,\n                expectedType: activeFilters.expectedType,\n                receivedType: activeFilters.receivedType\n            };\n\n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/filter\';\n\n            console.log(\'Making filter request to:\', fullUrl);\n\n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({\n                    results: currentResults,\n                    filters: filters,\n                    sort_by: currentSort.field,\n                    sort_order: currentSort.order\n                }),\n                contentType: \'application/json\',\n                success: function(response) {\n                    displayResults(response);\n                    window.filteredResults = response;\n                },\n                error: function(xhr) {\n                    console.error(\'Filter error:\', xhr);\n                    alert(\'Error applying filters: \' + xhr.responseText);\n                }\n            });\n        }\n\n        // Handle select all checkboxes\n        $(\'[id$="SelectAll"]\').change(function() {\n            const filterId = this.id.replace(\'SelectAll\', \'\');\n            $(`#${filterId}Options input`).prop(\'checked\', $(this).prop(\'checked\'));\n        });\n\n        // Update select all checkbox when individual checkboxes change\n        $(\'.filter-content\').on(\'change\', \'input[type="checkbox"]:not([id$="SelectAll"])\', function() {\n            const filterId = $(this).closest(\'.filter-content\').attr(\'id\').replace(\'Filter\', \'\');\n            const allChecked = $(`#${filterId}Options input:checked`).length === $(`#${filterId}Options input`).length;\n            $(`#${filterId}SelectAll`).prop(\'checked\', allChecked);\n        });\n\n        $(\'#clearFilters\').click(function() {\n            $(\'.filter-content input[type="checkbox"]\').prop(\'checked\', false);\n            $(\'[id$="SelectAll"]\').prop(\'checked\', false);\n            Object.keys(activeFilters).forEach(key => {\n                activeFilters[key] = [];\n            });\n            applyFilters();\n        });\n\n        $(\'#downloadResults\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download\';\n            \n            console.log(\'Making download request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ results: resultsToDownload }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'validation_results.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download error:\', xhr);\n                    alert(\'Error downloading results: \' + xhr.responseText);\n                }\n            });\n        });\n\n        $(\'#downloadValidEvents\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download-valid-events\';\n            \n            console.log(\'Making download valid events request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ \n                    results: resultsToDownload,\n                    logs_data: window.originalLogs || {}\n                }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'valid_events_report.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download valid events error:\', xhr);\n                    alert(\'Error downloading valid events: \' + xhr.responseText);\n                }\n            });\n        });\n\n        function displayResults(results) {\n            const tbody = $(\'#resultsBody\');\n            tbody.empty();\n            \n            // Debug log to check results being displayed\n            console.log(\'Displaying results:\', results);\n            \n            results.forEach(result => {\n                const statusClass = getStatusClass(result.validationStatus);\n                tbody.append(`\n                    <tr>\n                        <td>${result.eventName}</td>\n                        <td>${result.key}</td>\n                        <td>${result.value}</td>\n                        <td>${result.expectedType}</td>\n                        <td>${result.receivedType}</td>\n                        <td class="validation-status ${statusClass}">${result.validationStatus}</td>\n                    </tr>\n                `);\n            });\n        }\n\n        function getStatusClass(status) {\n            if (status === \'Valid\') return \'status-valid\';\n            if (status === \'Invalid/Wrong datatype/value\') return \'status-invalid\';\n            if (status === \'Payload value is Empty\') return \'status-empty\';\n            if (status === \'Extra key present in the log\') return \'status-extra\';\n            if (status === \'Extra event present in logs\') return \'status-extra-event\';\n            if (status === \'Field from extra event\') return \'status-extra-field\';\n            if (status === \'Event name not present in the logs\') return \'status-notpresent\';\n            return \'\';\n        }\n\n        $(\'.sort-header\').click(function() {\n            const field = $(this).data(\'sort\');\n            if (currentSort.field === field) {\n                currentSort.order = currentSort.order === \'asc\' ? \'desc\' : \'asc\';\n            } else {\n                currentSort.field = field;\n                currentSort.order = \'asc\';\n            }\n            applyFilters();\n        });\n\n        $(\'#eventNameFilter, #statusFilter, #expectedTypeFilter, #receivedTypeFilter\').change(applyFilters);\n\n    </script>\n</body>\n</html>'
2025-11-21 17:28:38,306 - INFO - 127.0.0.1 - - [21/Nov/2025 17:28:38] "GET / HTTP/1.1" 200 -
2025-11-21 17:28:38,354 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: no-cors
Sec-Fetch-Dest: empty
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831


2025-11-21 17:28:38,356 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua-Platform: "macOS"
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Sec-Ch-Ua-Mobile: ?0
Accept: image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: no-cors
Sec-Fetch-Dest: image
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831
If-None-Match: "1760083224.4597292-6435-2328635141"
If-Modified-Since: Fri, 10 Oct 2025 08:00:24 GMT


2025-11-21 17:28:38,357 - INFO - Body: b''
2025-11-21 17:28:38,357 - INFO - Body: b''
2025-11-21 17:28:38,357 - INFO - URL: http://localhost:10000/.well-known/appspecific/com.chrome.devtools.json
2025-11-21 17:28:38,358 - INFO - Method: GET
2025-11-21 17:28:38,358 - INFO - URL: http://localhost:10000/static/netcore_logo.png
2025-11-21 17:28:38,358 - INFO - Endpoint: None
2025-11-21 17:28:38,358 - INFO - Method: GET
2025-11-21 17:28:38,359 - INFO - Endpoint: static
2025-11-21 17:28:38,359 - ERROR - Page not found: http://localhost:10000/.well-known/appspecific/com.chrome.devtools.json
2025-11-21 17:28:38,364 - INFO - Response: b'{\n  "error": "Not found",\n  "url": "http://localhost:10000/.well-known/appspecific/com.chrome.devtools.json"\n}\n'
2025-11-21 17:28:38,364 - INFO - 127.0.0.1 - - [21/Nov/2025 17:28:38] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-21 17:28:38,370 - INFO - Response: [File Response] Content-Type: image/png, Headers: {'Content-Disposition': 'inline; filename=netcore_logo.png', 'Content-Type': 'image/png', 'Content-Length': '6435', 'Last-Modified': 'Fri, 10 Oct 2025 08:00:24 GMT', 'Cache-Control': 'no-cache', 'ETag': '"1760083224.4597292-6435-2328635141"', 'Date': 'Fri, 21 Nov 2025 11:58:38 GMT'}
2025-11-21 17:28:38,371 - INFO - 127.0.0.1 - - [21/Nov/2025 17:28:38] "[36mGET /static/netcore_logo.png HTTP/1.1[0m" 304 -
2025-11-21 17:28:53,704 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831


2025-11-21 17:28:53,705 - INFO - Body: b''
2025-11-21 17:28:53,706 - INFO - URL: http://localhost:10000/push-notification
2025-11-21 17:28:53,706 - INFO - Method: GET
2025-11-21 17:28:53,706 - INFO - Endpoint: push_notification
2025-11-21 17:28:53,707 - INFO - Response: b'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>FCM Push Notification Sender</title>\n    <link rel="icon" type="image/png" href="/static/favicon.png">\n    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">\n    <style>\n        :root {\n            --primary-color: #e35502;\n            --header-bg: #230f2e;\n        }\n        #addPayloadPair{\n            color: #d1d1d1;\n            background-color: #230f2e;\n        }\n        .bg-info {\n            background-color: #230f2e !important;\n            color: #230f2e;\n        }\n       \n        .container { margin-top: 30px; }\n        .form-label { font-weight: 600; color: #333; }\n        \n        /* Header styling */\n        .navbar {\n            background-color: var(--header-bg) !important;\n        }\n        \n        .navbar-brand, .navbar-nav .nav-link {\n            color: white !important;\n        }\n        \n        .navbar-brand img {\n            height: 40px;\n            width: auto;\n            filter: brightness(0) invert(1);\n        }\n        \n        @media (max-width: 768px) {\n            .navbar-brand img {\n                height: 30px;\n            }\n            .navbar-brand span {\n                font-size: 0.9rem;\n            }\n        }\n        \n        .navbar-toggler {\n            border-color: rgba(255,255,255,0.5);\n        }\n        \n        .navbar-toggler-icon {\n            background-image: url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 30 30\'%3e%3cpath stroke=\'rgba%28255, 255, 255, 0.75%29\' stroke-linecap=\'round\' stroke-miterlimit=\'10\' stroke-width=\'2\' d=\'M4 7h22M4 15h22M4 23h22\'/%3e%3c/svg%3e");\n        }\n        \n        /* Button styling */\n        .btn-primary {\n            background-color: var(--primary-color) !important;\n            border-color: var(--primary-color) !important;\n        }\n        \n        .btn-primary:hover {\n            background-color: #c64802 !important;\n            border-color: #c64802 !important;\n        }\n        \n        .btn-outline-primary {\n            color: white !important;\n            border-color: white !important;\n        }\n        \n        .btn-outline-primary:hover {\n            background-color: rgba(255,255,255,0.1) !important;\n        }\n        \n        .alert {\n            border-radius: 5px;\n        }\n        \n        .status-success {\n            background-color: #d4edda;\n            color: #155724;\n            border: 1px solid #c3e6cb;\n            padding: 12px;\n            border-radius: 5px;\n            margin-top: 10px;\n        }\n        \n        .status-error {\n            background-color: #f8d7da;\n            color: #721c24;\n            border: 1px solid #f5c6cb;\n            padding: 12px;\n            border-radius: 5px;\n            margin-top: 10px;\n        }\n        \n        .status-info {\n            background-color: #d1ecf1;\n            color: #0c5460;\n            border: 1px solid #bee5eb;\n            padding: 12px;\n            border-radius: 5px;\n            margin-top: 10px;\n        }\n\n        .payload-key,\n        .payload-value {\n            font-size: 0.9rem;\n        }\n\n        .remove-pair {\n            font-size: 0.85rem;\n            padding: 0.3rem 0.5rem;\n        }\n    </style>\n</head>\n<body>\n    <!-- Navbar matching main page -->\n    <nav class="navbar navbar-expand-lg navbar-light bg-light">\n        <div class="container-fluid">\n            <a class="navbar-brand d-flex align-items-center" href="/">\n                <img src="/static/netcore_logo.png" alt="Netcore Logo" height="40" class="me-2">\n                <span> Notifications</span>\n            </a>\n            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">\n                <span class="navbar-toggler-icon"></span>\n            </button>\n            <div class="collapse navbar-collapse" id="navbarNav">\n                <ul class="navbar-nav ms-auto">\n                    <li class="nav-item">\n                        <a class="btn btn-primary" href="/">\xe2\x86\x90 Back to Validation</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </nav>\n\n    <div class="container">\n        <h2>\xf0\x9f\x93\xb1 FCM Push Notification Sender</h2>\n        \n        <div class="card mb-4">\n            <div class="card-body">\n                <form id="fcmForm" enctype="multipart/form-data">\n                    <div class="row">\n                        <div class="col-md-6">\n                            <div class="mb-3">\n                                <label for="privateKeysFile" class="form-label">\n                                    Firebase Private Key (JSON)\n                                    <span id="credentialsUploadedBadge" class="badge bg-success ms-2" style="display: none;background-color: #230f2e !important; color: #f9f9f9;">\xe2\x9c\x93 Uploaded</span>\n                                </label>\n                                <input type="file" class="form-control" id="privateKeysFile" name="private_keys" accept=".json">\n                                <small class="form-text text-muted">Upload your Firebase service account JSON file</small>\n                                <div id="credentialsStatus" class="mt-2"></div>\n                            </div>\n                        </div>\n                        <div class="col-md-6">\n                            <div class="mb-3">\n                                <label for="fcmToken" class="form-label">FCM Device Token</label>\n                                <input type="text" class="form-control" id="fcmToken" name="fcm_token" placeholder="e.g., eW8C5Nx8u5I:..." required>\n                                <small class="form-text text-muted">Firebase Cloud Messaging token from your device</small>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="mb-3">\n                        <label for="notificationTemplate" class="form-label">Notification Template</label>\n                        <select class="form-control" id="notificationTemplate" required>\n                            <option value="">-- Select a template --</option>\n                            <option value="rating">Rating Push Notification</option>\n                            <option value="simple">Simple Push Notification</option>\n                        </select>\n                    </div>\n\n                    <!-- Simple Template Fields -->\n                    <div id="simpleTemplateFields" style="display: none;">\n                        <div class="row">\n                            <div class="col-md-6">\n                                <div class="mb-3">\n                                    <label for="notificationTitle" class="form-label">Title</label>\n                                    <input type="text" class="form-control" id="notificationTitle" placeholder="Enter notification title">\n                                </div>\n                            </div>\n                            <div class="col-md-6">\n                                <div class="mb-3">\n                                    <label for="notificationMessage" class="form-label">Message</label>\n                                    <input type="text" class="form-control" id="notificationMessage" placeholder="Enter notification message">\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <!-- Common Fields for all templates -->\n                    <div id="commonTemplateFields" style="display: none;">\n                        <div class="mb-3">\n                            <label for="deeplinkUrl" class="form-label">Deep Link URL (Optional)</label>\n                            <input type="text" class="form-control" id="deeplinkUrl" placeholder="e.g., myapp://screen/product/123">\n                            <small class="form-text text-muted">URL to navigate to when notification is clicked</small>\n                        </div>\n\n                        <div class="mb-3">\n                            <label for="imageLink" class="form-label">Image Link (Optional)</label>\n                            <input type="text" class="form-control" id="imageLink" placeholder="e.g., https://example.com/image.png">\n                            <small class="form-text text-muted">URL to the notification image</small>\n                        </div>\n\n                        <div class="mb-3">\n                            <label class="form-label">Custom Payload (Optional)</label>\n                            <div id="payloadKeyValuePairs" class="mb-3">\n                                <!-- Key-value pairs will be added here dynamically -->\n                            </div>\n                            <button type="button" class="btn btn-sm btn-success" id="addPayloadPair">\n                                <i class="bi bi-plus"></i> Add Key-Value Pair\n                            </button>\n                            <div id="formPayloadError" class="alert alert-danger mt-2" style="display: none;"></div>\n                        </div>\n                    </div>\n\n                    <div class="mb-3">\n                        <button type="submit" class="btn btn-primary">Send Push Notification</button>\n                        <div id="pushNotificationStatus" class="mt-3"></div>\n                        <div id="fcmResponseDetails" class="mt-3" style="display: none;">\n                            <div class="card border-info">\n                                <div class="card-header bg-info text-white">\n                                    <h6 class="mb-0">FCM Response Details</h6>\n                                </div>\n                                <div class="card-body">\n                                    <div class="row">\n                                        <div class="col-md-6">\n                                            <p class="mb-2"><strong>Message ID:</strong></p>\n                                            <p id="messageId" class="text-monospace" style="font-family: monospace; word-break: break-all;">-</p>\n                                        </div>\n                                        <div class="col-md-6">\n                                            <p class="mb-2"><strong>Template Type:</strong></p>\n                                            <p id="templateType">-</p>\n                                        </div>\n                                    </div>\n                                    <div class="row">\n                                        <div class="col-md-6">\n                                            <p class="mb-2"><strong>Device Token:</strong></p>\n                                            <p id="deviceToken" class="text-monospace" style="font-family: monospace; word-break: break-all;">-</p>\n                                        </div>\n                                        <div class="col-md-6">\n                                            <p class="mb-2"><strong>Timestamp:</strong></p>\n                                            <p id="timestamp">-</p>\n                                        </div>\n                                    </div>\n                                    <div class="row">\n                                        <div class="col-12">\n                                            <p class="mb-2"><strong>Status:</strong></p>\n                                            <p id="deliveryStatus" class="badge bg-success">Sent Successfully</p>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </form>\n            </div>\n        </div>\n\n        <!-- Template Information -->\n        <!-- <div class="card mb-4">\n            <div class="card-body">\n                <h5 class="card-title">\xf0\x9f\x93\x8b Available Templates</h5>\n                <div class="row">\n                    <div class="col-md-6">\n                        <h6>Rating Push Notification</h6>\n                        <p class="text-muted small">Sends an in-app rating request with customizable UI. Includes deep link support for navigation and automatic 30-day message expiry.</p>\n                    </div>\n                    <div class="col-md-6">\n                        <h6>Simple Push Notification</h6>\n                        <p class="text-muted small">Standard notification with title and message. Supports deep links and custom payload data for flexible app integration.</p>\n                    </div>\n                </div>\n            </div>\n        </div> -->\n    </div>\n\n    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>\n    <script>\n        $(document).ready(function() {\n            // ==================== LOCAL STORAGE PERSISTENCE ====================\n            \n            // Load saved FCM token and key-value pairs on page load\n            function loadSavedData() {\n                const savedFcmToken = localStorage.getItem(\'fcm_token\');\n                const savedKeyValuePairs = localStorage.getItem(\'fcm_custom_payload_pairs\');\n                \n                if (savedFcmToken) {\n                    $(\'#fcmToken\').val(savedFcmToken);\n                }\n                \n                // Load saved key-value pairs\n                if (savedKeyValuePairs) {\n                    try {\n                        const pairs = JSON.parse(savedKeyValuePairs);\n                        for (const [key, value] of Object.entries(pairs)) {\n                            addPayloadPair(key, value);\n                        }\n                    } catch (e) {\n                        console.error(\'Failed to load saved payload pairs:\', e);\n                    }\n                }\n            }\n            \n            // Save data to localStorage (excludes sensitive credentials)\n            function saveToLocalStorage() {\n                const fcmToken = $(\'#fcmToken\').val();\n                if (fcmToken) {\n                    localStorage.setItem(\'fcm_token\', fcmToken);\n                }\n                \n                // Save key-value pairs\n                const formPayload = getFormPayloadAsJson();\n                if (Object.keys(formPayload).length > 0) {\n                    localStorage.setItem(\'fcm_custom_payload_pairs\', JSON.stringify(formPayload));\n                }\n            }\n            \n            // Track if credentials are uploaded to server\n            let credentialsUploadedToServer = localStorage.getItem(\'credentialsUploadedToServer\') === \'true\';\n            \n            // Update credential status display on page load\n            function updateCredentialStatusDisplay() {\n                if (credentialsUploadedToServer) {\n                    // $(\'#credentialsStatus\').html(\'<div class="status-success">\xe2\x9c\x93 Firebase credentials uploaded and validated successfully</div>\');\n                    $(\'#credentialsUploadedBadge\').show();\n                }\n            }\n            \n            // Save private key when file is selected\n            $(\'#privateKeysFile\').change(function() {\n                const file = this.files[0];\n                if (!file) {\n                    // If file is cleared, hide badge but keep the flag for next upload\n                    $(\'#credentialsUploadedBadge\').hide();\n                    return;\n                }\n\n                const reader = new FileReader();\n                reader.onload = function(e) {\n                    const credentials = e.target.result;\n                    \n                    const statusDiv = $(\'#credentialsStatus\');\n                    statusDiv.html(\'<div class="status-info">Uploading and validating credentials...</div>\');\n\n                    $.ajax({\n                        url: \'/validate-fcm-credentials\',\n                        method: \'POST\',\n                        data: JSON.stringify({ credentials: credentials }),\n                        contentType: \'application/json\',\n                        success: function(response) {\n                            if (response.valid) {\n                                credentialsUploadedToServer = true;\n                                localStorage.setItem(\'credentialsUploadedToServer\', \'true\');\n                                statusDiv.html(\'<div class="status-success">\xe2\x9c\x93 Firebase credentials uploaded and validated successfully</div>\');\n                                $(\'#credentialsUploadedBadge\').show();\n                            } else {\n                                credentialsUploadedToServer = false;\n                                localStorage.setItem(\'credentialsUploadedToServer\', \'false\');\n                                statusDiv.html(\'<div class="status-error">\xe2\x9c\x97 \' + (response.message || \'Validation failed\') + \'</div>\');\n                                $(\'#credentialsUploadedBadge\').hide();\n                            }\n                        },\n                        error: function(xhr, status, error) {\n                            credentialsUploadedToServer = false;\n                            localStorage.setItem(\'credentialsUploadedToServer\', \'false\');\n                            const errorMsg = xhr.responseJSON?.message || error || \'Unknown error\';\n                            statusDiv.html(\'<div class="status-error">\xe2\x9c\x97 Error: \' + errorMsg + \'</div>\');\n                            $(\'#credentialsUploadedBadge\').hide();\n                        }\n                    });\n                };\n                reader.readAsText(file);\n            });\n            \n            // Save token on blur\n            $(\'#fcmToken\').on(\'blur\', function() {\n                saveToLocalStorage();\n            });\n            \n            // Save key-value pairs whenever they change\n            $(document).on(\'change\', \'.payload-key, .payload-value\', function() {\n                saveToLocalStorage();\n            });\n            \n            // ==================== CUSTOM PAYLOAD KEY-VALUE FORM ====================\n            \n            let payloadPairCount = 0;\n            \n            // Add new key-value pair\n            $(\'#addPayloadPair\').click(function() {\n                addPayloadPair();\n            });\n            \n            function addPayloadPair(key = \'\', value = \'\') {\n                payloadPairCount++;\n                const pairId = \'pair-\' + payloadPairCount;\n                \n                const pairHtml = `\n                    <div class="row mb-2" id="${pairId}">\n                        <div class="col-md-5">\n                            <input type="text" class="form-control payload-key" placeholder="Key" value="${key}">\n                        </div>\n                        <div class="col-md-5">\n                            <input type="text" class="form-control payload-value" placeholder="Value" value="${value}">\n                        </div>\n                        <div class="col-md-2">\n                            <button type="button" class="btn btn-sm btn-danger remove-pair" data-pair-id="${pairId}">Remove</button>\n                        </div>\n                    </div>\n                `;\n                \n                $(\'#payloadKeyValuePairs\').append(pairHtml);\n            }\n            \n            // Remove key-value pair\n            $(document).on(\'click\', \'.remove-pair\', function() {\n                const pairId = $(this).data(\'pair-id\');\n                $(\'#\' + pairId).remove();\n            });\n            \n            // Convert form payload to JSON\n            function getFormPayloadAsJson() {\n                const pairs = {};\n                $(\'#payloadKeyValuePairs .row\').each(function() {\n                    const key = $(this).find(\'.payload-key\').val().trim();\n                    const value = $(this).find(\'.payload-value\').val().trim();\n                    \n                    if (key) {\n                        pairs[key] = value;\n                    }\n                });\n                return pairs;\n            }\n            \n            // ==================== TEMPLATE SELECTION ====================\n            \n            // Toggle template-specific fields based on selection\n            $(\'#notificationTemplate\').change(function() {\n                const template = $(this).val();\n                if (template) {\n                    $(\'#simpleTemplateFields\').toggle(template === \'simple\');\n                    $(\'#commonTemplateFields\').show();\n                } else {\n                    $(\'#simpleTemplateFields\').hide();\n                    $(\'#commonTemplateFields\').hide();\n                }\n            });\n            \n            // ==================== FORM SUBMISSION ====================\n            \n            // Handle form submission\n            $(\'#fcmForm\').submit(function(e) {\n                e.preventDefault();\n\n                const template = $(\'#notificationTemplate\').val();\n                if (!template) {\n                    alert(\'Please select a notification template\');\n                    return;\n                }\n\n                // Check if credentials are uploaded\n                if (!credentialsUploadedToServer) {\n                    alert(\'Please upload Firebase private key file first\');\n                    return;\n                }\n\n                // Get custom payload from form\n                const formPayload = getFormPayloadAsJson();\n                let customPayload = \'\';\n                \n                if (Object.keys(formPayload).length > 0) {\n                    customPayload = JSON.stringify(formPayload);\n                }\n\n                const fcmToken = $(\'#fcmToken\').val();\n                if (!fcmToken) {\n                    alert(\'Please enter FCM device token\');\n                    return;\n                }\n                \n                // Save token to localStorage\n                saveToLocalStorage();\n                \n                // Build request payload (NO credentials sent)\n                const requestPayload = {\n                    template_type: template,\n                    fcm_token: fcmToken,\n                    deeplink: $(\'#deeplinkUrl\').val().trim() || \'\',\n                    image_link: $(\'#imageLink\').val().trim() || \'\'\n                };\n\n                // Add template-specific fields\n                if (template === \'simple\') {\n                    requestPayload.title = $(\'#notificationTitle\').val().trim();\n                    requestPayload.message = $(\'#notificationMessage\').val().trim();\n                }\n\n                // Add custom payload if present\n                if (customPayload) {\n                    requestPayload.custom_payload = customPayload;\n                }\n\n                const statusDiv = $(\'#pushNotificationStatus\');\n                statusDiv.html(\'<div class="status-info">Sending push notification...</div>\');\n\n                $.ajax({\n                    url: \'/send-push-notification\',\n                    method: \'POST\',\n                    data: JSON.stringify(requestPayload),\n                    contentType: \'application/json\',\n                    success: function(response) {\n                        if (response.success) {\n                            statusDiv.html(\'<div class="status-success">\xe2\x9c\x93 Push notification sent successfully!</div>\');\n                            \n                            // Display detailed FCM response\n                            $(\'#messageId\').text(response.message_id || \'N/A\');\n                            $(\'#templateType\').text(response.template_type || template);\n                            $(\'#deviceToken\').text(response.device_token ? response.device_token.substring(0, 30) + \'...\' : fcmToken.substring(0, 30) + \'...\');\n                            $(\'#timestamp\').text(response.timestamp || new Date().toISOString());\n                            $(\'#deliveryStatus\').text(response.status || \'Sent Successfully\').removeClass(\'bg-danger bg-warning\').addClass(\'bg-success\');\n                            $(\'#fcmResponseDetails\').show();\n                        } else {\n                            statusDiv.html(\'<div class="status-error">\xe2\x9c\x97 \' + (response.message || \'Failed to send notification\') + \'</div>\');\n                            $(\'#fcmResponseDetails\').hide();\n                        }\n                    },\n                    error: function(xhr, status, error) {\n                        const errorMsg = xhr.responseJSON?.message || error || \'Unknown error\';\n                        statusDiv.html(\'<div class="status-error">\xe2\x9c\x97 Error: \' + errorMsg + \'</div>\');\n                        $(\'#fcmResponseDetails\').hide();\n                    }\n                });\n            });\n            \n            // Load saved data on page load\n            loadSavedData();\n            updateCredentialStatusDisplay();\n        });\n    </script>\n</body>\n</html>'
2025-11-21 17:28:53,708 - INFO - 127.0.0.1 - - [21/Nov/2025 17:28:53] "GET /push-notification HTTP/1.1" 200 -
2025-11-21 17:28:53,736 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua-Platform: "macOS"
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Sec-Ch-Ua-Mobile: ?0
Accept: image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: no-cors
Sec-Fetch-Dest: image
Referer: http://localhost:10000/push-notification
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831
If-None-Match: "1760083224.4597292-6435-2328635141"
If-Modified-Since: Fri, 10 Oct 2025 08:00:24 GMT


2025-11-21 17:28:53,736 - INFO - Body: b''
2025-11-21 17:28:53,737 - INFO - URL: http://localhost:10000/static/netcore_logo.png
2025-11-21 17:28:53,737 - INFO - Method: GET
2025-11-21 17:28:53,737 - INFO - Endpoint: static
2025-11-21 17:28:53,738 - INFO - Response: [File Response] Content-Type: image/png, Headers: {'Content-Disposition': 'inline; filename=netcore_logo.png', 'Content-Type': 'image/png', 'Content-Length': '6435', 'Last-Modified': 'Fri, 10 Oct 2025 08:00:24 GMT', 'Cache-Control': 'no-cache', 'ETag': '"1760083224.4597292-6435-2328635141"', 'Date': 'Fri, 21 Nov 2025 11:58:53 GMT'}
2025-11-21 17:28:53,738 - INFO - 127.0.0.1 - - [21/Nov/2025 17:28:53] "[36mGET /static/netcore_logo.png HTTP/1.1[0m" 304 -
2025-11-21 17:29:00,164 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Content-Length: 350
Sec-Ch-Ua-Platform: "macOS"
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept: */*
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Content-Type: application/json
Sec-Ch-Ua-Mobile: ?0
Origin: http://localhost:10000
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/push-notification
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831


2025-11-21 17:29:00,165 - INFO - Body: b'{"template_type":"rating","fcm_token":"draY6WCzSciniCqnb8utwO:APA91bFzD_gJpEMuQkU3ybBTSoI2Udp1tr102HQpRxyiEz6kooBpXfl2YhdahmGjy0GCHq2SXv4M9o0qaURF_5WilcX8QyQaEkqOmWZO9uNrra2p04XXU-4","deeplink":"sampleDeeplink","image_link":"https://samplelib.com/lib/preview/jpeg/sample-clouds-400x300.jpg","custom_payload":"{\\"key1\\":\\"value1\\",\\"key2\\":\\"key3\\"}"}'
2025-11-21 17:29:00,165 - INFO - URL: http://localhost:10000/send-push-notification
2025-11-21 17:29:00,165 - INFO - Method: POST
2025-11-21 17:29:00,165 - INFO - Endpoint: send_push_notification
2025-11-21 17:29:00,208 - INFO - Deleted existing Firebase app instance
2025-11-21 17:29:00,293 - INFO - Firebase initialized successfully with /var/folders/q0/crpf2_g53vd_p40scnm76q7w0000gq/T/tmp3i0_o5x1.json
2025-11-21 17:29:00,294 - INFO - ================================================================================
2025-11-21 17:29:00,294 - INFO - COMPLETE PAYLOAD BEING SENT:
2025-11-21 17:29:00,294 - INFO - ================================================================================
2025-11-21 17:29:00,294 - INFO - Template Type: rating
2025-11-21 17:29:00,294 - INFO - FCM Token: draY6WCzSciniCqnb8utwO:APA91bFzD_gJpEMuQkU3ybBTSoI2Udp1tr102HQpRxyiEz6kooBpXfl2YhdahmGjy0GCHq2SXv4M9o0qaURF_5WilcX8QyQaEkqOmWZO9uNrra2p04XXU-4
2025-11-21 17:29:00,294 - INFO - Full Payload (JSON):
{
  "smtSrc": "Smartech",
  "data": {
    "actionButton": [],
    "attrParams": {},
    "carousel": [],
    "customPayload": {
      "key1": "value1",
      "key2": "key3"
    },
    "deeplink": "sampleDeeplink",
    "expiry": 1766318340,
    "image": "https://samplelib.com/lib/preview/jpeg/sample-clouds-400x300.jpg",
    "message": "Rating Push Notification",
    "publishedDate": "2025-11-21T17:29:00.293990",
    "sound": true,
    "status": "sent",
    "subtitle": "",
    "title": "Rating Push Notification",
    "trid": "175567-591-13872-0-20251121172900-T",
    "type": "Image"
  },
  "trid": "175567-591-13872-0-20251121172900-T",
  "smtUi": {
    "flid": 1,
    "lid": 1,
    "rat": {
      "cbt": "Submit",
      "dl": "",
      "sc": 5,
      "si": "https://cdna.netcoresmartech.com/14340/1680080201.png",
      "ty": 1,
      "ui": "https://cdna.netcoresmartech.com/14340/1680076013.png"
    }
  },
  "smtCustomPayload": {
    "key1": "value1",
    "key2": "key3"
  }
}
2025-11-21 17:29:00,294 - INFO - ================================================================================
2025-11-21 17:29:00,294 - INFO - ================================================================================
2025-11-21 17:29:00,294 - INFO - FCM MESSAGE DATA (converted to strings):
2025-11-21 17:29:00,294 - INFO - ================================================================================
2025-11-21 17:29:00,294 - INFO - Data Dict (JSON):
{
  "smtSrc": "Smartech",
  "trid": "175567-591-13872-0-20251121172900-T",
  "data": "{\"actionButton\": [], \"attrParams\": {}, \"carousel\": [], \"customPayload\": {\"key1\": \"value1\", \"key2\": \"key3\"}, \"deeplink\": \"sampleDeeplink\", \"expiry\": 1766318340, \"image\": \"https://samplelib.com/lib/preview/jpeg/sample-clouds-400x300.jpg\", \"message\": \"Rating Push Notification\", \"publishedDate\": \"2025-11-21T17:29:00.293990\", \"sound\": true, \"status\": \"sent\", \"subtitle\": \"\", \"title\": \"Rating Push Notification\", \"trid\": \"175567-591-13872-0-20251121172900-T\", \"type\": \"Image\"}",
  "smtUi": "{\"flid\": 1, \"lid\": 1, \"rat\": {\"cbt\": \"Submit\", \"dl\": \"\", \"sc\": 5, \"si\": \"https://cdna.netcoresmartech.com/14340/1680080201.png\", \"ty\": 1, \"ui\": \"https://cdna.netcoresmartech.com/14340/1680076013.png\"}}",
  "smtCustomPayload": "{\"key1\": \"value1\", \"key2\": \"key3\"}"
}
2025-11-21 17:29:00,294 - INFO - ================================================================================
2025-11-21 17:29:00,931 - INFO - Successfully sent notification to draY6WCzSciniCqnb8utwO:APA91bFzD_gJpEMuQkU3ybBTSoI2Udp1tr102HQpRxyiEz6kooBpXfl2YhdahmGjy0GCHq2SXv4M9o0qaURF_5WilcX8QyQaEkqOmWZO9uNrra2p04XXU-4. Message ID: projects/android-project-ecomapp/messages/0:1763726340879457%6c8bbd1a6c8bbd1a
2025-11-21 17:29:00,931 - INFO - push_notification_sent: {"template": "rating", "device": "draY6WCzSciniCqnb8ut...", "message_id": "projects/android-project-ecomapp/messages/0:1763726340879457%6c8bbd1a6c8bbd1a", "timestamp": "2025-11-21T17:29:00.931495"}
2025-11-21 17:29:00,931 - INFO - Response: b'{\n  "device_token": "draY6WCzSciniCqnb8utwO:APA91bFzD_gJpEMuQkU3ybBTSoI2Udp1tr102HQpRxyiEz6kooBpXfl2YhdahmGjy0GCHq2SXv4M9o0qaURF_5WilcX8QyQaEkqOmWZO9uNrra2p04XXU-4",\n  "message": "Push notification sent successfully",\n  "message_id": "projects/android-project-ecomapp/messages/0:1763726340879457%6c8bbd1a6c8bbd1a",\n  "status": "Sent Successfully",\n  "status_color": "bg-success",\n  "success": true,\n  "template_type": "rating",\n  "timestamp": "2025-11-21T17:29:00.931602"\n}\n'
2025-11-21 17:29:00,932 - INFO - 127.0.0.1 - - [21/Nov/2025 17:29:00] "POST /send-push-notification HTTP/1.1" 200 -
2025-11-21 17:29:15,280 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:10000/push-notification
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831


2025-11-21 17:29:15,280 - INFO - Body: b''
2025-11-21 17:29:15,281 - INFO - URL: http://localhost:10000/
2025-11-21 17:29:15,281 - INFO - Method: GET
2025-11-21 17:29:15,281 - INFO - Endpoint: index
2025-11-21 17:29:15,281 - INFO - Response: b'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Event Validation Tool</title>\n    <link rel="icon" type="image/png" href="/static/favicon.png">\n    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">\n    <link href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" rel="stylesheet">\n    <style>\n        :root {\n            --primary-color: #e35502;\n            --header-bg: #230f2e;\n        }\n        \n        .container { margin-top: 30px; }\n        .table-container { margin-top: 20px; }\n        .filter-container { margin: 20px 0; }\n        .hidden { display: none; }\n        .first-event { color: blue; }\n        \n        /* Header styling */\n        .navbar {\n            background-color: var(--header-bg) !important;\n        }\n        \n        .navbar-brand, .navbar-nav .nav-link {\n            color: white !important;\n        }\n        \n        .navbar-brand img {\n            height: 40px;\n            width: auto;\n            filter: brightness(0) invert(1); /* Makes logo white for dark background */\n        }\n        \n        /* Responsive logo sizing */\n        @media (max-width: 768px) {\n            .navbar-brand img {\n                height: 30px;\n            }\n            .navbar-brand span {\n                font-size: 0.9rem;\n            }\n        }\n        \n        .navbar-toggler {\n            border-color: rgba(255,255,255,0.5);\n        }\n        \n        .navbar-toggler-icon {\n            background-image: url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 30 30\'%3e%3cpath stroke=\'rgba%28255, 255, 255, 0.75%29\' stroke-linecap=\'round\' stroke-miterlimit=\'10\' stroke-width=\'2\' d=\'M4 7h22M4 15h22M4 23h22\'/%3e%3c/svg%3e");\n        }\n        \n        /* Button styling */\n        .btn-primary {\n            background-color: var(--primary-color) !important;\n            border-color: var(--primary-color) !important;\n        }\n        \n        .btn-primary:hover {\n            background-color: #c64802 !important;\n            border-color: #c64802 !important;\n        }\n        \n        .btn-outline-primary {\n            color: white !important;\n            border-color: white !important;\n        }\n        \n        .btn-outline-primary:hover {\n            background-color: rgba(255,255,255,0.1) !important;\n        }\n        .null-value { background-color: yellow; }\n        .valid-status { color: green; }\n        .invalid-status { color: red; }\n        .empty-status { color: orange; }\n        .not-present { color: darkolivegreen; }\n        .extra-key { color: rgb(24, 214, 185); }\n        .type-mismatch { background-color: #ffe6e6; }\n        .download-section {\n            margin: 20px 0;\n            text-align: right;\n        }\n        /* Status color coding */\n        .status-valid { background-color: #d4edda !important; color: #155724 !important; }\n        .status-invalid { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-empty { background-color: #fff3cd !important; color: #856404 !important; }\n        .status-extra { background-color: #d1ecf1 !important; color: #0c5460 !important; }\n        .status-notpresent { background-color: #042508 !important; color: #7f7b97 !important; }\n        .status-csv { background-color: #e2e3e5 !important; color: #383d41 !important; }\n        .status-extra-event { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-extra-field { background-color: #fff3cd !important; color: #856404 !important; }\n        .validation-status {\n            font-weight: bold;\n        }\n        .status-valid {\n            color: #28a745;\n        }\n        .status-invalid {\n            color: #dc3545;\n        }\n        .status-empty {\n            color: #ffc107;\n        }\n        .status-extra {\n            color: #17a2b8;\n        }\n        .status-extra-event {\n            color: #dc3545;\n        }\n        .status-extra-field {\n            color: #ffc107;\n        }\n        .filter-section {\n            background-color: #f8f9fa;\n            padding: 15px;\n            margin-bottom: 20px;\n            border-radius: 5px;\n        }\n        .sort-header {\n            cursor: pointer;\n        }\n        .sort-header:hover {\n            background-color: #e9ecef;\n        }\n        .sort-icon {\n            margin-left: 5px;\n        }\n        .filter-dropdown {\n            position: relative;\n            display: inline-block;\n        }\n        .filter-content {\n            display: none;\n            position: absolute;\n            background-color: #f9f9f9;\n            min-width: 200px;\n            max-height: 300px;\n            overflow-y: auto;\n            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\n            z-index: 1000;\n            padding: 10px;\n        }\n        .filter-content.show {\n            display: block;\n        }\n        .filter-checkbox {\n            margin: 5px 0;\n        }\n        .filter-checkbox label {\n            display: block;\n            padding: 5px;\n            cursor: pointer;\n        }\n        .filter-checkbox label:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-header {\n            display: flex;\n            align-items: center;\n            cursor: pointer;\n            padding: 5px;\n        }\n        .filter-header:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-icon {\n            margin-left: 5px;\n        }\n        .filter-actions {\n            margin-top: 10px;\n            padding-top: 10px;\n            border-top: 1px solid #ddd;\n        }\n    </style>\n</head>\n<body>\n    <nav class="navbar navbar-expand-lg navbar-light bg-light">\n        <div class="container-fluid">\n            <a class="navbar-brand d-flex align-items-center" href="#">\n                <img src="/static/netcore_logo.png" alt="Netcore Logo" height="40" class="me-2">\n                <span> Payload Validator</span>\n            </a>\n            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">\n                <span class="navbar-toggler-icon"></span>\n            </button>\n            <div class="collapse navbar-collapse" id="navbarNav">\n                <ul class="navbar-nav ms-auto">\n                    <li class="nav-item">\n                        <a class="btn btn-info me-2" href="/push-notification" style="background-color:#c64802 !important; border-color: #c64802 !important;">\xf0\x9f\x93\xb1 Push Notification</a>\n                    </li>\n                    <li class="nav-item">\n                        <a class="btn btn-primary" href="https://contact-api-via-csv-7e94e.web.app/" target="_blank">Trigger Activity API</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </nav>\n\n    <div class="container">\n        <h2>Event Validation Tool</h2>\n        \n        <div class="card mb-4">\n            <div class="card-body">\n                <div class="mb-3">\n                    <label class="form-label">Validation Mode</label>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="regularMode" value="regular" checked>\n                        <label class="form-check-label" for="regularMode">\n                            Android and iOS Event (Single Event/Event Payload format)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteMode" value="website">\n                        <label class="form-check-label" for="websiteMode">\n                            Website Logs Validation (JSON lines format with eventname and payload)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteV2Mode" value="website-v2">\n                        <label class="form-check-label" for="websiteV2Mode">\n                            Website Logs V2 Validation (JSON lines format with event key and system fields excluded)\n                        </label>\n                    </div>\n                    <!-- Webhook mode removed -->\n                </div>\n                \n                <form id="uploadForm" enctype="multipart/form-data">\n                    <div class="mb-3">\n                        <label for="csvFile" class="form-label">CSV File (Validation Rules)</label>\n                        <input type="file" class="form-control" id="csvFile" name="csv_file" accept=".csv" required>\n                        <div class="mt-2">\n                            <a href="/download_template" class="btn btn-outline-secondary btn-sm" download>\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"></path>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"></path>\n                                </svg>\n                                Download Sample CSV Template\n                            </a>\n                        </div>\n                    </div>\n                    <div class="mb-3" id="logInputContainer">\n                        <label class="form-label">Event Logs Input</label>\n                        <div class="form-check form-check-inline">\n                            <input class="form-check-input" type="radio" name="logInputMode" id="logInputFile" value="file" checked>\n                            <label class="form-check-label" for="logInputFile">Upload TXT File</label>\n                        </div>\n                        <div class="form-check form-check-inline">\n                            <input class="form-check-input" type="radio" name="logInputMode" id="logInputPaste" value="paste">\n                            <label class="form-check-label" for="logInputPaste">Paste Logs Manually</label>\n                        </div>\n                        <div id="txtFileInputWrapper" class="mt-2">\n                            <label for="txtFile" class="form-label">TXT File (Event Logs)</label>\n                            <input type="file" class="form-control" id="txtFile" name="txt_file" accept=".txt">\n                            <div class="mt-2 sample-downloads">\n                                <!-- Regular mode sample -->\n                                <button class="btn btn-outline-secondary btn-sm sample-download regular-mode download-btn" data-mode="regular">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"></path>\n                                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"></path>\n                                    </svg>\n                                    Download Regular Sample Log\n                                </button>\n                                <!-- Website mode sample -->\n                                <button class="btn btn-outline-secondary btn-sm sample-download website-mode download-btn" data-mode="website" style="display: none;">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"></path>\n                                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"></path>\n                                    </svg>\n                                    Download Website Sample Log\n                                </button>\n                                <!-- Website V2 mode samples -->\n                                <div class="v2-mode-downloads" style="display: none;">\n                                    <button class="btn btn-outline-secondary btn-sm mb-1 download-btn" data-mode="website-v2" data-multiline="false">\n                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                            <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"></path>\n                                            <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"></path>\n                                        </svg>\n                                        Download Website V2 Sample Log\n                                    </button>\n                                    <br>\n                                    <button class="btn btn-outline-secondary btn-sm download-btn" data-mode="website-v2" data-multiline="true">\n                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                            <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"></path>\n                                            <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"></path>\n                                        </svg>\n                                        Download Website V2 Multiline Sample\n                                    </button>\n                                </div>\n                                <div id="downloadError" class="alert alert-danger mt-2" style="display: none;"></div>\n                            </div>\n                        </div>\n                        <div id="manualLogInputWrapper" class="mt-2" style="display:none;">\n                            <label for="manualLogInput" class="form-label">Paste Event Logs Here</label>\n                            <textarea class="form-control" id="manualLogInput" name="manual_log" rows="8" placeholder="Paste logs here, e.g. Event Payload: {...}"></textarea>\n                        </div>\n                    </div>\n                    <!-- Webhook controls removed -->\n                    <button type="submit" class="btn btn-primary">Validate</button>\n                </form>\n            </div>\n        </div>\n\n        <div class="filter-section" id="filterSection" style="display: none;">\n            <div class="row mb-3">\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Summary</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>CSV Events:</strong></p>\n                                    <p class="text-primary" id="csvEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Log Events:</strong></p>\n                                    <p class="text-success" id="logEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Details</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Missing Events:</strong></p>\n                                    <p class="text-warning" id="missingEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Extra Events:</strong></p>\n                                    <p class="text-info" id="extraEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <h4>Filters</h4>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="eventName">\n                            Event Name <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="eventNameFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="eventNameSelectAll" checked>\n                                <label for="eventNameSelectAll">Select All</label>\n                            </div>\n                            <input type="text" id="eventNameSearch" class="form-control mb-2" placeholder="Search events...">\n                            <div id="eventNameOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'eventName\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'eventName\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="status">\n                            Status <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="statusFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="statusSelectAll" checked>\n                                <label for="statusSelectAll">Select All</label>\n                            </div>\n                            <div id="statusOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'status\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'status\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="expectedType">\n                            Expected Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="expectedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="expectedTypeSelectAll" checked>\n                                <label for="expectedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="expectedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'expectedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'expectedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="receivedType">\n                            Received Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="receivedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="receivedTypeSelectAll" checked>\n                                <label for="receivedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="receivedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'receivedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'receivedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-secondary" id="clearFilters">Clear All Filters</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-success" id="downloadResults">Download Results</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-info" id="downloadValidEvents">Download Valid Events</button>\n                </div>\n            </div>\n        </div>\n\n        <div id="fullyValidEventsSection" class="alert alert-success" style="display:none;">\n            <strong>Events with all payloads valid:</strong>\n            <ul id="fullyValidEventsList" style="margin-bottom:0;"></ul>\n        </div>\n\n        <div class="table-container">\n            <table class="table table-striped" id="resultsTable">\n                <thead>\n                    <tr>\n                        <th class="sort-header" data-sort="eventName">Event Name <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="key">Key <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="value">Value <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="expectedType">Expected Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="receivedType">Received Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="validationStatus">Status <span class="sort-icon">\xe2\x86\x95</span></th>\n                    </tr>\n                </thead>\n                <tbody id="resultsBody"></tbody>\n            </table>\n        </div>\n    </div>\n\n    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/moment/moment.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>\n    <script>\n        let currentResults = [];\n        let currentSummary = {};\n        let currentSort = { field: null, order: \'asc\' };\n        let activeFilters = {\n            eventName: [],\n            status: [],\n            expectedType: [],\n            receivedType: []\n        };\n\n        $(\'#dateRange\').daterangepicker({\n            autoUpdateInput: false,\n            locale: {\n                cancelLabel: \'Clear\'\n            }\n        });\n\n        $(\'#dateRange\').on(\'apply.daterangepicker\', function(ev, picker) {\n            $(this).val(picker.startDate.format(\'MM/DD/YYYY\') + \' - \' + picker.endDate.format(\'MM/DD/YYYY\'));\n            applyFilters();\n        });\n\n        $(\'#dateRange\').on(\'cancel.daterangepicker\', function(ev, picker) {\n            $(this).val(\'\');\n            applyFilters();\n        });\n\n        // Handle validation mode changes\n        $(\'input[name="validationMode"]\').change(function() {\n            const mode = $(this).val();\n            // Hide all sample download buttons and file inputs first\n            $(\'.sample-download, .v2-mode-downloads\').hide();\n            const $txtFileInput = $(\'#txtFile\');\n            const $txtFileContainer = $txtFileInput.closest(\'.mb-3\');\n            // Show appropriate elements based on mode\n            if (mode === \'regular\') {\n                $(\'.sample-download.regular-mode\').show();\n                $txtFileContainer.show();\n            } else if (mode === \'website\') {\n                $(\'.sample-download.website-mode\').show();\n                $txtFileContainer.show();\n            } else if (mode === \'website-v2\') {\n                $(\'.v2-mode-downloads\').show();\n                $txtFileContainer.show();\n            }\n        });\n\n        // Toggle between file and manual log input\n        $(\'input[name="logInputMode"]\').change(function() {\n            if ($(this).val() === \'file\') {\n                $(\'#txtFileInputWrapper\').show();\n                $(\'#manualLogInputWrapper\').hide();\n                $(\'#txtFile\').prop(\'required\', true);\n                $(\'#manualLogInput\').prop(\'required\', false);\n            } else {\n                $(\'#txtFileInputWrapper\').hide();\n                $(\'#manualLogInputWrapper\').show();\n                $(\'#txtFile\').prop(\'required\', false);\n                $(\'#manualLogInput\').prop(\'required\', true);\n            }\n        });\n\n        $(\'#uploadForm\').on(\'submit\', function(e) {\n            e.preventDefault();\n            const formData = new FormData();\n            const validationMode = $(\'input[name="validationMode"]:checked\').val();\n            let endpoint = \'/upload\';\n            if (validationMode === \'website\') {\n                endpoint = \'/validate-website-logs\';\n            } else if (validationMode === \'website-v2\') {\n                endpoint = \'/validate-website-logs-v2\';\n            }\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + endpoint;\n\n            // Always append CSV file\n            const csvFile = $(\'#csvFile\')[0].files[0];\n            if (csvFile) {\n                formData.append(\'csv_file\', csvFile);\n            }\n\n            // Check log input mode\n            const logInputMode = $(\'input[name="logInputMode"]:checked\').val();\n            if (logInputMode === \'file\') {\n                const txtFile = $(\'#txtFile\')[0].files[0];\n                if (txtFile) {\n                    formData.append(\'txt_file\', txtFile);\n                }\n            } else if (logInputMode === \'paste\') {\n                const manualLog = $(\'#manualLogInput\').val();\n                if (manualLog && manualLog.trim().length > 0) {\n                    formData.append(\'manual_log\', manualLog);\n                }\n            }\n\n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: formData,\n                processData: false,\n                contentType: false,\n                success: function(response) {\n                    // ...existing code...\n                    currentResults = [];\n                    currentSummary = {\n                        csv_events_count: 0,\n                        log_events_count: 0,\n                        csv_events: [],\n                        log_events: []\n                    };\n                    window.originalLogs = {};\n                    // ...existing code...\n                    if (response && response.results && Array.isArray(response.results)) {\n                        currentResults = response.results;\n                        if (response.summary) {\n                            currentSummary = response.summary;\n                        }\n                        if (response.original_logs) {\n                            window.originalLogs = response.original_logs;\n                        }\n                    } else if (Array.isArray(response)) {\n                        currentResults = response;\n                    } else {\n                        console.error(\'Invalid response format:\', response);\n                    }\n                    updateEventSummary();\n                    updateFilters();\n                    displayResults(currentResults);\n                    $(\'#filterSection\').show();\n                    if (response.fully_valid_events && response.fully_valid_events.length > 0) {\n                        $(\'#fullyValidEventsList\').empty();\n                        response.fully_valid_events.forEach(function(eventName) {\n                            $(\'#fullyValidEventsList\').append(\'<li>\' + eventName + \'</li>\');\n                        });\n                        $(\'#fullyValidEventsSection\').show();\n                    } else {\n                        $(\'#fullyValidEventsSection\').hide();\n                    }\n                },\n                error: function(xhr) {\n                    console.error(\'Upload error:\', xhr);\n                    alert(\'Error uploading files: \' + xhr.responseText);\n                }\n            });\n        });\n\n        // Webhook functionality removed\n\n        // Initialize filter dropdowns\n        // Handle sample file downloads\n        $(\'.download-btn\').click(function() {\n            const mode = $(this).data(\'mode\');\n            const multiline = $(this).data(\'multiline\') || false;\n            let url = `/download_sample_log/${mode}`;\n            if (mode === \'website-v2\' && multiline) {\n                url += \'?multiline=true\';\n            }\n\n            // Show loading state\n            $(this).prop(\'disabled\', true);\n            $(this).html(\'<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Downloading...\');\n            const button = $(this);\n\n            fetch(url)\n                .then(response => {\n                    if (!response.ok) {\n                        return response.json().then(err => Promise.reject(err));\n                    }\n                    return response.blob();\n                })\n                .then(blob => {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    let filename = \'sample_log.txt\';\n                    if (mode === \'website\') {\n                        filename = \'sample_website_logs.txt\';\n                    } else if (mode === \'website-v2\') {\n                        filename = multiline ? \'sample_website_logs_v2_multiline.txt\' : \'sample_website_logs_v2.txt\';\n                    }\n                    a.href = url;\n                    a.download = filename;\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                    $(\'#downloadError\').hide();\n                })\n                .catch(error => {\n                    console.error(\'Download error:\', error);\n                    $(\'#downloadError\').text(error.error || \'Error downloading file. Please try again.\').show();\n                })\n                .finally(() => {\n                    // Restore button state\n                    button.prop(\'disabled\', false);\n                    const svg = button.find(\'svg\').prop(\'outerHTML\');\n                    button.html(svg + \' Download \' + (mode === \'website-v2\' ? \n                        (multiline ? \'Website V2 Multiline Sample\' : \'Website V2 Sample Log\') : \n                        (mode === \'website\' ? \'Website Sample Log\' : \'Regular Sample Log\')));\n                });\n        });\n\n        $(document).ready(function() {\n            $(\'.filter-header\').click(function(e) {\n                e.stopPropagation();\n                const filterId = $(this).data(\'filter\');\n                console.log(\'Clicked filter:\', filterId);\n                $(`#${filterId}Filter`).toggleClass(\'show\');\n            });\n\n            // Close filter dropdowns when clicking outside\n            $(document).click(function(e) {\n                if (!$(e.target).closest(\'.filter-dropdown\').length) {\n                    $(\'.filter-content\').removeClass(\'show\');\n                }\n            });\n        });\n\n        function updateEventSummary() {\n            // Update event count displays\n            $(\'#csvEventsCount\').text(currentSummary.csv_events_count || 0);\n            $(\'#logEventsCount\').text(currentSummary.log_events_count || 0);\n            \n            // Calculate missing and extra events\n            const csvEvents = new Set(currentSummary.csv_events || []);\n            const logEvents = new Set(currentSummary.log_events || []);\n            \n            const missingEvents = csvEvents.size - new Set([...csvEvents].filter(x => logEvents.has(x))).size;\n            const extraEvents = logEvents.size - new Set([...logEvents].filter(x => csvEvents.has(x))).size;\n            \n            $(\'#missingEventsCount\').text(missingEvents);\n            $(\'#extraEventsCount\').text(extraEvents);\n        }\n\n        function updateFilters() {\n            const eventNames = new Set();\n            const expectedTypes = new Set();\n            const receivedTypes = new Set();\n            const statuses = new Set();\n            \n            currentResults.forEach(result => {\n                if (result.eventName) eventNames.add(result.eventName);\n                if (result.expectedType) expectedTypes.add(result.expectedType);\n                if (result.receivedType) receivedTypes.add(result.receivedType);\n                if (result.validationStatus) statuses.add(result.validationStatus);\n            });\n\n            console.log(\'Available statuses:\', Array.from(statuses));\n\n            updateFilterOptions(\'eventName\', eventNames);\n            updateFilterOptions(\'status\', statuses);\n            updateFilterOptions(\'expectedType\', expectedTypes);\n            updateFilterOptions(\'receivedType\', receivedTypes);\n        }\n\n        function updateFilterOptions(filterId, values) {\n            const container = $(`#${filterId}Options`);\n            container.empty();\n            \n            // Store all values for search filtering\n            if (!window.allFilterValues) window.allFilterValues = {};\n            window.allFilterValues[filterId] = Array.from(values).sort();\n\n            function renderOptions(filterValues) {\n                container.empty();\n                filterValues.forEach(value => {\n                    if (value) {\n                        const checkboxId = `${filterId}_${value.replace(/[^a-zA-Z0-9]/g, \'_\')}`;\n                        container.append(`\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="${checkboxId}" value="${value}" checked>\n                                <label for="${checkboxId}">${value}</label>\n                            </div>\n                        `);\n                    }\n                });\n            }\n\n            renderOptions(window.allFilterValues[filterId]);\n\n            // Update select all checkbox\n            $(`#${filterId}SelectAll`).prop(\'checked\', true);\n\n            // Add search functionality for eventName filter\n            if (filterId === \'eventName\') {\n                $(\'#eventNameSearch\').off(\'input\').on(\'input\', function() {\n                    const search = $(this).val().toLowerCase();\n                    const filtered = window.allFilterValues[\'eventName\'].filter(v => v.toLowerCase().includes(search));\n                    renderOptions(filtered);\n                });\n            }\n        }\n\n        function getSelectedValues(filterId) {\n            return $(`#${filterId}Options input:checked`).map(function() {\n                return $(this).val();\n            }).get();\n        }\n\n        function applyFilter(filterId) {\n            activeFilters[filterId] = getSelectedValues(filterId);\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function clearFilter(filterId) {\n            $(`#${filterId}Options input`).prop(\'checked\', false);\n            $(`#${filterId}SelectAll`).prop(\'checked\', false);\n            activeFilters[filterId] = [];\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function applyFilters() {\n            const filters = {\n                eventName: activeFilters.eventName,\n                validationStatus: activeFilters.status,\n                expectedType: activeFilters.expectedType,\n                receivedType: activeFilters.receivedType\n            };\n\n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/filter\';\n\n            console.log(\'Making filter request to:\', fullUrl);\n\n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({\n                    results: currentResults,\n                    filters: filters,\n                    sort_by: currentSort.field,\n                    sort_order: currentSort.order\n                }),\n                contentType: \'application/json\',\n                success: function(response) {\n                    displayResults(response);\n                    window.filteredResults = response;\n                },\n                error: function(xhr) {\n                    console.error(\'Filter error:\', xhr);\n                    alert(\'Error applying filters: \' + xhr.responseText);\n                }\n            });\n        }\n\n        // Handle select all checkboxes\n        $(\'[id$="SelectAll"]\').change(function() {\n            const filterId = this.id.replace(\'SelectAll\', \'\');\n            $(`#${filterId}Options input`).prop(\'checked\', $(this).prop(\'checked\'));\n        });\n\n        // Update select all checkbox when individual checkboxes change\n        $(\'.filter-content\').on(\'change\', \'input[type="checkbox"]:not([id$="SelectAll"])\', function() {\n            const filterId = $(this).closest(\'.filter-content\').attr(\'id\').replace(\'Filter\', \'\');\n            const allChecked = $(`#${filterId}Options input:checked`).length === $(`#${filterId}Options input`).length;\n            $(`#${filterId}SelectAll`).prop(\'checked\', allChecked);\n        });\n\n        $(\'#clearFilters\').click(function() {\n            $(\'.filter-content input[type="checkbox"]\').prop(\'checked\', false);\n            $(\'[id$="SelectAll"]\').prop(\'checked\', false);\n            Object.keys(activeFilters).forEach(key => {\n                activeFilters[key] = [];\n            });\n            applyFilters();\n        });\n\n        $(\'#downloadResults\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download\';\n            \n            console.log(\'Making download request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ results: resultsToDownload }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'validation_results.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download error:\', xhr);\n                    alert(\'Error downloading results: \' + xhr.responseText);\n                }\n            });\n        });\n\n        $(\'#downloadValidEvents\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download-valid-events\';\n            \n            console.log(\'Making download valid events request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ \n                    results: resultsToDownload,\n                    logs_data: window.originalLogs || {}\n                }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'valid_events_report.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download valid events error:\', xhr);\n                    alert(\'Error downloading valid events: \' + xhr.responseText);\n                }\n            });\n        });\n\n        function displayResults(results) {\n            const tbody = $(\'#resultsBody\');\n            tbody.empty();\n            \n            // Debug log to check results being displayed\n            console.log(\'Displaying results:\', results);\n            \n            results.forEach(result => {\n                const statusClass = getStatusClass(result.validationStatus);\n                tbody.append(`\n                    <tr>\n                        <td>${result.eventName}</td>\n                        <td>${result.key}</td>\n                        <td>${result.value}</td>\n                        <td>${result.expectedType}</td>\n                        <td>${result.receivedType}</td>\n                        <td class="validation-status ${statusClass}">${result.validationStatus}</td>\n                    </tr>\n                `);\n            });\n        }\n\n        function getStatusClass(status) {\n            if (status === \'Valid\') return \'status-valid\';\n            if (status === \'Invalid/Wrong datatype/value\') return \'status-invalid\';\n            if (status === \'Payload value is Empty\') return \'status-empty\';\n            if (status === \'Extra key present in the log\') return \'status-extra\';\n            if (status === \'Extra event present in logs\') return \'status-extra-event\';\n            if (status === \'Field from extra event\') return \'status-extra-field\';\n            if (status === \'Event name not present in the logs\') return \'status-notpresent\';\n            return \'\';\n        }\n\n        $(\'.sort-header\').click(function() {\n            const field = $(this).data(\'sort\');\n            if (currentSort.field === field) {\n                currentSort.order = currentSort.order === \'asc\' ? \'desc\' : \'asc\';\n            } else {\n                currentSort.field = field;\n                currentSort.order = \'asc\';\n            }\n            applyFilters();\n        });\n\n        $(\'#eventNameFilter, #statusFilter, #expectedTypeFilter, #receivedTypeFilter\').change(applyFilters);\n\n    </script>\n</body>\n</html>'
2025-11-21 17:29:15,282 - INFO - 127.0.0.1 - - [21/Nov/2025 17:29:15] "GET / HTTP/1.1" 200 -
2025-11-21 17:29:15,295 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua-Platform: "macOS"
If-None-Match: "1760083224.4597292-6435-2328635141"
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
If-Modified-Since: Fri, 10 Oct 2025 08:00:24 GMT
Sec-Ch-Ua-Mobile: ?0
Accept: image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: no-cors
Sec-Fetch-Dest: image
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831


2025-11-21 17:29:15,295 - INFO - Body: b''
2025-11-21 17:29:15,296 - INFO - URL: http://localhost:10000/static/netcore_logo.png
2025-11-21 17:29:15,296 - INFO - Method: GET
2025-11-21 17:29:15,297 - INFO - Endpoint: static
2025-11-21 17:29:15,302 - INFO - Response: [File Response] Content-Type: image/png, Headers: {'Content-Disposition': 'inline; filename=netcore_logo.png', 'Content-Type': 'image/png', 'Content-Length': '6435', 'Last-Modified': 'Fri, 10 Oct 2025 08:00:24 GMT', 'Cache-Control': 'no-cache', 'ETag': '"1760083224.4597292-6435-2328635141"', 'Date': 'Fri, 21 Nov 2025 11:59:15 GMT'}
2025-11-21 17:29:15,303 - INFO - 127.0.0.1 - - [21/Nov/2025 17:29:15] "[36mGET /static/netcore_logo.png HTTP/1.1[0m" 304 -
2025-11-21 17:29:19,646 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831


2025-11-21 17:29:19,646 - INFO - Body: b''
2025-11-21 17:29:19,646 - INFO - URL: http://localhost:10000/download_template
2025-11-21 17:29:19,646 - INFO - Method: GET
2025-11-21 17:29:19,646 - INFO - Endpoint: download_template
2025-11-21 17:29:19,647 - INFO - Response: [File Response] Content-Type: text/csv; charset=utf-8, Headers: {'Content-Disposition': 'attachment; filename=sample_template.csv', 'Content-Type': 'text/csv; charset=utf-8', 'Content-Length': '562', 'Last-Modified': 'Fri, 10 Oct 2025 07:22:38 GMT', 'Cache-Control': 'no-cache', 'ETag': '"1760080958.9658263-562-2913214935"', 'Date': 'Fri, 21 Nov 2025 11:59:19 GMT'}
2025-11-21 17:29:19,647 - INFO - 127.0.0.1 - - [21/Nov/2025 17:29:19] "GET /download_template HTTP/1.1" 200 -
2025-11-21 17:29:39,860 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua-Platform: "macOS"
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Sec-Ch-Ua-Mobile: ?0
Accept: */*
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831


2025-11-21 17:29:39,861 - INFO - Body: b''
2025-11-21 17:29:39,861 - INFO - URL: http://localhost:10000/download_sample_log/regular
2025-11-21 17:29:39,861 - INFO - Method: GET
2025-11-21 17:29:39,861 - INFO - Endpoint: download_sample_log
2025-11-21 17:29:39,862 - INFO - Sending sample file: /Users/allen.thomson/Desktop/sampleapp/automation/validation_script_android/samplelog_android.txt
2025-11-21 17:29:39,864 - INFO - Response: [File Response] Content-Type: text/plain; charset=utf-8, Headers: {'Content-Disposition': 'attachment; filename=samplelog_android.txt', 'Content-Type': 'text/plain; charset=utf-8', 'Content-Length': '4025', 'Last-Modified': 'Thu, 12 Jun 2025 07:13:40 GMT', 'Cache-Control': 'no-cache', 'ETag': '"1749712420.029259-4025-1057957485"', 'Date': 'Fri, 21 Nov 2025 11:59:39 GMT'}
2025-11-21 17:29:39,864 - INFO - 127.0.0.1 - - [21/Nov/2025 17:29:39] "GET /download_sample_log/regular HTTP/1.1" 200 -
2025-11-21 17:32:02,859 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Content-Length: 4028
Sec-Ch-Ua-Platform: "macOS"
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept: */*
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Content-Type: multipart/form-data; boundary=----WebKitFormBoundarymBZPzg4y4wv6lPLD
Sec-Ch-Ua-Mobile: ?0
Origin: http://localhost:10000
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831


2025-11-21 17:32:02,862 - INFO - Body: b'------WebKitFormBoundarymBZPzg4y4wv6lPLD\r\nContent-Disposition: form-data; name="csv_file"; filename="sample_template.csv"\r\nContent-Type: text/csv\r\n\r\neventName,eventPayload,dataType\r\nsign_up,seat_type,text\r\n,seat number,integer\r\n,movie,text\r\n,screen,text\r\n,date,date \r\n,location,text\r\n,experience,text\r\n,amount,float\r\nuser_profile_push,seat_type,text\r\n,seat number,integer\r\n,movie,text\r\n,screen,text\r\n,date,date \r\n,location,text\r\n,experience,text\r\n,amount,float\r\nclicked,revenue,float\r\nproduct_purchase,items[].variant_id,text, NOTE: ARRAY PAYLOAD. PLEASE DONT ADD THIS ROW IN THE ACTUAL SHEET\r\n,items[].prname,text\r\n,items[].price,float\r\n,items[].prid,text\r\n,items[].brand,text\r\nappointment_click,user_type,text\r\n------WebKitFormBoundarymBZPzg4y4wv6lPLD\r\nContent-Disposition: form-data; name="txt_file"; filename="sample_log.txt"\r\nContent-Type: text/plain\r\n\r\nEvent Payload: {"networkMode":"Unknown","eventId":0,"attrParams":{},"lng":"77.6068621","timeZone":"GMT+05:30","sessionId":"1735538447236","td":0,"screenOrientation":"portrait","payload":{ "seat_type": "basic","seat_number": 383,"movie": "marco","screen": "gold","date":"2024-12-12 11:08:02","location":"inia","expertise":"action","amount":23},"identity":"918129445708","eventTime":"1735539932203","eventName":"sign_up","lat":"12.9290555","retry":0}\n\nEvent Payload: {"identity":"6760dad009a5df4362321bdc","attrParams":{},"networkMode":"","lat":null,"eventTime":"1735893266793","timeZone":"GMT+05:30","eventId":0,"retry":0,"sessionId":"1735893263035","eventName":"viewed","td":0,"screenOrientation":"unknown","lng":null,"payload":{"name":"gid:\\/\\/shopify\\/ProductVariant\\/47363221193000","number":12,"price":12.11,"date":"2024-12-12 11:08:02"}}\n\nSingle Event = {"identity":"6760dad009a5df4362321bdc","attrParams":{},"networkMode":"","lat":null,"eventTime":"1735893266793","timeZone":"GMT+05:30","eventId":0,"retry":0,"sessionId":"1735893263035","eventName":"purchase","td":0,"screenOrientation":"unknown","lng":null,"payload":{"products":[{"name":"gid:\\/\\/shopify\\/ProductVariant\\/47363221193000","number":12,"price":12.11,"date":"2024-12-12 11:08:02"},{"name":"gid:\\/\\/shopify\\/ProductVariant\\/47363221193000","number":12,"price":12.11,"date":"2024-12-12 11:08:02"}]}}\n\nEvent Payload: {"networkMode":"Unknown","eventId":0,"attrParams":{},"lng":"77.6068621","timeZone":"GMT+05:30","sessionId":"1735538447236","td":0,"screenOrientation":"portrait","payload":{ "seat_type": "","seat_number": 383.11,"movie": "marco","screen": "gold","date":"2024-12-12","location":"inia","expertise":"action","amount":23,"revenue":"222","items":[{"variant_id":"gid:\\/\\/shopify\\/ProductVariant\\/47363221193000","prname":"Katyayani NPK 19 19 19 | Water Soluble Fertilizer","price":"732.00","prid":"gid:\\/\\/shopify\\/Product\\/8281838584104","brand":"Katyayani Organics"},{"variant_id":"gid:\\/\\/shopify\\/ProductVariant\\/45290092167464","prname":"Katyayani Seaweed Extract | Liquid Organic fertilizer","price":"249.00","prid":"gid:\\/\\/shopify\\/Product\\/8321730609448","brand":"Katyayani Organics"},{"variant_id":"gid:\\/\\/shopify\\/ProductVariant\\/45164076433704","prname":"Katyayani BAXIL | Bacillus supp 2% AS | Liquid Bio Fungicide","price":475,"prid":"gid:\\/\\/shopify\\/Product\\/8283406631208","brand":"Katyayani Organics"},{"variant_id":"gid:\\/\\/shopify\\/ProductVariant\\/45164483281192","prname":"Katyayani Flowering Booster Fertilizer | Organic Fertilizers","price":320.00,"prid":"gid:\\/\\/shopify\\/Product\\/8283544027432","brand":"Katyayani Organics"}]},"identity":"918129445708","eventTime":"1735539932203","eventName":"product_purchase","lat":"12.9290555","retry":0}\n\nEvent Payload: {"identity":"6760dad009a5df4362321bdc","attrParams":{},"networkMode":"","lat":null,"eventTime":"1735893266793","timeZone":"GMT+05:30","eventId":0,"retry":0,"sessionId":"1735893263035","eventName":"appointment_click","td":0,"screenOrientation":"unknown","lng":null,"payload":{"user_type":"existing","mindhealthscore":0,"mwellness_score":0,"profile_pending":"no"}}\r\n------WebKitFormBoundarymBZPzg4y4wv6lPLD--\r\n'
2025-11-21 17:32:02,862 - INFO - URL: http://localhost:10000/upload
2025-11-21 17:32:02,862 - INFO - Method: POST
2025-11-21 17:32:02,862 - INFO - Endpoint: upload
2025-11-21 17:32:02,862 - INFO - Upload endpoint called
2025-11-21 17:32:02,873 - INFO - file_upload: {"csv_file": "sample_template.csv", "timestamp": "2025-11-21T17:32:02.872971", "txt_file": "sample_log.txt"}
2025-11-21 17:32:02,876 - INFO - validation_complete: {"total_validations": 44, "valid_count": 24, "invalid_count": 20, "csv_events_count": 5, "log_events_count": 3, "extra_events_count": 0}
2025-11-21 17:32:02,877 - INFO - Response: b'{\n  "fully_valid_events": [],\n  "original_logs": {\n    "appointment_click": "Event Payload: {\\"identity\\":\\"6760dad009a5df4362321bdc\\",\\"attrParams\\":{},\\"networkMode\\":\\"\\",\\"lat\\":null,\\"eventTime\\":\\"1735893266793\\",\\"timeZone\\":\\"GMT+05:30\\",\\"eventId\\":0,\\"retry\\":0,\\"sessionId\\":\\"1735893263035\\",\\"eventName\\":\\"appointment_click\\",\\"td\\":0,\\"screenOrientation\\":\\"unknown\\",\\"lng\\":null,\\"payload\\":{\\"user_type\\":\\"existing\\",\\"mindhealthscore\\":0,\\"mwellness_score\\":0,\\"profile_pending\\":\\"no\\"}}",\n    "product_purchase": "Event Payload: {\\"networkMode\\":\\"Unknown\\",\\"eventId\\":0,\\"attrParams\\":{},\\"lng\\":\\"77.6068621\\",\\"timeZone\\":\\"GMT+05:30\\",\\"sessionId\\":\\"1735538447236\\",\\"td\\":0,\\"screenOrientation\\":\\"portrait\\",\\"payload\\":{ \\"seat_type\\": \\"\\",\\"seat_number\\": 383.11,\\"movie\\": \\"marco\\",\\"screen\\": \\"gold\\",\\"date\\":\\"2024-12-12\\",\\"location\\":\\"inia\\",\\"expertise\\":\\"action\\",\\"amount\\":23,\\"revenue\\":\\"222\\",\\"items\\":[{\\"variant_id\\":\\"gid:\\\\/\\\\/shopify\\\\/ProductVariant\\\\/47363221193000\\",\\"prname\\":\\"Katyayani NPK 19 19 19 | Water Soluble Fertilizer\\",\\"price\\":\\"732.00\\",\\"prid\\":\\"gid:\\\\/\\\\/shopify\\\\/Product\\\\/8281838584104\\",\\"brand\\":\\"Katyayani Organics\\"},{\\"variant_id\\":\\"gid:\\\\/\\\\/shopify\\\\/ProductVariant\\\\/45290092167464\\",\\"prname\\":\\"Katyayani Seaweed Extract | Liquid Organic fertilizer\\",\\"price\\":\\"249.00\\",\\"prid\\":\\"gid:\\\\/\\\\/shopify\\\\/Product\\\\/8321730609448\\",\\"brand\\":\\"Katyayani Organics\\"},{\\"variant_id\\":\\"gid:\\\\/\\\\/shopify\\\\/ProductVariant\\\\/45164076433704\\",\\"prname\\":\\"Katyayani BAXIL | Bacillus supp 2% AS | Liquid Bio Fungicide\\",\\"price\\":475,\\"prid\\":\\"gid:\\\\/\\\\/shopify\\\\/Product\\\\/8283406631208\\",\\"brand\\":\\"Katyayani Organics\\"},{\\"variant_id\\":\\"gid:\\\\/\\\\/shopify\\\\/ProductVariant\\\\/45164483281192\\",\\"prname\\":\\"Katyayani Flowering Booster Fertilizer | Organic Fertilizers\\",\\"price\\":320.00,\\"prid\\":\\"gid:\\\\/\\\\/shopify\\\\/Product\\\\/8283544027432\\",\\"brand\\":\\"Katyayani Organics\\"}]},\\"identity\\":\\"918129445708\\",\\"eventTime\\":\\"1735539932203\\",\\"eventName\\":\\"product_purchase\\",\\"lat\\":\\"12.9290555\\",\\"retry\\":0}",\n    "sign_up": "Event Payload: {\\"networkMode\\":\\"Unknown\\",\\"eventId\\":0,\\"attrParams\\":{},\\"lng\\":\\"77.6068621\\",\\"timeZone\\":\\"GMT+05:30\\",\\"sessionId\\":\\"1735538447236\\",\\"td\\":0,\\"screenOrientation\\":\\"portrait\\",\\"payload\\":{ \\"seat_type\\": \\"basic\\",\\"seat_number\\": 383,\\"movie\\": \\"marco\\",\\"screen\\": \\"gold\\",\\"date\\":\\"2024-12-12 11:08:02\\",\\"location\\":\\"inia\\",\\"expertise\\":\\"action\\",\\"amount\\":23},\\"identity\\":\\"918129445708\\",\\"eventTime\\":\\"1735539932203\\",\\"eventName\\":\\"sign_up\\",\\"lat\\":\\"12.9290555\\",\\"retry\\":0}"\n  },\n  "results": [\n    {\n      "eventName": "sign_up",\n      "expectedType": "EXTRA",\n      "key": "expertise",\n      "receivedType": "text",\n      "validationStatus": "Extra key present in the log",\n      "value": "action"\n    },\n    {\n      "eventName": "sign_up",\n      "expectedType": "text",\n      "key": "seat_type",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "basic"\n    },\n    {\n      "eventName": "sign_up",\n      "expectedType": "integer",\n      "key": "seat number",\n      "receivedType": "integer",\n      "validationStatus": "Valid",\n      "value": 383\n    },\n    {\n      "eventName": "sign_up",\n      "expectedType": "text",\n      "key": "movie",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "marco"\n    },\n    {\n      "eventName": "sign_up",\n      "expectedType": "text",\n      "key": "screen",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "gold"\n    },\n    {\n      "eventName": "sign_up",\n      "expectedType": "date",\n      "key": "date",\n      "receivedType": "date",\n      "validationStatus": "Valid",\n      "value": "2024-12-12 11:08:02"\n    },\n    {\n      "eventName": "sign_up",\n      "expectedType": "text",\n      "key": "location",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "inia"\n    },\n    {\n      "eventName": "sign_up",\n      "expectedType": "text",\n      "key": "experience",\n      "receivedType": "not present",\n      "validationStatus": "Payload not present in the log",\n      "value": null\n    },\n    {\n      "eventName": "sign_up",\n      "expectedType": "float",\n      "key": "amount",\n      "receivedType": "integer",\n      "validationStatus": "Invalid/Wrong datatype/value",\n      "value": 23\n    },\n    {\n      "comment": "Event \\"user_profile_push\\" from CSV was not found in the uploaded log file",\n      "eventName": "user_profile_push",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "user_profile_push"\n    },\n    {\n      "comment": "Event \\"clicked\\" from CSV was not found in the uploaded log file",\n      "eventName": "clicked",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "clicked"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "text",\n      "key": "items[0].variant_id",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "gid://shopify/ProductVariant/47363221193000"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "text",\n      "key": "items[0].prname",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "Katyayani NPK 19 19 19 | Water Soluble Fertilizer"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "float",\n      "key": "items[0].price",\n      "receivedType": "text",\n      "validationStatus": "Invalid/Wrong datatype/value",\n      "value": "732.00"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "text",\n      "key": "items[0].prid",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "gid://shopify/Product/8281838584104"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "text",\n      "key": "items[0].brand",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "Katyayani Organics"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "text",\n      "key": "items[1].variant_id",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "gid://shopify/ProductVariant/45290092167464"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "text",\n      "key": "items[1].prname",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "Katyayani Seaweed Extract | Liquid Organic fertilizer"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "float",\n      "key": "items[1].price",\n      "receivedType": "text",\n      "validationStatus": "Invalid/Wrong datatype/value",\n      "value": "249.00"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "text",\n      "key": "items[1].prid",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "gid://shopify/Product/8321730609448"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "text",\n      "key": "items[1].brand",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "Katyayani Organics"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "text",\n      "key": "items[2].variant_id",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "gid://shopify/ProductVariant/45164076433704"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "text",\n      "key": "items[2].prname",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "Katyayani BAXIL | Bacillus supp 2% AS | Liquid Bio Fungicide"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "float",\n      "key": "items[2].price",\n      "receivedType": "integer",\n      "validationStatus": "Invalid/Wrong datatype/value",\n      "value": 475\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "text",\n      "key": "items[2].prid",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "gid://shopify/Product/8283406631208"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "text",\n      "key": "items[2].brand",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "Katyayani Organics"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "text",\n      "key": "items[3].variant_id",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "gid://shopify/ProductVariant/45164483281192"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "text",\n      "key": "items[3].prname",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "Katyayani Flowering Booster Fertilizer | Organic Fertilizers"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "float",\n      "key": "items[3].price",\n      "receivedType": "float",\n      "validationStatus": "Valid",\n      "value": "320.00"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "text",\n      "key": "items[3].prid",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "gid://shopify/Product/8283544027432"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "text",\n      "key": "items[3].brand",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "Katyayani Organics"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "EXTRA",\n      "key": "movie",\n      "receivedType": "text",\n      "validationStatus": "Extra key present in the log",\n      "value": "marco"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "EXTRA",\n      "key": "seat_type",\n      "receivedType": "text",\n      "validationStatus": "Extra key present in the log",\n      "value": ""\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "EXTRA",\n      "key": "location",\n      "receivedType": "text",\n      "validationStatus": "Extra key present in the log",\n      "value": "inia"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "EXTRA",\n      "key": "amount",\n      "receivedType": "integer",\n      "validationStatus": "Extra key present in the log",\n      "value": 23\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "EXTRA",\n      "key": "screen",\n      "receivedType": "text",\n      "validationStatus": "Extra key present in the log",\n      "value": "gold"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "EXTRA",\n      "key": "date",\n      "receivedType": "date",\n      "validationStatus": "Extra key present in the log",\n      "value": "2024-12-12"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "EXTRA",\n      "key": "revenue",\n      "receivedType": "text",\n      "validationStatus": "Extra key present in the log",\n      "value": "222"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "EXTRA",\n      "key": "expertise",\n      "receivedType": "text",\n      "validationStatus": "Extra key present in the log",\n      "value": "action"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "EXTRA",\n      "key": "seat_number",\n      "receivedType": "float",\n      "validationStatus": "Extra key present in the log",\n      "value": 383.11\n    },\n    {\n      "eventName": "appointment_click",\n      "expectedType": "EXTRA",\n      "key": "mindhealthscore",\n      "receivedType": "integer",\n      "validationStatus": "Extra key present in the log",\n      "value": 0\n    },\n    {\n      "eventName": "appointment_click",\n      "expectedType": "EXTRA",\n      "key": "profile_pending",\n      "receivedType": "text",\n      "validationStatus": "Extra key present in the log",\n      "value": "no"\n    },\n    {\n      "eventName": "appointment_click",\n      "expectedType": "EXTRA",\n      "key": "mwellness_score",\n      "receivedType": "integer",\n      "validationStatus": "Extra key present in the log",\n      "value": 0\n    },\n    {\n      "eventName": "appointment_click",\n      "expectedType": "text",\n      "key": "user_type",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "existing"\n    }\n  ],\n  "summary": {\n    "csv_events": [\n      "product_purchase",\n      "user_profile_push",\n      "sign_up",\n      "clicked",\n      "appointment_click"\n    ],\n    "csv_events_count": 5,\n    "extra_events": [],\n    "log_events": [\n      "sign_up",\n      "appointment_click",\n      "product_purchase"\n    ],\n    "log_events_count": 3\n  }\n}\n'
2025-11-21 17:32:02,877 - INFO - 127.0.0.1 - - [21/Nov/2025 17:32:02] "POST /upload HTTP/1.1" 200 -
2025-11-21 17:32:42,831 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Content-Length: 7469
Sec-Ch-Ua-Platform: "macOS"
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept: */*
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Content-Type: application/json
Sec-Ch-Ua-Mobile: ?0
Origin: http://localhost:10000
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831


2025-11-21 17:32:42,834 - INFO - Body: b'{"results":[{"eventName":"sign_up","expectedType":"EXTRA","key":"expertise","receivedType":"text","validationStatus":"Extra key present in the log","value":"action"},{"eventName":"sign_up","expectedType":"text","key":"seat_type","receivedType":"text","validationStatus":"Valid","value":"basic"},{"eventName":"sign_up","expectedType":"integer","key":"seat number","receivedType":"integer","validationStatus":"Valid","value":383},{"eventName":"sign_up","expectedType":"text","key":"movie","receivedType":"text","validationStatus":"Valid","value":"marco"},{"eventName":"sign_up","expectedType":"text","key":"screen","receivedType":"text","validationStatus":"Valid","value":"gold"},{"eventName":"sign_up","expectedType":"date","key":"date","receivedType":"date","validationStatus":"Valid","value":"2024-12-12 11:08:02"},{"eventName":"sign_up","expectedType":"text","key":"location","receivedType":"text","validationStatus":"Valid","value":"inia"},{"eventName":"sign_up","expectedType":"text","key":"experience","receivedType":"not present","validationStatus":"Payload not present in the log","value":null},{"eventName":"sign_up","expectedType":"float","key":"amount","receivedType":"integer","validationStatus":"Invalid/Wrong datatype/value","value":23},{"comment":"Event \\"user_profile_push\\" from CSV was not found in the uploaded log file","eventName":"user_profile_push","expectedType":"event","key":"EVENT_NAME","receivedType":"not present in logs","validationStatus":"Event name not present in the logs","value":"user_profile_push"},{"comment":"Event \\"clicked\\" from CSV was not found in the uploaded log file","eventName":"clicked","expectedType":"event","key":"EVENT_NAME","receivedType":"not present in logs","validationStatus":"Event name not present in the logs","value":"clicked"},{"eventName":"product_purchase","expectedType":"text","key":"items[0].variant_id","receivedType":"text","validationStatus":"Valid","value":"gid://shopify/ProductVariant/47363221193000"},{"eventName":"product_purchase","expectedType":"text","key":"items[0].prname","receivedType":"text","validationStatus":"Valid","value":"Katyayani NPK 19 19 19 | Water Soluble Fertilizer"},{"eventName":"product_purchase","expectedType":"float","key":"items[0].price","receivedType":"text","validationStatus":"Invalid/Wrong datatype/value","value":"732.00"},{"eventName":"product_purchase","expectedType":"text","key":"items[0].prid","receivedType":"text","validationStatus":"Valid","value":"gid://shopify/Product/8281838584104"},{"eventName":"product_purchase","expectedType":"text","key":"items[0].brand","receivedType":"text","validationStatus":"Valid","value":"Katyayani Organics"},{"eventName":"product_purchase","expectedType":"text","key":"items[1].variant_id","receivedType":"text","validationStatus":"Valid","value":"gid://shopify/ProductVariant/45290092167464"},{"eventName":"product_purchase","expectedType":"text","key":"items[1].prname","receivedType":"text","validationStatus":"Valid","value":"Katyayani Seaweed Extract | Liquid Organic fertilizer"},{"eventName":"product_purchase","expectedType":"float","key":"items[1].price","receivedType":"text","validationStatus":"Invalid/Wrong datatype/value","value":"249.00"},{"eventName":"product_purchase","expectedType":"text","key":"items[1].prid","receivedType":"text","validationStatus":"Valid","value":"gid://shopify/Product/8321730609448"},{"eventName":"product_purchase","expectedType":"text","key":"items[1].brand","receivedType":"text","validationStatus":"Valid","value":"Katyayani Organics"},{"eventName":"product_purchase","expectedType":"text","key":"items[2].variant_id","receivedType":"text","validationStatus":"Valid","value":"gid://shopify/ProductVariant/45164076433704"},{"eventName":"product_purchase","expectedType":"text","key":"items[2].prname","receivedType":"text","validationStatus":"Valid","value":"Katyayani BAXIL | Bacillus supp 2% AS | Liquid Bio Fungicide"},{"eventName":"product_purchase","expectedType":"float","key":"items[2].price","receivedType":"integer","validationStatus":"Invalid/Wrong datatype/value","value":475},{"eventName":"product_purchase","expectedType":"text","key":"items[2].prid","receivedType":"text","validationStatus":"Valid","value":"gid://shopify/Product/8283406631208"},{"eventName":"product_purchase","expectedType":"text","key":"items[2].brand","receivedType":"text","validationStatus":"Valid","value":"Katyayani Organics"},{"eventName":"product_purchase","expectedType":"text","key":"items[3].variant_id","receivedType":"text","validationStatus":"Valid","value":"gid://shopify/ProductVariant/45164483281192"},{"eventName":"product_purchase","expectedType":"text","key":"items[3].prname","receivedType":"text","validationStatus":"Valid","value":"Katyayani Flowering Booster Fertilizer | Organic Fertilizers"},{"eventName":"product_purchase","expectedType":"float","key":"items[3].price","receivedType":"float","validationStatus":"Valid","value":"320.00"},{"eventName":"product_purchase","expectedType":"text","key":"items[3].prid","receivedType":"text","validationStatus":"Valid","value":"gid://shopify/Product/8283544027432"},{"eventName":"product_purchase","expectedType":"text","key":"items[3].brand","receivedType":"text","validationStatus":"Valid","value":"Katyayani Organics"},{"eventName":"product_purchase","expectedType":"EXTRA","key":"movie","receivedType":"text","validationStatus":"Extra key present in the log","value":"marco"},{"eventName":"product_purchase","expectedType":"EXTRA","key":"seat_type","receivedType":"text","validationStatus":"Extra key present in the log","value":""},{"eventName":"product_purchase","expectedType":"EXTRA","key":"location","receivedType":"text","validationStatus":"Extra key present in the log","value":"inia"},{"eventName":"product_purchase","expectedType":"EXTRA","key":"amount","receivedType":"integer","validationStatus":"Extra key present in the log","value":23},{"eventName":"product_purchase","expectedType":"EXTRA","key":"screen","receivedType":"text","validationStatus":"Extra key present in the log","value":"gold"},{"eventName":"product_purchase","expectedType":"EXTRA","key":"date","receivedType":"date","validationStatus":"Extra key present in the log","value":"2024-12-12"},{"eventName":"product_purchase","expectedType":"EXTRA","key":"revenue","receivedType":"text","validationStatus":"Extra key present in the log","value":"222"},{"eventName":"product_purchase","expectedType":"EXTRA","key":"expertise","receivedType":"text","validationStatus":"Extra key present in the log","value":"action"},{"eventName":"product_purchase","expectedType":"EXTRA","key":"seat_number","receivedType":"float","validationStatus":"Extra key present in the log","value":383.11},{"eventName":"appointment_click","expectedType":"EXTRA","key":"mindhealthscore","receivedType":"integer","validationStatus":"Extra key present in the log","value":0},{"eventName":"appointment_click","expectedType":"EXTRA","key":"profile_pending","receivedType":"text","validationStatus":"Extra key present in the log","value":"no"},{"eventName":"appointment_click","expectedType":"EXTRA","key":"mwellness_score","receivedType":"integer","validationStatus":"Extra key present in the log","value":0},{"eventName":"appointment_click","expectedType":"text","key":"user_type","receivedType":"text","validationStatus":"Valid","value":"existing"}],"filters":{"eventName":[],"validationStatus":[],"expectedType":[],"receivedType":[]},"sort_by":null,"sort_order":"asc"}'
2025-11-21 17:32:42,834 - INFO - URL: http://localhost:10000/filter
2025-11-21 17:32:42,835 - INFO - Method: POST
2025-11-21 17:32:42,835 - INFO - Endpoint: filter_results
2025-11-21 17:32:42,835 - INFO - Filter endpoint called
2025-11-21 17:32:42,836 - INFO - Filter data received: {'results': [{'eventName': 'sign_up', 'expectedType': 'EXTRA', 'key': 'expertise', 'receivedType': 'text', 'validationStatus': 'Extra key present in the log', 'value': 'action'}, {'eventName': 'sign_up', 'expectedType': 'text', 'key': 'seat_type', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'basic'}, {'eventName': 'sign_up', 'expectedType': 'integer', 'key': 'seat number', 'receivedType': 'integer', 'validationStatus': 'Valid', 'value': 383}, {'eventName': 'sign_up', 'expectedType': 'text', 'key': 'movie', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'marco'}, {'eventName': 'sign_up', 'expectedType': 'text', 'key': 'screen', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'gold'}, {'eventName': 'sign_up', 'expectedType': 'date', 'key': 'date', 'receivedType': 'date', 'validationStatus': 'Valid', 'value': '2024-12-12 11:08:02'}, {'eventName': 'sign_up', 'expectedType': 'text', 'key': 'location', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'inia'}, {'eventName': 'sign_up', 'expectedType': 'text', 'key': 'experience', 'receivedType': 'not present', 'validationStatus': 'Payload not present in the log', 'value': None}, {'eventName': 'sign_up', 'expectedType': 'float', 'key': 'amount', 'receivedType': 'integer', 'validationStatus': 'Invalid/Wrong datatype/value', 'value': 23}, {'comment': 'Event "user_profile_push" from CSV was not found in the uploaded log file', 'eventName': 'user_profile_push', 'expectedType': 'event', 'key': 'EVENT_NAME', 'receivedType': 'not present in logs', 'validationStatus': 'Event name not present in the logs', 'value': 'user_profile_push'}, {'comment': 'Event "clicked" from CSV was not found in the uploaded log file', 'eventName': 'clicked', 'expectedType': 'event', 'key': 'EVENT_NAME', 'receivedType': 'not present in logs', 'validationStatus': 'Event name not present in the logs', 'value': 'clicked'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[0].variant_id', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'gid://shopify/ProductVariant/47363221193000'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[0].prname', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'Katyayani NPK 19 19 19 | Water Soluble Fertilizer'}, {'eventName': 'product_purchase', 'expectedType': 'float', 'key': 'items[0].price', 'receivedType': 'text', 'validationStatus': 'Invalid/Wrong datatype/value', 'value': '732.00'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[0].prid', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'gid://shopify/Product/8281838584104'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[0].brand', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'Katyayani Organics'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[1].variant_id', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'gid://shopify/ProductVariant/45290092167464'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[1].prname', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'Katyayani Seaweed Extract | Liquid Organic fertilizer'}, {'eventName': 'product_purchase', 'expectedType': 'float', 'key': 'items[1].price', 'receivedType': 'text', 'validationStatus': 'Invalid/Wrong datatype/value', 'value': '249.00'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[1].prid', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'gid://shopify/Product/8321730609448'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[1].brand', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'Katyayani Organics'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[2].variant_id', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'gid://shopify/ProductVariant/45164076433704'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[2].prname', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'Katyayani BAXIL | Bacillus supp 2% AS | Liquid Bio Fungicide'}, {'eventName': 'product_purchase', 'expectedType': 'float', 'key': 'items[2].price', 'receivedType': 'integer', 'validationStatus': 'Invalid/Wrong datatype/value', 'value': 475}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[2].prid', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'gid://shopify/Product/8283406631208'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[2].brand', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'Katyayani Organics'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[3].variant_id', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'gid://shopify/ProductVariant/45164483281192'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[3].prname', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'Katyayani Flowering Booster Fertilizer | Organic Fertilizers'}, {'eventName': 'product_purchase', 'expectedType': 'float', 'key': 'items[3].price', 'receivedType': 'float', 'validationStatus': 'Valid', 'value': '320.00'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[3].prid', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'gid://shopify/Product/8283544027432'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[3].brand', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'Katyayani Organics'}, {'eventName': 'product_purchase', 'expectedType': 'EXTRA', 'key': 'movie', 'receivedType': 'text', 'validationStatus': 'Extra key present in the log', 'value': 'marco'}, {'eventName': 'product_purchase', 'expectedType': 'EXTRA', 'key': 'seat_type', 'receivedType': 'text', 'validationStatus': 'Extra key present in the log', 'value': ''}, {'eventName': 'product_purchase', 'expectedType': 'EXTRA', 'key': 'location', 'receivedType': 'text', 'validationStatus': 'Extra key present in the log', 'value': 'inia'}, {'eventName': 'product_purchase', 'expectedType': 'EXTRA', 'key': 'amount', 'receivedType': 'integer', 'validationStatus': 'Extra key present in the log', 'value': 23}, {'eventName': 'product_purchase', 'expectedType': 'EXTRA', 'key': 'screen', 'receivedType': 'text', 'validationStatus': 'Extra key present in the log', 'value': 'gold'}, {'eventName': 'product_purchase', 'expectedType': 'EXTRA', 'key': 'date', 'receivedType': 'date', 'validationStatus': 'Extra key present in the log', 'value': '2024-12-12'}, {'eventName': 'product_purchase', 'expectedType': 'EXTRA', 'key': 'revenue', 'receivedType': 'text', 'validationStatus': 'Extra key present in the log', 'value': '222'}, {'eventName': 'product_purchase', 'expectedType': 'EXTRA', 'key': 'expertise', 'receivedType': 'text', 'validationStatus': 'Extra key present in the log', 'value': 'action'}, {'eventName': 'product_purchase', 'expectedType': 'EXTRA', 'key': 'seat_number', 'receivedType': 'float', 'validationStatus': 'Extra key present in the log', 'value': 383.11}, {'eventName': 'appointment_click', 'expectedType': 'EXTRA', 'key': 'mindhealthscore', 'receivedType': 'integer', 'validationStatus': 'Extra key present in the log', 'value': 0}, {'eventName': 'appointment_click', 'expectedType': 'EXTRA', 'key': 'profile_pending', 'receivedType': 'text', 'validationStatus': 'Extra key present in the log', 'value': 'no'}, {'eventName': 'appointment_click', 'expectedType': 'EXTRA', 'key': 'mwellness_score', 'receivedType': 'integer', 'validationStatus': 'Extra key present in the log', 'value': 0}, {'eventName': 'appointment_click', 'expectedType': 'text', 'key': 'user_type', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'existing'}], 'filters': {'eventName': [], 'validationStatus': [], 'expectedType': [], 'receivedType': []}, 'sort_by': None, 'sort_order': 'asc'}
2025-11-21 17:32:42,836 - INFO - Filtered results count: 44
2025-11-21 17:32:42,837 - INFO - Response: b'[\n  {\n    "eventName": "sign_up",\n    "expectedType": "EXTRA",\n    "key": "expertise",\n    "receivedType": "text",\n    "validationStatus": "Extra key present in the log",\n    "value": "action"\n  },\n  {\n    "eventName": "sign_up",\n    "expectedType": "text",\n    "key": "seat_type",\n    "receivedType": "text",\n    "validationStatus": "Valid",\n    "value": "basic"\n  },\n  {\n    "eventName": "sign_up",\n    "expectedType": "integer",\n    "key": "seat number",\n    "receivedType": "integer",\n    "validationStatus": "Valid",\n    "value": 383\n  },\n  {\n    "eventName": "sign_up",\n    "expectedType": "text",\n    "key": "movie",\n    "receivedType": "text",\n    "validationStatus": "Valid",\n    "value": "marco"\n  },\n  {\n    "eventName": "sign_up",\n    "expectedType": "text",\n    "key": "screen",\n    "receivedType": "text",\n    "validationStatus": "Valid",\n    "value": "gold"\n  },\n  {\n    "eventName": "sign_up",\n    "expectedType": "date",\n    "key": "date",\n    "receivedType": "date",\n    "validationStatus": "Valid",\n    "value": "2024-12-12 11:08:02"\n  },\n  {\n    "eventName": "sign_up",\n    "expectedType": "text",\n    "key": "location",\n    "receivedType": "text",\n    "validationStatus": "Valid",\n    "value": "inia"\n  },\n  {\n    "eventName": "sign_up",\n    "expectedType": "text",\n    "key": "experience",\n    "receivedType": "not present",\n    "validationStatus": "Payload not present in the log",\n    "value": null\n  },\n  {\n    "eventName": "sign_up",\n    "expectedType": "float",\n    "key": "amount",\n    "receivedType": "integer",\n    "validationStatus": "Invalid/Wrong datatype/value",\n    "value": 23\n  },\n  {\n    "comment": "Event \\"user_profile_push\\" from CSV was not found in the uploaded log file",\n    "eventName": "user_profile_push",\n    "expectedType": "event",\n    "key": "EVENT_NAME",\n    "receivedType": "not present in logs",\n    "validationStatus": "Event name not present in the logs",\n    "value": "user_profile_push"\n  },\n  {\n    "comment": "Event \\"clicked\\" from CSV was not found in the uploaded log file",\n    "eventName": "clicked",\n    "expectedType": "event",\n    "key": "EVENT_NAME",\n    "receivedType": "not present in logs",\n    "validationStatus": "Event name not present in the logs",\n    "value": "clicked"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "text",\n    "key": "items[0].variant_id",\n    "receivedType": "text",\n    "validationStatus": "Valid",\n    "value": "gid://shopify/ProductVariant/47363221193000"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "text",\n    "key": "items[0].prname",\n    "receivedType": "text",\n    "validationStatus": "Valid",\n    "value": "Katyayani NPK 19 19 19 | Water Soluble Fertilizer"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "float",\n    "key": "items[0].price",\n    "receivedType": "text",\n    "validationStatus": "Invalid/Wrong datatype/value",\n    "value": "732.00"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "text",\n    "key": "items[0].prid",\n    "receivedType": "text",\n    "validationStatus": "Valid",\n    "value": "gid://shopify/Product/8281838584104"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "text",\n    "key": "items[0].brand",\n    "receivedType": "text",\n    "validationStatus": "Valid",\n    "value": "Katyayani Organics"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "text",\n    "key": "items[1].variant_id",\n    "receivedType": "text",\n    "validationStatus": "Valid",\n    "value": "gid://shopify/ProductVariant/45290092167464"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "text",\n    "key": "items[1].prname",\n    "receivedType": "text",\n    "validationStatus": "Valid",\n    "value": "Katyayani Seaweed Extract | Liquid Organic fertilizer"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "float",\n    "key": "items[1].price",\n    "receivedType": "text",\n    "validationStatus": "Invalid/Wrong datatype/value",\n    "value": "249.00"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "text",\n    "key": "items[1].prid",\n    "receivedType": "text",\n    "validationStatus": "Valid",\n    "value": "gid://shopify/Product/8321730609448"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "text",\n    "key": "items[1].brand",\n    "receivedType": "text",\n    "validationStatus": "Valid",\n    "value": "Katyayani Organics"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "text",\n    "key": "items[2].variant_id",\n    "receivedType": "text",\n    "validationStatus": "Valid",\n    "value": "gid://shopify/ProductVariant/45164076433704"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "text",\n    "key": "items[2].prname",\n    "receivedType": "text",\n    "validationStatus": "Valid",\n    "value": "Katyayani BAXIL | Bacillus supp 2% AS | Liquid Bio Fungicide"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "float",\n    "key": "items[2].price",\n    "receivedType": "integer",\n    "validationStatus": "Invalid/Wrong datatype/value",\n    "value": 475\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "text",\n    "key": "items[2].prid",\n    "receivedType": "text",\n    "validationStatus": "Valid",\n    "value": "gid://shopify/Product/8283406631208"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "text",\n    "key": "items[2].brand",\n    "receivedType": "text",\n    "validationStatus": "Valid",\n    "value": "Katyayani Organics"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "text",\n    "key": "items[3].variant_id",\n    "receivedType": "text",\n    "validationStatus": "Valid",\n    "value": "gid://shopify/ProductVariant/45164483281192"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "text",\n    "key": "items[3].prname",\n    "receivedType": "text",\n    "validationStatus": "Valid",\n    "value": "Katyayani Flowering Booster Fertilizer | Organic Fertilizers"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "float",\n    "key": "items[3].price",\n    "receivedType": "float",\n    "validationStatus": "Valid",\n    "value": "320.00"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "text",\n    "key": "items[3].prid",\n    "receivedType": "text",\n    "validationStatus": "Valid",\n    "value": "gid://shopify/Product/8283544027432"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "text",\n    "key": "items[3].brand",\n    "receivedType": "text",\n    "validationStatus": "Valid",\n    "value": "Katyayani Organics"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "EXTRA",\n    "key": "movie",\n    "receivedType": "text",\n    "validationStatus": "Extra key present in the log",\n    "value": "marco"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "EXTRA",\n    "key": "seat_type",\n    "receivedType": "text",\n    "validationStatus": "Extra key present in the log",\n    "value": ""\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "EXTRA",\n    "key": "location",\n    "receivedType": "text",\n    "validationStatus": "Extra key present in the log",\n    "value": "inia"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "EXTRA",\n    "key": "amount",\n    "receivedType": "integer",\n    "validationStatus": "Extra key present in the log",\n    "value": 23\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "EXTRA",\n    "key": "screen",\n    "receivedType": "text",\n    "validationStatus": "Extra key present in the log",\n    "value": "gold"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "EXTRA",\n    "key": "date",\n    "receivedType": "date",\n    "validationStatus": "Extra key present in the log",\n    "value": "2024-12-12"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "EXTRA",\n    "key": "revenue",\n    "receivedType": "text",\n    "validationStatus": "Extra key present in the log",\n    "value": "222"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "EXTRA",\n    "key": "expertise",\n    "receivedType": "text",\n    "validationStatus": "Extra key present in the log",\n    "value": "action"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "EXTRA",\n    "key": "seat_number",\n    "receivedType": "float",\n    "validationStatus": "Extra key present in the log",\n    "value": 383.11\n  },\n  {\n    "eventName": "appointment_click",\n    "expectedType": "EXTRA",\n    "key": "mindhealthscore",\n    "receivedType": "integer",\n    "validationStatus": "Extra key present in the log",\n    "value": 0\n  },\n  {\n    "eventName": "appointment_click",\n    "expectedType": "EXTRA",\n    "key": "profile_pending",\n    "receivedType": "text",\n    "validationStatus": "Extra key present in the log",\n    "value": "no"\n  },\n  {\n    "eventName": "appointment_click",\n    "expectedType": "EXTRA",\n    "key": "mwellness_score",\n    "receivedType": "integer",\n    "validationStatus": "Extra key present in the log",\n    "value": 0\n  },\n  {\n    "eventName": "appointment_click",\n    "expectedType": "text",\n    "key": "user_type",\n    "receivedType": "text",\n    "validationStatus": "Valid",\n    "value": "existing"\n  }\n]\n'
2025-11-21 17:32:42,838 - INFO - 127.0.0.1 - - [21/Nov/2025 17:32:42] "POST /filter HTTP/1.1" 200 -
2025-11-21 17:32:43,464 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Content-Length: 7600
Sec-Ch-Ua-Platform: "macOS"
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept: */*
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Content-Type: application/json
Sec-Ch-Ua-Mobile: ?0
Origin: http://localhost:10000
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831


2025-11-21 17:32:43,464 - INFO - Body: b'{"results":[{"eventName":"sign_up","expectedType":"EXTRA","key":"expertise","receivedType":"text","validationStatus":"Extra key present in the log","value":"action"},{"eventName":"sign_up","expectedType":"text","key":"seat_type","receivedType":"text","validationStatus":"Valid","value":"basic"},{"eventName":"sign_up","expectedType":"integer","key":"seat number","receivedType":"integer","validationStatus":"Valid","value":383},{"eventName":"sign_up","expectedType":"text","key":"movie","receivedType":"text","validationStatus":"Valid","value":"marco"},{"eventName":"sign_up","expectedType":"text","key":"screen","receivedType":"text","validationStatus":"Valid","value":"gold"},{"eventName":"sign_up","expectedType":"date","key":"date","receivedType":"date","validationStatus":"Valid","value":"2024-12-12 11:08:02"},{"eventName":"sign_up","expectedType":"text","key":"location","receivedType":"text","validationStatus":"Valid","value":"inia"},{"eventName":"sign_up","expectedType":"text","key":"experience","receivedType":"not present","validationStatus":"Payload not present in the log","value":null},{"eventName":"sign_up","expectedType":"float","key":"amount","receivedType":"integer","validationStatus":"Invalid/Wrong datatype/value","value":23},{"comment":"Event \\"user_profile_push\\" from CSV was not found in the uploaded log file","eventName":"user_profile_push","expectedType":"event","key":"EVENT_NAME","receivedType":"not present in logs","validationStatus":"Event name not present in the logs","value":"user_profile_push"},{"comment":"Event \\"clicked\\" from CSV was not found in the uploaded log file","eventName":"clicked","expectedType":"event","key":"EVENT_NAME","receivedType":"not present in logs","validationStatus":"Event name not present in the logs","value":"clicked"},{"eventName":"product_purchase","expectedType":"text","key":"items[0].variant_id","receivedType":"text","validationStatus":"Valid","value":"gid://shopify/ProductVariant/47363221193000"},{"eventName":"product_purchase","expectedType":"text","key":"items[0].prname","receivedType":"text","validationStatus":"Valid","value":"Katyayani NPK 19 19 19 | Water Soluble Fertilizer"},{"eventName":"product_purchase","expectedType":"float","key":"items[0].price","receivedType":"text","validationStatus":"Invalid/Wrong datatype/value","value":"732.00"},{"eventName":"product_purchase","expectedType":"text","key":"items[0].prid","receivedType":"text","validationStatus":"Valid","value":"gid://shopify/Product/8281838584104"},{"eventName":"product_purchase","expectedType":"text","key":"items[0].brand","receivedType":"text","validationStatus":"Valid","value":"Katyayani Organics"},{"eventName":"product_purchase","expectedType":"text","key":"items[1].variant_id","receivedType":"text","validationStatus":"Valid","value":"gid://shopify/ProductVariant/45290092167464"},{"eventName":"product_purchase","expectedType":"text","key":"items[1].prname","receivedType":"text","validationStatus":"Valid","value":"Katyayani Seaweed Extract | Liquid Organic fertilizer"},{"eventName":"product_purchase","expectedType":"float","key":"items[1].price","receivedType":"text","validationStatus":"Invalid/Wrong datatype/value","value":"249.00"},{"eventName":"product_purchase","expectedType":"text","key":"items[1].prid","receivedType":"text","validationStatus":"Valid","value":"gid://shopify/Product/8321730609448"},{"eventName":"product_purchase","expectedType":"text","key":"items[1].brand","receivedType":"text","validationStatus":"Valid","value":"Katyayani Organics"},{"eventName":"product_purchase","expectedType":"text","key":"items[2].variant_id","receivedType":"text","validationStatus":"Valid","value":"gid://shopify/ProductVariant/45164076433704"},{"eventName":"product_purchase","expectedType":"text","key":"items[2].prname","receivedType":"text","validationStatus":"Valid","value":"Katyayani BAXIL | Bacillus supp 2% AS | Liquid Bio Fungicide"},{"eventName":"product_purchase","expectedType":"float","key":"items[2].price","receivedType":"integer","validationStatus":"Invalid/Wrong datatype/value","value":475},{"eventName":"product_purchase","expectedType":"text","key":"items[2].prid","receivedType":"text","validationStatus":"Valid","value":"gid://shopify/Product/8283406631208"},{"eventName":"product_purchase","expectedType":"text","key":"items[2].brand","receivedType":"text","validationStatus":"Valid","value":"Katyayani Organics"},{"eventName":"product_purchase","expectedType":"text","key":"items[3].variant_id","receivedType":"text","validationStatus":"Valid","value":"gid://shopify/ProductVariant/45164483281192"},{"eventName":"product_purchase","expectedType":"text","key":"items[3].prname","receivedType":"text","validationStatus":"Valid","value":"Katyayani Flowering Booster Fertilizer | Organic Fertilizers"},{"eventName":"product_purchase","expectedType":"float","key":"items[3].price","receivedType":"float","validationStatus":"Valid","value":"320.00"},{"eventName":"product_purchase","expectedType":"text","key":"items[3].prid","receivedType":"text","validationStatus":"Valid","value":"gid://shopify/Product/8283544027432"},{"eventName":"product_purchase","expectedType":"text","key":"items[3].brand","receivedType":"text","validationStatus":"Valid","value":"Katyayani Organics"},{"eventName":"product_purchase","expectedType":"EXTRA","key":"movie","receivedType":"text","validationStatus":"Extra key present in the log","value":"marco"},{"eventName":"product_purchase","expectedType":"EXTRA","key":"seat_type","receivedType":"text","validationStatus":"Extra key present in the log","value":""},{"eventName":"product_purchase","expectedType":"EXTRA","key":"location","receivedType":"text","validationStatus":"Extra key present in the log","value":"inia"},{"eventName":"product_purchase","expectedType":"EXTRA","key":"amount","receivedType":"integer","validationStatus":"Extra key present in the log","value":23},{"eventName":"product_purchase","expectedType":"EXTRA","key":"screen","receivedType":"text","validationStatus":"Extra key present in the log","value":"gold"},{"eventName":"product_purchase","expectedType":"EXTRA","key":"date","receivedType":"date","validationStatus":"Extra key present in the log","value":"2024-12-12"},{"eventName":"product_purchase","expectedType":"EXTRA","key":"revenue","receivedType":"text","validationStatus":"Extra key present in the log","value":"222"},{"eventName":"product_purchase","expectedType":"EXTRA","key":"expertise","receivedType":"text","validationStatus":"Extra key present in the log","value":"action"},{"eventName":"product_purchase","expectedType":"EXTRA","key":"seat_number","receivedType":"float","validationStatus":"Extra key present in the log","value":383.11},{"eventName":"appointment_click","expectedType":"EXTRA","key":"mindhealthscore","receivedType":"integer","validationStatus":"Extra key present in the log","value":0},{"eventName":"appointment_click","expectedType":"EXTRA","key":"profile_pending","receivedType":"text","validationStatus":"Extra key present in the log","value":"no"},{"eventName":"appointment_click","expectedType":"EXTRA","key":"mwellness_score","receivedType":"integer","validationStatus":"Extra key present in the log","value":0},{"eventName":"appointment_click","expectedType":"text","key":"user_type","receivedType":"text","validationStatus":"Valid","value":"existing"}],"filters":{"eventName":[],"validationStatus":["Event name not present in the logs","Extra key present in the log","Invalid/Wrong datatype/value","Payload not present in the log"],"expectedType":[],"receivedType":[]},"sort_by":null,"sort_order":"asc"}'
2025-11-21 17:32:43,464 - INFO - URL: http://localhost:10000/filter
2025-11-21 17:32:43,464 - INFO - Method: POST
2025-11-21 17:32:43,464 - INFO - Endpoint: filter_results
2025-11-21 17:32:43,465 - INFO - Filter endpoint called
2025-11-21 17:32:43,465 - INFO - Filter data received: {'results': [{'eventName': 'sign_up', 'expectedType': 'EXTRA', 'key': 'expertise', 'receivedType': 'text', 'validationStatus': 'Extra key present in the log', 'value': 'action'}, {'eventName': 'sign_up', 'expectedType': 'text', 'key': 'seat_type', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'basic'}, {'eventName': 'sign_up', 'expectedType': 'integer', 'key': 'seat number', 'receivedType': 'integer', 'validationStatus': 'Valid', 'value': 383}, {'eventName': 'sign_up', 'expectedType': 'text', 'key': 'movie', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'marco'}, {'eventName': 'sign_up', 'expectedType': 'text', 'key': 'screen', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'gold'}, {'eventName': 'sign_up', 'expectedType': 'date', 'key': 'date', 'receivedType': 'date', 'validationStatus': 'Valid', 'value': '2024-12-12 11:08:02'}, {'eventName': 'sign_up', 'expectedType': 'text', 'key': 'location', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'inia'}, {'eventName': 'sign_up', 'expectedType': 'text', 'key': 'experience', 'receivedType': 'not present', 'validationStatus': 'Payload not present in the log', 'value': None}, {'eventName': 'sign_up', 'expectedType': 'float', 'key': 'amount', 'receivedType': 'integer', 'validationStatus': 'Invalid/Wrong datatype/value', 'value': 23}, {'comment': 'Event "user_profile_push" from CSV was not found in the uploaded log file', 'eventName': 'user_profile_push', 'expectedType': 'event', 'key': 'EVENT_NAME', 'receivedType': 'not present in logs', 'validationStatus': 'Event name not present in the logs', 'value': 'user_profile_push'}, {'comment': 'Event "clicked" from CSV was not found in the uploaded log file', 'eventName': 'clicked', 'expectedType': 'event', 'key': 'EVENT_NAME', 'receivedType': 'not present in logs', 'validationStatus': 'Event name not present in the logs', 'value': 'clicked'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[0].variant_id', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'gid://shopify/ProductVariant/47363221193000'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[0].prname', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'Katyayani NPK 19 19 19 | Water Soluble Fertilizer'}, {'eventName': 'product_purchase', 'expectedType': 'float', 'key': 'items[0].price', 'receivedType': 'text', 'validationStatus': 'Invalid/Wrong datatype/value', 'value': '732.00'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[0].prid', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'gid://shopify/Product/8281838584104'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[0].brand', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'Katyayani Organics'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[1].variant_id', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'gid://shopify/ProductVariant/45290092167464'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[1].prname', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'Katyayani Seaweed Extract | Liquid Organic fertilizer'}, {'eventName': 'product_purchase', 'expectedType': 'float', 'key': 'items[1].price', 'receivedType': 'text', 'validationStatus': 'Invalid/Wrong datatype/value', 'value': '249.00'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[1].prid', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'gid://shopify/Product/8321730609448'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[1].brand', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'Katyayani Organics'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[2].variant_id', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'gid://shopify/ProductVariant/45164076433704'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[2].prname', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'Katyayani BAXIL | Bacillus supp 2% AS | Liquid Bio Fungicide'}, {'eventName': 'product_purchase', 'expectedType': 'float', 'key': 'items[2].price', 'receivedType': 'integer', 'validationStatus': 'Invalid/Wrong datatype/value', 'value': 475}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[2].prid', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'gid://shopify/Product/8283406631208'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[2].brand', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'Katyayani Organics'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[3].variant_id', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'gid://shopify/ProductVariant/45164483281192'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[3].prname', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'Katyayani Flowering Booster Fertilizer | Organic Fertilizers'}, {'eventName': 'product_purchase', 'expectedType': 'float', 'key': 'items[3].price', 'receivedType': 'float', 'validationStatus': 'Valid', 'value': '320.00'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[3].prid', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'gid://shopify/Product/8283544027432'}, {'eventName': 'product_purchase', 'expectedType': 'text', 'key': 'items[3].brand', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'Katyayani Organics'}, {'eventName': 'product_purchase', 'expectedType': 'EXTRA', 'key': 'movie', 'receivedType': 'text', 'validationStatus': 'Extra key present in the log', 'value': 'marco'}, {'eventName': 'product_purchase', 'expectedType': 'EXTRA', 'key': 'seat_type', 'receivedType': 'text', 'validationStatus': 'Extra key present in the log', 'value': ''}, {'eventName': 'product_purchase', 'expectedType': 'EXTRA', 'key': 'location', 'receivedType': 'text', 'validationStatus': 'Extra key present in the log', 'value': 'inia'}, {'eventName': 'product_purchase', 'expectedType': 'EXTRA', 'key': 'amount', 'receivedType': 'integer', 'validationStatus': 'Extra key present in the log', 'value': 23}, {'eventName': 'product_purchase', 'expectedType': 'EXTRA', 'key': 'screen', 'receivedType': 'text', 'validationStatus': 'Extra key present in the log', 'value': 'gold'}, {'eventName': 'product_purchase', 'expectedType': 'EXTRA', 'key': 'date', 'receivedType': 'date', 'validationStatus': 'Extra key present in the log', 'value': '2024-12-12'}, {'eventName': 'product_purchase', 'expectedType': 'EXTRA', 'key': 'revenue', 'receivedType': 'text', 'validationStatus': 'Extra key present in the log', 'value': '222'}, {'eventName': 'product_purchase', 'expectedType': 'EXTRA', 'key': 'expertise', 'receivedType': 'text', 'validationStatus': 'Extra key present in the log', 'value': 'action'}, {'eventName': 'product_purchase', 'expectedType': 'EXTRA', 'key': 'seat_number', 'receivedType': 'float', 'validationStatus': 'Extra key present in the log', 'value': 383.11}, {'eventName': 'appointment_click', 'expectedType': 'EXTRA', 'key': 'mindhealthscore', 'receivedType': 'integer', 'validationStatus': 'Extra key present in the log', 'value': 0}, {'eventName': 'appointment_click', 'expectedType': 'EXTRA', 'key': 'profile_pending', 'receivedType': 'text', 'validationStatus': 'Extra key present in the log', 'value': 'no'}, {'eventName': 'appointment_click', 'expectedType': 'EXTRA', 'key': 'mwellness_score', 'receivedType': 'integer', 'validationStatus': 'Extra key present in the log', 'value': 0}, {'eventName': 'appointment_click', 'expectedType': 'text', 'key': 'user_type', 'receivedType': 'text', 'validationStatus': 'Valid', 'value': 'existing'}], 'filters': {'eventName': [], 'validationStatus': ['Event name not present in the logs', 'Extra key present in the log', 'Invalid/Wrong datatype/value', 'Payload not present in the log'], 'expectedType': [], 'receivedType': []}, 'sort_by': None, 'sort_order': 'asc'}
2025-11-21 17:32:43,465 - INFO - Filtered results count: 20
2025-11-21 17:32:43,465 - INFO - Response: b'[\n  {\n    "eventName": "sign_up",\n    "expectedType": "EXTRA",\n    "key": "expertise",\n    "receivedType": "text",\n    "validationStatus": "Extra key present in the log",\n    "value": "action"\n  },\n  {\n    "eventName": "sign_up",\n    "expectedType": "text",\n    "key": "experience",\n    "receivedType": "not present",\n    "validationStatus": "Payload not present in the log",\n    "value": null\n  },\n  {\n    "eventName": "sign_up",\n    "expectedType": "float",\n    "key": "amount",\n    "receivedType": "integer",\n    "validationStatus": "Invalid/Wrong datatype/value",\n    "value": 23\n  },\n  {\n    "comment": "Event \\"user_profile_push\\" from CSV was not found in the uploaded log file",\n    "eventName": "user_profile_push",\n    "expectedType": "event",\n    "key": "EVENT_NAME",\n    "receivedType": "not present in logs",\n    "validationStatus": "Event name not present in the logs",\n    "value": "user_profile_push"\n  },\n  {\n    "comment": "Event \\"clicked\\" from CSV was not found in the uploaded log file",\n    "eventName": "clicked",\n    "expectedType": "event",\n    "key": "EVENT_NAME",\n    "receivedType": "not present in logs",\n    "validationStatus": "Event name not present in the logs",\n    "value": "clicked"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "float",\n    "key": "items[0].price",\n    "receivedType": "text",\n    "validationStatus": "Invalid/Wrong datatype/value",\n    "value": "732.00"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "float",\n    "key": "items[1].price",\n    "receivedType": "text",\n    "validationStatus": "Invalid/Wrong datatype/value",\n    "value": "249.00"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "float",\n    "key": "items[2].price",\n    "receivedType": "integer",\n    "validationStatus": "Invalid/Wrong datatype/value",\n    "value": 475\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "EXTRA",\n    "key": "movie",\n    "receivedType": "text",\n    "validationStatus": "Extra key present in the log",\n    "value": "marco"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "EXTRA",\n    "key": "seat_type",\n    "receivedType": "text",\n    "validationStatus": "Extra key present in the log",\n    "value": ""\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "EXTRA",\n    "key": "location",\n    "receivedType": "text",\n    "validationStatus": "Extra key present in the log",\n    "value": "inia"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "EXTRA",\n    "key": "amount",\n    "receivedType": "integer",\n    "validationStatus": "Extra key present in the log",\n    "value": 23\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "EXTRA",\n    "key": "screen",\n    "receivedType": "text",\n    "validationStatus": "Extra key present in the log",\n    "value": "gold"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "EXTRA",\n    "key": "date",\n    "receivedType": "date",\n    "validationStatus": "Extra key present in the log",\n    "value": "2024-12-12"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "EXTRA",\n    "key": "revenue",\n    "receivedType": "text",\n    "validationStatus": "Extra key present in the log",\n    "value": "222"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "EXTRA",\n    "key": "expertise",\n    "receivedType": "text",\n    "validationStatus": "Extra key present in the log",\n    "value": "action"\n  },\n  {\n    "eventName": "product_purchase",\n    "expectedType": "EXTRA",\n    "key": "seat_number",\n    "receivedType": "float",\n    "validationStatus": "Extra key present in the log",\n    "value": 383.11\n  },\n  {\n    "eventName": "appointment_click",\n    "expectedType": "EXTRA",\n    "key": "mindhealthscore",\n    "receivedType": "integer",\n    "validationStatus": "Extra key present in the log",\n    "value": 0\n  },\n  {\n    "eventName": "appointment_click",\n    "expectedType": "EXTRA",\n    "key": "profile_pending",\n    "receivedType": "text",\n    "validationStatus": "Extra key present in the log",\n    "value": "no"\n  },\n  {\n    "eventName": "appointment_click",\n    "expectedType": "EXTRA",\n    "key": "mwellness_score",\n    "receivedType": "integer",\n    "validationStatus": "Extra key present in the log",\n    "value": 0\n  }\n]\n'
2025-11-21 17:32:43,466 - INFO - 127.0.0.1 - - [21/Nov/2025 17:32:43] "POST /filter HTTP/1.1" 200 -
2025-11-21 17:34:23,968 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Content-Length: 3451
Sec-Ch-Ua-Platform: "macOS"
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept: */*
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Content-Type: application/json
Sec-Ch-Ua-Mobile: ?0
Origin: http://localhost:10000
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831


2025-11-21 17:34:23,969 - INFO - Body: b'{"results":[{"eventName":"sign_up","expectedType":"EXTRA","key":"expertise","receivedType":"text","validationStatus":"Extra key present in the log","value":"action"},{"eventName":"sign_up","expectedType":"text","key":"experience","receivedType":"not present","validationStatus":"Payload not present in the log","value":null},{"eventName":"sign_up","expectedType":"float","key":"amount","receivedType":"integer","validationStatus":"Invalid/Wrong datatype/value","value":23},{"comment":"Event \\"user_profile_push\\" from CSV was not found in the uploaded log file","eventName":"user_profile_push","expectedType":"event","key":"EVENT_NAME","receivedType":"not present in logs","validationStatus":"Event name not present in the logs","value":"user_profile_push"},{"comment":"Event \\"clicked\\" from CSV was not found in the uploaded log file","eventName":"clicked","expectedType":"event","key":"EVENT_NAME","receivedType":"not present in logs","validationStatus":"Event name not present in the logs","value":"clicked"},{"eventName":"product_purchase","expectedType":"float","key":"items[0].price","receivedType":"text","validationStatus":"Invalid/Wrong datatype/value","value":"732.00"},{"eventName":"product_purchase","expectedType":"float","key":"items[1].price","receivedType":"text","validationStatus":"Invalid/Wrong datatype/value","value":"249.00"},{"eventName":"product_purchase","expectedType":"float","key":"items[2].price","receivedType":"integer","validationStatus":"Invalid/Wrong datatype/value","value":475},{"eventName":"product_purchase","expectedType":"EXTRA","key":"movie","receivedType":"text","validationStatus":"Extra key present in the log","value":"marco"},{"eventName":"product_purchase","expectedType":"EXTRA","key":"seat_type","receivedType":"text","validationStatus":"Extra key present in the log","value":""},{"eventName":"product_purchase","expectedType":"EXTRA","key":"location","receivedType":"text","validationStatus":"Extra key present in the log","value":"inia"},{"eventName":"product_purchase","expectedType":"EXTRA","key":"amount","receivedType":"integer","validationStatus":"Extra key present in the log","value":23},{"eventName":"product_purchase","expectedType":"EXTRA","key":"screen","receivedType":"text","validationStatus":"Extra key present in the log","value":"gold"},{"eventName":"product_purchase","expectedType":"EXTRA","key":"date","receivedType":"date","validationStatus":"Extra key present in the log","value":"2024-12-12"},{"eventName":"product_purchase","expectedType":"EXTRA","key":"revenue","receivedType":"text","validationStatus":"Extra key present in the log","value":"222"},{"eventName":"product_purchase","expectedType":"EXTRA","key":"expertise","receivedType":"text","validationStatus":"Extra key present in the log","value":"action"},{"eventName":"product_purchase","expectedType":"EXTRA","key":"seat_number","receivedType":"float","validationStatus":"Extra key present in the log","value":383.11},{"eventName":"appointment_click","expectedType":"EXTRA","key":"mindhealthscore","receivedType":"integer","validationStatus":"Extra key present in the log","value":0},{"eventName":"appointment_click","expectedType":"EXTRA","key":"profile_pending","receivedType":"text","validationStatus":"Extra key present in the log","value":"no"},{"eventName":"appointment_click","expectedType":"EXTRA","key":"mwellness_score","receivedType":"integer","validationStatus":"Extra key present in the log","value":0}]}'
2025-11-21 17:34:23,969 - INFO - URL: http://localhost:10000/download
2025-11-21 17:34:23,969 - INFO - Method: POST
2025-11-21 17:34:23,969 - INFO - Endpoint: download_results
2025-11-21 17:34:23,970 - INFO - Download endpoint called
2025-11-21 17:34:23,970 - INFO - Download data received
2025-11-21 17:34:23,971 - INFO - CSV file generated successfully
2025-11-21 17:34:23,972 - INFO - Response: b'eventName,key,value,expectedType,receivedType,validationStatus,comment\r\nsign_up,expertise,action,EXTRA,text,Extra key present in the log,This is an EXTRA payload or there is a spelling mistake with the required payload\r\nsign_up,experience,,text,not present,Payload not present in the log,Field is missing in the payload\r\nsign_up,amount,23,float,integer,Invalid/Wrong datatype/value,"Expected type: float, Received type: integer"\r\nuser_profile_push,EVENT_NAME,user_profile_push,event,not present in logs,Event name not present in the logs,"Event ""user_profile_push"" from CSV was not found in the uploaded log file"\r\nclicked,EVENT_NAME,clicked,event,not present in logs,Event name not present in the logs,"Event ""clicked"" from CSV was not found in the uploaded log file"\r\nproduct_purchase,items[0].price,732.00,float,text,Invalid/Wrong datatype/value,"Expected type: float, Received type: text"\r\nproduct_purchase,items[1].price,249.00,float,text,Invalid/Wrong datatype/value,"Expected type: float, Received type: text"\r\nproduct_purchase,items[2].price,475,float,integer,Invalid/Wrong datatype/value,"Expected type: float, Received type: integer"\r\nproduct_purchase,movie,marco,EXTRA,text,Extra key present in the log,This is an EXTRA payload or there is a spelling mistake with the required payload\r\nproduct_purchase,seat_type,,EXTRA,text,Extra key present in the log,This is an EXTRA payload or there is a spelling mistake with the required payload\r\nproduct_purchase,location,inia,EXTRA,text,Extra key present in the log,This is an EXTRA payload or there is a spelling mistake with the required payload\r\nproduct_purchase,amount,23,EXTRA,integer,Extra key present in the log,This is an EXTRA payload or there is a spelling mistake with the required payload\r\nproduct_purchase,screen,gold,EXTRA,text,Extra key present in the log,This is an EXTRA payload or there is a spelling mistake with the required payload\r\nproduct_purchase,date,2024-12-12,EXTRA,date,Extra key present in the log,This is an EXTRA payload or there is a spelling mistake with the required payload\r\nproduct_purchase,revenue,222,EXTRA,text,Extra key present in the log,This is an EXTRA payload or there is a spelling mistake with the required payload\r\nproduct_purchase,expertise,action,EXTRA,text,Extra key present in the log,This is an EXTRA payload or there is a spelling mistake with the required payload\r\nproduct_purchase,seat_number,383.11,EXTRA,float,Extra key present in the log,This is an EXTRA payload or there is a spelling mistake with the required payload\r\nappointment_click,mindhealthscore,0,EXTRA,integer,Extra key present in the log,This is an EXTRA payload or there is a spelling mistake with the required payload\r\nappointment_click,profile_pending,no,EXTRA,text,Extra key present in the log,This is an EXTRA payload or there is a spelling mistake with the required payload\r\nappointment_click,mwellness_score,0,EXTRA,integer,Extra key present in the log,This is an EXTRA payload or there is a spelling mistake with the required payload\r\n'
2025-11-21 17:34:23,974 - INFO - 127.0.0.1 - - [21/Nov/2025 17:34:23] "POST /download HTTP/1.1" 200 -
2025-11-21 17:39:48,093 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Content-Length: 3701
Sec-Ch-Ua-Platform: "macOS"
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept: */*
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Content-Type: multipart/form-data; boundary=----WebKitFormBoundarycWANxf5OgiFNktXu
Sec-Ch-Ua-Mobile: ?0
Origin: http://localhost:10000
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831


2025-11-21 17:39:48,096 - INFO - Body: b'------WebKitFormBoundarycWANxf5OgiFNktXu\r\nContent-Disposition: form-data; name="csv_file"; filename="sample_template.csv"\r\nContent-Type: text/csv\r\n\r\neventName,eventPayload,dataType\r\nsign_up,seat_type,text\r\n,seat number,integer\r\n,movie,text\r\n,screen,text\r\n,date,date \r\n,location,text\r\n,experience,text\r\n,amount,float\r\nuser_profile_push,seat_type,text\r\n,seat number,integer\r\n,movie,text\r\n,screen,text\r\n,date,date \r\n,location,text\r\n,experience,text\r\n,amount,float\r\nclicked,revenue,float\r\nproduct_purchase,items[].variant_id,text, NOTE: ARRAY PAYLOAD. PLEASE DONT ADD THIS ROW IN THE ACTUAL SHEET\r\n,items[].prname,text\r\n,items[].price,float\r\n,items[].prid,text\r\n,items[].brand,text\r\nappointment_click,user_type,text\r\n------WebKitFormBoundarycWANxf5OgiFNktXu\r\nContent-Disposition: form-data; name="manual_log"\r\n\r\nEvent Payload: {"networkMode":"Unknown","eventId":22,"attrParams":{},"lng":null,"timeZone":"GMT+05:30","sessionId":"1763726331004","td":0,"screenOrientation":"portrait","identity":"9447563433","eventTime":"1763726947351","eventName":"user_logged_in","lat":null,"retry":0}\r\nEvent Payload: {"networkMode":"Unknown","eventId":65,"lng":null,"timeZone":"GMT+05:30","sessionId":"1763726331004","td":0,"screenOrientation":"portrait","payload":{"hsl_counter":1,"hsl_data":"01E:0,02c:02,029:0,","hsl_ven":"hsl","identity":"9447563433"},"identity":"9447563433","eventTime":"1763726948392","eventName":"nh_branch_tracker","lat":null,"retry":0}\r\nEvent Payload: {"networkMode":"Unknown","eventId":0,"attrParams":{},"lng":null,"timeZone":"GMT+05:30","sessionId":"1763726331004","td":0,"screenOrientation":"portrait","payload":{"user_name":"allen","age":"12"},"identity":"9447563433","eventTime":"1763726956808","eventName":"logout_event","lat":null,"retry":0}\r\nEvent Payload: {"networkMode":"Unknown","eventId":0,"attrParams":{},"lng":null,"timeZone":"GMT+05:30","sessionId":"1763726331004","td":0,"screenOrientation":"portrait","payload":{"payment_type":"alle","card_name":2,"card_type":"alle","items":[{"prname":"Apples","price":10.1},{"prname":"Bananas","price":5}]},"identity":"9447563433","eventTime":"1763726956808","eventName":"new_event","lat":null,"retry":0}\r\nEvent Payload: {"networkMode":"Unknown","eventId":40,"lng":null,"timeZone":"GMT+05:30","sessionId":"1763726331004","td":0,"screenOrientation":"portrait","payload":{"AGE":1},"identity":"9447563433","eventTime":"1763726956846","eventName":"user_profile_push","lat":null,"retry":0}\r\nEvent Payload: {"networkMode":"Unknown","eventId":0,"attrParams":{},"lng":null,"timeZone":"GMT+05:30","sessionId":"1763726331004","td":0,"screenOrientation":"portrait","payload":{"user_type":"1","event_date":"2025-10-12 12:12:12+0530","event_date_1":"2025-10-12 12:12:12+0530"},"identity":"9447563433","eventTime":"1763726960816","eventName":"appointment_click","lat":null,"retry":0}\r\nEvent Payload: {"networkMode":"Unknown","eventId":0,"attrParams":{},"lng":null,"timeZone":"GMT+05:30","sessionId":"1763726331004","td":0,"screenOrientation":"portrait","payload":{"payment_type":"alle","card_name":2,"card_type":"alle","items":[{"prname":"Apples","price":10.1},{"prname":"Bananas","price":5}]},"identity":"9447563433","eventTime":"1763726960815","eventName":"profile_clicked","lat":null,"retry":0}\r\nEvent Payload: {"networkMode":"Unknown","eventId":0,"attrParams":{},"lng":null,"timeZone":"GMT+05:30","sessionId":"1763726331004","td":0,"screenOrientation":"portrait","payload":{"payment_type":"alle","card_name":2,"card_type":"alle","items":[{"prname":"Apples","price":10.1},{"prname":"Bananas","price":5}]},"identity":"9447563433","eventTime":"1763726960816","eventName":"product_purchase","lat":null,"retry":0}\r\n------WebKitFormBoundarycWANxf5OgiFNktXu--\r\n'
2025-11-21 17:39:48,096 - INFO - URL: http://localhost:10000/upload
2025-11-21 17:39:48,097 - INFO - Method: POST
2025-11-21 17:39:48,097 - INFO - Endpoint: upload
2025-11-21 17:39:48,097 - INFO - Upload endpoint called
2025-11-21 17:39:48,102 - INFO - file_upload: {"csv_file": "sample_template.csv", "timestamp": "2025-11-21T17:39:48.101380", "manual_log": "manual_log_input"}
2025-11-21 17:39:48,105 - INFO - validation_complete: {"total_validations": 46, "valid_count": 4, "invalid_count": 42, "csv_events_count": 5, "log_events_count": 8, "extra_events_count": 5}
2025-11-21 17:39:48,105 - INFO - Response: b'{\n  "fully_valid_events": [],\n  "original_logs": {\n    "appointment_click": "Event Payload: {\\"networkMode\\":\\"Unknown\\",\\"eventId\\":0,\\"attrParams\\":{},\\"lng\\":null,\\"timeZone\\":\\"GMT+05:30\\",\\"sessionId\\":\\"1763726331004\\",\\"td\\":0,\\"screenOrientation\\":\\"portrait\\",\\"payload\\":{\\"user_type\\":\\"1\\",\\"event_date\\":\\"2025-10-12 12:12:12+0530\\",\\"event_date_1\\":\\"2025-10-12 12:12:12+0530\\"},\\"identity\\":\\"9447563433\\",\\"eventTime\\":\\"1763726960816\\",\\"eventName\\":\\"appointment_click\\",\\"lat\\":null,\\"retry\\":0}",\n    "logout_event": "Event Payload: {\\"networkMode\\":\\"Unknown\\",\\"eventId\\":0,\\"attrParams\\":{},\\"lng\\":null,\\"timeZone\\":\\"GMT+05:30\\",\\"sessionId\\":\\"1763726331004\\",\\"td\\":0,\\"screenOrientation\\":\\"portrait\\",\\"payload\\":{\\"user_name\\":\\"allen\\",\\"age\\":\\"12\\"},\\"identity\\":\\"9447563433\\",\\"eventTime\\":\\"1763726956808\\",\\"eventName\\":\\"logout_event\\",\\"lat\\":null,\\"retry\\":0}",\n    "new_event": "Event Payload: {\\"networkMode\\":\\"Unknown\\",\\"eventId\\":0,\\"attrParams\\":{},\\"lng\\":null,\\"timeZone\\":\\"GMT+05:30\\",\\"sessionId\\":\\"1763726331004\\",\\"td\\":0,\\"screenOrientation\\":\\"portrait\\",\\"payload\\":{\\"payment_type\\":\\"alle\\",\\"card_name\\":2,\\"card_type\\":\\"alle\\",\\"items\\":[{\\"prname\\":\\"Apples\\",\\"price\\":10.1},{\\"prname\\":\\"Bananas\\",\\"price\\":5}]},\\"identity\\":\\"9447563433\\",\\"eventTime\\":\\"1763726956808\\",\\"eventName\\":\\"new_event\\",\\"lat\\":null,\\"retry\\":0}",\n    "nh_branch_tracker": "Event Payload: {\\"networkMode\\":\\"Unknown\\",\\"eventId\\":65,\\"lng\\":null,\\"timeZone\\":\\"GMT+05:30\\",\\"sessionId\\":\\"1763726331004\\",\\"td\\":0,\\"screenOrientation\\":\\"portrait\\",\\"payload\\":{\\"hsl_counter\\":1,\\"hsl_data\\":\\"01E:0,02c:02,029:0,\\",\\"hsl_ven\\":\\"hsl\\",\\"identity\\":\\"9447563433\\"},\\"identity\\":\\"9447563433\\",\\"eventTime\\":\\"1763726948392\\",\\"eventName\\":\\"nh_branch_tracker\\",\\"lat\\":null,\\"retry\\":0}",\n    "product_purchase": "Event Payload: {\\"networkMode\\":\\"Unknown\\",\\"eventId\\":0,\\"attrParams\\":{},\\"lng\\":null,\\"timeZone\\":\\"GMT+05:30\\",\\"sessionId\\":\\"1763726331004\\",\\"td\\":0,\\"screenOrientation\\":\\"portrait\\",\\"payload\\":{\\"payment_type\\":\\"alle\\",\\"card_name\\":2,\\"card_type\\":\\"alle\\",\\"items\\":[{\\"prname\\":\\"Apples\\",\\"price\\":10.1},{\\"prname\\":\\"Bananas\\",\\"price\\":5}]},\\"identity\\":\\"9447563433\\",\\"eventTime\\":\\"1763726960816\\",\\"eventName\\":\\"product_purchase\\",\\"lat\\":null,\\"retry\\":0}",\n    "profile_clicked": "Event Payload: {\\"networkMode\\":\\"Unknown\\",\\"eventId\\":0,\\"attrParams\\":{},\\"lng\\":null,\\"timeZone\\":\\"GMT+05:30\\",\\"sessionId\\":\\"1763726331004\\",\\"td\\":0,\\"screenOrientation\\":\\"portrait\\",\\"payload\\":{\\"payment_type\\":\\"alle\\",\\"card_name\\":2,\\"card_type\\":\\"alle\\",\\"items\\":[{\\"prname\\":\\"Apples\\",\\"price\\":10.1},{\\"prname\\":\\"Bananas\\",\\"price\\":5}]},\\"identity\\":\\"9447563433\\",\\"eventTime\\":\\"1763726960815\\",\\"eventName\\":\\"profile_clicked\\",\\"lat\\":null,\\"retry\\":0}",\n    "user_logged_in": "Event Payload: {\\"networkMode\\":\\"Unknown\\",\\"eventId\\":22,\\"attrParams\\":{},\\"lng\\":null,\\"timeZone\\":\\"GMT+05:30\\",\\"sessionId\\":\\"1763726331004\\",\\"td\\":0,\\"screenOrientation\\":\\"portrait\\",\\"identity\\":\\"9447563433\\",\\"eventTime\\":\\"1763726947351\\",\\"eventName\\":\\"user_logged_in\\",\\"lat\\":null,\\"retry\\":0}",\n    "user_profile_push": "Event Payload: {\\"networkMode\\":\\"Unknown\\",\\"eventId\\":40,\\"lng\\":null,\\"timeZone\\":\\"GMT+05:30\\",\\"sessionId\\":\\"1763726331004\\",\\"td\\":0,\\"screenOrientation\\":\\"portrait\\",\\"payload\\":{\\"AGE\\":1},\\"identity\\":\\"9447563433\\",\\"eventTime\\":\\"1763726956846\\",\\"eventName\\":\\"user_profile_push\\",\\"lat\\":null,\\"retry\\":0}"\n  },\n  "results": [\n    {\n      "comment": "Event \\"sign_up\\" from CSV was not found in the uploaded log file",\n      "eventName": "sign_up",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "sign_up"\n    },\n    {\n      "eventName": "user_profile_push",\n      "expectedType": "EXTRA",\n      "key": "age",\n      "receivedType": "integer",\n      "validationStatus": "Extra key present in the log",\n      "value": 1\n    },\n    {\n      "eventName": "user_profile_push",\n      "expectedType": "text",\n      "key": "seat_type",\n      "receivedType": "not present",\n      "validationStatus": "Payload not present in the log",\n      "value": null\n    },\n    {\n      "eventName": "user_profile_push",\n      "expectedType": "integer",\n      "key": "seat number",\n      "receivedType": "not present",\n      "validationStatus": "Payload not present in the log",\n      "value": null\n    },\n    {\n      "eventName": "user_profile_push",\n      "expectedType": "text",\n      "key": "movie",\n      "receivedType": "not present",\n      "validationStatus": "Payload not present in the log",\n      "value": null\n    },\n    {\n      "eventName": "user_profile_push",\n      "expectedType": "text",\n      "key": "screen",\n      "receivedType": "not present",\n      "validationStatus": "Payload not present in the log",\n      "value": null\n    },\n    {\n      "eventName": "user_profile_push",\n      "expectedType": "date",\n      "key": "date",\n      "receivedType": "not present",\n      "validationStatus": "Payload not present in the log",\n      "value": null\n    },\n    {\n      "eventName": "user_profile_push",\n      "expectedType": "text",\n      "key": "location",\n      "receivedType": "not present",\n      "validationStatus": "Payload not present in the log",\n      "value": null\n    },\n    {\n      "eventName": "user_profile_push",\n      "expectedType": "text",\n      "key": "experience",\n      "receivedType": "not present",\n      "validationStatus": "Payload not present in the log",\n      "value": null\n    },\n    {\n      "eventName": "user_profile_push",\n      "expectedType": "float",\n      "key": "amount",\n      "receivedType": "not present",\n      "validationStatus": "Payload not present in the log",\n      "value": null\n    },\n    {\n      "comment": "Event \\"clicked\\" from CSV was not found in the uploaded log file",\n      "eventName": "clicked",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "clicked"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "text",\n      "key": "items[0].variant_id",\n      "receivedType": "null",\n      "validationStatus": "Payload value is Empty",\n      "value": null\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "text",\n      "key": "items[0].prname",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "Apples"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "float",\n      "key": "items[0].price",\n      "receivedType": "float",\n      "validationStatus": "Valid",\n      "value": "10.10"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "text",\n      "key": "items[0].prid",\n      "receivedType": "null",\n      "validationStatus": "Payload value is Empty",\n      "value": null\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "text",\n      "key": "items[0].brand",\n      "receivedType": "null",\n      "validationStatus": "Payload value is Empty",\n      "value": null\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "text",\n      "key": "items[1].variant_id",\n      "receivedType": "null",\n      "validationStatus": "Payload value is Empty",\n      "value": null\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "text",\n      "key": "items[1].prname",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "Bananas"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "float",\n      "key": "items[1].price",\n      "receivedType": "integer",\n      "validationStatus": "Invalid/Wrong datatype/value",\n      "value": 5\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "text",\n      "key": "items[1].prid",\n      "receivedType": "null",\n      "validationStatus": "Payload value is Empty",\n      "value": null\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "text",\n      "key": "items[1].brand",\n      "receivedType": "null",\n      "validationStatus": "Payload value is Empty",\n      "value": null\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "EXTRA",\n      "key": "payment_type",\n      "receivedType": "text",\n      "validationStatus": "Extra key present in the log",\n      "value": "alle"\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "EXTRA",\n      "key": "card_name",\n      "receivedType": "integer",\n      "validationStatus": "Extra key present in the log",\n      "value": 2\n    },\n    {\n      "eventName": "product_purchase",\n      "expectedType": "EXTRA",\n      "key": "card_type",\n      "receivedType": "text",\n      "validationStatus": "Extra key present in the log",\n      "value": "alle"\n    },\n    {\n      "eventName": "appointment_click",\n      "expectedType": "EXTRA",\n      "key": "event_date",\n      "receivedType": "text",\n      "validationStatus": "Extra key present in the log",\n      "value": "2025-10-12 12:12:12+0530"\n    },\n    {\n      "eventName": "appointment_click",\n      "expectedType": "EXTRA",\n      "key": "event_date_1",\n      "receivedType": "text",\n      "validationStatus": "Extra key present in the log",\n      "value": "2025-10-12 12:12:12+0530"\n    },\n    {\n      "eventName": "appointment_click",\n      "expectedType": "text",\n      "key": "user_type",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "1"\n    },\n    {\n      "comment": "Event \\"user_logged_in\\" found in logs but not defined in CSV validation rules",\n      "eventName": "user_logged_in",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "extra event in logs",\n      "validationStatus": "Extra event present in logs",\n      "value": "user_logged_in"\n    },\n    {\n      "comment": "Event \\"profile_clicked\\" found in logs but not defined in CSV validation rules",\n      "eventName": "profile_clicked",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "extra event in logs",\n      "validationStatus": "Extra event present in logs",\n      "value": "profile_clicked"\n    },\n    {\n      "comment": "Field from event \\"profile_clicked\\" which is not defined in CSV validation rules",\n      "eventName": "profile_clicked",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "payment_type",\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "alle"\n    },\n    {\n      "comment": "Field from event \\"profile_clicked\\" which is not defined in CSV validation rules",\n      "eventName": "profile_clicked",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "card_name",\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 2\n    },\n    {\n      "comment": "Field from event \\"profile_clicked\\" which is not defined in CSV validation rules",\n      "eventName": "profile_clicked",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "card_type",\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "alle"\n    },\n    {\n      "comment": "Field from event \\"profile_clicked\\" which is not defined in CSV validation rules",\n      "eventName": "profile_clicked",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "items",\n      "receivedType": "array",\n      "validationStatus": "Field from extra event",\n      "value": [\n        {\n          "price": 10.1,\n          "prname": "Apples"\n        },\n        {\n          "price": 5,\n          "prname": "Bananas"\n        }\n      ]\n    },\n    {\n      "comment": "Event \\"nh_branch_tracker\\" found in logs but not defined in CSV validation rules",\n      "eventName": "nh_branch_tracker",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "extra event in logs",\n      "validationStatus": "Extra event present in logs",\n      "value": "nh_branch_tracker"\n    },\n    {\n      "comment": "Field from event \\"nh_branch_tracker\\" which is not defined in CSV validation rules",\n      "eventName": "nh_branch_tracker",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "hsl_counter",\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 1\n    },\n    {\n      "comment": "Field from event \\"nh_branch_tracker\\" which is not defined in CSV validation rules",\n      "eventName": "nh_branch_tracker",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "hsl_data",\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "01E:0,02c:02,029:0,"\n    },\n    {\n      "comment": "Field from event \\"nh_branch_tracker\\" which is not defined in CSV validation rules",\n      "eventName": "nh_branch_tracker",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "hsl_ven",\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "hsl"\n    },\n    {\n      "comment": "Field from event \\"nh_branch_tracker\\" which is not defined in CSV validation rules",\n      "eventName": "nh_branch_tracker",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "identity",\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "9447563433"\n    },\n    {\n      "comment": "Event \\"logout_event\\" found in logs but not defined in CSV validation rules",\n      "eventName": "logout_event",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "extra event in logs",\n      "validationStatus": "Extra event present in logs",\n      "value": "logout_event"\n    },\n    {\n      "comment": "Field from event \\"logout_event\\" which is not defined in CSV validation rules",\n      "eventName": "logout_event",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "user_name",\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "allen"\n    },\n    {\n      "comment": "Field from event \\"logout_event\\" which is not defined in CSV validation rules",\n      "eventName": "logout_event",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "age",\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "12"\n    },\n    {\n      "comment": "Event \\"new_event\\" found in logs but not defined in CSV validation rules",\n      "eventName": "new_event",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "extra event in logs",\n      "validationStatus": "Extra event present in logs",\n      "value": "new_event"\n    },\n    {\n      "comment": "Field from event \\"new_event\\" which is not defined in CSV validation rules",\n      "eventName": "new_event",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "payment_type",\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "alle"\n    },\n    {\n      "comment": "Field from event \\"new_event\\" which is not defined in CSV validation rules",\n      "eventName": "new_event",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "card_name",\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 2\n    },\n    {\n      "comment": "Field from event \\"new_event\\" which is not defined in CSV validation rules",\n      "eventName": "new_event",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "card_type",\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "alle"\n    },\n    {\n      "comment": "Field from event \\"new_event\\" which is not defined in CSV validation rules",\n      "eventName": "new_event",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "items",\n      "receivedType": "array",\n      "validationStatus": "Field from extra event",\n      "value": [\n        {\n          "price": 10.1,\n          "prname": "Apples"\n        },\n        {\n          "price": 5,\n          "prname": "Bananas"\n        }\n      ]\n    }\n  ],\n  "summary": {\n    "csv_events": [\n      "product_purchase",\n      "user_profile_push",\n      "sign_up",\n      "clicked",\n      "appointment_click"\n    ],\n    "csv_events_count": 5,\n    "extra_events": [\n      "user_logged_in",\n      "profile_clicked",\n      "nh_branch_tracker",\n      "logout_event",\n      "new_event"\n    ],\n    "log_events": [\n      "product_purchase",\n      "user_logged_in",\n      "user_profile_push",\n      "profile_clicked",\n      "nh_branch_tracker",\n      "appointment_click",\n      "logout_event",\n      "new_event"\n    ],\n    "log_events_count": 8\n  }\n}\n'
2025-11-21 17:39:48,106 - INFO - 127.0.0.1 - - [21/Nov/2025 17:39:48] "POST /upload HTTP/1.1" 200 -
2025-11-21 17:41:30,393 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831


2025-11-21 17:41:30,396 - INFO - Body: b''
2025-11-21 17:41:30,397 - INFO - URL: http://localhost:10000/push-notification
2025-11-21 17:41:30,397 - INFO - Method: GET
2025-11-21 17:41:30,397 - INFO - Endpoint: push_notification
2025-11-21 17:41:30,402 - INFO - Response: b'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>FCM Push Notification Sender</title>\n    <link rel="icon" type="image/png" href="/static/favicon.png">\n    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">\n    <style>\n        :root {\n            --primary-color: #e35502;\n            --header-bg: #230f2e;\n        }\n        #addPayloadPair{\n            color: #d1d1d1;\n            background-color: #230f2e;\n        }\n        .bg-info {\n            background-color: #230f2e !important;\n            color: #230f2e;\n        }\n       \n        .container { margin-top: 30px; }\n        .form-label { font-weight: 600; color: #333; }\n        \n        /* Header styling */\n        .navbar {\n            background-color: var(--header-bg) !important;\n        }\n        \n        .navbar-brand, .navbar-nav .nav-link {\n            color: white !important;\n        }\n        \n        .navbar-brand img {\n            height: 40px;\n            width: auto;\n            filter: brightness(0) invert(1);\n        }\n        \n        @media (max-width: 768px) {\n            .navbar-brand img {\n                height: 30px;\n            }\n            .navbar-brand span {\n                font-size: 0.9rem;\n            }\n        }\n        \n        .navbar-toggler {\n            border-color: rgba(255,255,255,0.5);\n        }\n        \n        .navbar-toggler-icon {\n            background-image: url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 30 30\'%3e%3cpath stroke=\'rgba%28255, 255, 255, 0.75%29\' stroke-linecap=\'round\' stroke-miterlimit=\'10\' stroke-width=\'2\' d=\'M4 7h22M4 15h22M4 23h22\'/%3e%3c/svg%3e");\n        }\n        \n        /* Button styling */\n        .btn-primary {\n            background-color: var(--primary-color) !important;\n            border-color: var(--primary-color) !important;\n        }\n        \n        .btn-primary:hover {\n            background-color: #c64802 !important;\n            border-color: #c64802 !important;\n        }\n        \n        .btn-outline-primary {\n            color: white !important;\n            border-color: white !important;\n        }\n        \n        .btn-outline-primary:hover {\n            background-color: rgba(255,255,255,0.1) !important;\n        }\n        \n        .alert {\n            border-radius: 5px;\n        }\n        \n        .status-success {\n            background-color: #d4edda;\n            color: #155724;\n            border: 1px solid #c3e6cb;\n            padding: 12px;\n            border-radius: 5px;\n            margin-top: 10px;\n        }\n        \n        .status-error {\n            background-color: #f8d7da;\n            color: #721c24;\n            border: 1px solid #f5c6cb;\n            padding: 12px;\n            border-radius: 5px;\n            margin-top: 10px;\n        }\n        \n        .status-info {\n            background-color: #d1ecf1;\n            color: #0c5460;\n            border: 1px solid #bee5eb;\n            padding: 12px;\n            border-radius: 5px;\n            margin-top: 10px;\n        }\n\n        .payload-key,\n        .payload-value {\n            font-size: 0.9rem;\n        }\n\n        .remove-pair {\n            font-size: 0.85rem;\n            padding: 0.3rem 0.5rem;\n        }\n    </style>\n</head>\n<body>\n    <!-- Navbar matching main page -->\n    <nav class="navbar navbar-expand-lg navbar-light bg-light">\n        <div class="container-fluid">\n            <a class="navbar-brand d-flex align-items-center" href="/">\n                <img src="/static/netcore_logo.png" alt="Netcore Logo" height="40" class="me-2">\n                <span> Notifications</span>\n            </a>\n            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">\n                <span class="navbar-toggler-icon"></span>\n            </button>\n            <div class="collapse navbar-collapse" id="navbarNav">\n                <ul class="navbar-nav ms-auto">\n                    <li class="nav-item">\n                        <a class="btn btn-primary" href="/">\xe2\x86\x90 Back to Validation</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </nav>\n\n    <div class="container">\n        <h2>\xf0\x9f\x93\xb1 FCM Push Notification Sender</h2>\n        \n        <div class="card mb-4">\n            <div class="card-body">\n                <form id="fcmForm" enctype="multipart/form-data">\n                    <div class="row">\n                        <div class="col-md-6">\n                            <div class="mb-3">\n                                <label for="privateKeysFile" class="form-label">\n                                    Firebase Private Key (JSON)\n                                    <span id="credentialsUploadedBadge" class="badge bg-success ms-2" style="display: none;background-color: #230f2e !important; color: #f9f9f9;">\xe2\x9c\x93 Uploaded</span>\n                                </label>\n                                <input type="file" class="form-control" id="privateKeysFile" name="private_keys" accept=".json">\n                                <small class="form-text text-muted">Upload your Firebase service account JSON file</small>\n                                <div id="credentialsStatus" class="mt-2"></div>\n                            </div>\n                        </div>\n                        <div class="col-md-6">\n                            <div class="mb-3">\n                                <label for="fcmToken" class="form-label">FCM Device Token</label>\n                                <input type="text" class="form-control" id="fcmToken" name="fcm_token" placeholder="e.g., eW8C5Nx8u5I:..." required>\n                                <small class="form-text text-muted">Firebase Cloud Messaging token from your device</small>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="mb-3">\n                        <label for="notificationTemplate" class="form-label">Notification Template</label>\n                        <select class="form-control" id="notificationTemplate" required>\n                            <option value="">-- Select a template --</option>\n                            <option value="rating">Rating Push Notification</option>\n                            <option value="simple">Simple Push Notification</option>\n                        </select>\n                    </div>\n\n                    <!-- Simple Template Fields -->\n                    <div id="simpleTemplateFields" style="display: none;">\n                        <div class="row">\n                            <div class="col-md-6">\n                                <div class="mb-3">\n                                    <label for="notificationTitle" class="form-label">Title</label>\n                                    <input type="text" class="form-control" id="notificationTitle" placeholder="Enter notification title">\n                                </div>\n                            </div>\n                            <div class="col-md-6">\n                                <div class="mb-3">\n                                    <label for="notificationMessage" class="form-label">Message</label>\n                                    <input type="text" class="form-control" id="notificationMessage" placeholder="Enter notification message">\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <!-- Common Fields for all templates -->\n                    <div id="commonTemplateFields" style="display: none;">\n                        <div class="mb-3">\n                            <label for="deeplinkUrl" class="form-label">Deep Link URL (Optional)</label>\n                            <input type="text" class="form-control" id="deeplinkUrl" placeholder="e.g., myapp://screen/product/123">\n                            <small class="form-text text-muted">URL to navigate to when notification is clicked</small>\n                        </div>\n\n                        <div class="mb-3">\n                            <label for="imageLink" class="form-label">Image Link (Optional)</label>\n                            <input type="text" class="form-control" id="imageLink" placeholder="e.g., https://example.com/image.png">\n                            <small class="form-text text-muted">URL to the notification image</small>\n                        </div>\n\n                        <div class="mb-3">\n                            <label class="form-label">Custom Payload (Optional)</label>\n                            <div id="payloadKeyValuePairs" class="mb-3">\n                                <!-- Key-value pairs will be added here dynamically -->\n                            </div>\n                            <button type="button" class="btn btn-sm btn-success" id="addPayloadPair">\n                                <i class="bi bi-plus"></i> Add Key-Value Pair\n                            </button>\n                            <div id="formPayloadError" class="alert alert-danger mt-2" style="display: none;"></div>\n                        </div>\n                    </div>\n\n                    <div class="mb-3">\n                        <button type="submit" class="btn btn-primary">Send Push Notification</button>\n                        <div id="pushNotificationStatus" class="mt-3"></div>\n                        <div id="fcmResponseDetails" class="mt-3" style="display: none;">\n                            <div class="card border-info">\n                                <div class="card-header bg-info text-white">\n                                    <h6 class="mb-0">FCM Response Details</h6>\n                                </div>\n                                <div class="card-body">\n                                    <div class="row">\n                                        <div class="col-md-6">\n                                            <p class="mb-2"><strong>Message ID:</strong></p>\n                                            <p id="messageId" class="text-monospace" style="font-family: monospace; word-break: break-all;">-</p>\n                                        </div>\n                                        <div class="col-md-6">\n                                            <p class="mb-2"><strong>Template Type:</strong></p>\n                                            <p id="templateType">-</p>\n                                        </div>\n                                    </div>\n                                    <div class="row">\n                                        <div class="col-md-6">\n                                            <p class="mb-2"><strong>Device Token:</strong></p>\n                                            <p id="deviceToken" class="text-monospace" style="font-family: monospace; word-break: break-all;">-</p>\n                                        </div>\n                                        <div class="col-md-6">\n                                            <p class="mb-2"><strong>Timestamp:</strong></p>\n                                            <p id="timestamp">-</p>\n                                        </div>\n                                    </div>\n                                    <div class="row">\n                                        <div class="col-12">\n                                            <p class="mb-2"><strong>Status:</strong></p>\n                                            <p id="deliveryStatus" class="badge bg-success">Sent Successfully</p>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </form>\n            </div>\n        </div>\n\n        <!-- Template Information -->\n        <!-- <div class="card mb-4">\n            <div class="card-body">\n                <h5 class="card-title">\xf0\x9f\x93\x8b Available Templates</h5>\n                <div class="row">\n                    <div class="col-md-6">\n                        <h6>Rating Push Notification</h6>\n                        <p class="text-muted small">Sends an in-app rating request with customizable UI. Includes deep link support for navigation and automatic 30-day message expiry.</p>\n                    </div>\n                    <div class="col-md-6">\n                        <h6>Simple Push Notification</h6>\n                        <p class="text-muted small">Standard notification with title and message. Supports deep links and custom payload data for flexible app integration.</p>\n                    </div>\n                </div>\n            </div>\n        </div> -->\n    </div>\n\n    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>\n    <script>\n        $(document).ready(function() {\n            // ==================== LOCAL STORAGE PERSISTENCE ====================\n            \n            // Load saved FCM token and key-value pairs on page load\n            function loadSavedData() {\n                const savedFcmToken = localStorage.getItem(\'fcm_token\');\n                const savedKeyValuePairs = localStorage.getItem(\'fcm_custom_payload_pairs\');\n                \n                if (savedFcmToken) {\n                    $(\'#fcmToken\').val(savedFcmToken);\n                }\n                \n                // Load saved key-value pairs\n                if (savedKeyValuePairs) {\n                    try {\n                        const pairs = JSON.parse(savedKeyValuePairs);\n                        for (const [key, value] of Object.entries(pairs)) {\n                            addPayloadPair(key, value);\n                        }\n                    } catch (e) {\n                        console.error(\'Failed to load saved payload pairs:\', e);\n                    }\n                }\n            }\n            \n            // Save data to localStorage (excludes sensitive credentials)\n            function saveToLocalStorage() {\n                const fcmToken = $(\'#fcmToken\').val();\n                if (fcmToken) {\n                    localStorage.setItem(\'fcm_token\', fcmToken);\n                }\n                \n                // Save key-value pairs\n                const formPayload = getFormPayloadAsJson();\n                if (Object.keys(formPayload).length > 0) {\n                    localStorage.setItem(\'fcm_custom_payload_pairs\', JSON.stringify(formPayload));\n                }\n            }\n            \n            // Track if credentials are uploaded to server\n            let credentialsUploadedToServer = localStorage.getItem(\'credentialsUploadedToServer\') === \'true\';\n            \n            // Update credential status display on page load\n            function updateCredentialStatusDisplay() {\n                if (credentialsUploadedToServer) {\n                    // $(\'#credentialsStatus\').html(\'<div class="status-success">\xe2\x9c\x93 Firebase credentials uploaded and validated successfully</div>\');\n                    $(\'#credentialsUploadedBadge\').show();\n                }\n            }\n            \n            // Save private key when file is selected\n            $(\'#privateKeysFile\').change(function() {\n                const file = this.files[0];\n                if (!file) {\n                    // If file is cleared, hide badge but keep the flag for next upload\n                    $(\'#credentialsUploadedBadge\').hide();\n                    return;\n                }\n\n                const reader = new FileReader();\n                reader.onload = function(e) {\n                    const credentials = e.target.result;\n                    \n                    const statusDiv = $(\'#credentialsStatus\');\n                    statusDiv.html(\'<div class="status-info">Uploading and validating credentials...</div>\');\n\n                    $.ajax({\n                        url: \'/validate-fcm-credentials\',\n                        method: \'POST\',\n                        data: JSON.stringify({ credentials: credentials }),\n                        contentType: \'application/json\',\n                        success: function(response) {\n                            if (response.valid) {\n                                credentialsUploadedToServer = true;\n                                localStorage.setItem(\'credentialsUploadedToServer\', \'true\');\n                                statusDiv.html(\'<div class="status-success">\xe2\x9c\x93 Firebase credentials uploaded and validated successfully</div>\');\n                                $(\'#credentialsUploadedBadge\').show();\n                            } else {\n                                credentialsUploadedToServer = false;\n                                localStorage.setItem(\'credentialsUploadedToServer\', \'false\');\n                                statusDiv.html(\'<div class="status-error">\xe2\x9c\x97 \' + (response.message || \'Validation failed\') + \'</div>\');\n                                $(\'#credentialsUploadedBadge\').hide();\n                            }\n                        },\n                        error: function(xhr, status, error) {\n                            credentialsUploadedToServer = false;\n                            localStorage.setItem(\'credentialsUploadedToServer\', \'false\');\n                            const errorMsg = xhr.responseJSON?.message || error || \'Unknown error\';\n                            statusDiv.html(\'<div class="status-error">\xe2\x9c\x97 Error: \' + errorMsg + \'</div>\');\n                            $(\'#credentialsUploadedBadge\').hide();\n                        }\n                    });\n                };\n                reader.readAsText(file);\n            });\n            \n            // Save token on blur\n            $(\'#fcmToken\').on(\'blur\', function() {\n                saveToLocalStorage();\n            });\n            \n            // Save key-value pairs whenever they change\n            $(document).on(\'change\', \'.payload-key, .payload-value\', function() {\n                saveToLocalStorage();\n            });\n            \n            // ==================== CUSTOM PAYLOAD KEY-VALUE FORM ====================\n            \n            let payloadPairCount = 0;\n            \n            // Add new key-value pair\n            $(\'#addPayloadPair\').click(function() {\n                addPayloadPair();\n            });\n            \n            function addPayloadPair(key = \'\', value = \'\') {\n                payloadPairCount++;\n                const pairId = \'pair-\' + payloadPairCount;\n                \n                const pairHtml = `\n                    <div class="row mb-2" id="${pairId}">\n                        <div class="col-md-5">\n                            <input type="text" class="form-control payload-key" placeholder="Key" value="${key}">\n                        </div>\n                        <div class="col-md-5">\n                            <input type="text" class="form-control payload-value" placeholder="Value" value="${value}">\n                        </div>\n                        <div class="col-md-2">\n                            <button type="button" class="btn btn-sm btn-danger remove-pair" data-pair-id="${pairId}">Remove</button>\n                        </div>\n                    </div>\n                `;\n                \n                $(\'#payloadKeyValuePairs\').append(pairHtml);\n            }\n            \n            // Remove key-value pair\n            $(document).on(\'click\', \'.remove-pair\', function() {\n                const pairId = $(this).data(\'pair-id\');\n                $(\'#\' + pairId).remove();\n            });\n            \n            // Convert form payload to JSON\n            function getFormPayloadAsJson() {\n                const pairs = {};\n                $(\'#payloadKeyValuePairs .row\').each(function() {\n                    const key = $(this).find(\'.payload-key\').val().trim();\n                    const value = $(this).find(\'.payload-value\').val().trim();\n                    \n                    if (key) {\n                        pairs[key] = value;\n                    }\n                });\n                return pairs;\n            }\n            \n            // ==================== TEMPLATE SELECTION ====================\n            \n            // Toggle template-specific fields based on selection\n            $(\'#notificationTemplate\').change(function() {\n                const template = $(this).val();\n                if (template) {\n                    $(\'#simpleTemplateFields\').toggle(template === \'simple\');\n                    $(\'#commonTemplateFields\').show();\n                } else {\n                    $(\'#simpleTemplateFields\').hide();\n                    $(\'#commonTemplateFields\').hide();\n                }\n            });\n            \n            // ==================== FORM SUBMISSION ====================\n            \n            // Handle form submission\n            $(\'#fcmForm\').submit(function(e) {\n                e.preventDefault();\n\n                const template = $(\'#notificationTemplate\').val();\n                if (!template) {\n                    alert(\'Please select a notification template\');\n                    return;\n                }\n\n                // Check if credentials are uploaded\n                if (!credentialsUploadedToServer) {\n                    alert(\'Please upload Firebase private key file first\');\n                    return;\n                }\n\n                // Get custom payload from form\n                const formPayload = getFormPayloadAsJson();\n                let customPayload = \'\';\n                \n                if (Object.keys(formPayload).length > 0) {\n                    customPayload = JSON.stringify(formPayload);\n                }\n\n                const fcmToken = $(\'#fcmToken\').val();\n                if (!fcmToken) {\n                    alert(\'Please enter FCM device token\');\n                    return;\n                }\n                \n                // Save token to localStorage\n                saveToLocalStorage();\n                \n                // Build request payload (NO credentials sent)\n                const requestPayload = {\n                    template_type: template,\n                    fcm_token: fcmToken,\n                    deeplink: $(\'#deeplinkUrl\').val().trim() || \'\',\n                    image_link: $(\'#imageLink\').val().trim() || \'\'\n                };\n\n                // Add template-specific fields\n                if (template === \'simple\') {\n                    requestPayload.title = $(\'#notificationTitle\').val().trim();\n                    requestPayload.message = $(\'#notificationMessage\').val().trim();\n                }\n\n                // Add custom payload if present\n                if (customPayload) {\n                    requestPayload.custom_payload = customPayload;\n                }\n\n                const statusDiv = $(\'#pushNotificationStatus\');\n                statusDiv.html(\'<div class="status-info">Sending push notification...</div>\');\n\n                $.ajax({\n                    url: \'/send-push-notification\',\n                    method: \'POST\',\n                    data: JSON.stringify(requestPayload),\n                    contentType: \'application/json\',\n                    success: function(response) {\n                        if (response.success) {\n                            statusDiv.html(\'<div class="status-success">\xe2\x9c\x93 Push notification sent successfully!</div>\');\n                            \n                            // Display detailed FCM response\n                            $(\'#messageId\').text(response.message_id || \'N/A\');\n                            $(\'#templateType\').text(response.template_type || template);\n                            $(\'#deviceToken\').text(response.device_token ? response.device_token.substring(0, 30) + \'...\' : fcmToken.substring(0, 30) + \'...\');\n                            $(\'#timestamp\').text(response.timestamp || new Date().toISOString());\n                            $(\'#deliveryStatus\').text(response.status || \'Sent Successfully\').removeClass(\'bg-danger bg-warning\').addClass(\'bg-success\');\n                            $(\'#fcmResponseDetails\').show();\n                        } else {\n                            statusDiv.html(\'<div class="status-error">\xe2\x9c\x97 \' + (response.message || \'Failed to send notification\') + \'</div>\');\n                            $(\'#fcmResponseDetails\').hide();\n                        }\n                    },\n                    error: function(xhr, status, error) {\n                        const errorMsg = xhr.responseJSON?.message || error || \'Unknown error\';\n                        statusDiv.html(\'<div class="status-error">\xe2\x9c\x97 Error: \' + errorMsg + \'</div>\');\n                        $(\'#fcmResponseDetails\').hide();\n                    }\n                });\n            });\n            \n            // Load saved data on page load\n            loadSavedData();\n            updateCredentialStatusDisplay();\n        });\n    </script>\n</body>\n</html>'
2025-11-21 17:41:30,403 - INFO - 127.0.0.1 - - [21/Nov/2025 17:41:30] "GET /push-notification HTTP/1.1" 200 -
2025-11-21 17:41:30,442 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua-Platform: "macOS"
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Sec-Ch-Ua-Mobile: ?0
Accept: image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: no-cors
Sec-Fetch-Dest: image
Referer: http://localhost:10000/push-notification
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831
If-None-Match: "1760083224.4597292-6435-2328635141"
If-Modified-Since: Fri, 10 Oct 2025 08:00:24 GMT


2025-11-21 17:41:30,443 - INFO - Body: b''
2025-11-21 17:41:30,443 - INFO - URL: http://localhost:10000/static/netcore_logo.png
2025-11-21 17:41:30,443 - INFO - Method: GET
2025-11-21 17:41:30,443 - INFO - Endpoint: static
2025-11-21 17:41:30,447 - INFO - Response: [File Response] Content-Type: image/png, Headers: {'Content-Disposition': 'inline; filename=netcore_logo.png', 'Content-Type': 'image/png', 'Content-Length': '6435', 'Last-Modified': 'Fri, 10 Oct 2025 08:00:24 GMT', 'Cache-Control': 'no-cache', 'ETag': '"1760083224.4597292-6435-2328635141"', 'Date': 'Fri, 21 Nov 2025 12:11:30 GMT'}
2025-11-21 17:41:30,449 - INFO - 127.0.0.1 - - [21/Nov/2025 17:41:30] "[36mGET /static/netcore_logo.png HTTP/1.1[0m" 304 -
2025-11-21 17:41:34,228 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Content-Length: 2512
Sec-Ch-Ua-Platform: "macOS"
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept: */*
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Content-Type: application/json
Sec-Ch-Ua-Mobile: ?0
Origin: http://localhost:10000
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/push-notification
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831


2025-11-21 17:41:34,229 - INFO - Body: b'{"credentials":"{\\n  \\"type\\": \\"service_account\\",\\n  \\"project_id\\": \\"android-project-ecomapp\\",\\n  \\"private_key_id\\": \\"98faa67ef71a81fd31a8d1d638e449d1715574c0\\",\\n  \\"private_key\\": \\"-----BEGIN PRIVATE KEY-----\\\\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC2j9OBNqCK1xoN\\\\nHwJjKUHjtGTdy39E+SJSS5Xido8P3cLLAWRBxIEoH9hc3EKD1E5V71y+KOLuUZcy\\\\nIiPxXuk5roqgERhuXpprr8U7cPganZ8jFne4mlWPnjLitxT9SP7ZkEMgz559+ZM+\\\\nW/Pbf6MejbP+qGJeABYOVmK4LQwpFvCxCZHrVJpNpOH+dnBrF9TOzWNiq4Mw8Apn\\\\ntbPmFDHU5QZwd4nE5+o5ekLCn6TyyjN/qeDxQYpi3FPcYVLB7/niM0ilIEFewfkv\\\\nxI9w5OYBnjjQOoFKuiX4lqFh00l2TJqOxT/k+xaT4My6wLiOimuCvEE0drdoVnvW\\\\nzKY8Ja/DAgMBAAECggEALZs4hysSaBzcUTLR8du4rh2+pPnVTXG/dTeUtgJQMvJ/\\\\nWx954EQqz89Eyc3sf+plt2oYjRjBuC+ByfBlckL3mIVV9C7RH6FailRavUK3eE6w\\\\nFp/iQKetgDdRFvoNsEiwAcHcQzIasfXLJuTpwofcRCG6OX/vMvRqjiJefwwh4ZGB\\\\nel2E3vBrM9c2fP3wkGWiWoTXZKtuyKV9RAbRwg5LqVNTpxhufSXgzScagDY8nLR1\\\\nrJ/83zd2EzP6p7cYFS6Uq88b0w9hWVHHwUrfTGhGYhNX6qVVl57icGgHadLXIqdT\\\\nI5+K7qHMoz6BcLrPHlEnc5uJ2rk0nmrbVKl7QJuAYQKBgQDd/yVRpS6Wtz5cV9QT\\\\n1/BEbfa98uqXnxu5fn3ddJw6uQzqQt+KcGaEg+ko/bQNkgiLgauM0JuVEP90a19T\\\\nHx/yTaP9Uo4d/GATkCX6j4eXoHAoeBnCMYuQXRlLA1tc+6hIngjDWejsZELnPLEL\\\\nFwyKWSFgAkCoUfOucHhN72fe9QKBgQDShmAajT4vjZs2Nuu0GjgYeb6JRG1+HP1Q\\\\n8ylclx7PhfAMwQNNHMV6rV/x8DDBDM2guEqccWPDvejqREKcjyGventJCXecxlgf\\\\nfi3NXtaJ8vJ9NJUT9UXxv5o8gjWcNZ2Jf1yAUxS9lxS5CMiww5sPj0H6rfEExfXR\\\\n+RyeMX2w1wKBgQCGUmlcO1wzKXD8ItBZqWDhpr+TMzYqw8TcueKianpVNb7Qx+HG\\\\nPDhrmf0sJkYZp/CvqKgKLfbVfVF0ObuV6dFEpSHCl38SObBQZfn033+liRgUBIdh\\\\nbuUJVquFLeTMICE0vxqCSRacYhXxIFHnaezWkROWqgZBUkTlmXvRfDgXOQKBgEu6\\\\nFlu2rsXANDKeMs7IF6GGOWl6+b/BgcVakmhB281eKmkMDLnyPX7RWo/WjFME3fqQ\\\\nEBaSGwbQCzYpc6SJP961Oh+dji8QkaZSZvtWv+lDQMKU5YMWWSCKgVp+o/Yaux44\\\\nd/eY6v7/l26voDElS2OfbmZTpzzGUJRE/WxR9RplAoGAUXLvWs1fqYugbSnTAbMq\\\\ni0XNQm4wtCQOjx/z2ovy4DGIyfzZGNuC76ySDcIqpyJeCtfqkq6ag05jXK3lFmGm\\\\ngeYP9vdl6VSsBj8GaYJ7kLK57dh8100Nc07JsmNZx73YRqabCBvw/1nxQzOMKkPQ\\\\nxhlHt2R1kN/+ZaOC7+xFwpM=\\\\n-----END PRIVATE KEY-----\\\\n\\",\\n  \\"client_email\\": \\"firebase-adminsdk-rep6g@android-project-ecomapp.iam.gserviceaccount.com\\",\\n  \\"client_id\\": \\"116662145837078911094\\",\\n  \\"auth_uri\\": \\"https://accounts.google.com/o/oauth2/auth\\",\\n  \\"token_uri\\": \\"https://oauth2.googleapis.com/token\\",\\n  \\"auth_provider_x509_cert_url\\": \\"https://www.googleapis.com/oauth2/v1/certs\\",\\n  \\"client_x509_cert_url\\": \\"https://www.googleapis.com/robot/v1/metadata/x509/firebase-adminsdk-rep6g%40android-project-ecomapp.iam.gserviceaccount.com\\",\\n  \\"universe_domain\\": \\"googleapis.com\\"\\n}\\n"}'
2025-11-21 17:41:34,229 - INFO - URL: http://localhost:10000/validate-fcm-credentials
2025-11-21 17:41:34,229 - INFO - Method: POST
2025-11-21 17:41:34,229 - INFO - Endpoint: validate_fcm_credentials
2025-11-21 17:41:34,281 - INFO - Deleted existing Firebase app instance
2025-11-21 17:41:34,358 - INFO - Firebase initialized successfully with /var/folders/q0/crpf2_g53vd_p40scnm76q7w0000gq/T/tmpkvd5srba.json
2025-11-21 17:41:34,358 - INFO - FCM credentials validated and stored server-side
2025-11-21 17:41:34,358 - INFO - Response: b'{\n  "message": "Credentials validated and stored",\n  "valid": true\n}\n'
2025-11-21 17:41:34,358 - INFO - 127.0.0.1 - - [21/Nov/2025 17:41:34] "POST /validate-fcm-credentials HTTP/1.1" 200 -
2025-11-21 17:50:22,842 - INFO -  * Detected change in '/Users/allen.thomson/Desktop/sampleapp/automation/validation_script_android/fcm_service.py', reloading
2025-11-21 17:50:22,991 - INFO -  * Restarting with stat
2025-11-21 17:50:23,211 - WARNING -  * Debugger is active!
2025-11-21 17:50:23,222 - INFO -  * Debugger PIN: 804-181-670
2025-11-21 17:51:37,824 - INFO -  * Detected change in '/Users/allen.thomson/Desktop/sampleapp/automation/validation_script_android/fcm_service.py', reloading
2025-11-21 17:51:37,874 - INFO -  * Restarting with stat
2025-11-21 17:51:38,086 - WARNING -  * Debugger is active!
2025-11-21 17:51:38,097 - INFO -  * Debugger PIN: 804-181-670
2025-11-21 17:51:41,590 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:10000
 * Running on http://172.16.20.190:10000
2025-11-21 17:51:41,590 - INFO - [33mPress CTRL+C to quit[0m
2025-11-21 17:51:41,594 - INFO -  * Restarting with stat
2025-11-21 17:51:41,723 - WARNING -  * Debugger is active!
2025-11-21 17:51:41,731 - INFO -  * Debugger PIN: 804-181-670
2025-11-21 17:51:44,952 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Cache-Control: max-age=0
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831


2025-11-21 17:51:44,953 - INFO - Body: b''
2025-11-21 17:51:44,953 - INFO - URL: http://localhost:10000/push-notification
2025-11-21 17:51:44,953 - INFO - Method: GET
2025-11-21 17:51:44,953 - INFO - Endpoint: push_notification
2025-11-21 17:51:44,961 - INFO - Response: b'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>FCM Push Notification Sender</title>\n    <link rel="icon" type="image/png" href="/static/favicon.png">\n    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">\n    <style>\n        :root {\n            --primary-color: #e35502;\n            --header-bg: #230f2e;\n        }\n        #addPayloadPair{\n            color: #d1d1d1;\n            background-color: #230f2e;\n        }\n        .bg-info {\n            background-color: #230f2e !important;\n            color: #230f2e;\n        }\n       \n        .container { margin-top: 30px; }\n        .form-label { font-weight: 600; color: #333; }\n        \n        /* Header styling */\n        .navbar {\n            background-color: var(--header-bg) !important;\n        }\n        \n        .navbar-brand, .navbar-nav .nav-link {\n            color: white !important;\n        }\n        \n        .navbar-brand img {\n            height: 40px;\n            width: auto;\n            filter: brightness(0) invert(1);\n        }\n        \n        @media (max-width: 768px) {\n            .navbar-brand img {\n                height: 30px;\n            }\n            .navbar-brand span {\n                font-size: 0.9rem;\n            }\n        }\n        \n        .navbar-toggler {\n            border-color: rgba(255,255,255,0.5);\n        }\n        \n        .navbar-toggler-icon {\n            background-image: url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 30 30\'%3e%3cpath stroke=\'rgba%28255, 255, 255, 0.75%29\' stroke-linecap=\'round\' stroke-miterlimit=\'10\' stroke-width=\'2\' d=\'M4 7h22M4 15h22M4 23h22\'/%3e%3c/svg%3e");\n        }\n        \n        /* Button styling */\n        .btn-primary {\n            background-color: var(--primary-color) !important;\n            border-color: var(--primary-color) !important;\n        }\n        \n        .btn-primary:hover {\n            background-color: #c64802 !important;\n            border-color: #c64802 !important;\n        }\n        \n        .btn-outline-primary {\n            color: white !important;\n            border-color: white !important;\n        }\n        \n        .btn-outline-primary:hover {\n            background-color: rgba(255,255,255,0.1) !important;\n        }\n        \n        .alert {\n            border-radius: 5px;\n        }\n        \n        .status-success {\n            background-color: #d4edda;\n            color: #155724;\n            border: 1px solid #c3e6cb;\n            padding: 12px;\n            border-radius: 5px;\n            margin-top: 10px;\n        }\n        \n        .status-error {\n            background-color: #f8d7da;\n            color: #721c24;\n            border: 1px solid #f5c6cb;\n            padding: 12px;\n            border-radius: 5px;\n            margin-top: 10px;\n        }\n        \n        .status-info {\n            background-color: #d1ecf1;\n            color: #0c5460;\n            border: 1px solid #bee5eb;\n            padding: 12px;\n            border-radius: 5px;\n            margin-top: 10px;\n        }\n\n        .payload-key,\n        .payload-value {\n            font-size: 0.9rem;\n        }\n\n        .remove-pair {\n            font-size: 0.85rem;\n            padding: 0.3rem 0.5rem;\n        }\n    </style>\n</head>\n<body>\n    <!-- Navbar matching main page -->\n    <nav class="navbar navbar-expand-lg navbar-light bg-light">\n        <div class="container-fluid">\n            <a class="navbar-brand d-flex align-items-center" href="/">\n                <img src="/static/netcore_logo.png" alt="Netcore Logo" height="40" class="me-2">\n                <span> Notifications</span>\n            </a>\n            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">\n                <span class="navbar-toggler-icon"></span>\n            </button>\n            <div class="collapse navbar-collapse" id="navbarNav">\n                <ul class="navbar-nav ms-auto">\n                    <li class="nav-item">\n                        <a class="btn btn-primary" href="/">\xe2\x86\x90 Back to Validation</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </nav>\n\n    <div class="container">\n        <h2>\xf0\x9f\x93\xb1 FCM Push Notification Sender</h2>\n        \n        <div class="card mb-4">\n            <div class="card-body">\n                <form id="fcmForm" enctype="multipart/form-data">\n                    <div class="row">\n                        <div class="col-md-6">\n                            <div class="mb-3">\n                                <label for="privateKeysFile" class="form-label">\n                                    Firebase Private Key (JSON)\n                                    <span id="credentialsUploadedBadge" class="badge bg-success ms-2" style="display: none;background-color: #230f2e !important; color: #f9f9f9;">\xe2\x9c\x93 Uploaded</span>\n                                </label>\n                                <input type="file" class="form-control" id="privateKeysFile" name="private_keys" accept=".json">\n                                <small class="form-text text-muted">Upload your Firebase service account JSON file</small>\n                                <div id="credentialsStatus" class="mt-2"></div>\n                            </div>\n                        </div>\n                        <div class="col-md-6">\n                            <div class="mb-3">\n                                <label for="fcmToken" class="form-label">FCM Device Token</label>\n                                <input type="text" class="form-control" id="fcmToken" name="fcm_token" placeholder="e.g., eW8C5Nx8u5I:..." required>\n                                <small class="form-text text-muted">Firebase Cloud Messaging token from your device</small>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="mb-3">\n                        <label for="notificationTemplate" class="form-label">Notification Template</label>\n                        <select class="form-control" id="notificationTemplate" required>\n                            <option value="">-- Select a template --</option>\n                            <option value="rating">Rating Push Notification</option>\n                            <option value="simple">Simple Push Notification</option>\n                        </select>\n                    </div>\n\n                    <!-- Simple Template Fields -->\n                    <div id="simpleTemplateFields" style="display: none;">\n                        <div class="row">\n                            <div class="col-md-6">\n                                <div class="mb-3">\n                                    <label for="notificationTitle" class="form-label">Title</label>\n                                    <input type="text" class="form-control" id="notificationTitle" placeholder="Enter notification title">\n                                </div>\n                            </div>\n                            <div class="col-md-6">\n                                <div class="mb-3">\n                                    <label for="notificationMessage" class="form-label">Message</label>\n                                    <input type="text" class="form-control" id="notificationMessage" placeholder="Enter notification message">\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <!-- Common Fields for all templates -->\n                    <div id="commonTemplateFields" style="display: none;">\n                        <div class="mb-3">\n                            <label for="deeplinkUrl" class="form-label">Deep Link URL (Optional)</label>\n                            <input type="text" class="form-control" id="deeplinkUrl" placeholder="e.g., myapp://screen/product/123">\n                            <small class="form-text text-muted">URL to navigate to when notification is clicked</small>\n                        </div>\n\n                        <div class="mb-3">\n                            <label for="imageLink" class="form-label">Image Link (Optional)</label>\n                            <input type="text" class="form-control" id="imageLink" placeholder="e.g., https://example.com/image.png">\n                            <small class="form-text text-muted">URL to the notification image</small>\n                        </div>\n\n                        <div class="mb-3">\n                            <label class="form-label">Custom Payload (Optional)</label>\n                            <div id="payloadKeyValuePairs" class="mb-3">\n                                <!-- Key-value pairs will be added here dynamically -->\n                            </div>\n                            <button type="button" class="btn btn-sm btn-success" id="addPayloadPair">\n                                <i class="bi bi-plus"></i> Add Key-Value Pair\n                            </button>\n                            <div id="formPayloadError" class="alert alert-danger mt-2" style="display: none;"></div>\n                        </div>\n                    </div>\n\n                    <div class="mb-3">\n                        <button type="submit" class="btn btn-primary">Send Push Notification</button>\n                        <div id="pushNotificationStatus" class="mt-3"></div>\n                        <div id="fcmResponseDetails" class="mt-3" style="display: none;">\n                            <div class="card border-info">\n                                <div class="card-header bg-info text-white">\n                                    <h6 class="mb-0">FCM Response Details</h6>\n                                </div>\n                                <div class="card-body">\n                                    <div class="row">\n                                        <div class="col-md-6">\n                                            <p class="mb-2"><strong>Message ID:</strong></p>\n                                            <p id="messageId" class="text-monospace" style="font-family: monospace; word-break: break-all;">-</p>\n                                        </div>\n                                        <div class="col-md-6">\n                                            <p class="mb-2"><strong>Template Type:</strong></p>\n                                            <p id="templateType">-</p>\n                                        </div>\n                                    </div>\n                                    <div class="row">\n                                        <div class="col-md-6">\n                                            <p class="mb-2"><strong>Device Token:</strong></p>\n                                            <p id="deviceToken" class="text-monospace" style="font-family: monospace; word-break: break-all;">-</p>\n                                        </div>\n                                        <div class="col-md-6">\n                                            <p class="mb-2"><strong>Timestamp:</strong></p>\n                                            <p id="timestamp">-</p>\n                                        </div>\n                                    </div>\n                                    <div class="row">\n                                        <div class="col-12">\n                                            <p class="mb-2"><strong>Status:</strong></p>\n                                            <p id="deliveryStatus" class="badge bg-success">Sent Successfully</p>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </form>\n            </div>\n        </div>\n\n        <!-- Template Information -->\n        <!-- <div class="card mb-4">\n            <div class="card-body">\n                <h5 class="card-title">\xf0\x9f\x93\x8b Available Templates</h5>\n                <div class="row">\n                    <div class="col-md-6">\n                        <h6>Rating Push Notification</h6>\n                        <p class="text-muted small">Sends an in-app rating request with customizable UI. Includes deep link support for navigation and automatic 30-day message expiry.</p>\n                    </div>\n                    <div class="col-md-6">\n                        <h6>Simple Push Notification</h6>\n                        <p class="text-muted small">Standard notification with title and message. Supports deep links and custom payload data for flexible app integration.</p>\n                    </div>\n                </div>\n            </div>\n        </div> -->\n    </div>\n\n    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>\n    <script>\n        $(document).ready(function() {\n            // ==================== LOCAL STORAGE PERSISTENCE ====================\n            \n            // Load saved FCM token and key-value pairs on page load\n            function loadSavedData() {\n                const savedFcmToken = localStorage.getItem(\'fcm_token\');\n                const savedKeyValuePairs = localStorage.getItem(\'fcm_custom_payload_pairs\');\n                \n                if (savedFcmToken) {\n                    $(\'#fcmToken\').val(savedFcmToken);\n                }\n                \n                // Load saved key-value pairs\n                if (savedKeyValuePairs) {\n                    try {\n                        const pairs = JSON.parse(savedKeyValuePairs);\n                        for (const [key, value] of Object.entries(pairs)) {\n                            addPayloadPair(key, value);\n                        }\n                    } catch (e) {\n                        console.error(\'Failed to load saved payload pairs:\', e);\n                    }\n                }\n            }\n            \n            // Save data to localStorage (excludes sensitive credentials)\n            function saveToLocalStorage() {\n                const fcmToken = $(\'#fcmToken\').val();\n                if (fcmToken) {\n                    localStorage.setItem(\'fcm_token\', fcmToken);\n                }\n                \n                // Save key-value pairs\n                const formPayload = getFormPayloadAsJson();\n                if (Object.keys(formPayload).length > 0) {\n                    localStorage.setItem(\'fcm_custom_payload_pairs\', JSON.stringify(formPayload));\n                }\n            }\n            \n            // Track if credentials are uploaded to server\n            let credentialsUploadedToServer = localStorage.getItem(\'credentialsUploadedToServer\') === \'true\';\n            \n            // Update credential status display on page load\n            function updateCredentialStatusDisplay() {\n                if (credentialsUploadedToServer) {\n                    // $(\'#credentialsStatus\').html(\'<div class="status-success">\xe2\x9c\x93 Firebase credentials uploaded and validated successfully</div>\');\n                    $(\'#credentialsUploadedBadge\').show();\n                }\n            }\n            \n            // Save private key when file is selected\n            $(\'#privateKeysFile\').change(function() {\n                const file = this.files[0];\n                if (!file) {\n                    // If file is cleared, hide badge but keep the flag for next upload\n                    $(\'#credentialsUploadedBadge\').hide();\n                    return;\n                }\n\n                const reader = new FileReader();\n                reader.onload = function(e) {\n                    const credentials = e.target.result;\n                    \n                    const statusDiv = $(\'#credentialsStatus\');\n                    statusDiv.html(\'<div class="status-info">Uploading and validating credentials...</div>\');\n\n                    $.ajax({\n                        url: \'/validate-fcm-credentials\',\n                        method: \'POST\',\n                        data: JSON.stringify({ credentials: credentials }),\n                        contentType: \'application/json\',\n                        success: function(response) {\n                            if (response.valid) {\n                                credentialsUploadedToServer = true;\n                                localStorage.setItem(\'credentialsUploadedToServer\', \'true\');\n                                statusDiv.html(\'<div class="status-success">\xe2\x9c\x93 Firebase credentials uploaded and validated successfully</div>\');\n                                $(\'#credentialsUploadedBadge\').show();\n                            } else {\n                                credentialsUploadedToServer = false;\n                                localStorage.setItem(\'credentialsUploadedToServer\', \'false\');\n                                statusDiv.html(\'<div class="status-error">\xe2\x9c\x97 \' + (response.message || \'Validation failed\') + \'</div>\');\n                                $(\'#credentialsUploadedBadge\').hide();\n                            }\n                        },\n                        error: function(xhr, status, error) {\n                            credentialsUploadedToServer = false;\n                            localStorage.setItem(\'credentialsUploadedToServer\', \'false\');\n                            const errorMsg = xhr.responseJSON?.message || error || \'Unknown error\';\n                            statusDiv.html(\'<div class="status-error">\xe2\x9c\x97 Error: \' + errorMsg + \'</div>\');\n                            $(\'#credentialsUploadedBadge\').hide();\n                        }\n                    });\n                };\n                reader.readAsText(file);\n            });\n            \n            // Save token on blur\n            $(\'#fcmToken\').on(\'blur\', function() {\n                saveToLocalStorage();\n            });\n            \n            // Save key-value pairs whenever they change\n            $(document).on(\'change\', \'.payload-key, .payload-value\', function() {\n                saveToLocalStorage();\n            });\n            \n            // ==================== CUSTOM PAYLOAD KEY-VALUE FORM ====================\n            \n            let payloadPairCount = 0;\n            \n            // Add new key-value pair\n            $(\'#addPayloadPair\').click(function() {\n                addPayloadPair();\n            });\n            \n            function addPayloadPair(key = \'\', value = \'\') {\n                payloadPairCount++;\n                const pairId = \'pair-\' + payloadPairCount;\n                \n                const pairHtml = `\n                    <div class="row mb-2" id="${pairId}">\n                        <div class="col-md-5">\n                            <input type="text" class="form-control payload-key" placeholder="Key" value="${key}">\n                        </div>\n                        <div class="col-md-5">\n                            <input type="text" class="form-control payload-value" placeholder="Value" value="${value}">\n                        </div>\n                        <div class="col-md-2">\n                            <button type="button" class="btn btn-sm btn-danger remove-pair" data-pair-id="${pairId}">Remove</button>\n                        </div>\n                    </div>\n                `;\n                \n                $(\'#payloadKeyValuePairs\').append(pairHtml);\n            }\n            \n            // Remove key-value pair\n            $(document).on(\'click\', \'.remove-pair\', function() {\n                const pairId = $(this).data(\'pair-id\');\n                $(\'#\' + pairId).remove();\n            });\n            \n            // Convert form payload to JSON\n            function getFormPayloadAsJson() {\n                const pairs = {};\n                $(\'#payloadKeyValuePairs .row\').each(function() {\n                    const key = $(this).find(\'.payload-key\').val().trim();\n                    const value = $(this).find(\'.payload-value\').val().trim();\n                    \n                    if (key) {\n                        pairs[key] = value;\n                    }\n                });\n                return pairs;\n            }\n            \n            // ==================== TEMPLATE SELECTION ====================\n            \n            // Toggle template-specific fields based on selection\n            $(\'#notificationTemplate\').change(function() {\n                const template = $(this).val();\n                if (template) {\n                    $(\'#simpleTemplateFields\').toggle(template === \'simple\');\n                    $(\'#commonTemplateFields\').show();\n                } else {\n                    $(\'#simpleTemplateFields\').hide();\n                    $(\'#commonTemplateFields\').hide();\n                }\n            });\n            \n            // ==================== FORM SUBMISSION ====================\n            \n            // Handle form submission\n            $(\'#fcmForm\').submit(function(e) {\n                e.preventDefault();\n\n                const template = $(\'#notificationTemplate\').val();\n                if (!template) {\n                    alert(\'Please select a notification template\');\n                    return;\n                }\n\n                // Check if credentials are uploaded\n                if (!credentialsUploadedToServer) {\n                    alert(\'Please upload Firebase private key file first\');\n                    return;\n                }\n\n                // Get custom payload from form\n                const formPayload = getFormPayloadAsJson();\n                let customPayload = \'\';\n                \n                if (Object.keys(formPayload).length > 0) {\n                    customPayload = JSON.stringify(formPayload);\n                }\n\n                const fcmToken = $(\'#fcmToken\').val();\n                if (!fcmToken) {\n                    alert(\'Please enter FCM device token\');\n                    return;\n                }\n                \n                // Save token to localStorage\n                saveToLocalStorage();\n                \n                // Build request payload (NO credentials sent)\n                const requestPayload = {\n                    template_type: template,\n                    fcm_token: fcmToken,\n                    deeplink: $(\'#deeplinkUrl\').val().trim() || \'\',\n                    image_link: $(\'#imageLink\').val().trim() || \'\'\n                };\n\n                // Add template-specific fields\n                if (template === \'simple\') {\n                    requestPayload.title = $(\'#notificationTitle\').val().trim();\n                    requestPayload.message = $(\'#notificationMessage\').val().trim();\n                }\n\n                // Add custom payload if present\n                if (customPayload) {\n                    requestPayload.custom_payload = customPayload;\n                }\n\n                const statusDiv = $(\'#pushNotificationStatus\');\n                statusDiv.html(\'<div class="status-info">Sending push notification...</div>\');\n\n                $.ajax({\n                    url: \'/send-push-notification\',\n                    method: \'POST\',\n                    data: JSON.stringify(requestPayload),\n                    contentType: \'application/json\',\n                    success: function(response) {\n                        if (response.success) {\n                            statusDiv.html(\'<div class="status-success">\xe2\x9c\x93 Push notification sent successfully!</div>\');\n                            \n                            // Display detailed FCM response\n                            $(\'#messageId\').text(response.message_id || \'N/A\');\n                            $(\'#templateType\').text(response.template_type || template);\n                            $(\'#deviceToken\').text(response.device_token ? response.device_token.substring(0, 30) + \'...\' : fcmToken.substring(0, 30) + \'...\');\n                            $(\'#timestamp\').text(response.timestamp || new Date().toISOString());\n                            $(\'#deliveryStatus\').text(response.status || \'Sent Successfully\').removeClass(\'bg-danger bg-warning\').addClass(\'bg-success\');\n                            $(\'#fcmResponseDetails\').show();\n                        } else {\n                            statusDiv.html(\'<div class="status-error">\xe2\x9c\x97 \' + (response.message || \'Failed to send notification\') + \'</div>\');\n                            $(\'#fcmResponseDetails\').hide();\n                        }\n                    },\n                    error: function(xhr, status, error) {\n                        const errorMsg = xhr.responseJSON?.message || error || \'Unknown error\';\n                        statusDiv.html(\'<div class="status-error">\xe2\x9c\x97 Error: \' + errorMsg + \'</div>\');\n                        $(\'#fcmResponseDetails\').hide();\n                    }\n                });\n            });\n            \n            // Load saved data on page load\n            loadSavedData();\n            updateCredentialStatusDisplay();\n        });\n    </script>\n</body>\n</html>'
2025-11-21 17:51:44,961 - INFO - 127.0.0.1 - - [21/Nov/2025 17:51:44] "GET /push-notification HTTP/1.1" 200 -
2025-11-21 17:51:45,011 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua-Platform: "macOS"
If-None-Match: "1760083224.4597292-6435-2328635141"
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
If-Modified-Since: Fri, 10 Oct 2025 08:00:24 GMT
Sec-Ch-Ua-Mobile: ?0
Accept: image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: no-cors
Sec-Fetch-Dest: image
Referer: http://localhost:10000/push-notification
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831


2025-11-21 17:51:45,011 - INFO - Body: b''
2025-11-21 17:51:45,011 - INFO - URL: http://localhost:10000/static/netcore_logo.png
2025-11-21 17:51:45,011 - INFO - Method: GET
2025-11-21 17:51:45,011 - INFO - Endpoint: static
2025-11-21 17:51:45,018 - INFO - Response: [File Response] Content-Type: image/png, Headers: {'Content-Disposition': 'inline; filename=netcore_logo.png', 'Content-Type': 'image/png', 'Content-Length': '6435', 'Last-Modified': 'Fri, 10 Oct 2025 08:00:24 GMT', 'Cache-Control': 'no-cache', 'ETag': '"1760083224.4597292-6435-2328635141"', 'Date': 'Fri, 21 Nov 2025 12:21:45 GMT'}
2025-11-21 17:51:45,018 - INFO - 127.0.0.1 - - [21/Nov/2025 17:51:45] "[36mGET /static/netcore_logo.png HTTP/1.1[0m" 304 -
2025-11-21 17:51:45,099 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua-Platform: "macOS"
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Sec-Ch-Ua-Mobile: ?0
Accept: image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: no-cors
Sec-Fetch-Dest: image
Referer: http://localhost:10000/push-notification
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831
If-None-Match: "1760083224.4566805-889-3395757291"
If-Modified-Since: Fri, 10 Oct 2025 08:00:24 GMT


2025-11-21 17:51:45,099 - INFO - Body: b''
2025-11-21 17:51:45,099 - INFO - URL: http://localhost:10000/static/favicon.png
2025-11-21 17:51:45,099 - INFO - Method: GET
2025-11-21 17:51:45,099 - INFO - Endpoint: static
2025-11-21 17:51:45,100 - INFO - Response: [File Response] Content-Type: image/png, Headers: {'Content-Disposition': 'inline; filename=favicon.png', 'Content-Type': 'image/png', 'Content-Length': '889', 'Last-Modified': 'Fri, 10 Oct 2025 08:00:24 GMT', 'Cache-Control': 'no-cache', 'ETag': '"1760083224.4566805-889-3395757291"', 'Date': 'Fri, 21 Nov 2025 12:21:45 GMT'}
2025-11-21 17:51:45,100 - INFO - 127.0.0.1 - - [21/Nov/2025 17:51:45] "[36mGET /static/favicon.png HTTP/1.1[0m" 304 -
2025-11-21 17:51:47,403 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Content-Length: 2512
Sec-Ch-Ua-Platform: "macOS"
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept: */*
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Content-Type: application/json
Sec-Ch-Ua-Mobile: ?0
Origin: http://localhost:10000
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/push-notification
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831


2025-11-21 17:51:47,404 - INFO - Body: b'{"credentials":"{\\n  \\"type\\": \\"service_account\\",\\n  \\"project_id\\": \\"android-project-ecomapp\\",\\n  \\"private_key_id\\": \\"98faa67ef71a81fd31a8d1d638e449d1715574c0\\",\\n  \\"private_key\\": \\"-----BEGIN PRIVATE KEY-----\\\\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC2j9OBNqCK1xoN\\\\nHwJjKUHjtGTdy39E+SJSS5Xido8P3cLLAWRBxIEoH9hc3EKD1E5V71y+KOLuUZcy\\\\nIiPxXuk5roqgERhuXpprr8U7cPganZ8jFne4mlWPnjLitxT9SP7ZkEMgz559+ZM+\\\\nW/Pbf6MejbP+qGJeABYOVmK4LQwpFvCxCZHrVJpNpOH+dnBrF9TOzWNiq4Mw8Apn\\\\ntbPmFDHU5QZwd4nE5+o5ekLCn6TyyjN/qeDxQYpi3FPcYVLB7/niM0ilIEFewfkv\\\\nxI9w5OYBnjjQOoFKuiX4lqFh00l2TJqOxT/k+xaT4My6wLiOimuCvEE0drdoVnvW\\\\nzKY8Ja/DAgMBAAECggEALZs4hysSaBzcUTLR8du4rh2+pPnVTXG/dTeUtgJQMvJ/\\\\nWx954EQqz89Eyc3sf+plt2oYjRjBuC+ByfBlckL3mIVV9C7RH6FailRavUK3eE6w\\\\nFp/iQKetgDdRFvoNsEiwAcHcQzIasfXLJuTpwofcRCG6OX/vMvRqjiJefwwh4ZGB\\\\nel2E3vBrM9c2fP3wkGWiWoTXZKtuyKV9RAbRwg5LqVNTpxhufSXgzScagDY8nLR1\\\\nrJ/83zd2EzP6p7cYFS6Uq88b0w9hWVHHwUrfTGhGYhNX6qVVl57icGgHadLXIqdT\\\\nI5+K7qHMoz6BcLrPHlEnc5uJ2rk0nmrbVKl7QJuAYQKBgQDd/yVRpS6Wtz5cV9QT\\\\n1/BEbfa98uqXnxu5fn3ddJw6uQzqQt+KcGaEg+ko/bQNkgiLgauM0JuVEP90a19T\\\\nHx/yTaP9Uo4d/GATkCX6j4eXoHAoeBnCMYuQXRlLA1tc+6hIngjDWejsZELnPLEL\\\\nFwyKWSFgAkCoUfOucHhN72fe9QKBgQDShmAajT4vjZs2Nuu0GjgYeb6JRG1+HP1Q\\\\n8ylclx7PhfAMwQNNHMV6rV/x8DDBDM2guEqccWPDvejqREKcjyGventJCXecxlgf\\\\nfi3NXtaJ8vJ9NJUT9UXxv5o8gjWcNZ2Jf1yAUxS9lxS5CMiww5sPj0H6rfEExfXR\\\\n+RyeMX2w1wKBgQCGUmlcO1wzKXD8ItBZqWDhpr+TMzYqw8TcueKianpVNb7Qx+HG\\\\nPDhrmf0sJkYZp/CvqKgKLfbVfVF0ObuV6dFEpSHCl38SObBQZfn033+liRgUBIdh\\\\nbuUJVquFLeTMICE0vxqCSRacYhXxIFHnaezWkROWqgZBUkTlmXvRfDgXOQKBgEu6\\\\nFlu2rsXANDKeMs7IF6GGOWl6+b/BgcVakmhB281eKmkMDLnyPX7RWo/WjFME3fqQ\\\\nEBaSGwbQCzYpc6SJP961Oh+dji8QkaZSZvtWv+lDQMKU5YMWWSCKgVp+o/Yaux44\\\\nd/eY6v7/l26voDElS2OfbmZTpzzGUJRE/WxR9RplAoGAUXLvWs1fqYugbSnTAbMq\\\\ni0XNQm4wtCQOjx/z2ovy4DGIyfzZGNuC76ySDcIqpyJeCtfqkq6ag05jXK3lFmGm\\\\ngeYP9vdl6VSsBj8GaYJ7kLK57dh8100Nc07JsmNZx73YRqabCBvw/1nxQzOMKkPQ\\\\nxhlHt2R1kN/+ZaOC7+xFwpM=\\\\n-----END PRIVATE KEY-----\\\\n\\",\\n  \\"client_email\\": \\"firebase-adminsdk-rep6g@android-project-ecomapp.iam.gserviceaccount.com\\",\\n  \\"client_id\\": \\"116662145837078911094\\",\\n  \\"auth_uri\\": \\"https://accounts.google.com/o/oauth2/auth\\",\\n  \\"token_uri\\": \\"https://oauth2.googleapis.com/token\\",\\n  \\"auth_provider_x509_cert_url\\": \\"https://www.googleapis.com/oauth2/v1/certs\\",\\n  \\"client_x509_cert_url\\": \\"https://www.googleapis.com/robot/v1/metadata/x509/firebase-adminsdk-rep6g%40android-project-ecomapp.iam.gserviceaccount.com\\",\\n  \\"universe_domain\\": \\"googleapis.com\\"\\n}\\n"}'
2025-11-21 17:51:47,404 - INFO - URL: http://localhost:10000/validate-fcm-credentials
2025-11-21 17:51:47,404 - INFO - Method: POST
2025-11-21 17:51:47,404 - INFO - Endpoint: validate_fcm_credentials
2025-11-21 17:51:47,651 - INFO - Firebase initialized successfully with /var/folders/q0/crpf2_g53vd_p40scnm76q7w0000gq/T/tmpi0zt1km9.json
2025-11-21 17:51:47,652 - INFO - FCM credentials validated and stored server-side
2025-11-21 17:51:47,652 - INFO - Response: b'{\n  "message": "Credentials validated and stored",\n  "valid": true\n}\n'
2025-11-21 17:51:47,652 - INFO - 127.0.0.1 - - [21/Nov/2025 17:51:47] "POST /validate-fcm-credentials HTTP/1.1" 200 -
2025-11-21 17:51:51,382 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Content-Length: 272
Sec-Ch-Ua-Platform: "macOS"
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept: */*
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Content-Type: application/json
Sec-Ch-Ua-Mobile: ?0
Origin: http://localhost:10000
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/push-notification
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831


2025-11-21 17:51:51,384 - INFO - Body: b'{"template_type":"rating","fcm_token":"draY6WCzSciniCqnb8utwO:APA91bFzD_gJpEMuQkU3ybBTSoI2Udp1tr102HQpRxyiEz6kooBpXfl2YhdahmGjy0GCHq2SXv4M9o0qaURF_5WilcX8QyQaEkqOmWZO9uNrra2p04XXU-4","deeplink":"","image_link":"","custom_payload":"{\\"key1\\":\\"value1\\",\\"key2\\":\\"key3\\"}"}'
2025-11-21 17:51:51,384 - INFO - URL: http://localhost:10000/send-push-notification
2025-11-21 17:51:51,384 - INFO - Method: POST
2025-11-21 17:51:51,384 - INFO - Endpoint: send_push_notification
2025-11-21 17:51:51,386 - INFO - Deleted existing Firebase app instance
2025-11-21 17:51:51,490 - INFO - Firebase initialized successfully with /var/folders/q0/crpf2_g53vd_p40scnm76q7w0000gq/T/tmpdanhd6k_.json
2025-11-21 17:51:51,490 - INFO - ================================================================================
2025-11-21 17:51:51,490 - INFO - COMPLETE PAYLOAD BEING SENT:
2025-11-21 17:51:51,490 - INFO - ================================================================================
2025-11-21 17:51:51,490 - INFO - Template Type: rating
2025-11-21 17:51:51,490 - INFO - FCM Token: draY6WCzSciniCqnb8utwO:APA91bFzD_gJpEMuQkU3ybBTSoI2Udp1tr102HQpRxyiEz6kooBpXfl2YhdahmGjy0GCHq2SXv4M9o0qaURF_5WilcX8QyQaEkqOmWZO9uNrra2p04XXU-4
2025-11-21 17:51:51,490 - INFO - Full Payload (JSON):
{
  "smtSrc": "Smartech",
  "data": {
    "actionButton": [],
    "attrParams": {},
    "carousel": [],
    "customPayload": {
      "key1": "value1",
      "key2": "key3"
    },
    "deeplink": "",
    "expiry": 1766319711,
    "image": "",
    "message": "Rating Push Notification",
    "publishedDate": "2025-11-21T17:51:51.490397",
    "sound": true,
    "status": "sent",
    "subtitle": "",
    "title": "Rating Push Notification",
    "trid": "175567-591-13872-0-20251121175151-T",
    "type": "Simple"
  },
  "trid": "175567-591-13872-0-20251121175151-T",
  "smtUi": {
    "flid": 1,
    "lid": 1,
    "rat": {
      "cbt": "Submit",
      "dl": "",
      "sc": 5,
      "si": "https://cdna.netcoresmartech.com/14340/1680080201.png",
      "ty": 1,
      "ui": "https://cdna.netcoresmartech.com/14340/1680076013.png"
    }
  },
  "smtCustomPayload": {
    "key1": "value1",
    "key2": "key3"
  }
}
2025-11-21 17:51:51,490 - INFO - ================================================================================
2025-11-21 17:51:51,490 - INFO - ================================================================================
2025-11-21 17:51:51,490 - INFO - FCM MESSAGE DATA (converted to strings):
2025-11-21 17:51:51,490 - INFO - ================================================================================
2025-11-21 17:51:51,490 - INFO - Data Dict (JSON):
{
  "smtSrc": "Smartech",
  "trid": "175567-591-13872-0-20251121175151-T",
  "data": "{\"actionButton\": [], \"attrParams\": {}, \"carousel\": [], \"customPayload\": {\"key1\": \"value1\", \"key2\": \"key3\"}, \"deeplink\": \"\", \"expiry\": 1766319711, \"image\": \"\", \"message\": \"Rating Push Notification\", \"publishedDate\": \"2025-11-21T17:51:51.490397\", \"sound\": true, \"status\": \"sent\", \"subtitle\": \"\", \"title\": \"Rating Push Notification\", \"trid\": \"175567-591-13872-0-20251121175151-T\", \"type\": \"Simple\"}",
  "smtUi": "{\"flid\": 1, \"lid\": 1, \"rat\": {\"cbt\": \"Submit\", \"dl\": \"\", \"sc\": 5, \"si\": \"https://cdna.netcoresmartech.com/14340/1680080201.png\", \"ty\": 1, \"ui\": \"https://cdna.netcoresmartech.com/14340/1680076013.png\"}}",
  "smtCustomPayload": "{\"key1\": \"value1\", \"key2\": \"key3\"}"
}
2025-11-21 17:51:51,490 - INFO - ================================================================================
2025-11-21 17:51:52,201 - INFO - Successfully sent notification to draY6WCzSciniCqnb8utwO:APA91bFzD_gJpEMuQkU3ybBTSoI2Udp1tr102HQpRxyiEz6kooBpXfl2YhdahmGjy0GCHq2SXv4M9o0qaURF_5WilcX8QyQaEkqOmWZO9uNrra2p04XXU-4. Message ID: projects/android-project-ecomapp/messages/0:1763727712167639%6c8bbd1af9fd7ecd
2025-11-21 17:51:52,202 - INFO - push_notification_sent: {"template": "rating", "device": "draY6WCzSciniCqnb8ut...", "message_id": "projects/android-project-ecomapp/messages/0:1763727712167639%6c8bbd1af9fd7ecd", "timestamp": "2025-11-21T17:51:52.202388"}
2025-11-21 17:51:52,203 - INFO - Response: b'{\n  "device_token": "draY6WCzSciniCqnb8utwO:APA91bFzD_gJpEMuQkU3ybBTSoI2Udp1tr102HQpRxyiEz6kooBpXfl2YhdahmGjy0GCHq2SXv4M9o0qaURF_5WilcX8QyQaEkqOmWZO9uNrra2p04XXU-4",\n  "message": "Push notification sent successfully",\n  "message_id": "projects/android-project-ecomapp/messages/0:1763727712167639%6c8bbd1af9fd7ecd",\n  "status": "Sent Successfully",\n  "status_color": "bg-success",\n  "success": true,\n  "template_type": "rating",\n  "timestamp": "2025-11-21T17:51:52.202638"\n}\n'
2025-11-21 17:51:52,203 - INFO - 127.0.0.1 - - [21/Nov/2025 17:51:52] "POST /send-push-notification HTTP/1.1" 200 -
2025-11-21 17:51:58,622 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Content-Length: 272
Sec-Ch-Ua-Platform: "macOS"
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Accept: */*
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Content-Type: application/json
Sec-Ch-Ua-Mobile: ?0
Origin: http://localhost:10000
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/push-notification
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Cookie: G_ENABLED_IDPS=google; g_state={"i_l":0,"i_ll":1761932652460,"i_b":"PC6TgPeVdCRrApqPyLSK1E0B4dpwNQ8S1CDxzKuUuww"}; remember_token=1|4a0a1dd5ea69791275ae2b251699461e736c025cf4fb0f77f0c42c0d1fd1a0babb890f89790bdc3ee870dadc8cd491e40975fbd7051499a8968ac58402795831


2025-11-21 17:51:58,623 - INFO - Body: b'{"template_type":"rating","fcm_token":"draY6WCzSciniCqnb8utwO:APA91bFzD_gJpEMuQkU3ybBTSoI2Udp1tr102HQpRxyiEz6kooBpXfl2YhdahmGjy0GCHq2SXv4M9o0qaURF_5WilcX8QyQaEkqOmWZO9uNrra2p04XXU-4","deeplink":"","image_link":"","custom_payload":"{\\"key1\\":\\"value1\\",\\"key2\\":\\"key3\\"}"}'
2025-11-21 17:51:58,623 - INFO - URL: http://localhost:10000/send-push-notification
2025-11-21 17:51:58,623 - INFO - Method: POST
2025-11-21 17:51:58,623 - INFO - Endpoint: send_push_notification
2025-11-21 17:51:58,640 - INFO - Deleted existing Firebase app instance
2025-11-21 17:51:58,735 - INFO - Firebase initialized successfully with /var/folders/q0/crpf2_g53vd_p40scnm76q7w0000gq/T/tmp348ff11y.json
2025-11-21 17:51:58,735 - INFO - ================================================================================
2025-11-21 17:51:58,735 - INFO - COMPLETE PAYLOAD BEING SENT:
2025-11-21 17:51:58,735 - INFO - ================================================================================
2025-11-21 17:51:58,735 - INFO - Template Type: rating
2025-11-21 17:51:58,735 - INFO - FCM Token: draY6WCzSciniCqnb8utwO:APA91bFzD_gJpEMuQkU3ybBTSoI2Udp1tr102HQpRxyiEz6kooBpXfl2YhdahmGjy0GCHq2SXv4M9o0qaURF_5WilcX8QyQaEkqOmWZO9uNrra2p04XXU-4
2025-11-21 17:51:58,735 - INFO - Full Payload (JSON):
{
  "smtSrc": "Smartech",
  "data": {
    "actionButton": [],
    "attrParams": {},
    "carousel": [],
    "customPayload": {
      "key1": "value1",
      "key2": "key3"
    },
    "deeplink": "",
    "expiry": 1766319718,
    "image": "",
    "message": "Rating Push Notification",
    "publishedDate": "2025-11-21T17:51:58.735108",
    "sound": true,
    "status": "sent",
    "subtitle": "",
    "title": "Rating Push Notification",
    "trid": "175567-591-13872-0-20251121175158-T",
    "type": "Simple"
  },
  "trid": "175567-591-13872-0-20251121175158-T",
  "smtUi": {
    "flid": 1,
    "lid": 1,
    "rat": {
      "cbt": "Submit",
      "dl": "",
      "sc": 5,
      "si": "https://cdna.netcoresmartech.com/14340/1680080201.png",
      "ty": 1,
      "ui": "https://cdna.netcoresmartech.com/14340/1680076013.png"
    }
  },
  "smtCustomPayload": {
    "key1": "value1",
    "key2": "key3"
  }
}
2025-11-21 17:51:58,735 - INFO - ================================================================================
2025-11-21 17:51:58,735 - INFO - ================================================================================
2025-11-21 17:51:58,735 - INFO - FCM MESSAGE DATA (converted to strings):
2025-11-21 17:51:58,735 - INFO - ================================================================================
2025-11-21 17:51:58,735 - INFO - Data Dict (JSON):
{
  "smtSrc": "Smartech",
  "trid": "175567-591-13872-0-20251121175158-T",
  "data": "{\"actionButton\": [], \"attrParams\": {}, \"carousel\": [], \"customPayload\": {\"key1\": \"value1\", \"key2\": \"key3\"}, \"deeplink\": \"\", \"expiry\": 1766319718, \"image\": \"\", \"message\": \"Rating Push Notification\", \"publishedDate\": \"2025-11-21T17:51:58.735108\", \"sound\": true, \"status\": \"sent\", \"subtitle\": \"\", \"title\": \"Rating Push Notification\", \"trid\": \"175567-591-13872-0-20251121175158-T\", \"type\": \"Simple\"}",
  "smtUi": "{\"flid\": 1, \"lid\": 1, \"rat\": {\"cbt\": \"Submit\", \"dl\": \"\", \"sc\": 5, \"si\": \"https://cdna.netcoresmartech.com/14340/1680080201.png\", \"ty\": 1, \"ui\": \"https://cdna.netcoresmartech.com/14340/1680076013.png\"}}",
  "smtCustomPayload": "{\"key1\": \"value1\", \"key2\": \"key3\"}"
}
2025-11-21 17:51:58,735 - INFO - ================================================================================
2025-11-21 17:51:59,166 - INFO - Successfully sent notification to draY6WCzSciniCqnb8utwO:APA91bFzD_gJpEMuQkU3ybBTSoI2Udp1tr102HQpRxyiEz6kooBpXfl2YhdahmGjy0GCHq2SXv4M9o0qaURF_5WilcX8QyQaEkqOmWZO9uNrra2p04XXU-4. Message ID: projects/android-project-ecomapp/messages/0:1763727719136305%6c8bbd1af9fd7ecd
2025-11-21 17:51:59,166 - INFO - push_notification_sent: {"template": "rating", "device": "draY6WCzSciniCqnb8ut...", "message_id": "projects/android-project-ecomapp/messages/0:1763727719136305%6c8bbd1af9fd7ecd", "timestamp": "2025-11-21T17:51:59.166522"}
2025-11-21 17:51:59,167 - INFO - Response: b'{\n  "device_token": "draY6WCzSciniCqnb8utwO:APA91bFzD_gJpEMuQkU3ybBTSoI2Udp1tr102HQpRxyiEz6kooBpXfl2YhdahmGjy0GCHq2SXv4M9o0qaURF_5WilcX8QyQaEkqOmWZO9uNrra2p04XXU-4",\n  "message": "Push notification sent successfully",\n  "message_id": "projects/android-project-ecomapp/messages/0:1763727719136305%6c8bbd1af9fd7ecd",\n  "status": "Sent Successfully",\n  "status_color": "bg-success",\n  "success": true,\n  "template_type": "rating",\n  "timestamp": "2025-11-21T17:51:59.166740"\n}\n'
2025-11-21 17:51:59,167 - INFO - 127.0.0.1 - - [21/Nov/2025 17:51:59] "POST /send-push-notification HTTP/1.1" 200 -
