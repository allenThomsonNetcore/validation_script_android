2025-10-10 12:36:23,762 - WARNING -  * Debugger is active!
2025-10-10 12:36:23,772 - INFO -  * Debugger PIN: 132-353-793
2025-10-10 12:36:51,965 - INFO -  * Detected change in '/Users/allen.thomson/Desktop/sampleapp/automation/validation_script_android/beta.py', reloading
2025-10-10 12:36:52,231 - WARNING -  * Debugger is active!
2025-10-10 12:36:52,239 - INFO -  * Debugger PIN: 132-353-793
2025-10-10 12:37:00,454 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Cache-Control: max-age=0
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:37:00,454 - INFO - Body: b''
2025-10-10 12:37:00,455 - INFO - URL: http://localhost:10000/
2025-10-10 12:37:00,455 - INFO - Method: GET
2025-10-10 12:37:00,455 - INFO - Endpoint: index
2025-10-10 12:37:00,463 - INFO - Response: b'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Event Validation Tool</title>\n    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">\n    <link href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" rel="stylesheet">\n    <style>\n        .container { margin-top: 30px; }\n        .table-container { margin-top: 20px; }\n        .filter-container { margin: 20px 0; }\n        .hidden { display: none; }\n        .first-event { color: blue; }\n        .null-value { background-color: yellow; }\n        .valid-status { color: green; }\n        .invalid-status { color: red; }\n        .empty-status { color: orange; }\n        .not-present { color: darkolivegreen; }\n        .extra-key { color: rgb(24, 214, 185); }\n        .type-mismatch { background-color: #ffe6e6; }\n        .download-section {\n            margin: 20px 0;\n            text-align: right;\n        }\n        /* Status color coding */\n        .status-valid { background-color: #d4edda !important; color: #155724 !important; }\n        .status-invalid { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-empty { background-color: #fff3cd !important; color: #856404 !important; }\n        .status-extra { background-color: #d1ecf1 !important; color: #0c5460 !important; }\n        .status-notpresent { background-color: #042508 !important; color: #7f7b97 !important; }\n        .status-csv { background-color: #e2e3e5 !important; color: #383d41 !important; }\n        .status-extra-event { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-extra-field { background-color: #fff3cd !important; color: #856404 !important; }\n        .validation-status {\n            font-weight: bold;\n        }\n        .status-valid {\n            color: #28a745;\n        }\n        .status-invalid {\n            color: #dc3545;\n        }\n        .status-empty {\n            color: #ffc107;\n        }\n        .status-extra {\n            color: #17a2b8;\n        }\n        .status-extra-event {\n            color: #dc3545;\n        }\n        .status-extra-field {\n            color: #ffc107;\n        }\n        .filter-section {\n            background-color: #f8f9fa;\n            padding: 15px;\n            margin-bottom: 20px;\n            border-radius: 5px;\n        }\n        .sort-header {\n            cursor: pointer;\n        }\n        .sort-header:hover {\n            background-color: #e9ecef;\n        }\n        .sort-icon {\n            margin-left: 5px;\n        }\n        .filter-dropdown {\n            position: relative;\n            display: inline-block;\n        }\n        .filter-content {\n            display: none;\n            position: absolute;\n            background-color: #f9f9f9;\n            min-width: 200px;\n            max-height: 300px;\n            overflow-y: auto;\n            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\n            z-index: 1000;\n            padding: 10px;\n        }\n        .filter-content.show {\n            display: block;\n        }\n        .filter-checkbox {\n            margin: 5px 0;\n        }\n        .filter-checkbox label {\n            display: block;\n            padding: 5px;\n            cursor: pointer;\n        }\n        .filter-checkbox label:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-header {\n            display: flex;\n            align-items: center;\n            cursor: pointer;\n            padding: 5px;\n        }\n        .filter-header:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-icon {\n            margin-left: 5px;\n        }\n        .filter-actions {\n            margin-top: 10px;\n            padding-top: 10px;\n            border-top: 1px solid #ddd;\n        }\n    </style>\n</head>\n<body>\n    <nav class="navbar navbar-expand-lg navbar-light bg-light">\n        <div class="container-fluid">\n            <a class="navbar-brand" href="#">Payload Validator</a>\n            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">\n                <span class="navbar-toggler-icon"></span>\n            </button>\n            <div class="collapse navbar-collapse" id="navbarNav">\n                <ul class="navbar-nav ms-auto">\n                    <li class="nav-item">\n                        <a class="btn btn-primary" href="https://contact-api-netcore-beta-0-16.onrender.com/" target="_blank">Trigger Activity API</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </nav>\n\n    <div class="container">\n        <h2>Event Validation Tool</h2>\n        \n        <div class="card mb-4">\n            <div class="card-body">\n                <div class="mb-3">\n                    <label class="form-label">Validation Mode</label>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="regularMode" value="regular" checked>\n                        <label class="form-check-label" for="regularMode">\n                            Regular Event Validation (Single Event/Event Payload format)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteMode" value="website">\n                        <label class="form-check-label" for="websiteMode">\n                            Website Logs Validation (JSON lines format with eventname and payload)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteV2Mode" value="website-v2">\n                        <label class="form-check-label" for="websiteV2Mode">\n                            Website Logs V2 Validation (JSON lines format with event key and system fields excluded)\n                        </label>\n                    </div>\n                </div>\n                \n                <form id="uploadForm" enctype="multipart/form-data">\n                    <div class="mb-3">\n                        <label for="csvFile" class="form-label">CSV File (Validation Rules)</label>\n                        <input type="file" class="form-control" id="csvFile" name="csv_file" accept=".csv" required>\n                        <div class="mt-2">\n                            <a href="/download_template" class="btn btn-outline-secondary btn-sm">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Sample Template\n                            </a>\n                        </div>\n                    </div>\n                    <div class="mb-3">\n                        <label for="txtFile" class="form-label">TXT File (Event Logs)</label>\n                        <input type="file" class="form-control" id="txtFile" name="txt_file" accept=".txt" required>\n                        <div class="mt-2">\n                            <a href="/download_sample_log" class="btn btn-outline-secondary btn-sm">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Sample Log\n                            </a>\n                        </div>\n                    </div>\n                    <button type="submit" class="btn btn-primary">Validate</button>\n                </form>\n            </div>\n        </div>\n\n        <div class="filter-section" id="filterSection" style="display: none;">\n            <div class="row mb-3">\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Summary</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>CSV Events:</strong></p>\n                                    <p class="text-primary" id="csvEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Log Events:</strong></p>\n                                    <p class="text-success" id="logEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Details</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Missing Events:</strong></p>\n                                    <p class="text-warning" id="missingEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Extra Events:</strong></p>\n                                    <p class="text-info" id="extraEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <h4>Filters</h4>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="eventName">\n                            Event Name <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="eventNameFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="eventNameSelectAll" checked>\n                                <label for="eventNameSelectAll">Select All</label>\n                            </div>\n                            <div id="eventNameOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'eventName\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'eventName\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="status">\n                            Status <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="statusFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="statusSelectAll" checked>\n                                <label for="statusSelectAll">Select All</label>\n                            </div>\n                            <div id="statusOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'status\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'status\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="expectedType">\n                            Expected Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="expectedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="expectedTypeSelectAll" checked>\n                                <label for="expectedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="expectedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'expectedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'expectedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="receivedType">\n                            Received Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="receivedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="receivedTypeSelectAll" checked>\n                                <label for="receivedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="receivedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'receivedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'receivedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-secondary" id="clearFilters">Clear All Filters</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-success" id="downloadResults">Download Results</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-info" id="downloadValidEvents">Download Valid Events</button>\n                </div>\n            </div>\n        </div>\n\n        <div id="fullyValidEventsSection" class="alert alert-success" style="display:none;">\n            <strong>Events with all payloads valid:</strong>\n            <ul id="fullyValidEventsList" style="margin-bottom:0;"></ul>\n        </div>\n\n        <div class="table-container">\n            <table class="table table-striped" id="resultsTable">\n                <thead>\n                    <tr>\n                        <th class="sort-header" data-sort="eventName">Event Name <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="key">Key <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="value">Value <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="expectedType">Expected Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="receivedType">Received Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="validationStatus">Status <span class="sort-icon">\xe2\x86\x95</span></th>\n                    </tr>\n                </thead>\n                <tbody id="resultsBody"></tbody>\n            </table>\n        </div>\n    </div>\n\n    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/moment/moment.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>\n    <script>\n        let currentResults = [];\n        let currentSummary = {};\n        let currentSort = { field: null, order: \'asc\' };\n        let activeFilters = {\n            eventName: [],\n            status: [],\n            expectedType: [],\n            receivedType: []\n        };\n\n        $(\'#dateRange\').daterangepicker({\n            autoUpdateInput: false,\n            locale: {\n                cancelLabel: \'Clear\'\n            }\n        });\n\n        $(\'#dateRange\').on(\'apply.daterangepicker\', function(ev, picker) {\n            $(this).val(picker.startDate.format(\'MM/DD/YYYY\') + \' - \' + picker.endDate.format(\'MM/DD/YYYY\'));\n            applyFilters();\n        });\n\n        $(\'#dateRange\').on(\'cancel.daterangepicker\', function(ev, picker) {\n            $(this).val(\'\');\n            applyFilters();\n        });\n\n        $(\'#uploadForm\').on(\'submit\', function(e) {\n            e.preventDefault();\n            const formData = new FormData(this);\n            \n            // Determine which endpoint to use based on validation mode\n            const validationMode = $(\'input[name="validationMode"]:checked\').val();\n            let endpoint = \'/upload\';\n            if (validationMode === \'website\') {\n                endpoint = \'/validate-website-logs\';\n            } else if (validationMode === \'website-v2\') {\n                endpoint = \'/validate-website-logs-v2\';\n            }\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + endpoint;\n            \n            console.log(\'Making request to:\', fullUrl);\n            console.log(\'Validation mode:\', validationMode);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: formData,\n                processData: false,\n                contentType: false,\n                success: function(response) {\n                    console.log(\'Upload response:\', response);\n                    \n                    // Handle both old and new response formats\n                    if (response.results && response.summary) {\n                        // New format with summary\n                        currentResults = response.results;\n                        currentSummary = response.summary;\n                        // Store original logs for download feature\n                        window.originalLogs = response.original_logs || {};\n                    } else {\n                        // Old format - just results array\n                        currentResults = response;\n                        currentSummary = {\n                            csv_events_count: 0,\n                            log_events_count: 0,\n                            csv_events: [],\n                            log_events: []\n                        };\n                        window.originalLogs = {};\n                    }\n                    \n                    updateEventSummary();\n                    updateFilters();\n                    displayResults(currentResults);\n                    $(\'#filterSection\').show();\n\n                    if (response.fully_valid_events && response.fully_valid_events.length > 0) {\n                        $(\'#fullyValidEventsList\').empty();\n                        response.fully_valid_events.forEach(function(eventName) {\n                            $(\'#fullyValidEventsList\').append(\'<li>\' + eventName + \'</li>\');\n                        });\n                        $(\'#fullyValidEventsSection\').show();\n                    } else {\n                        $(\'#fullyValidEventsSection\').hide();\n                    }\n                },\n                error: function(xhr) {\n                    console.error(\'Upload error:\', xhr);\n                    alert(\'Error uploading files: \' + xhr.responseText);\n                }\n            });\n        });\n\n        // Initialize filter dropdowns\n        $(document).ready(function() {\n            $(\'.filter-header\').click(function(e) {\n                e.stopPropagation();\n                const filterId = $(this).data(\'filter\');\n                console.log(\'Clicked filter:\', filterId);\n                $(`#${filterId}Filter`).toggleClass(\'show\');\n            });\n\n            // Close filter dropdowns when clicking outside\n            $(document).click(function(e) {\n                if (!$(e.target).closest(\'.filter-dropdown\').length) {\n                    $(\'.filter-content\').removeClass(\'show\');\n                }\n            });\n        });\n\n        function updateEventSummary() {\n            // Update event count displays\n            $(\'#csvEventsCount\').text(currentSummary.csv_events_count || 0);\n            $(\'#logEventsCount\').text(currentSummary.log_events_count || 0);\n            \n            // Calculate missing and extra events\n            const csvEvents = new Set(currentSummary.csv_events || []);\n            const logEvents = new Set(currentSummary.log_events || []);\n            \n            const missingEvents = csvEvents.size - new Set([...csvEvents].filter(x => logEvents.has(x))).size;\n            const extraEvents = logEvents.size - new Set([...logEvents].filter(x => csvEvents.has(x))).size;\n            \n            $(\'#missingEventsCount\').text(missingEvents);\n            $(\'#extraEventsCount\').text(extraEvents);\n        }\n\n        function updateFilters() {\n            const eventNames = new Set();\n            const expectedTypes = new Set();\n            const receivedTypes = new Set();\n            const statuses = new Set();\n            \n            currentResults.forEach(result => {\n                if (result.eventName) eventNames.add(result.eventName);\n                if (result.expectedType) expectedTypes.add(result.expectedType);\n                if (result.receivedType) receivedTypes.add(result.receivedType);\n                if (result.validationStatus) statuses.add(result.validationStatus);\n            });\n\n            console.log(\'Available statuses:\', Array.from(statuses));\n\n            updateFilterOptions(\'eventName\', eventNames);\n            updateFilterOptions(\'status\', statuses);\n            updateFilterOptions(\'expectedType\', expectedTypes);\n            updateFilterOptions(\'receivedType\', receivedTypes);\n        }\n\n        function updateFilterOptions(filterId, values) {\n            const container = $(`#${filterId}Options`);\n            container.empty();\n            \n            console.log(`Updating ${filterId} with values:`, Array.from(values));\n            \n            Array.from(values).sort().forEach(value => {\n                if (value) {\n                    const checkboxId = `${filterId}_${value.replace(/[^a-zA-Z0-9]/g, \'_\')}`;\n                    container.append(`\n                        <div class="filter-checkbox">\n                            <input type="checkbox" id="${checkboxId}" value="${value}" checked>\n                            <label for="${checkboxId}">${value}</label>\n                        </div>\n                    `);\n                }\n            });\n\n            // Update select all checkbox\n            $(`#${filterId}SelectAll`).prop(\'checked\', true);\n        }\n\n        function getSelectedValues(filterId) {\n            return $(`#${filterId}Options input:checked`).map(function() {\n                return $(this).val();\n            }).get();\n        }\n\n        function applyFilter(filterId) {\n            activeFilters[filterId] = getSelectedValues(filterId);\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function clearFilter(filterId) {\n            $(`#${filterId}Options input`).prop(\'checked\', false);\n            $(`#${filterId}SelectAll`).prop(\'checked\', false);\n            activeFilters[filterId] = [];\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function applyFilters() {\n            const filters = {\n                eventName: activeFilters.eventName,\n                validationStatus: activeFilters.status,\n                expectedType: activeFilters.expectedType,\n                receivedType: activeFilters.receivedType\n            };\n\n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/filter\';\n\n            console.log(\'Making filter request to:\', fullUrl);\n\n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({\n                    results: currentResults,\n                    filters: filters,\n                    sort_by: currentSort.field,\n                    sort_order: currentSort.order\n                }),\n                contentType: \'application/json\',\n                success: function(response) {\n                    displayResults(response);\n                    window.filteredResults = response;\n                },\n                error: function(xhr) {\n                    console.error(\'Filter error:\', xhr);\n                    alert(\'Error applying filters: \' + xhr.responseText);\n                }\n            });\n        }\n\n        // Handle select all checkboxes\n        $(\'[id$="SelectAll"]\').change(function() {\n            const filterId = this.id.replace(\'SelectAll\', \'\');\n            $(`#${filterId}Options input`).prop(\'checked\', $(this).prop(\'checked\'));\n        });\n\n        // Update select all checkbox when individual checkboxes change\n        $(\'.filter-content\').on(\'change\', \'input[type="checkbox"]:not([id$="SelectAll"])\', function() {\n            const filterId = $(this).closest(\'.filter-content\').attr(\'id\').replace(\'Filter\', \'\');\n            const allChecked = $(`#${filterId}Options input:checked`).length === $(`#${filterId}Options input`).length;\n            $(`#${filterId}SelectAll`).prop(\'checked\', allChecked);\n        });\n\n        $(\'#clearFilters\').click(function() {\n            $(\'.filter-content input[type="checkbox"]\').prop(\'checked\', false);\n            $(\'[id$="SelectAll"]\').prop(\'checked\', false);\n            Object.keys(activeFilters).forEach(key => {\n                activeFilters[key] = [];\n            });\n            applyFilters();\n        });\n\n        $(\'#downloadResults\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download\';\n            \n            console.log(\'Making download request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ results: resultsToDownload }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'validation_results.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download error:\', xhr);\n                    alert(\'Error downloading results: \' + xhr.responseText);\n                }\n            });\n        });\n\n        $(\'#downloadValidEvents\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download-valid-events\';\n            \n            console.log(\'Making download valid events request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ \n                    results: resultsToDownload,\n                    logs_data: window.originalLogs || {}\n                }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'valid_events_report.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download valid events error:\', xhr);\n                    alert(\'Error downloading valid events: \' + xhr.responseText);\n                }\n            });\n        });\n\n        function displayResults(results) {\n            const tbody = $(\'#resultsBody\');\n            tbody.empty();\n            \n            // Debug log to check results being displayed\n            console.log(\'Displaying results:\', results);\n            \n            results.forEach(result => {\n                const statusClass = getStatusClass(result.validationStatus);\n                tbody.append(`\n                    <tr>\n                        <td>${result.eventName}</td>\n                        <td>${result.key}</td>\n                        <td>${result.value}</td>\n                        <td>${result.expectedType}</td>\n                        <td>${result.receivedType}</td>\n                        <td class="validation-status ${statusClass}">${result.validationStatus}</td>\n                    </tr>\n                `);\n            });\n        }\n\n        function getStatusClass(status) {\n            if (status === \'Valid\') return \'status-valid\';\n            if (status === \'Invalid/Wrong datatype/value\') return \'status-invalid\';\n            if (status === \'Payload value is Empty\') return \'status-empty\';\n            if (status === \'Extra key present in the log\') return \'status-extra\';\n            if (status === \'Extra event present in logs\') return \'status-extra-event\';\n            if (status === \'Field from extra event\') return \'status-extra-field\';\n            if (status === \'Event name not present in the logs\') return \'status-notpresent\';\n            return \'\';\n        }\n\n        $(\'.sort-header\').click(function() {\n            const field = $(this).data(\'sort\');\n            if (currentSort.field === field) {\n                currentSort.order = currentSort.order === \'asc\' ? \'desc\' : \'asc\';\n            } else {\n                currentSort.field = field;\n                currentSort.order = \'asc\';\n            }\n            applyFilters();\n        });\n\n        $(\'#eventNameFilter, #statusFilter, #expectedTypeFilter, #receivedTypeFilter\').change(applyFilters);\n    </script>\n</body>\n</html>'
2025-10-10 12:37:00,463 - INFO - 127.0.0.1 - - [10/Oct/2025 12:37:00] "GET / HTTP/1.1" 200 -
2025-10-10 12:37:01,826 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Cache-Control: max-age=0
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:37:01,827 - INFO - Body: b''
2025-10-10 12:37:01,827 - INFO - URL: http://localhost:10000/
2025-10-10 12:37:01,827 - INFO - Method: GET
2025-10-10 12:37:01,827 - INFO - Endpoint: index
2025-10-10 12:37:01,827 - INFO - Response: b'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Event Validation Tool</title>\n    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">\n    <link href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" rel="stylesheet">\n    <style>\n        .container { margin-top: 30px; }\n        .table-container { margin-top: 20px; }\n        .filter-container { margin: 20px 0; }\n        .hidden { display: none; }\n        .first-event { color: blue; }\n        .null-value { background-color: yellow; }\n        .valid-status { color: green; }\n        .invalid-status { color: red; }\n        .empty-status { color: orange; }\n        .not-present { color: darkolivegreen; }\n        .extra-key { color: rgb(24, 214, 185); }\n        .type-mismatch { background-color: #ffe6e6; }\n        .download-section {\n            margin: 20px 0;\n            text-align: right;\n        }\n        /* Status color coding */\n        .status-valid { background-color: #d4edda !important; color: #155724 !important; }\n        .status-invalid { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-empty { background-color: #fff3cd !important; color: #856404 !important; }\n        .status-extra { background-color: #d1ecf1 !important; color: #0c5460 !important; }\n        .status-notpresent { background-color: #042508 !important; color: #7f7b97 !important; }\n        .status-csv { background-color: #e2e3e5 !important; color: #383d41 !important; }\n        .status-extra-event { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-extra-field { background-color: #fff3cd !important; color: #856404 !important; }\n        .validation-status {\n            font-weight: bold;\n        }\n        .status-valid {\n            color: #28a745;\n        }\n        .status-invalid {\n            color: #dc3545;\n        }\n        .status-empty {\n            color: #ffc107;\n        }\n        .status-extra {\n            color: #17a2b8;\n        }\n        .status-extra-event {\n            color: #dc3545;\n        }\n        .status-extra-field {\n            color: #ffc107;\n        }\n        .filter-section {\n            background-color: #f8f9fa;\n            padding: 15px;\n            margin-bottom: 20px;\n            border-radius: 5px;\n        }\n        .sort-header {\n            cursor: pointer;\n        }\n        .sort-header:hover {\n            background-color: #e9ecef;\n        }\n        .sort-icon {\n            margin-left: 5px;\n        }\n        .filter-dropdown {\n            position: relative;\n            display: inline-block;\n        }\n        .filter-content {\n            display: none;\n            position: absolute;\n            background-color: #f9f9f9;\n            min-width: 200px;\n            max-height: 300px;\n            overflow-y: auto;\n            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\n            z-index: 1000;\n            padding: 10px;\n        }\n        .filter-content.show {\n            display: block;\n        }\n        .filter-checkbox {\n            margin: 5px 0;\n        }\n        .filter-checkbox label {\n            display: block;\n            padding: 5px;\n            cursor: pointer;\n        }\n        .filter-checkbox label:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-header {\n            display: flex;\n            align-items: center;\n            cursor: pointer;\n            padding: 5px;\n        }\n        .filter-header:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-icon {\n            margin-left: 5px;\n        }\n        .filter-actions {\n            margin-top: 10px;\n            padding-top: 10px;\n            border-top: 1px solid #ddd;\n        }\n    </style>\n</head>\n<body>\n    <nav class="navbar navbar-expand-lg navbar-light bg-light">\n        <div class="container-fluid">\n            <a class="navbar-brand" href="#">Payload Validator</a>\n            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">\n                <span class="navbar-toggler-icon"></span>\n            </button>\n            <div class="collapse navbar-collapse" id="navbarNav">\n                <ul class="navbar-nav ms-auto">\n                    <li class="nav-item">\n                        <a class="btn btn-primary" href="https://contact-api-netcore-beta-0-16.onrender.com/" target="_blank">Trigger Activity API</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </nav>\n\n    <div class="container">\n        <h2>Event Validation Tool</h2>\n        \n        <div class="card mb-4">\n            <div class="card-body">\n                <div class="mb-3">\n                    <label class="form-label">Validation Mode</label>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="regularMode" value="regular" checked>\n                        <label class="form-check-label" for="regularMode">\n                            Regular Event Validation (Single Event/Event Payload format)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteMode" value="website">\n                        <label class="form-check-label" for="websiteMode">\n                            Website Logs Validation (JSON lines format with eventname and payload)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteV2Mode" value="website-v2">\n                        <label class="form-check-label" for="websiteV2Mode">\n                            Website Logs V2 Validation (JSON lines format with event key and system fields excluded)\n                        </label>\n                    </div>\n                </div>\n                \n                <form id="uploadForm" enctype="multipart/form-data">\n                    <div class="mb-3">\n                        <label for="csvFile" class="form-label">CSV File (Validation Rules)</label>\n                        <input type="file" class="form-control" id="csvFile" name="csv_file" accept=".csv" required>\n                        <div class="mt-2">\n                            <a href="/download_template" class="btn btn-outline-secondary btn-sm">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Sample Template\n                            </a>\n                        </div>\n                    </div>\n                    <div class="mb-3">\n                        <label for="txtFile" class="form-label">TXT File (Event Logs)</label>\n                        <input type="file" class="form-control" id="txtFile" name="txt_file" accept=".txt" required>\n                        <div class="mt-2">\n                            <a href="/download_sample_log" class="btn btn-outline-secondary btn-sm">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Sample Log\n                            </a>\n                        </div>\n                    </div>\n                    <button type="submit" class="btn btn-primary">Validate</button>\n                </form>\n            </div>\n        </div>\n\n        <div class="filter-section" id="filterSection" style="display: none;">\n            <div class="row mb-3">\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Summary</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>CSV Events:</strong></p>\n                                    <p class="text-primary" id="csvEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Log Events:</strong></p>\n                                    <p class="text-success" id="logEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Details</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Missing Events:</strong></p>\n                                    <p class="text-warning" id="missingEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Extra Events:</strong></p>\n                                    <p class="text-info" id="extraEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <h4>Filters</h4>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="eventName">\n                            Event Name <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="eventNameFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="eventNameSelectAll" checked>\n                                <label for="eventNameSelectAll">Select All</label>\n                            </div>\n                            <div id="eventNameOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'eventName\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'eventName\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="status">\n                            Status <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="statusFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="statusSelectAll" checked>\n                                <label for="statusSelectAll">Select All</label>\n                            </div>\n                            <div id="statusOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'status\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'status\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="expectedType">\n                            Expected Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="expectedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="expectedTypeSelectAll" checked>\n                                <label for="expectedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="expectedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'expectedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'expectedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="receivedType">\n                            Received Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="receivedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="receivedTypeSelectAll" checked>\n                                <label for="receivedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="receivedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'receivedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'receivedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-secondary" id="clearFilters">Clear All Filters</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-success" id="downloadResults">Download Results</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-info" id="downloadValidEvents">Download Valid Events</button>\n                </div>\n            </div>\n        </div>\n\n        <div id="fullyValidEventsSection" class="alert alert-success" style="display:none;">\n            <strong>Events with all payloads valid:</strong>\n            <ul id="fullyValidEventsList" style="margin-bottom:0;"></ul>\n        </div>\n\n        <div class="table-container">\n            <table class="table table-striped" id="resultsTable">\n                <thead>\n                    <tr>\n                        <th class="sort-header" data-sort="eventName">Event Name <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="key">Key <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="value">Value <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="expectedType">Expected Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="receivedType">Received Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="validationStatus">Status <span class="sort-icon">\xe2\x86\x95</span></th>\n                    </tr>\n                </thead>\n                <tbody id="resultsBody"></tbody>\n            </table>\n        </div>\n    </div>\n\n    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/moment/moment.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>\n    <script>\n        let currentResults = [];\n        let currentSummary = {};\n        let currentSort = { field: null, order: \'asc\' };\n        let activeFilters = {\n            eventName: [],\n            status: [],\n            expectedType: [],\n            receivedType: []\n        };\n\n        $(\'#dateRange\').daterangepicker({\n            autoUpdateInput: false,\n            locale: {\n                cancelLabel: \'Clear\'\n            }\n        });\n\n        $(\'#dateRange\').on(\'apply.daterangepicker\', function(ev, picker) {\n            $(this).val(picker.startDate.format(\'MM/DD/YYYY\') + \' - \' + picker.endDate.format(\'MM/DD/YYYY\'));\n            applyFilters();\n        });\n\n        $(\'#dateRange\').on(\'cancel.daterangepicker\', function(ev, picker) {\n            $(this).val(\'\');\n            applyFilters();\n        });\n\n        $(\'#uploadForm\').on(\'submit\', function(e) {\n            e.preventDefault();\n            const formData = new FormData(this);\n            \n            // Determine which endpoint to use based on validation mode\n            const validationMode = $(\'input[name="validationMode"]:checked\').val();\n            let endpoint = \'/upload\';\n            if (validationMode === \'website\') {\n                endpoint = \'/validate-website-logs\';\n            } else if (validationMode === \'website-v2\') {\n                endpoint = \'/validate-website-logs-v2\';\n            }\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + endpoint;\n            \n            console.log(\'Making request to:\', fullUrl);\n            console.log(\'Validation mode:\', validationMode);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: formData,\n                processData: false,\n                contentType: false,\n                success: function(response) {\n                    console.log(\'Upload response:\', response);\n                    \n                    // Handle both old and new response formats\n                    if (response.results && response.summary) {\n                        // New format with summary\n                        currentResults = response.results;\n                        currentSummary = response.summary;\n                        // Store original logs for download feature\n                        window.originalLogs = response.original_logs || {};\n                    } else {\n                        // Old format - just results array\n                        currentResults = response;\n                        currentSummary = {\n                            csv_events_count: 0,\n                            log_events_count: 0,\n                            csv_events: [],\n                            log_events: []\n                        };\n                        window.originalLogs = {};\n                    }\n                    \n                    updateEventSummary();\n                    updateFilters();\n                    displayResults(currentResults);\n                    $(\'#filterSection\').show();\n\n                    if (response.fully_valid_events && response.fully_valid_events.length > 0) {\n                        $(\'#fullyValidEventsList\').empty();\n                        response.fully_valid_events.forEach(function(eventName) {\n                            $(\'#fullyValidEventsList\').append(\'<li>\' + eventName + \'</li>\');\n                        });\n                        $(\'#fullyValidEventsSection\').show();\n                    } else {\n                        $(\'#fullyValidEventsSection\').hide();\n                    }\n                },\n                error: function(xhr) {\n                    console.error(\'Upload error:\', xhr);\n                    alert(\'Error uploading files: \' + xhr.responseText);\n                }\n            });\n        });\n\n        // Initialize filter dropdowns\n        $(document).ready(function() {\n            $(\'.filter-header\').click(function(e) {\n                e.stopPropagation();\n                const filterId = $(this).data(\'filter\');\n                console.log(\'Clicked filter:\', filterId);\n                $(`#${filterId}Filter`).toggleClass(\'show\');\n            });\n\n            // Close filter dropdowns when clicking outside\n            $(document).click(function(e) {\n                if (!$(e.target).closest(\'.filter-dropdown\').length) {\n                    $(\'.filter-content\').removeClass(\'show\');\n                }\n            });\n        });\n\n        function updateEventSummary() {\n            // Update event count displays\n            $(\'#csvEventsCount\').text(currentSummary.csv_events_count || 0);\n            $(\'#logEventsCount\').text(currentSummary.log_events_count || 0);\n            \n            // Calculate missing and extra events\n            const csvEvents = new Set(currentSummary.csv_events || []);\n            const logEvents = new Set(currentSummary.log_events || []);\n            \n            const missingEvents = csvEvents.size - new Set([...csvEvents].filter(x => logEvents.has(x))).size;\n            const extraEvents = logEvents.size - new Set([...logEvents].filter(x => csvEvents.has(x))).size;\n            \n            $(\'#missingEventsCount\').text(missingEvents);\n            $(\'#extraEventsCount\').text(extraEvents);\n        }\n\n        function updateFilters() {\n            const eventNames = new Set();\n            const expectedTypes = new Set();\n            const receivedTypes = new Set();\n            const statuses = new Set();\n            \n            currentResults.forEach(result => {\n                if (result.eventName) eventNames.add(result.eventName);\n                if (result.expectedType) expectedTypes.add(result.expectedType);\n                if (result.receivedType) receivedTypes.add(result.receivedType);\n                if (result.validationStatus) statuses.add(result.validationStatus);\n            });\n\n            console.log(\'Available statuses:\', Array.from(statuses));\n\n            updateFilterOptions(\'eventName\', eventNames);\n            updateFilterOptions(\'status\', statuses);\n            updateFilterOptions(\'expectedType\', expectedTypes);\n            updateFilterOptions(\'receivedType\', receivedTypes);\n        }\n\n        function updateFilterOptions(filterId, values) {\n            const container = $(`#${filterId}Options`);\n            container.empty();\n            \n            console.log(`Updating ${filterId} with values:`, Array.from(values));\n            \n            Array.from(values).sort().forEach(value => {\n                if (value) {\n                    const checkboxId = `${filterId}_${value.replace(/[^a-zA-Z0-9]/g, \'_\')}`;\n                    container.append(`\n                        <div class="filter-checkbox">\n                            <input type="checkbox" id="${checkboxId}" value="${value}" checked>\n                            <label for="${checkboxId}">${value}</label>\n                        </div>\n                    `);\n                }\n            });\n\n            // Update select all checkbox\n            $(`#${filterId}SelectAll`).prop(\'checked\', true);\n        }\n\n        function getSelectedValues(filterId) {\n            return $(`#${filterId}Options input:checked`).map(function() {\n                return $(this).val();\n            }).get();\n        }\n\n        function applyFilter(filterId) {\n            activeFilters[filterId] = getSelectedValues(filterId);\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function clearFilter(filterId) {\n            $(`#${filterId}Options input`).prop(\'checked\', false);\n            $(`#${filterId}SelectAll`).prop(\'checked\', false);\n            activeFilters[filterId] = [];\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function applyFilters() {\n            const filters = {\n                eventName: activeFilters.eventName,\n                validationStatus: activeFilters.status,\n                expectedType: activeFilters.expectedType,\n                receivedType: activeFilters.receivedType\n            };\n\n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/filter\';\n\n            console.log(\'Making filter request to:\', fullUrl);\n\n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({\n                    results: currentResults,\n                    filters: filters,\n                    sort_by: currentSort.field,\n                    sort_order: currentSort.order\n                }),\n                contentType: \'application/json\',\n                success: function(response) {\n                    displayResults(response);\n                    window.filteredResults = response;\n                },\n                error: function(xhr) {\n                    console.error(\'Filter error:\', xhr);\n                    alert(\'Error applying filters: \' + xhr.responseText);\n                }\n            });\n        }\n\n        // Handle select all checkboxes\n        $(\'[id$="SelectAll"]\').change(function() {\n            const filterId = this.id.replace(\'SelectAll\', \'\');\n            $(`#${filterId}Options input`).prop(\'checked\', $(this).prop(\'checked\'));\n        });\n\n        // Update select all checkbox when individual checkboxes change\n        $(\'.filter-content\').on(\'change\', \'input[type="checkbox"]:not([id$="SelectAll"])\', function() {\n            const filterId = $(this).closest(\'.filter-content\').attr(\'id\').replace(\'Filter\', \'\');\n            const allChecked = $(`#${filterId}Options input:checked`).length === $(`#${filterId}Options input`).length;\n            $(`#${filterId}SelectAll`).prop(\'checked\', allChecked);\n        });\n\n        $(\'#clearFilters\').click(function() {\n            $(\'.filter-content input[type="checkbox"]\').prop(\'checked\', false);\n            $(\'[id$="SelectAll"]\').prop(\'checked\', false);\n            Object.keys(activeFilters).forEach(key => {\n                activeFilters[key] = [];\n            });\n            applyFilters();\n        });\n\n        $(\'#downloadResults\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download\';\n            \n            console.log(\'Making download request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ results: resultsToDownload }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'validation_results.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download error:\', xhr);\n                    alert(\'Error downloading results: \' + xhr.responseText);\n                }\n            });\n        });\n\n        $(\'#downloadValidEvents\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download-valid-events\';\n            \n            console.log(\'Making download valid events request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ \n                    results: resultsToDownload,\n                    logs_data: window.originalLogs || {}\n                }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'valid_events_report.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download valid events error:\', xhr);\n                    alert(\'Error downloading valid events: \' + xhr.responseText);\n                }\n            });\n        });\n\n        function displayResults(results) {\n            const tbody = $(\'#resultsBody\');\n            tbody.empty();\n            \n            // Debug log to check results being displayed\n            console.log(\'Displaying results:\', results);\n            \n            results.forEach(result => {\n                const statusClass = getStatusClass(result.validationStatus);\n                tbody.append(`\n                    <tr>\n                        <td>${result.eventName}</td>\n                        <td>${result.key}</td>\n                        <td>${result.value}</td>\n                        <td>${result.expectedType}</td>\n                        <td>${result.receivedType}</td>\n                        <td class="validation-status ${statusClass}">${result.validationStatus}</td>\n                    </tr>\n                `);\n            });\n        }\n\n        function getStatusClass(status) {\n            if (status === \'Valid\') return \'status-valid\';\n            if (status === \'Invalid/Wrong datatype/value\') return \'status-invalid\';\n            if (status === \'Payload value is Empty\') return \'status-empty\';\n            if (status === \'Extra key present in the log\') return \'status-extra\';\n            if (status === \'Extra event present in logs\') return \'status-extra-event\';\n            if (status === \'Field from extra event\') return \'status-extra-field\';\n            if (status === \'Event name not present in the logs\') return \'status-notpresent\';\n            return \'\';\n        }\n\n        $(\'.sort-header\').click(function() {\n            const field = $(this).data(\'sort\');\n            if (currentSort.field === field) {\n                currentSort.order = currentSort.order === \'asc\' ? \'desc\' : \'asc\';\n            } else {\n                currentSort.field = field;\n                currentSort.order = \'asc\';\n            }\n            applyFilters();\n        });\n\n        $(\'#eventNameFilter, #statusFilter, #expectedTypeFilter, #receivedTypeFilter\').change(applyFilters);\n    </script>\n</body>\n</html>'
2025-10-10 12:37:01,828 - INFO - 127.0.0.1 - - [10/Oct/2025 12:37:01] "GET / HTTP/1.1" 200 -
2025-10-10 12:40:28,618 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Cache-Control: max-age=0
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:40:28,619 - INFO - Body: b''
2025-10-10 12:40:28,619 - INFO - URL: http://localhost:10000/
2025-10-10 12:40:28,619 - INFO - Method: GET
2025-10-10 12:40:28,619 - INFO - Endpoint: index
2025-10-10 12:40:28,633 - INFO - Response: b'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Event Validation Tool</title>\n    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">\n    <link href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" rel="stylesheet">\n    <style>\n        :root {\n            --primary-color: #e35502;\n            --header-bg: #230f2e;\n        }\n        \n        .container { margin-top: 30px; }\n        .table-container { margin-top: 20px; }\n        .filter-container { margin: 20px 0; }\n        .hidden { display: none; }\n        .first-event { color: blue; }\n        \n        /* Header styling */\n        .navbar {\n            background-color: var(--header-bg) !important;\n        }\n        \n        .navbar-brand, .navbar-nav .nav-link {\n            color: white !important;\n        }\n        \n        .navbar-toggler {\n            border-color: rgba(255,255,255,0.5);\n        }\n        \n        .navbar-toggler-icon {\n            background-image: url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 30 30\'%3e%3cpath stroke=\'rgba%28255, 255, 255, 0.75%29\' stroke-linecap=\'round\' stroke-miterlimit=\'10\' stroke-width=\'2\' d=\'M4 7h22M4 15h22M4 23h22\'/%3e%3c/svg%3e");\n        }\n        \n        /* Button styling */\n        .btn-primary {\n            background-color: var(--primary-color) !important;\n            border-color: var(--primary-color) !important;\n        }\n        \n        .btn-primary:hover {\n            background-color: #c64802 !important;\n            border-color: #c64802 !important;\n        }\n        \n        .btn-outline-primary {\n            color: white !important;\n            border-color: white !important;\n        }\n        \n        .btn-outline-primary:hover {\n            background-color: rgba(255,255,255,0.1) !important;\n        }\n        .null-value { background-color: yellow; }\n        .valid-status { color: green; }\n        .invalid-status { color: red; }\n        .empty-status { color: orange; }\n        .not-present { color: darkolivegreen; }\n        .extra-key { color: rgb(24, 214, 185); }\n        .type-mismatch { background-color: #ffe6e6; }\n        .download-section {\n            margin: 20px 0;\n            text-align: right;\n        }\n        /* Status color coding */\n        .status-valid { background-color: #d4edda !important; color: #155724 !important; }\n        .status-invalid { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-empty { background-color: #fff3cd !important; color: #856404 !important; }\n        .status-extra { background-color: #d1ecf1 !important; color: #0c5460 !important; }\n        .status-notpresent { background-color: #042508 !important; color: #7f7b97 !important; }\n        .status-csv { background-color: #e2e3e5 !important; color: #383d41 !important; }\n        .status-extra-event { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-extra-field { background-color: #fff3cd !important; color: #856404 !important; }\n        .validation-status {\n            font-weight: bold;\n        }\n        .status-valid {\n            color: #28a745;\n        }\n        .status-invalid {\n            color: #dc3545;\n        }\n        .status-empty {\n            color: #ffc107;\n        }\n        .status-extra {\n            color: #17a2b8;\n        }\n        .status-extra-event {\n            color: #dc3545;\n        }\n        .status-extra-field {\n            color: #ffc107;\n        }\n        .filter-section {\n            background-color: #f8f9fa;\n            padding: 15px;\n            margin-bottom: 20px;\n            border-radius: 5px;\n        }\n        .sort-header {\n            cursor: pointer;\n        }\n        .sort-header:hover {\n            background-color: #e9ecef;\n        }\n        .sort-icon {\n            margin-left: 5px;\n        }\n        .filter-dropdown {\n            position: relative;\n            display: inline-block;\n        }\n        .filter-content {\n            display: none;\n            position: absolute;\n            background-color: #f9f9f9;\n            min-width: 200px;\n            max-height: 300px;\n            overflow-y: auto;\n            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\n            z-index: 1000;\n            padding: 10px;\n        }\n        .filter-content.show {\n            display: block;\n        }\n        .filter-checkbox {\n            margin: 5px 0;\n        }\n        .filter-checkbox label {\n            display: block;\n            padding: 5px;\n            cursor: pointer;\n        }\n        .filter-checkbox label:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-header {\n            display: flex;\n            align-items: center;\n            cursor: pointer;\n            padding: 5px;\n        }\n        .filter-header:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-icon {\n            margin-left: 5px;\n        }\n        .filter-actions {\n            margin-top: 10px;\n            padding-top: 10px;\n            border-top: 1px solid #ddd;\n        }\n    </style>\n</head>\n<body>\n    <nav class="navbar navbar-expand-lg navbar-light bg-light">\n        <div class="container-fluid">\n            <a class="navbar-brand" href="#">Netcore Event Payload Validator</a>\n            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">\n                <span class="navbar-toggler-icon"></span>\n            </button>\n            <div class="collapse navbar-collapse" id="navbarNav">\n                <ul class="navbar-nav ms-auto">\n                    <li class="nav-item">\n                        <a class="btn btn-primary" href="https://contact-api-netcore-beta-0-16.onrender.com/" target="_blank">Trigger Activity API</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </nav>\n\n    <div class="container">\n        <h2>Event Validation Tool</h2>\n        \n        <div class="card mb-4">\n            <div class="card-body">\n                <div class="mb-3">\n                    <label class="form-label">Validation Mode</label>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="regularMode" value="regular" checked>\n                        <label class="form-check-label" for="regularMode">\n                            Regular Event Validation (Single Event/Event Payload format)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteMode" value="website">\n                        <label class="form-check-label" for="websiteMode">\n                            Website Logs Validation (JSON lines format with eventname and payload)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteV2Mode" value="website-v2">\n                        <label class="form-check-label" for="websiteV2Mode">\n                            Website Logs V2 Validation (JSON lines format with event key and system fields excluded)\n                        </label>\n                    </div>\n                </div>\n                \n                <form id="uploadForm" enctype="multipart/form-data">\n                    <div class="mb-3">\n                        <label for="csvFile" class="form-label">CSV File (Validation Rules)</label>\n                        <input type="file" class="form-control" id="csvFile" name="csv_file" accept=".csv" required>\n                        <div class="mt-2">\n                            <a href="/download_template" class="btn btn-outline-secondary btn-sm">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Sample Template\n                            </a>\n                        </div>\n                    </div>\n                    <div class="mb-3">\n                        <label for="txtFile" class="form-label">TXT File (Event Logs)</label>\n                        <input type="file" class="form-control" id="txtFile" name="txt_file" accept=".txt" required>\n                        <div class="mt-2">\n                            <a href="/download_sample_log" class="btn btn-outline-secondary btn-sm">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Sample Log\n                            </a>\n                        </div>\n                    </div>\n                    <button type="submit" class="btn btn-primary">Validate</button>\n                </form>\n            </div>\n        </div>\n\n        <div class="filter-section" id="filterSection" style="display: none;">\n            <div class="row mb-3">\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Summary</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>CSV Events:</strong></p>\n                                    <p class="text-primary" id="csvEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Log Events:</strong></p>\n                                    <p class="text-success" id="logEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Details</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Missing Events:</strong></p>\n                                    <p class="text-warning" id="missingEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Extra Events:</strong></p>\n                                    <p class="text-info" id="extraEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <h4>Filters</h4>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="eventName">\n                            Event Name <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="eventNameFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="eventNameSelectAll" checked>\n                                <label for="eventNameSelectAll">Select All</label>\n                            </div>\n                            <div id="eventNameOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'eventName\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'eventName\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="status">\n                            Status <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="statusFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="statusSelectAll" checked>\n                                <label for="statusSelectAll">Select All</label>\n                            </div>\n                            <div id="statusOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'status\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'status\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="expectedType">\n                            Expected Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="expectedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="expectedTypeSelectAll" checked>\n                                <label for="expectedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="expectedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'expectedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'expectedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="receivedType">\n                            Received Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="receivedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="receivedTypeSelectAll" checked>\n                                <label for="receivedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="receivedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'receivedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'receivedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-secondary" id="clearFilters">Clear All Filters</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-success" id="downloadResults">Download Results</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-info" id="downloadValidEvents">Download Valid Events</button>\n                </div>\n            </div>\n        </div>\n\n        <div id="fullyValidEventsSection" class="alert alert-success" style="display:none;">\n            <strong>Events with all payloads valid:</strong>\n            <ul id="fullyValidEventsList" style="margin-bottom:0;"></ul>\n        </div>\n\n        <div class="table-container">\n            <table class="table table-striped" id="resultsTable">\n                <thead>\n                    <tr>\n                        <th class="sort-header" data-sort="eventName">Event Name <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="key">Key <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="value">Value <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="expectedType">Expected Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="receivedType">Received Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="validationStatus">Status <span class="sort-icon">\xe2\x86\x95</span></th>\n                    </tr>\n                </thead>\n                <tbody id="resultsBody"></tbody>\n            </table>\n        </div>\n    </div>\n\n    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/moment/moment.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>\n    <script>\n        let currentResults = [];\n        let currentSummary = {};\n        let currentSort = { field: null, order: \'asc\' };\n        let activeFilters = {\n            eventName: [],\n            status: [],\n            expectedType: [],\n            receivedType: []\n        };\n\n        $(\'#dateRange\').daterangepicker({\n            autoUpdateInput: false,\n            locale: {\n                cancelLabel: \'Clear\'\n            }\n        });\n\n        $(\'#dateRange\').on(\'apply.daterangepicker\', function(ev, picker) {\n            $(this).val(picker.startDate.format(\'MM/DD/YYYY\') + \' - \' + picker.endDate.format(\'MM/DD/YYYY\'));\n            applyFilters();\n        });\n\n        $(\'#dateRange\').on(\'cancel.daterangepicker\', function(ev, picker) {\n            $(this).val(\'\');\n            applyFilters();\n        });\n\n        $(\'#uploadForm\').on(\'submit\', function(e) {\n            e.preventDefault();\n            const formData = new FormData(this);\n            \n            // Determine which endpoint to use based on validation mode\n            const validationMode = $(\'input[name="validationMode"]:checked\').val();\n            let endpoint = \'/upload\';\n            if (validationMode === \'website\') {\n                endpoint = \'/validate-website-logs\';\n            } else if (validationMode === \'website-v2\') {\n                endpoint = \'/validate-website-logs-v2\';\n            }\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + endpoint;\n            \n            console.log(\'Making request to:\', fullUrl);\n            console.log(\'Validation mode:\', validationMode);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: formData,\n                processData: false,\n                contentType: false,\n                success: function(response) {\n                    console.log(\'Upload response:\', response);\n                    \n                    // Handle both old and new response formats\n                    if (response.results && response.summary) {\n                        // New format with summary\n                        currentResults = response.results;\n                        currentSummary = response.summary;\n                        // Store original logs for download feature\n                        window.originalLogs = response.original_logs || {};\n                    } else {\n                        // Old format - just results array\n                        currentResults = response;\n                        currentSummary = {\n                            csv_events_count: 0,\n                            log_events_count: 0,\n                            csv_events: [],\n                            log_events: []\n                        };\n                        window.originalLogs = {};\n                    }\n                    \n                    updateEventSummary();\n                    updateFilters();\n                    displayResults(currentResults);\n                    $(\'#filterSection\').show();\n\n                    if (response.fully_valid_events && response.fully_valid_events.length > 0) {\n                        $(\'#fullyValidEventsList\').empty();\n                        response.fully_valid_events.forEach(function(eventName) {\n                            $(\'#fullyValidEventsList\').append(\'<li>\' + eventName + \'</li>\');\n                        });\n                        $(\'#fullyValidEventsSection\').show();\n                    } else {\n                        $(\'#fullyValidEventsSection\').hide();\n                    }\n                },\n                error: function(xhr) {\n                    console.error(\'Upload error:\', xhr);\n                    alert(\'Error uploading files: \' + xhr.responseText);\n                }\n            });\n        });\n\n        // Initialize filter dropdowns\n        $(document).ready(function() {\n            $(\'.filter-header\').click(function(e) {\n                e.stopPropagation();\n                const filterId = $(this).data(\'filter\');\n                console.log(\'Clicked filter:\', filterId);\n                $(`#${filterId}Filter`).toggleClass(\'show\');\n            });\n\n            // Close filter dropdowns when clicking outside\n            $(document).click(function(e) {\n                if (!$(e.target).closest(\'.filter-dropdown\').length) {\n                    $(\'.filter-content\').removeClass(\'show\');\n                }\n            });\n        });\n\n        function updateEventSummary() {\n            // Update event count displays\n            $(\'#csvEventsCount\').text(currentSummary.csv_events_count || 0);\n            $(\'#logEventsCount\').text(currentSummary.log_events_count || 0);\n            \n            // Calculate missing and extra events\n            const csvEvents = new Set(currentSummary.csv_events || []);\n            const logEvents = new Set(currentSummary.log_events || []);\n            \n            const missingEvents = csvEvents.size - new Set([...csvEvents].filter(x => logEvents.has(x))).size;\n            const extraEvents = logEvents.size - new Set([...logEvents].filter(x => csvEvents.has(x))).size;\n            \n            $(\'#missingEventsCount\').text(missingEvents);\n            $(\'#extraEventsCount\').text(extraEvents);\n        }\n\n        function updateFilters() {\n            const eventNames = new Set();\n            const expectedTypes = new Set();\n            const receivedTypes = new Set();\n            const statuses = new Set();\n            \n            currentResults.forEach(result => {\n                if (result.eventName) eventNames.add(result.eventName);\n                if (result.expectedType) expectedTypes.add(result.expectedType);\n                if (result.receivedType) receivedTypes.add(result.receivedType);\n                if (result.validationStatus) statuses.add(result.validationStatus);\n            });\n\n            console.log(\'Available statuses:\', Array.from(statuses));\n\n            updateFilterOptions(\'eventName\', eventNames);\n            updateFilterOptions(\'status\', statuses);\n            updateFilterOptions(\'expectedType\', expectedTypes);\n            updateFilterOptions(\'receivedType\', receivedTypes);\n        }\n\n        function updateFilterOptions(filterId, values) {\n            const container = $(`#${filterId}Options`);\n            container.empty();\n            \n            console.log(`Updating ${filterId} with values:`, Array.from(values));\n            \n            Array.from(values).sort().forEach(value => {\n                if (value) {\n                    const checkboxId = `${filterId}_${value.replace(/[^a-zA-Z0-9]/g, \'_\')}`;\n                    container.append(`\n                        <div class="filter-checkbox">\n                            <input type="checkbox" id="${checkboxId}" value="${value}" checked>\n                            <label for="${checkboxId}">${value}</label>\n                        </div>\n                    `);\n                }\n            });\n\n            // Update select all checkbox\n            $(`#${filterId}SelectAll`).prop(\'checked\', true);\n        }\n\n        function getSelectedValues(filterId) {\n            return $(`#${filterId}Options input:checked`).map(function() {\n                return $(this).val();\n            }).get();\n        }\n\n        function applyFilter(filterId) {\n            activeFilters[filterId] = getSelectedValues(filterId);\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function clearFilter(filterId) {\n            $(`#${filterId}Options input`).prop(\'checked\', false);\n            $(`#${filterId}SelectAll`).prop(\'checked\', false);\n            activeFilters[filterId] = [];\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function applyFilters() {\n            const filters = {\n                eventName: activeFilters.eventName,\n                validationStatus: activeFilters.status,\n                expectedType: activeFilters.expectedType,\n                receivedType: activeFilters.receivedType\n            };\n\n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/filter\';\n\n            console.log(\'Making filter request to:\', fullUrl);\n\n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({\n                    results: currentResults,\n                    filters: filters,\n                    sort_by: currentSort.field,\n                    sort_order: currentSort.order\n                }),\n                contentType: \'application/json\',\n                success: function(response) {\n                    displayResults(response);\n                    window.filteredResults = response;\n                },\n                error: function(xhr) {\n                    console.error(\'Filter error:\', xhr);\n                    alert(\'Error applying filters: \' + xhr.responseText);\n                }\n            });\n        }\n\n        // Handle select all checkboxes\n        $(\'[id$="SelectAll"]\').change(function() {\n            const filterId = this.id.replace(\'SelectAll\', \'\');\n            $(`#${filterId}Options input`).prop(\'checked\', $(this).prop(\'checked\'));\n        });\n\n        // Update select all checkbox when individual checkboxes change\n        $(\'.filter-content\').on(\'change\', \'input[type="checkbox"]:not([id$="SelectAll"])\', function() {\n            const filterId = $(this).closest(\'.filter-content\').attr(\'id\').replace(\'Filter\', \'\');\n            const allChecked = $(`#${filterId}Options input:checked`).length === $(`#${filterId}Options input`).length;\n            $(`#${filterId}SelectAll`).prop(\'checked\', allChecked);\n        });\n\n        $(\'#clearFilters\').click(function() {\n            $(\'.filter-content input[type="checkbox"]\').prop(\'checked\', false);\n            $(\'[id$="SelectAll"]\').prop(\'checked\', false);\n            Object.keys(activeFilters).forEach(key => {\n                activeFilters[key] = [];\n            });\n            applyFilters();\n        });\n\n        $(\'#downloadResults\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download\';\n            \n            console.log(\'Making download request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ results: resultsToDownload }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'validation_results.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download error:\', xhr);\n                    alert(\'Error downloading results: \' + xhr.responseText);\n                }\n            });\n        });\n\n        $(\'#downloadValidEvents\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download-valid-events\';\n            \n            console.log(\'Making download valid events request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ \n                    results: resultsToDownload,\n                    logs_data: window.originalLogs || {}\n                }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'valid_events_report.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download valid events error:\', xhr);\n                    alert(\'Error downloading valid events: \' + xhr.responseText);\n                }\n            });\n        });\n\n        function displayResults(results) {\n            const tbody = $(\'#resultsBody\');\n            tbody.empty();\n            \n            // Debug log to check results being displayed\n            console.log(\'Displaying results:\', results);\n            \n            results.forEach(result => {\n                const statusClass = getStatusClass(result.validationStatus);\n                tbody.append(`\n                    <tr>\n                        <td>${result.eventName}</td>\n                        <td>${result.key}</td>\n                        <td>${result.value}</td>\n                        <td>${result.expectedType}</td>\n                        <td>${result.receivedType}</td>\n                        <td class="validation-status ${statusClass}">${result.validationStatus}</td>\n                    </tr>\n                `);\n            });\n        }\n\n        function getStatusClass(status) {\n            if (status === \'Valid\') return \'status-valid\';\n            if (status === \'Invalid/Wrong datatype/value\') return \'status-invalid\';\n            if (status === \'Payload value is Empty\') return \'status-empty\';\n            if (status === \'Extra key present in the log\') return \'status-extra\';\n            if (status === \'Extra event present in logs\') return \'status-extra-event\';\n            if (status === \'Field from extra event\') return \'status-extra-field\';\n            if (status === \'Event name not present in the logs\') return \'status-notpresent\';\n            return \'\';\n        }\n\n        $(\'.sort-header\').click(function() {\n            const field = $(this).data(\'sort\');\n            if (currentSort.field === field) {\n                currentSort.order = currentSort.order === \'asc\' ? \'desc\' : \'asc\';\n            } else {\n                currentSort.field = field;\n                currentSort.order = \'asc\';\n            }\n            applyFilters();\n        });\n\n        $(\'#eventNameFilter, #statusFilter, #expectedTypeFilter, #receivedTypeFilter\').change(applyFilters);\n    </script>\n</body>\n</html>'
2025-10-10 12:40:28,633 - INFO - 127.0.0.1 - - [10/Oct/2025 12:40:28] "GET / HTTP/1.1" 200 -
2025-10-10 12:41:36,411 - INFO -  * Detected change in '/Users/allen.thomson/Desktop/sampleapp/automation/validation_script_android/beta2.py', reloading
2025-10-10 12:41:36,748 - WARNING -  * Debugger is active!
2025-10-10 12:41:36,760 - INFO -  * Debugger PIN: 132-353-793
2025-10-10 12:41:38,166 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Cache-Control: max-age=0
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:41:38,166 - INFO - Body: b''
2025-10-10 12:41:38,167 - INFO - URL: http://localhost:10000/
2025-10-10 12:41:38,167 - INFO - Method: GET
2025-10-10 12:41:38,167 - INFO - Endpoint: index
2025-10-10 12:41:38,177 - INFO - Response: b'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Event Validation Tool</title>\n    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">\n    <link href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" rel="stylesheet">\n    <style>\n        :root {\n            --primary-color: #e35502;\n            --header-bg: #230f2e;\n        }\n        \n        .container { margin-top: 30px; }\n        .table-container { margin-top: 20px; }\n        .filter-container { margin: 20px 0; }\n        .hidden { display: none; }\n        .first-event { color: blue; }\n        \n        /* Header styling */\n        .navbar {\n            background-color: var(--header-bg) !important;\n        }\n        \n        .navbar-brand, .navbar-nav .nav-link {\n            color: white !important;\n        }\n        \n        .navbar-toggler {\n            border-color: rgba(255,255,255,0.5);\n        }\n        \n        .navbar-toggler-icon {\n            background-image: url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 30 30\'%3e%3cpath stroke=\'rgba%28255, 255, 255, 0.75%29\' stroke-linecap=\'round\' stroke-miterlimit=\'10\' stroke-width=\'2\' d=\'M4 7h22M4 15h22M4 23h22\'/%3e%3c/svg%3e");\n        }\n        \n        /* Button styling */\n        .btn-primary {\n            background-color: var(--primary-color) !important;\n            border-color: var(--primary-color) !important;\n        }\n        \n        .btn-primary:hover {\n            background-color: #c64802 !important;\n            border-color: #c64802 !important;\n        }\n        \n        .btn-outline-primary {\n            color: white !important;\n            border-color: white !important;\n        }\n        \n        .btn-outline-primary:hover {\n            background-color: rgba(255,255,255,0.1) !important;\n        }\n        .null-value { background-color: yellow; }\n        .valid-status { color: green; }\n        .invalid-status { color: red; }\n        .empty-status { color: orange; }\n        .not-present { color: darkolivegreen; }\n        .extra-key { color: rgb(24, 214, 185); }\n        .type-mismatch { background-color: #ffe6e6; }\n        .download-section {\n            margin: 20px 0;\n            text-align: right;\n        }\n        /* Status color coding */\n        .status-valid { background-color: #d4edda !important; color: #155724 !important; }\n        .status-invalid { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-empty { background-color: #fff3cd !important; color: #856404 !important; }\n        .status-extra { background-color: #d1ecf1 !important; color: #0c5460 !important; }\n        .status-notpresent { background-color: #042508 !important; color: #7f7b97 !important; }\n        .status-csv { background-color: #e2e3e5 !important; color: #383d41 !important; }\n        .status-extra-event { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-extra-field { background-color: #fff3cd !important; color: #856404 !important; }\n        .validation-status {\n            font-weight: bold;\n        }\n        .status-valid {\n            color: #28a745;\n        }\n        .status-invalid {\n            color: #dc3545;\n        }\n        .status-empty {\n            color: #ffc107;\n        }\n        .status-extra {\n            color: #17a2b8;\n        }\n        .status-extra-event {\n            color: #dc3545;\n        }\n        .status-extra-field {\n            color: #ffc107;\n        }\n        .filter-section {\n            background-color: #f8f9fa;\n            padding: 15px;\n            margin-bottom: 20px;\n            border-radius: 5px;\n        }\n        .sort-header {\n            cursor: pointer;\n        }\n        .sort-header:hover {\n            background-color: #e9ecef;\n        }\n        .sort-icon {\n            margin-left: 5px;\n        }\n        .filter-dropdown {\n            position: relative;\n            display: inline-block;\n        }\n        .filter-content {\n            display: none;\n            position: absolute;\n            background-color: #f9f9f9;\n            min-width: 200px;\n            max-height: 300px;\n            overflow-y: auto;\n            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\n            z-index: 1000;\n            padding: 10px;\n        }\n        .filter-content.show {\n            display: block;\n        }\n        .filter-checkbox {\n            margin: 5px 0;\n        }\n        .filter-checkbox label {\n            display: block;\n            padding: 5px;\n            cursor: pointer;\n        }\n        .filter-checkbox label:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-header {\n            display: flex;\n            align-items: center;\n            cursor: pointer;\n            padding: 5px;\n        }\n        .filter-header:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-icon {\n            margin-left: 5px;\n        }\n        .filter-actions {\n            margin-top: 10px;\n            padding-top: 10px;\n            border-top: 1px solid #ddd;\n        }\n    </style>\n</head>\n<body>\n    <nav class="navbar navbar-expand-lg navbar-light bg-light">\n        <div class="container-fluid">\n            <a class="navbar-brand" href="#">Netcore Event Payload Validator</a>\n            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">\n                <span class="navbar-toggler-icon"></span>\n            </button>\n            <div class="collapse navbar-collapse" id="navbarNav">\n                <ul class="navbar-nav ms-auto">\n                    <li class="nav-item">\n                        <a class="btn btn-primary" href="https://contact-api-netcore-beta-0-16.onrender.com/" target="_blank">Trigger Activity API</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </nav>\n\n    <div class="container">\n        <h2>Event Validation Tool</h2>\n        \n        <div class="card mb-4">\n            <div class="card-body">\n                <div class="mb-3">\n                    <label class="form-label">Validation Mode</label>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="regularMode" value="regular" checked>\n                        <label class="form-check-label" for="regularMode">\n                            Regular Event Validation (Single Event/Event Payload format)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteMode" value="website">\n                        <label class="form-check-label" for="websiteMode">\n                            Website Logs Validation (JSON lines format with eventname and payload)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteV2Mode" value="website-v2">\n                        <label class="form-check-label" for="websiteV2Mode">\n                            Website Logs V2 Validation (JSON lines format with event key and system fields excluded)\n                        </label>\n                    </div>\n                </div>\n                \n                <form id="uploadForm" enctype="multipart/form-data">\n                    <div class="mb-3">\n                        <label for="csvFile" class="form-label">CSV File (Validation Rules)</label>\n                        <input type="file" class="form-control" id="csvFile" name="csv_file" accept=".csv" required>\n                        <div class="mt-2">\n                            <a href="/download_template" class="btn btn-outline-secondary btn-sm">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Sample Template\n                            </a>\n                        </div>\n                    </div>\n                    <div class="mb-3">\n                        <label for="txtFile" class="form-label">TXT File (Event Logs)</label>\n                        <input type="file" class="form-control" id="txtFile" name="txt_file" accept=".txt" required>\n                        <div class="mt-2">\n                            <a href="/download_sample_log" class="btn btn-outline-secondary btn-sm">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Sample Log\n                            </a>\n                        </div>\n                    </div>\n                    <button type="submit" class="btn btn-primary">Validate</button>\n                </form>\n            </div>\n        </div>\n\n        <div class="filter-section" id="filterSection" style="display: none;">\n            <div class="row mb-3">\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Summary</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>CSV Events:</strong></p>\n                                    <p class="text-primary" id="csvEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Log Events:</strong></p>\n                                    <p class="text-success" id="logEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Details</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Missing Events:</strong></p>\n                                    <p class="text-warning" id="missingEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Extra Events:</strong></p>\n                                    <p class="text-info" id="extraEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <h4>Filters</h4>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="eventName">\n                            Event Name <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="eventNameFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="eventNameSelectAll" checked>\n                                <label for="eventNameSelectAll">Select All</label>\n                            </div>\n                            <div id="eventNameOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'eventName\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'eventName\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="status">\n                            Status <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="statusFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="statusSelectAll" checked>\n                                <label for="statusSelectAll">Select All</label>\n                            </div>\n                            <div id="statusOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'status\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'status\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="expectedType">\n                            Expected Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="expectedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="expectedTypeSelectAll" checked>\n                                <label for="expectedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="expectedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'expectedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'expectedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="receivedType">\n                            Received Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="receivedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="receivedTypeSelectAll" checked>\n                                <label for="receivedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="receivedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'receivedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'receivedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-secondary" id="clearFilters">Clear All Filters</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-success" id="downloadResults">Download Results</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-info" id="downloadValidEvents">Download Valid Events</button>\n                </div>\n            </div>\n        </div>\n\n        <div id="fullyValidEventsSection" class="alert alert-success" style="display:none;">\n            <strong>Events with all payloads valid:</strong>\n            <ul id="fullyValidEventsList" style="margin-bottom:0;"></ul>\n        </div>\n\n        <div class="table-container">\n            <table class="table table-striped" id="resultsTable">\n                <thead>\n                    <tr>\n                        <th class="sort-header" data-sort="eventName">Event Name <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="key">Key <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="value">Value <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="expectedType">Expected Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="receivedType">Received Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="validationStatus">Status <span class="sort-icon">\xe2\x86\x95</span></th>\n                    </tr>\n                </thead>\n                <tbody id="resultsBody"></tbody>\n            </table>\n        </div>\n    </div>\n\n    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/moment/moment.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>\n    <script>\n        let currentResults = [];\n        let currentSummary = {};\n        let currentSort = { field: null, order: \'asc\' };\n        let activeFilters = {\n            eventName: [],\n            status: [],\n            expectedType: [],\n            receivedType: []\n        };\n\n        $(\'#dateRange\').daterangepicker({\n            autoUpdateInput: false,\n            locale: {\n                cancelLabel: \'Clear\'\n            }\n        });\n\n        $(\'#dateRange\').on(\'apply.daterangepicker\', function(ev, picker) {\n            $(this).val(picker.startDate.format(\'MM/DD/YYYY\') + \' - \' + picker.endDate.format(\'MM/DD/YYYY\'));\n            applyFilters();\n        });\n\n        $(\'#dateRange\').on(\'cancel.daterangepicker\', function(ev, picker) {\n            $(this).val(\'\');\n            applyFilters();\n        });\n\n        $(\'#uploadForm\').on(\'submit\', function(e) {\n            e.preventDefault();\n            const formData = new FormData(this);\n            \n            // Determine which endpoint to use based on validation mode\n            const validationMode = $(\'input[name="validationMode"]:checked\').val();\n            let endpoint = \'/upload\';\n            if (validationMode === \'website\') {\n                endpoint = \'/validate-website-logs\';\n            } else if (validationMode === \'website-v2\') {\n                endpoint = \'/validate-website-logs-v2\';\n            }\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + endpoint;\n            \n            console.log(\'Making request to:\', fullUrl);\n            console.log(\'Validation mode:\', validationMode);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: formData,\n                processData: false,\n                contentType: false,\n                success: function(response) {\n                    console.log(\'Upload response:\', response);\n                    \n                    // Handle both old and new response formats\n                    if (response.results && response.summary) {\n                        // New format with summary\n                        currentResults = response.results;\n                        currentSummary = response.summary;\n                        // Store original logs for download feature\n                        window.originalLogs = response.original_logs || {};\n                    } else {\n                        // Old format - just results array\n                        currentResults = response;\n                        currentSummary = {\n                            csv_events_count: 0,\n                            log_events_count: 0,\n                            csv_events: [],\n                            log_events: []\n                        };\n                        window.originalLogs = {};\n                    }\n                    \n                    updateEventSummary();\n                    updateFilters();\n                    displayResults(currentResults);\n                    $(\'#filterSection\').show();\n\n                    if (response.fully_valid_events && response.fully_valid_events.length > 0) {\n                        $(\'#fullyValidEventsList\').empty();\n                        response.fully_valid_events.forEach(function(eventName) {\n                            $(\'#fullyValidEventsList\').append(\'<li>\' + eventName + \'</li>\');\n                        });\n                        $(\'#fullyValidEventsSection\').show();\n                    } else {\n                        $(\'#fullyValidEventsSection\').hide();\n                    }\n                },\n                error: function(xhr) {\n                    console.error(\'Upload error:\', xhr);\n                    alert(\'Error uploading files: \' + xhr.responseText);\n                }\n            });\n        });\n\n        // Initialize filter dropdowns\n        $(document).ready(function() {\n            $(\'.filter-header\').click(function(e) {\n                e.stopPropagation();\n                const filterId = $(this).data(\'filter\');\n                console.log(\'Clicked filter:\', filterId);\n                $(`#${filterId}Filter`).toggleClass(\'show\');\n            });\n\n            // Close filter dropdowns when clicking outside\n            $(document).click(function(e) {\n                if (!$(e.target).closest(\'.filter-dropdown\').length) {\n                    $(\'.filter-content\').removeClass(\'show\');\n                }\n            });\n        });\n\n        function updateEventSummary() {\n            // Update event count displays\n            $(\'#csvEventsCount\').text(currentSummary.csv_events_count || 0);\n            $(\'#logEventsCount\').text(currentSummary.log_events_count || 0);\n            \n            // Calculate missing and extra events\n            const csvEvents = new Set(currentSummary.csv_events || []);\n            const logEvents = new Set(currentSummary.log_events || []);\n            \n            const missingEvents = csvEvents.size - new Set([...csvEvents].filter(x => logEvents.has(x))).size;\n            const extraEvents = logEvents.size - new Set([...logEvents].filter(x => csvEvents.has(x))).size;\n            \n            $(\'#missingEventsCount\').text(missingEvents);\n            $(\'#extraEventsCount\').text(extraEvents);\n        }\n\n        function updateFilters() {\n            const eventNames = new Set();\n            const expectedTypes = new Set();\n            const receivedTypes = new Set();\n            const statuses = new Set();\n            \n            currentResults.forEach(result => {\n                if (result.eventName) eventNames.add(result.eventName);\n                if (result.expectedType) expectedTypes.add(result.expectedType);\n                if (result.receivedType) receivedTypes.add(result.receivedType);\n                if (result.validationStatus) statuses.add(result.validationStatus);\n            });\n\n            console.log(\'Available statuses:\', Array.from(statuses));\n\n            updateFilterOptions(\'eventName\', eventNames);\n            updateFilterOptions(\'status\', statuses);\n            updateFilterOptions(\'expectedType\', expectedTypes);\n            updateFilterOptions(\'receivedType\', receivedTypes);\n        }\n\n        function updateFilterOptions(filterId, values) {\n            const container = $(`#${filterId}Options`);\n            container.empty();\n            \n            console.log(`Updating ${filterId} with values:`, Array.from(values));\n            \n            Array.from(values).sort().forEach(value => {\n                if (value) {\n                    const checkboxId = `${filterId}_${value.replace(/[^a-zA-Z0-9]/g, \'_\')}`;\n                    container.append(`\n                        <div class="filter-checkbox">\n                            <input type="checkbox" id="${checkboxId}" value="${value}" checked>\n                            <label for="${checkboxId}">${value}</label>\n                        </div>\n                    `);\n                }\n            });\n\n            // Update select all checkbox\n            $(`#${filterId}SelectAll`).prop(\'checked\', true);\n        }\n\n        function getSelectedValues(filterId) {\n            return $(`#${filterId}Options input:checked`).map(function() {\n                return $(this).val();\n            }).get();\n        }\n\n        function applyFilter(filterId) {\n            activeFilters[filterId] = getSelectedValues(filterId);\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function clearFilter(filterId) {\n            $(`#${filterId}Options input`).prop(\'checked\', false);\n            $(`#${filterId}SelectAll`).prop(\'checked\', false);\n            activeFilters[filterId] = [];\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function applyFilters() {\n            const filters = {\n                eventName: activeFilters.eventName,\n                validationStatus: activeFilters.status,\n                expectedType: activeFilters.expectedType,\n                receivedType: activeFilters.receivedType\n            };\n\n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/filter\';\n\n            console.log(\'Making filter request to:\', fullUrl);\n\n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({\n                    results: currentResults,\n                    filters: filters,\n                    sort_by: currentSort.field,\n                    sort_order: currentSort.order\n                }),\n                contentType: \'application/json\',\n                success: function(response) {\n                    displayResults(response);\n                    window.filteredResults = response;\n                },\n                error: function(xhr) {\n                    console.error(\'Filter error:\', xhr);\n                    alert(\'Error applying filters: \' + xhr.responseText);\n                }\n            });\n        }\n\n        // Handle select all checkboxes\n        $(\'[id$="SelectAll"]\').change(function() {\n            const filterId = this.id.replace(\'SelectAll\', \'\');\n            $(`#${filterId}Options input`).prop(\'checked\', $(this).prop(\'checked\'));\n        });\n\n        // Update select all checkbox when individual checkboxes change\n        $(\'.filter-content\').on(\'change\', \'input[type="checkbox"]:not([id$="SelectAll"])\', function() {\n            const filterId = $(this).closest(\'.filter-content\').attr(\'id\').replace(\'Filter\', \'\');\n            const allChecked = $(`#${filterId}Options input:checked`).length === $(`#${filterId}Options input`).length;\n            $(`#${filterId}SelectAll`).prop(\'checked\', allChecked);\n        });\n\n        $(\'#clearFilters\').click(function() {\n            $(\'.filter-content input[type="checkbox"]\').prop(\'checked\', false);\n            $(\'[id$="SelectAll"]\').prop(\'checked\', false);\n            Object.keys(activeFilters).forEach(key => {\n                activeFilters[key] = [];\n            });\n            applyFilters();\n        });\n\n        $(\'#downloadResults\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download\';\n            \n            console.log(\'Making download request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ results: resultsToDownload }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'validation_results.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download error:\', xhr);\n                    alert(\'Error downloading results: \' + xhr.responseText);\n                }\n            });\n        });\n\n        $(\'#downloadValidEvents\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download-valid-events\';\n            \n            console.log(\'Making download valid events request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ \n                    results: resultsToDownload,\n                    logs_data: window.originalLogs || {}\n                }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'valid_events_report.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download valid events error:\', xhr);\n                    alert(\'Error downloading valid events: \' + xhr.responseText);\n                }\n            });\n        });\n\n        function displayResults(results) {\n            const tbody = $(\'#resultsBody\');\n            tbody.empty();\n            \n            // Debug log to check results being displayed\n            console.log(\'Displaying results:\', results);\n            \n            results.forEach(result => {\n                const statusClass = getStatusClass(result.validationStatus);\n                tbody.append(`\n                    <tr>\n                        <td>${result.eventName}</td>\n                        <td>${result.key}</td>\n                        <td>${result.value}</td>\n                        <td>${result.expectedType}</td>\n                        <td>${result.receivedType}</td>\n                        <td class="validation-status ${statusClass}">${result.validationStatus}</td>\n                    </tr>\n                `);\n            });\n        }\n\n        function getStatusClass(status) {\n            if (status === \'Valid\') return \'status-valid\';\n            if (status === \'Invalid/Wrong datatype/value\') return \'status-invalid\';\n            if (status === \'Payload value is Empty\') return \'status-empty\';\n            if (status === \'Extra key present in the log\') return \'status-extra\';\n            if (status === \'Extra event present in logs\') return \'status-extra-event\';\n            if (status === \'Field from extra event\') return \'status-extra-field\';\n            if (status === \'Event name not present in the logs\') return \'status-notpresent\';\n            return \'\';\n        }\n\n        $(\'.sort-header\').click(function() {\n            const field = $(this).data(\'sort\');\n            if (currentSort.field === field) {\n                currentSort.order = currentSort.order === \'asc\' ? \'desc\' : \'asc\';\n            } else {\n                currentSort.field = field;\n                currentSort.order = \'asc\';\n            }\n            applyFilters();\n        });\n\n        $(\'#eventNameFilter, #statusFilter, #expectedTypeFilter, #receivedTypeFilter\').change(applyFilters);\n    </script>\n</body>\n</html>'
2025-10-10 12:41:38,178 - INFO - 127.0.0.1 - - [10/Oct/2025 12:41:38] "GET / HTTP/1.1" 200 -
2025-10-10 12:41:38,904 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:41:38,905 - INFO - Body: b''
2025-10-10 12:41:38,905 - INFO - URL: http://localhost:10000/download_template
2025-10-10 12:41:38,905 - INFO - Method: GET
2025-10-10 12:41:38,905 - INFO - Endpoint: download_template
2025-10-10 12:41:38,916 - INFO - 127.0.0.1 - - [10/Oct/2025 12:41:38] "[35m[1mGET /download_template HTTP/1.1[0m" 500 -
2025-10-10 12:41:38,935 - INFO - 127.0.0.1 - - [10/Oct/2025 12:41:38] "GET /download_template?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1" 200 -
2025-10-10 12:41:38,935 - INFO - 127.0.0.1 - - [10/Oct/2025 12:41:38] "GET /download_template?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1" 200 -
2025-10-10 12:41:39,006 - INFO - 127.0.0.1 - - [10/Oct/2025 12:41:39] "GET /download_template?__debugger__=yes&cmd=resource&f=console.png&s=3oL1XRpvYKe76h5Nhhxz HTTP/1.1" 200 -
2025-10-10 12:41:39,020 - INFO - 127.0.0.1 - - [10/Oct/2025 12:41:39] "GET /download_template?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1" 200 -
2025-10-10 12:41:45,966 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:41:45,966 - INFO - Body: b''
2025-10-10 12:41:45,967 - INFO - URL: http://localhost:10000/download_template
2025-10-10 12:41:45,967 - INFO - Method: GET
2025-10-10 12:41:45,967 - INFO - Endpoint: download_template
2025-10-10 12:41:45,976 - INFO - 127.0.0.1 - - [10/Oct/2025 12:41:45] "[35m[1mGET /download_template HTTP/1.1[0m" 500 -
2025-10-10 12:41:46,005 - INFO - 127.0.0.1 - - [10/Oct/2025 12:41:46] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 304 -
2025-10-10 12:41:46,007 - INFO - 127.0.0.1 - - [10/Oct/2025 12:41:46] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 304 -
2025-10-10 12:41:46,017 - INFO - 127.0.0.1 - - [10/Oct/2025 12:41:46] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=console.png&s=3oL1XRpvYKe76h5Nhhxz HTTP/1.1[0m" 304 -
2025-10-10 12:41:53,936 - INFO -  * Detected change in '/Users/allen.thomson/Desktop/sampleapp/automation/validation_script_android/beta2.py', reloading
2025-10-10 12:41:54,214 - WARNING -  * Debugger is active!
2025-10-10 12:41:54,221 - INFO -  * Debugger PIN: 132-353-793
2025-10-10 12:42:21,036 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:10000
 * Running on http://172.16.20.191:10000
2025-10-10 12:42:21,036 - INFO - [33mPress CTRL+C to quit[0m
2025-10-10 12:42:21,037 - INFO -  * Restarting with stat
2025-10-10 12:42:21,174 - WARNING -  * Debugger is active!
2025-10-10 12:42:21,180 - INFO -  * Debugger PIN: 132-353-793
2025-10-10 12:42:22,674 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Cache-Control: max-age=0
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:42:22,675 - INFO - Body: b''
2025-10-10 12:42:22,675 - INFO - URL: http://localhost:10000/
2025-10-10 12:42:22,675 - INFO - Method: GET
2025-10-10 12:42:22,676 - INFO - Endpoint: index
2025-10-10 12:42:22,683 - INFO - Response: b'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Event Validation Tool</title>\n    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">\n    <link href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" rel="stylesheet">\n    <style>\n        :root {\n            --primary-color: #e35502;\n            --header-bg: #230f2e;\n        }\n        \n        .container { margin-top: 30px; }\n        .table-container { margin-top: 20px; }\n        .filter-container { margin: 20px 0; }\n        .hidden { display: none; }\n        .first-event { color: blue; }\n        \n        /* Header styling */\n        .navbar {\n            background-color: var(--header-bg) !important;\n        }\n        \n        .navbar-brand, .navbar-nav .nav-link {\n            color: white !important;\n        }\n        \n        .navbar-toggler {\n            border-color: rgba(255,255,255,0.5);\n        }\n        \n        .navbar-toggler-icon {\n            background-image: url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 30 30\'%3e%3cpath stroke=\'rgba%28255, 255, 255, 0.75%29\' stroke-linecap=\'round\' stroke-miterlimit=\'10\' stroke-width=\'2\' d=\'M4 7h22M4 15h22M4 23h22\'/%3e%3c/svg%3e");\n        }\n        \n        /* Button styling */\n        .btn-primary {\n            background-color: var(--primary-color) !important;\n            border-color: var(--primary-color) !important;\n        }\n        \n        .btn-primary:hover {\n            background-color: #c64802 !important;\n            border-color: #c64802 !important;\n        }\n        \n        .btn-outline-primary {\n            color: white !important;\n            border-color: white !important;\n        }\n        \n        .btn-outline-primary:hover {\n            background-color: rgba(255,255,255,0.1) !important;\n        }\n        .null-value { background-color: yellow; }\n        .valid-status { color: green; }\n        .invalid-status { color: red; }\n        .empty-status { color: orange; }\n        .not-present { color: darkolivegreen; }\n        .extra-key { color: rgb(24, 214, 185); }\n        .type-mismatch { background-color: #ffe6e6; }\n        .download-section {\n            margin: 20px 0;\n            text-align: right;\n        }\n        /* Status color coding */\n        .status-valid { background-color: #d4edda !important; color: #155724 !important; }\n        .status-invalid { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-empty { background-color: #fff3cd !important; color: #856404 !important; }\n        .status-extra { background-color: #d1ecf1 !important; color: #0c5460 !important; }\n        .status-notpresent { background-color: #042508 !important; color: #7f7b97 !important; }\n        .status-csv { background-color: #e2e3e5 !important; color: #383d41 !important; }\n        .status-extra-event { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-extra-field { background-color: #fff3cd !important; color: #856404 !important; }\n        .validation-status {\n            font-weight: bold;\n        }\n        .status-valid {\n            color: #28a745;\n        }\n        .status-invalid {\n            color: #dc3545;\n        }\n        .status-empty {\n            color: #ffc107;\n        }\n        .status-extra {\n            color: #17a2b8;\n        }\n        .status-extra-event {\n            color: #dc3545;\n        }\n        .status-extra-field {\n            color: #ffc107;\n        }\n        .filter-section {\n            background-color: #f8f9fa;\n            padding: 15px;\n            margin-bottom: 20px;\n            border-radius: 5px;\n        }\n        .sort-header {\n            cursor: pointer;\n        }\n        .sort-header:hover {\n            background-color: #e9ecef;\n        }\n        .sort-icon {\n            margin-left: 5px;\n        }\n        .filter-dropdown {\n            position: relative;\n            display: inline-block;\n        }\n        .filter-content {\n            display: none;\n            position: absolute;\n            background-color: #f9f9f9;\n            min-width: 200px;\n            max-height: 300px;\n            overflow-y: auto;\n            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\n            z-index: 1000;\n            padding: 10px;\n        }\n        .filter-content.show {\n            display: block;\n        }\n        .filter-checkbox {\n            margin: 5px 0;\n        }\n        .filter-checkbox label {\n            display: block;\n            padding: 5px;\n            cursor: pointer;\n        }\n        .filter-checkbox label:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-header {\n            display: flex;\n            align-items: center;\n            cursor: pointer;\n            padding: 5px;\n        }\n        .filter-header:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-icon {\n            margin-left: 5px;\n        }\n        .filter-actions {\n            margin-top: 10px;\n            padding-top: 10px;\n            border-top: 1px solid #ddd;\n        }\n    </style>\n</head>\n<body>\n    <nav class="navbar navbar-expand-lg navbar-light bg-light">\n        <div class="container-fluid">\n            <a class="navbar-brand" href="#">Netcore Event Payload Validator</a>\n            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">\n                <span class="navbar-toggler-icon"></span>\n            </button>\n            <div class="collapse navbar-collapse" id="navbarNav">\n                <ul class="navbar-nav ms-auto">\n                    <li class="nav-item">\n                        <a class="btn btn-primary" href="https://contact-api-netcore-beta-0-16.onrender.com/" target="_blank">Trigger Activity API</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </nav>\n\n    <div class="container">\n        <h2>Event Validation Tool</h2>\n        \n        <div class="card mb-4">\n            <div class="card-body">\n                <div class="mb-3">\n                    <label class="form-label">Validation Mode</label>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="regularMode" value="regular" checked>\n                        <label class="form-check-label" for="regularMode">\n                            Regular Event Validation (Single Event/Event Payload format)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteMode" value="website">\n                        <label class="form-check-label" for="websiteMode">\n                            Website Logs Validation (JSON lines format with eventname and payload)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteV2Mode" value="website-v2">\n                        <label class="form-check-label" for="websiteV2Mode">\n                            Website Logs V2 Validation (JSON lines format with event key and system fields excluded)\n                        </label>\n                    </div>\n                </div>\n                \n                <form id="uploadForm" enctype="multipart/form-data">\n                    <div class="mb-3">\n                        <label for="csvFile" class="form-label">CSV File (Validation Rules)</label>\n                        <input type="file" class="form-control" id="csvFile" name="csv_file" accept=".csv" required>\n                        <div class="mt-2">\n                            <a href="/download_template" class="btn btn-outline-secondary btn-sm">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Sample Template\n                            </a>\n                        </div>\n                    </div>\n                    <div class="mb-3">\n                        <label for="txtFile" class="form-label">TXT File (Event Logs)</label>\n                        <input type="file" class="form-control" id="txtFile" name="txt_file" accept=".txt" required>\n                        <div class="mt-2">\n                            <a href="/download_sample_log" class="btn btn-outline-secondary btn-sm">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Sample Log\n                            </a>\n                        </div>\n                    </div>\n                    <button type="submit" class="btn btn-primary">Validate</button>\n                </form>\n            </div>\n        </div>\n\n        <div class="filter-section" id="filterSection" style="display: none;">\n            <div class="row mb-3">\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Summary</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>CSV Events:</strong></p>\n                                    <p class="text-primary" id="csvEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Log Events:</strong></p>\n                                    <p class="text-success" id="logEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Details</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Missing Events:</strong></p>\n                                    <p class="text-warning" id="missingEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Extra Events:</strong></p>\n                                    <p class="text-info" id="extraEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <h4>Filters</h4>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="eventName">\n                            Event Name <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="eventNameFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="eventNameSelectAll" checked>\n                                <label for="eventNameSelectAll">Select All</label>\n                            </div>\n                            <div id="eventNameOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'eventName\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'eventName\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="status">\n                            Status <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="statusFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="statusSelectAll" checked>\n                                <label for="statusSelectAll">Select All</label>\n                            </div>\n                            <div id="statusOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'status\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'status\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="expectedType">\n                            Expected Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="expectedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="expectedTypeSelectAll" checked>\n                                <label for="expectedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="expectedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'expectedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'expectedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="receivedType">\n                            Received Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="receivedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="receivedTypeSelectAll" checked>\n                                <label for="receivedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="receivedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'receivedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'receivedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-secondary" id="clearFilters">Clear All Filters</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-success" id="downloadResults">Download Results</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-info" id="downloadValidEvents">Download Valid Events</button>\n                </div>\n            </div>\n        </div>\n\n        <div id="fullyValidEventsSection" class="alert alert-success" style="display:none;">\n            <strong>Events with all payloads valid:</strong>\n            <ul id="fullyValidEventsList" style="margin-bottom:0;"></ul>\n        </div>\n\n        <div class="table-container">\n            <table class="table table-striped" id="resultsTable">\n                <thead>\n                    <tr>\n                        <th class="sort-header" data-sort="eventName">Event Name <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="key">Key <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="value">Value <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="expectedType">Expected Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="receivedType">Received Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="validationStatus">Status <span class="sort-icon">\xe2\x86\x95</span></th>\n                    </tr>\n                </thead>\n                <tbody id="resultsBody"></tbody>\n            </table>\n        </div>\n    </div>\n\n    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/moment/moment.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>\n    <script>\n        let currentResults = [];\n        let currentSummary = {};\n        let currentSort = { field: null, order: \'asc\' };\n        let activeFilters = {\n            eventName: [],\n            status: [],\n            expectedType: [],\n            receivedType: []\n        };\n\n        $(\'#dateRange\').daterangepicker({\n            autoUpdateInput: false,\n            locale: {\n                cancelLabel: \'Clear\'\n            }\n        });\n\n        $(\'#dateRange\').on(\'apply.daterangepicker\', function(ev, picker) {\n            $(this).val(picker.startDate.format(\'MM/DD/YYYY\') + \' - \' + picker.endDate.format(\'MM/DD/YYYY\'));\n            applyFilters();\n        });\n\n        $(\'#dateRange\').on(\'cancel.daterangepicker\', function(ev, picker) {\n            $(this).val(\'\');\n            applyFilters();\n        });\n\n        $(\'#uploadForm\').on(\'submit\', function(e) {\n            e.preventDefault();\n            const formData = new FormData(this);\n            \n            // Determine which endpoint to use based on validation mode\n            const validationMode = $(\'input[name="validationMode"]:checked\').val();\n            let endpoint = \'/upload\';\n            if (validationMode === \'website\') {\n                endpoint = \'/validate-website-logs\';\n            } else if (validationMode === \'website-v2\') {\n                endpoint = \'/validate-website-logs-v2\';\n            }\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + endpoint;\n            \n            console.log(\'Making request to:\', fullUrl);\n            console.log(\'Validation mode:\', validationMode);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: formData,\n                processData: false,\n                contentType: false,\n                success: function(response) {\n                    console.log(\'Upload response:\', response);\n                    \n                    // Handle both old and new response formats\n                    if (response.results && response.summary) {\n                        // New format with summary\n                        currentResults = response.results;\n                        currentSummary = response.summary;\n                        // Store original logs for download feature\n                        window.originalLogs = response.original_logs || {};\n                    } else {\n                        // Old format - just results array\n                        currentResults = response;\n                        currentSummary = {\n                            csv_events_count: 0,\n                            log_events_count: 0,\n                            csv_events: [],\n                            log_events: []\n                        };\n                        window.originalLogs = {};\n                    }\n                    \n                    updateEventSummary();\n                    updateFilters();\n                    displayResults(currentResults);\n                    $(\'#filterSection\').show();\n\n                    if (response.fully_valid_events && response.fully_valid_events.length > 0) {\n                        $(\'#fullyValidEventsList\').empty();\n                        response.fully_valid_events.forEach(function(eventName) {\n                            $(\'#fullyValidEventsList\').append(\'<li>\' + eventName + \'</li>\');\n                        });\n                        $(\'#fullyValidEventsSection\').show();\n                    } else {\n                        $(\'#fullyValidEventsSection\').hide();\n                    }\n                },\n                error: function(xhr) {\n                    console.error(\'Upload error:\', xhr);\n                    alert(\'Error uploading files: \' + xhr.responseText);\n                }\n            });\n        });\n\n        // Initialize filter dropdowns\n        $(document).ready(function() {\n            $(\'.filter-header\').click(function(e) {\n                e.stopPropagation();\n                const filterId = $(this).data(\'filter\');\n                console.log(\'Clicked filter:\', filterId);\n                $(`#${filterId}Filter`).toggleClass(\'show\');\n            });\n\n            // Close filter dropdowns when clicking outside\n            $(document).click(function(e) {\n                if (!$(e.target).closest(\'.filter-dropdown\').length) {\n                    $(\'.filter-content\').removeClass(\'show\');\n                }\n            });\n        });\n\n        function updateEventSummary() {\n            // Update event count displays\n            $(\'#csvEventsCount\').text(currentSummary.csv_events_count || 0);\n            $(\'#logEventsCount\').text(currentSummary.log_events_count || 0);\n            \n            // Calculate missing and extra events\n            const csvEvents = new Set(currentSummary.csv_events || []);\n            const logEvents = new Set(currentSummary.log_events || []);\n            \n            const missingEvents = csvEvents.size - new Set([...csvEvents].filter(x => logEvents.has(x))).size;\n            const extraEvents = logEvents.size - new Set([...logEvents].filter(x => csvEvents.has(x))).size;\n            \n            $(\'#missingEventsCount\').text(missingEvents);\n            $(\'#extraEventsCount\').text(extraEvents);\n        }\n\n        function updateFilters() {\n            const eventNames = new Set();\n            const expectedTypes = new Set();\n            const receivedTypes = new Set();\n            const statuses = new Set();\n            \n            currentResults.forEach(result => {\n                if (result.eventName) eventNames.add(result.eventName);\n                if (result.expectedType) expectedTypes.add(result.expectedType);\n                if (result.receivedType) receivedTypes.add(result.receivedType);\n                if (result.validationStatus) statuses.add(result.validationStatus);\n            });\n\n            console.log(\'Available statuses:\', Array.from(statuses));\n\n            updateFilterOptions(\'eventName\', eventNames);\n            updateFilterOptions(\'status\', statuses);\n            updateFilterOptions(\'expectedType\', expectedTypes);\n            updateFilterOptions(\'receivedType\', receivedTypes);\n        }\n\n        function updateFilterOptions(filterId, values) {\n            const container = $(`#${filterId}Options`);\n            container.empty();\n            \n            console.log(`Updating ${filterId} with values:`, Array.from(values));\n            \n            Array.from(values).sort().forEach(value => {\n                if (value) {\n                    const checkboxId = `${filterId}_${value.replace(/[^a-zA-Z0-9]/g, \'_\')}`;\n                    container.append(`\n                        <div class="filter-checkbox">\n                            <input type="checkbox" id="${checkboxId}" value="${value}" checked>\n                            <label for="${checkboxId}">${value}</label>\n                        </div>\n                    `);\n                }\n            });\n\n            // Update select all checkbox\n            $(`#${filterId}SelectAll`).prop(\'checked\', true);\n        }\n\n        function getSelectedValues(filterId) {\n            return $(`#${filterId}Options input:checked`).map(function() {\n                return $(this).val();\n            }).get();\n        }\n\n        function applyFilter(filterId) {\n            activeFilters[filterId] = getSelectedValues(filterId);\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function clearFilter(filterId) {\n            $(`#${filterId}Options input`).prop(\'checked\', false);\n            $(`#${filterId}SelectAll`).prop(\'checked\', false);\n            activeFilters[filterId] = [];\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function applyFilters() {\n            const filters = {\n                eventName: activeFilters.eventName,\n                validationStatus: activeFilters.status,\n                expectedType: activeFilters.expectedType,\n                receivedType: activeFilters.receivedType\n            };\n\n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/filter\';\n\n            console.log(\'Making filter request to:\', fullUrl);\n\n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({\n                    results: currentResults,\n                    filters: filters,\n                    sort_by: currentSort.field,\n                    sort_order: currentSort.order\n                }),\n                contentType: \'application/json\',\n                success: function(response) {\n                    displayResults(response);\n                    window.filteredResults = response;\n                },\n                error: function(xhr) {\n                    console.error(\'Filter error:\', xhr);\n                    alert(\'Error applying filters: \' + xhr.responseText);\n                }\n            });\n        }\n\n        // Handle select all checkboxes\n        $(\'[id$="SelectAll"]\').change(function() {\n            const filterId = this.id.replace(\'SelectAll\', \'\');\n            $(`#${filterId}Options input`).prop(\'checked\', $(this).prop(\'checked\'));\n        });\n\n        // Update select all checkbox when individual checkboxes change\n        $(\'.filter-content\').on(\'change\', \'input[type="checkbox"]:not([id$="SelectAll"])\', function() {\n            const filterId = $(this).closest(\'.filter-content\').attr(\'id\').replace(\'Filter\', \'\');\n            const allChecked = $(`#${filterId}Options input:checked`).length === $(`#${filterId}Options input`).length;\n            $(`#${filterId}SelectAll`).prop(\'checked\', allChecked);\n        });\n\n        $(\'#clearFilters\').click(function() {\n            $(\'.filter-content input[type="checkbox"]\').prop(\'checked\', false);\n            $(\'[id$="SelectAll"]\').prop(\'checked\', false);\n            Object.keys(activeFilters).forEach(key => {\n                activeFilters[key] = [];\n            });\n            applyFilters();\n        });\n\n        $(\'#downloadResults\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download\';\n            \n            console.log(\'Making download request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ results: resultsToDownload }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'validation_results.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download error:\', xhr);\n                    alert(\'Error downloading results: \' + xhr.responseText);\n                }\n            });\n        });\n\n        $(\'#downloadValidEvents\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download-valid-events\';\n            \n            console.log(\'Making download valid events request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ \n                    results: resultsToDownload,\n                    logs_data: window.originalLogs || {}\n                }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'valid_events_report.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download valid events error:\', xhr);\n                    alert(\'Error downloading valid events: \' + xhr.responseText);\n                }\n            });\n        });\n\n        function displayResults(results) {\n            const tbody = $(\'#resultsBody\');\n            tbody.empty();\n            \n            // Debug log to check results being displayed\n            console.log(\'Displaying results:\', results);\n            \n            results.forEach(result => {\n                const statusClass = getStatusClass(result.validationStatus);\n                tbody.append(`\n                    <tr>\n                        <td>${result.eventName}</td>\n                        <td>${result.key}</td>\n                        <td>${result.value}</td>\n                        <td>${result.expectedType}</td>\n                        <td>${result.receivedType}</td>\n                        <td class="validation-status ${statusClass}">${result.validationStatus}</td>\n                    </tr>\n                `);\n            });\n        }\n\n        function getStatusClass(status) {\n            if (status === \'Valid\') return \'status-valid\';\n            if (status === \'Invalid/Wrong datatype/value\') return \'status-invalid\';\n            if (status === \'Payload value is Empty\') return \'status-empty\';\n            if (status === \'Extra key present in the log\') return \'status-extra\';\n            if (status === \'Extra event present in logs\') return \'status-extra-event\';\n            if (status === \'Field from extra event\') return \'status-extra-field\';\n            if (status === \'Event name not present in the logs\') return \'status-notpresent\';\n            return \'\';\n        }\n\n        $(\'.sort-header\').click(function() {\n            const field = $(this).data(\'sort\');\n            if (currentSort.field === field) {\n                currentSort.order = currentSort.order === \'asc\' ? \'desc\' : \'asc\';\n            } else {\n                currentSort.field = field;\n                currentSort.order = \'asc\';\n            }\n            applyFilters();\n        });\n\n        $(\'#eventNameFilter, #statusFilter, #expectedTypeFilter, #receivedTypeFilter\').change(applyFilters);\n    </script>\n</body>\n</html>'
2025-10-10 12:42:22,684 - INFO - 127.0.0.1 - - [10/Oct/2025 12:42:22] "GET / HTTP/1.1" 200 -
2025-10-10 12:42:24,059 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:42:24,060 - INFO - Body: b''
2025-10-10 12:42:24,060 - INFO - URL: http://localhost:10000/download_template
2025-10-10 12:42:24,061 - INFO - Method: GET
2025-10-10 12:42:24,061 - INFO - Endpoint: download_template
2025-10-10 12:42:24,072 - INFO - 127.0.0.1 - - [10/Oct/2025 12:42:24] "[35m[1mGET /download_template HTTP/1.1[0m" 500 -
2025-10-10 12:42:24,100 - INFO - 127.0.0.1 - - [10/Oct/2025 12:42:24] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 304 -
2025-10-10 12:42:24,100 - INFO - 127.0.0.1 - - [10/Oct/2025 12:42:24] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 304 -
2025-10-10 12:42:24,108 - INFO - 127.0.0.1 - - [10/Oct/2025 12:42:24] "GET /download_template?__debugger__=yes&cmd=resource&f=console.png&s=PyWyyDnt5EiAkFZout5u HTTP/1.1" 200 -
2025-10-10 12:45:16,550 - INFO -  * Detected change in '/Users/allen.thomson/Desktop/sampleapp/automation/validation_script_android/beta2.py', reloading
2025-10-10 12:45:16,623 - INFO -  * Restarting with stat
2025-10-10 12:45:16,861 - WARNING -  * Debugger is active!
2025-10-10 12:45:16,868 - INFO -  * Debugger PIN: 132-353-793
2025-10-10 12:45:34,003 - INFO -  * Detected change in '/Users/allen.thomson/Desktop/sampleapp/automation/validation_script_android/beta2.py', reloading
2025-10-10 12:45:34,051 - INFO -  * Restarting with stat
2025-10-10 12:45:34,231 - WARNING -  * Debugger is active!
2025-10-10 12:45:34,237 - INFO -  * Debugger PIN: 132-353-793
2025-10-10 12:46:22,201 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Cache-Control: max-age=0
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:46:22,202 - INFO - Body: b''
2025-10-10 12:46:22,202 - INFO - URL: http://localhost:10000/
2025-10-10 12:46:22,202 - INFO - Method: GET
2025-10-10 12:46:22,202 - INFO - Endpoint: index
2025-10-10 12:46:22,209 - INFO - Response: b'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Event Validation Tool</title>\n    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">\n    <link href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" rel="stylesheet">\n    <style>\n        :root {\n            --primary-color: #e35502;\n            --header-bg: #230f2e;\n        }\n        \n        .container { margin-top: 30px; }\n        .table-container { margin-top: 20px; }\n        .filter-container { margin: 20px 0; }\n        .hidden { display: none; }\n        .first-event { color: blue; }\n        \n        /* Header styling */\n        .navbar {\n            background-color: var(--header-bg) !important;\n        }\n        \n        .navbar-brand, .navbar-nav .nav-link {\n            color: white !important;\n        }\n        \n        .navbar-toggler {\n            border-color: rgba(255,255,255,0.5);\n        }\n        \n        .navbar-toggler-icon {\n            background-image: url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 30 30\'%3e%3cpath stroke=\'rgba%28255, 255, 255, 0.75%29\' stroke-linecap=\'round\' stroke-miterlimit=\'10\' stroke-width=\'2\' d=\'M4 7h22M4 15h22M4 23h22\'/%3e%3c/svg%3e");\n        }\n        \n        /* Button styling */\n        .btn-primary {\n            background-color: var(--primary-color) !important;\n            border-color: var(--primary-color) !important;\n        }\n        \n        .btn-primary:hover {\n            background-color: #c64802 !important;\n            border-color: #c64802 !important;\n        }\n        \n        .btn-outline-primary {\n            color: white !important;\n            border-color: white !important;\n        }\n        \n        .btn-outline-primary:hover {\n            background-color: rgba(255,255,255,0.1) !important;\n        }\n        .null-value { background-color: yellow; }\n        .valid-status { color: green; }\n        .invalid-status { color: red; }\n        .empty-status { color: orange; }\n        .not-present { color: darkolivegreen; }\n        .extra-key { color: rgb(24, 214, 185); }\n        .type-mismatch { background-color: #ffe6e6; }\n        .download-section {\n            margin: 20px 0;\n            text-align: right;\n        }\n        /* Status color coding */\n        .status-valid { background-color: #d4edda !important; color: #155724 !important; }\n        .status-invalid { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-empty { background-color: #fff3cd !important; color: #856404 !important; }\n        .status-extra { background-color: #d1ecf1 !important; color: #0c5460 !important; }\n        .status-notpresent { background-color: #042508 !important; color: #7f7b97 !important; }\n        .status-csv { background-color: #e2e3e5 !important; color: #383d41 !important; }\n        .status-extra-event { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-extra-field { background-color: #fff3cd !important; color: #856404 !important; }\n        .validation-status {\n            font-weight: bold;\n        }\n        .status-valid {\n            color: #28a745;\n        }\n        .status-invalid {\n            color: #dc3545;\n        }\n        .status-empty {\n            color: #ffc107;\n        }\n        .status-extra {\n            color: #17a2b8;\n        }\n        .status-extra-event {\n            color: #dc3545;\n        }\n        .status-extra-field {\n            color: #ffc107;\n        }\n        .filter-section {\n            background-color: #f8f9fa;\n            padding: 15px;\n            margin-bottom: 20px;\n            border-radius: 5px;\n        }\n        .sort-header {\n            cursor: pointer;\n        }\n        .sort-header:hover {\n            background-color: #e9ecef;\n        }\n        .sort-icon {\n            margin-left: 5px;\n        }\n        .filter-dropdown {\n            position: relative;\n            display: inline-block;\n        }\n        .filter-content {\n            display: none;\n            position: absolute;\n            background-color: #f9f9f9;\n            min-width: 200px;\n            max-height: 300px;\n            overflow-y: auto;\n            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\n            z-index: 1000;\n            padding: 10px;\n        }\n        .filter-content.show {\n            display: block;\n        }\n        .filter-checkbox {\n            margin: 5px 0;\n        }\n        .filter-checkbox label {\n            display: block;\n            padding: 5px;\n            cursor: pointer;\n        }\n        .filter-checkbox label:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-header {\n            display: flex;\n            align-items: center;\n            cursor: pointer;\n            padding: 5px;\n        }\n        .filter-header:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-icon {\n            margin-left: 5px;\n        }\n        .filter-actions {\n            margin-top: 10px;\n            padding-top: 10px;\n            border-top: 1px solid #ddd;\n        }\n    </style>\n</head>\n<body>\n    <nav class="navbar navbar-expand-lg navbar-light bg-light">\n        <div class="container-fluid">\n            <a class="navbar-brand" href="#">Netcore Event Payload Validator</a>\n            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">\n                <span class="navbar-toggler-icon"></span>\n            </button>\n            <div class="collapse navbar-collapse" id="navbarNav">\n                <ul class="navbar-nav ms-auto">\n                    <li class="nav-item">\n                        <a class="btn btn-primary" href="https://contact-api-netcore-beta-0-16.onrender.com/" target="_blank">Trigger Activity API</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </nav>\n\n    <div class="container">\n        <h2>Event Validation Tool</h2>\n        \n        <div class="card mb-4">\n            <div class="card-body">\n                <div class="mb-3">\n                    <label class="form-label">Validation Mode</label>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="regularMode" value="regular" checked>\n                        <label class="form-check-label" for="regularMode">\n                            Regular Event Validation (Single Event/Event Payload format)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteMode" value="website">\n                        <label class="form-check-label" for="websiteMode">\n                            Website Logs Validation (JSON lines format with eventname and payload)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteV2Mode" value="website-v2">\n                        <label class="form-check-label" for="websiteV2Mode">\n                            Website Logs V2 Validation (JSON lines format with event key and system fields excluded)\n                        </label>\n                    </div>\n                </div>\n                \n                <form id="uploadForm" enctype="multipart/form-data">\n                    <div class="mb-3">\n                        <label for="csvFile" class="form-label">CSV File (Validation Rules)</label>\n                        <input type="file" class="form-control" id="csvFile" name="csv_file" accept=".csv" required>\n                        <div class="mt-2">\n                            <a href="/download_template" class="btn btn-outline-secondary btn-sm">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Sample Template\n                            </a>\n                        </div>\n                    </div>\n                    <div class="mb-3">\n                        <label for="txtFile" class="form-label">TXT File (Event Logs)</label>\n                        <input type="file" class="form-control" id="txtFile" name="txt_file" accept=".txt" required>\n                        <div class="mt-2 sample-downloads">\n                            <!-- Regular mode sample -->\n                            <a href="/download_sample_log/regular" class="btn btn-outline-secondary btn-sm sample-download regular-mode">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Regular Sample Log\n                            </a>\n                            <!-- Website mode sample -->\n                            <a href="/download_sample_log/website" class="btn btn-outline-secondary btn-sm sample-download website-mode" style="display: none;">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Website Sample Log\n                            </a>\n                            <!-- Website V2 mode samples -->\n                            <div class="v2-mode-downloads" style="display: none;">\n                                <a href="/download_sample_log/website-v2" class="btn btn-outline-secondary btn-sm mb-1">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                    </svg>\n                                    Download Website V2 Sample Log\n                                </a>\n                                <a href="/download_sample_log/website-v2?multiline=true" class="btn btn-outline-secondary btn-sm">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                    </svg>\n                                    Download Website V2 Multiline Sample\n                                </a>\n                            </div>\n                        </div>\n                    </div>\n                    <button type="submit" class="btn btn-primary">Validate</button>\n                </form>\n            </div>\n        </div>\n\n        <div class="filter-section" id="filterSection" style="display: none;">\n            <div class="row mb-3">\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Summary</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>CSV Events:</strong></p>\n                                    <p class="text-primary" id="csvEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Log Events:</strong></p>\n                                    <p class="text-success" id="logEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Details</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Missing Events:</strong></p>\n                                    <p class="text-warning" id="missingEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Extra Events:</strong></p>\n                                    <p class="text-info" id="extraEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <h4>Filters</h4>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="eventName">\n                            Event Name <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="eventNameFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="eventNameSelectAll" checked>\n                                <label for="eventNameSelectAll">Select All</label>\n                            </div>\n                            <div id="eventNameOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'eventName\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'eventName\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="status">\n                            Status <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="statusFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="statusSelectAll" checked>\n                                <label for="statusSelectAll">Select All</label>\n                            </div>\n                            <div id="statusOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'status\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'status\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="expectedType">\n                            Expected Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="expectedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="expectedTypeSelectAll" checked>\n                                <label for="expectedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="expectedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'expectedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'expectedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="receivedType">\n                            Received Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="receivedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="receivedTypeSelectAll" checked>\n                                <label for="receivedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="receivedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'receivedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'receivedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-secondary" id="clearFilters">Clear All Filters</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-success" id="downloadResults">Download Results</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-info" id="downloadValidEvents">Download Valid Events</button>\n                </div>\n            </div>\n        </div>\n\n        <div id="fullyValidEventsSection" class="alert alert-success" style="display:none;">\n            <strong>Events with all payloads valid:</strong>\n            <ul id="fullyValidEventsList" style="margin-bottom:0;"></ul>\n        </div>\n\n        <div class="table-container">\n            <table class="table table-striped" id="resultsTable">\n                <thead>\n                    <tr>\n                        <th class="sort-header" data-sort="eventName">Event Name <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="key">Key <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="value">Value <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="expectedType">Expected Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="receivedType">Received Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="validationStatus">Status <span class="sort-icon">\xe2\x86\x95</span></th>\n                    </tr>\n                </thead>\n                <tbody id="resultsBody"></tbody>\n            </table>\n        </div>\n    </div>\n\n    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/moment/moment.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>\n    <script>\n        let currentResults = [];\n        let currentSummary = {};\n        let currentSort = { field: null, order: \'asc\' };\n        let activeFilters = {\n            eventName: [],\n            status: [],\n            expectedType: [],\n            receivedType: []\n        };\n\n        $(\'#dateRange\').daterangepicker({\n            autoUpdateInput: false,\n            locale: {\n                cancelLabel: \'Clear\'\n            }\n        });\n\n        $(\'#dateRange\').on(\'apply.daterangepicker\', function(ev, picker) {\n            $(this).val(picker.startDate.format(\'MM/DD/YYYY\') + \' - \' + picker.endDate.format(\'MM/DD/YYYY\'));\n            applyFilters();\n        });\n\n        $(\'#dateRange\').on(\'cancel.daterangepicker\', function(ev, picker) {\n            $(this).val(\'\');\n            applyFilters();\n        });\n\n        // Handle validation mode changes\n        $(\'input[name="validationMode"]\').change(function() {\n            const mode = $(this).val();\n            // Hide all sample download buttons first\n            $(\'.sample-download, .v2-mode-downloads\').hide();\n            \n            // Show the appropriate download button based on mode\n            if (mode === \'regular\') {\n                $(\'.sample-download.regular-mode\').show();\n            } else if (mode === \'website\') {\n                $(\'.sample-download.website-mode\').show();\n            } else if (mode === \'website-v2\') {\n                $(\'.v2-mode-downloads\').show();\n            }\n        });\n\n        $(\'#uploadForm\').on(\'submit\', function(e) {\n            e.preventDefault();\n            const formData = new FormData(this);\n            \n            // Determine which endpoint to use based on validation mode\n            const validationMode = $(\'input[name="validationMode"]:checked\').val();\n            let endpoint = \'/upload\';\n            if (validationMode === \'website\') {\n                endpoint = \'/validate-website-logs\';\n            } else if (validationMode === \'website-v2\') {\n                endpoint = \'/validate-website-logs-v2\';\n            }\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + endpoint;\n            \n            console.log(\'Making request to:\', fullUrl);\n            console.log(\'Validation mode:\', validationMode);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: formData,\n                processData: false,\n                contentType: false,\n                success: function(response) {\n                    console.log(\'Upload response:\', response);\n                    \n                    // Handle both old and new response formats\n                    if (response.results && response.summary) {\n                        // New format with summary\n                        currentResults = response.results;\n                        currentSummary = response.summary;\n                        // Store original logs for download feature\n                        window.originalLogs = response.original_logs || {};\n                    } else {\n                        // Old format - just results array\n                        currentResults = response;\n                        currentSummary = {\n                            csv_events_count: 0,\n                            log_events_count: 0,\n                            csv_events: [],\n                            log_events: []\n                        };\n                        window.originalLogs = {};\n                    }\n                    \n                    updateEventSummary();\n                    updateFilters();\n                    displayResults(currentResults);\n                    $(\'#filterSection\').show();\n\n                    if (response.fully_valid_events && response.fully_valid_events.length > 0) {\n                        $(\'#fullyValidEventsList\').empty();\n                        response.fully_valid_events.forEach(function(eventName) {\n                            $(\'#fullyValidEventsList\').append(\'<li>\' + eventName + \'</li>\');\n                        });\n                        $(\'#fullyValidEventsSection\').show();\n                    } else {\n                        $(\'#fullyValidEventsSection\').hide();\n                    }\n                },\n                error: function(xhr) {\n                    console.error(\'Upload error:\', xhr);\n                    alert(\'Error uploading files: \' + xhr.responseText);\n                }\n            });\n        });\n\n        // Initialize filter dropdowns\n        $(document).ready(function() {\n            $(\'.filter-header\').click(function(e) {\n                e.stopPropagation();\n                const filterId = $(this).data(\'filter\');\n                console.log(\'Clicked filter:\', filterId);\n                $(`#${filterId}Filter`).toggleClass(\'show\');\n            });\n\n            // Close filter dropdowns when clicking outside\n            $(document).click(function(e) {\n                if (!$(e.target).closest(\'.filter-dropdown\').length) {\n                    $(\'.filter-content\').removeClass(\'show\');\n                }\n            });\n        });\n\n        function updateEventSummary() {\n            // Update event count displays\n            $(\'#csvEventsCount\').text(currentSummary.csv_events_count || 0);\n            $(\'#logEventsCount\').text(currentSummary.log_events_count || 0);\n            \n            // Calculate missing and extra events\n            const csvEvents = new Set(currentSummary.csv_events || []);\n            const logEvents = new Set(currentSummary.log_events || []);\n            \n            const missingEvents = csvEvents.size - new Set([...csvEvents].filter(x => logEvents.has(x))).size;\n            const extraEvents = logEvents.size - new Set([...logEvents].filter(x => csvEvents.has(x))).size;\n            \n            $(\'#missingEventsCount\').text(missingEvents);\n            $(\'#extraEventsCount\').text(extraEvents);\n        }\n\n        function updateFilters() {\n            const eventNames = new Set();\n            const expectedTypes = new Set();\n            const receivedTypes = new Set();\n            const statuses = new Set();\n            \n            currentResults.forEach(result => {\n                if (result.eventName) eventNames.add(result.eventName);\n                if (result.expectedType) expectedTypes.add(result.expectedType);\n                if (result.receivedType) receivedTypes.add(result.receivedType);\n                if (result.validationStatus) statuses.add(result.validationStatus);\n            });\n\n            console.log(\'Available statuses:\', Array.from(statuses));\n\n            updateFilterOptions(\'eventName\', eventNames);\n            updateFilterOptions(\'status\', statuses);\n            updateFilterOptions(\'expectedType\', expectedTypes);\n            updateFilterOptions(\'receivedType\', receivedTypes);\n        }\n\n        function updateFilterOptions(filterId, values) {\n            const container = $(`#${filterId}Options`);\n            container.empty();\n            \n            console.log(`Updating ${filterId} with values:`, Array.from(values));\n            \n            Array.from(values).sort().forEach(value => {\n                if (value) {\n                    const checkboxId = `${filterId}_${value.replace(/[^a-zA-Z0-9]/g, \'_\')}`;\n                    container.append(`\n                        <div class="filter-checkbox">\n                            <input type="checkbox" id="${checkboxId}" value="${value}" checked>\n                            <label for="${checkboxId}">${value}</label>\n                        </div>\n                    `);\n                }\n            });\n\n            // Update select all checkbox\n            $(`#${filterId}SelectAll`).prop(\'checked\', true);\n        }\n\n        function getSelectedValues(filterId) {\n            return $(`#${filterId}Options input:checked`).map(function() {\n                return $(this).val();\n            }).get();\n        }\n\n        function applyFilter(filterId) {\n            activeFilters[filterId] = getSelectedValues(filterId);\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function clearFilter(filterId) {\n            $(`#${filterId}Options input`).prop(\'checked\', false);\n            $(`#${filterId}SelectAll`).prop(\'checked\', false);\n            activeFilters[filterId] = [];\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function applyFilters() {\n            const filters = {\n                eventName: activeFilters.eventName,\n                validationStatus: activeFilters.status,\n                expectedType: activeFilters.expectedType,\n                receivedType: activeFilters.receivedType\n            };\n\n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/filter\';\n\n            console.log(\'Making filter request to:\', fullUrl);\n\n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({\n                    results: currentResults,\n                    filters: filters,\n                    sort_by: currentSort.field,\n                    sort_order: currentSort.order\n                }),\n                contentType: \'application/json\',\n                success: function(response) {\n                    displayResults(response);\n                    window.filteredResults = response;\n                },\n                error: function(xhr) {\n                    console.error(\'Filter error:\', xhr);\n                    alert(\'Error applying filters: \' + xhr.responseText);\n                }\n            });\n        }\n\n        // Handle select all checkboxes\n        $(\'[id$="SelectAll"]\').change(function() {\n            const filterId = this.id.replace(\'SelectAll\', \'\');\n            $(`#${filterId}Options input`).prop(\'checked\', $(this).prop(\'checked\'));\n        });\n\n        // Update select all checkbox when individual checkboxes change\n        $(\'.filter-content\').on(\'change\', \'input[type="checkbox"]:not([id$="SelectAll"])\', function() {\n            const filterId = $(this).closest(\'.filter-content\').attr(\'id\').replace(\'Filter\', \'\');\n            const allChecked = $(`#${filterId}Options input:checked`).length === $(`#${filterId}Options input`).length;\n            $(`#${filterId}SelectAll`).prop(\'checked\', allChecked);\n        });\n\n        $(\'#clearFilters\').click(function() {\n            $(\'.filter-content input[type="checkbox"]\').prop(\'checked\', false);\n            $(\'[id$="SelectAll"]\').prop(\'checked\', false);\n            Object.keys(activeFilters).forEach(key => {\n                activeFilters[key] = [];\n            });\n            applyFilters();\n        });\n\n        $(\'#downloadResults\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download\';\n            \n            console.log(\'Making download request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ results: resultsToDownload }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'validation_results.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download error:\', xhr);\n                    alert(\'Error downloading results: \' + xhr.responseText);\n                }\n            });\n        });\n\n        $(\'#downloadValidEvents\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download-valid-events\';\n            \n            console.log(\'Making download valid events request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ \n                    results: resultsToDownload,\n                    logs_data: window.originalLogs || {}\n                }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'valid_events_report.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download valid events error:\', xhr);\n                    alert(\'Error downloading valid events: \' + xhr.responseText);\n                }\n            });\n        });\n\n        function displayResults(results) {\n            const tbody = $(\'#resultsBody\');\n            tbody.empty();\n            \n            // Debug log to check results being displayed\n            console.log(\'Displaying results:\', results);\n            \n            results.forEach(result => {\n                const statusClass = getStatusClass(result.validationStatus);\n                tbody.append(`\n                    <tr>\n                        <td>${result.eventName}</td>\n                        <td>${result.key}</td>\n                        <td>${result.value}</td>\n                        <td>${result.expectedType}</td>\n                        <td>${result.receivedType}</td>\n                        <td class="validation-status ${statusClass}">${result.validationStatus}</td>\n                    </tr>\n                `);\n            });\n        }\n\n        function getStatusClass(status) {\n            if (status === \'Valid\') return \'status-valid\';\n            if (status === \'Invalid/Wrong datatype/value\') return \'status-invalid\';\n            if (status === \'Payload value is Empty\') return \'status-empty\';\n            if (status === \'Extra key present in the log\') return \'status-extra\';\n            if (status === \'Extra event present in logs\') return \'status-extra-event\';\n            if (status === \'Field from extra event\') return \'status-extra-field\';\n            if (status === \'Event name not present in the logs\') return \'status-notpresent\';\n            return \'\';\n        }\n\n        $(\'.sort-header\').click(function() {\n            const field = $(this).data(\'sort\');\n            if (currentSort.field === field) {\n                currentSort.order = currentSort.order === \'asc\' ? \'desc\' : \'asc\';\n            } else {\n                currentSort.field = field;\n                currentSort.order = \'asc\';\n            }\n            applyFilters();\n        });\n\n        $(\'#eventNameFilter, #statusFilter, #expectedTypeFilter, #receivedTypeFilter\').change(applyFilters);\n    </script>\n</body>\n</html>'
2025-10-10 12:46:22,210 - INFO - 127.0.0.1 - - [10/Oct/2025 12:46:22] "GET / HTTP/1.1" 200 -
2025-10-10 12:46:23,936 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Cache-Control: max-age=0
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:46:23,936 - INFO - Body: b''
2025-10-10 12:46:23,937 - INFO - URL: http://localhost:10000/
2025-10-10 12:46:23,937 - INFO - Method: GET
2025-10-10 12:46:23,937 - INFO - Endpoint: index
2025-10-10 12:46:23,938 - INFO - Response: b'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Event Validation Tool</title>\n    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">\n    <link href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" rel="stylesheet">\n    <style>\n        :root {\n            --primary-color: #e35502;\n            --header-bg: #230f2e;\n        }\n        \n        .container { margin-top: 30px; }\n        .table-container { margin-top: 20px; }\n        .filter-container { margin: 20px 0; }\n        .hidden { display: none; }\n        .first-event { color: blue; }\n        \n        /* Header styling */\n        .navbar {\n            background-color: var(--header-bg) !important;\n        }\n        \n        .navbar-brand, .navbar-nav .nav-link {\n            color: white !important;\n        }\n        \n        .navbar-toggler {\n            border-color: rgba(255,255,255,0.5);\n        }\n        \n        .navbar-toggler-icon {\n            background-image: url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 30 30\'%3e%3cpath stroke=\'rgba%28255, 255, 255, 0.75%29\' stroke-linecap=\'round\' stroke-miterlimit=\'10\' stroke-width=\'2\' d=\'M4 7h22M4 15h22M4 23h22\'/%3e%3c/svg%3e");\n        }\n        \n        /* Button styling */\n        .btn-primary {\n            background-color: var(--primary-color) !important;\n            border-color: var(--primary-color) !important;\n        }\n        \n        .btn-primary:hover {\n            background-color: #c64802 !important;\n            border-color: #c64802 !important;\n        }\n        \n        .btn-outline-primary {\n            color: white !important;\n            border-color: white !important;\n        }\n        \n        .btn-outline-primary:hover {\n            background-color: rgba(255,255,255,0.1) !important;\n        }\n        .null-value { background-color: yellow; }\n        .valid-status { color: green; }\n        .invalid-status { color: red; }\n        .empty-status { color: orange; }\n        .not-present { color: darkolivegreen; }\n        .extra-key { color: rgb(24, 214, 185); }\n        .type-mismatch { background-color: #ffe6e6; }\n        .download-section {\n            margin: 20px 0;\n            text-align: right;\n        }\n        /* Status color coding */\n        .status-valid { background-color: #d4edda !important; color: #155724 !important; }\n        .status-invalid { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-empty { background-color: #fff3cd !important; color: #856404 !important; }\n        .status-extra { background-color: #d1ecf1 !important; color: #0c5460 !important; }\n        .status-notpresent { background-color: #042508 !important; color: #7f7b97 !important; }\n        .status-csv { background-color: #e2e3e5 !important; color: #383d41 !important; }\n        .status-extra-event { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-extra-field { background-color: #fff3cd !important; color: #856404 !important; }\n        .validation-status {\n            font-weight: bold;\n        }\n        .status-valid {\n            color: #28a745;\n        }\n        .status-invalid {\n            color: #dc3545;\n        }\n        .status-empty {\n            color: #ffc107;\n        }\n        .status-extra {\n            color: #17a2b8;\n        }\n        .status-extra-event {\n            color: #dc3545;\n        }\n        .status-extra-field {\n            color: #ffc107;\n        }\n        .filter-section {\n            background-color: #f8f9fa;\n            padding: 15px;\n            margin-bottom: 20px;\n            border-radius: 5px;\n        }\n        .sort-header {\n            cursor: pointer;\n        }\n        .sort-header:hover {\n            background-color: #e9ecef;\n        }\n        .sort-icon {\n            margin-left: 5px;\n        }\n        .filter-dropdown {\n            position: relative;\n            display: inline-block;\n        }\n        .filter-content {\n            display: none;\n            position: absolute;\n            background-color: #f9f9f9;\n            min-width: 200px;\n            max-height: 300px;\n            overflow-y: auto;\n            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\n            z-index: 1000;\n            padding: 10px;\n        }\n        .filter-content.show {\n            display: block;\n        }\n        .filter-checkbox {\n            margin: 5px 0;\n        }\n        .filter-checkbox label {\n            display: block;\n            padding: 5px;\n            cursor: pointer;\n        }\n        .filter-checkbox label:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-header {\n            display: flex;\n            align-items: center;\n            cursor: pointer;\n            padding: 5px;\n        }\n        .filter-header:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-icon {\n            margin-left: 5px;\n        }\n        .filter-actions {\n            margin-top: 10px;\n            padding-top: 10px;\n            border-top: 1px solid #ddd;\n        }\n    </style>\n</head>\n<body>\n    <nav class="navbar navbar-expand-lg navbar-light bg-light">\n        <div class="container-fluid">\n            <a class="navbar-brand" href="#">Netcore Event Payload Validator</a>\n            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">\n                <span class="navbar-toggler-icon"></span>\n            </button>\n            <div class="collapse navbar-collapse" id="navbarNav">\n                <ul class="navbar-nav ms-auto">\n                    <li class="nav-item">\n                        <a class="btn btn-primary" href="https://contact-api-netcore-beta-0-16.onrender.com/" target="_blank">Trigger Activity API</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </nav>\n\n    <div class="container">\n        <h2>Event Validation Tool</h2>\n        \n        <div class="card mb-4">\n            <div class="card-body">\n                <div class="mb-3">\n                    <label class="form-label">Validation Mode</label>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="regularMode" value="regular" checked>\n                        <label class="form-check-label" for="regularMode">\n                            Regular Event Validation (Single Event/Event Payload format)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteMode" value="website">\n                        <label class="form-check-label" for="websiteMode">\n                            Website Logs Validation (JSON lines format with eventname and payload)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteV2Mode" value="website-v2">\n                        <label class="form-check-label" for="websiteV2Mode">\n                            Website Logs V2 Validation (JSON lines format with event key and system fields excluded)\n                        </label>\n                    </div>\n                </div>\n                \n                <form id="uploadForm" enctype="multipart/form-data">\n                    <div class="mb-3">\n                        <label for="csvFile" class="form-label">CSV File (Validation Rules)</label>\n                        <input type="file" class="form-control" id="csvFile" name="csv_file" accept=".csv" required>\n                        <div class="mt-2">\n                            <a href="/download_template" class="btn btn-outline-secondary btn-sm">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Sample Template\n                            </a>\n                        </div>\n                    </div>\n                    <div class="mb-3">\n                        <label for="txtFile" class="form-label">TXT File (Event Logs)</label>\n                        <input type="file" class="form-control" id="txtFile" name="txt_file" accept=".txt" required>\n                        <div class="mt-2 sample-downloads">\n                            <!-- Regular mode sample -->\n                            <a href="/download_sample_log/regular" class="btn btn-outline-secondary btn-sm sample-download regular-mode">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Regular Sample Log\n                            </a>\n                            <!-- Website mode sample -->\n                            <a href="/download_sample_log/website" class="btn btn-outline-secondary btn-sm sample-download website-mode" style="display: none;">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Website Sample Log\n                            </a>\n                            <!-- Website V2 mode samples -->\n                            <div class="v2-mode-downloads" style="display: none;">\n                                <a href="/download_sample_log/website-v2" class="btn btn-outline-secondary btn-sm mb-1">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                    </svg>\n                                    Download Website V2 Sample Log\n                                </a>\n                                <a href="/download_sample_log/website-v2?multiline=true" class="btn btn-outline-secondary btn-sm">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                    </svg>\n                                    Download Website V2 Multiline Sample\n                                </a>\n                            </div>\n                        </div>\n                    </div>\n                    <button type="submit" class="btn btn-primary">Validate</button>\n                </form>\n            </div>\n        </div>\n\n        <div class="filter-section" id="filterSection" style="display: none;">\n            <div class="row mb-3">\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Summary</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>CSV Events:</strong></p>\n                                    <p class="text-primary" id="csvEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Log Events:</strong></p>\n                                    <p class="text-success" id="logEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Details</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Missing Events:</strong></p>\n                                    <p class="text-warning" id="missingEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Extra Events:</strong></p>\n                                    <p class="text-info" id="extraEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <h4>Filters</h4>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="eventName">\n                            Event Name <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="eventNameFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="eventNameSelectAll" checked>\n                                <label for="eventNameSelectAll">Select All</label>\n                            </div>\n                            <div id="eventNameOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'eventName\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'eventName\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="status">\n                            Status <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="statusFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="statusSelectAll" checked>\n                                <label for="statusSelectAll">Select All</label>\n                            </div>\n                            <div id="statusOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'status\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'status\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="expectedType">\n                            Expected Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="expectedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="expectedTypeSelectAll" checked>\n                                <label for="expectedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="expectedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'expectedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'expectedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="receivedType">\n                            Received Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="receivedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="receivedTypeSelectAll" checked>\n                                <label for="receivedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="receivedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'receivedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'receivedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-secondary" id="clearFilters">Clear All Filters</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-success" id="downloadResults">Download Results</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-info" id="downloadValidEvents">Download Valid Events</button>\n                </div>\n            </div>\n        </div>\n\n        <div id="fullyValidEventsSection" class="alert alert-success" style="display:none;">\n            <strong>Events with all payloads valid:</strong>\n            <ul id="fullyValidEventsList" style="margin-bottom:0;"></ul>\n        </div>\n\n        <div class="table-container">\n            <table class="table table-striped" id="resultsTable">\n                <thead>\n                    <tr>\n                        <th class="sort-header" data-sort="eventName">Event Name <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="key">Key <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="value">Value <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="expectedType">Expected Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="receivedType">Received Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="validationStatus">Status <span class="sort-icon">\xe2\x86\x95</span></th>\n                    </tr>\n                </thead>\n                <tbody id="resultsBody"></tbody>\n            </table>\n        </div>\n    </div>\n\n    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/moment/moment.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>\n    <script>\n        let currentResults = [];\n        let currentSummary = {};\n        let currentSort = { field: null, order: \'asc\' };\n        let activeFilters = {\n            eventName: [],\n            status: [],\n            expectedType: [],\n            receivedType: []\n        };\n\n        $(\'#dateRange\').daterangepicker({\n            autoUpdateInput: false,\n            locale: {\n                cancelLabel: \'Clear\'\n            }\n        });\n\n        $(\'#dateRange\').on(\'apply.daterangepicker\', function(ev, picker) {\n            $(this).val(picker.startDate.format(\'MM/DD/YYYY\') + \' - \' + picker.endDate.format(\'MM/DD/YYYY\'));\n            applyFilters();\n        });\n\n        $(\'#dateRange\').on(\'cancel.daterangepicker\', function(ev, picker) {\n            $(this).val(\'\');\n            applyFilters();\n        });\n\n        // Handle validation mode changes\n        $(\'input[name="validationMode"]\').change(function() {\n            const mode = $(this).val();\n            // Hide all sample download buttons first\n            $(\'.sample-download, .v2-mode-downloads\').hide();\n            \n            // Show the appropriate download button based on mode\n            if (mode === \'regular\') {\n                $(\'.sample-download.regular-mode\').show();\n            } else if (mode === \'website\') {\n                $(\'.sample-download.website-mode\').show();\n            } else if (mode === \'website-v2\') {\n                $(\'.v2-mode-downloads\').show();\n            }\n        });\n\n        $(\'#uploadForm\').on(\'submit\', function(e) {\n            e.preventDefault();\n            const formData = new FormData(this);\n            \n            // Determine which endpoint to use based on validation mode\n            const validationMode = $(\'input[name="validationMode"]:checked\').val();\n            let endpoint = \'/upload\';\n            if (validationMode === \'website\') {\n                endpoint = \'/validate-website-logs\';\n            } else if (validationMode === \'website-v2\') {\n                endpoint = \'/validate-website-logs-v2\';\n            }\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + endpoint;\n            \n            console.log(\'Making request to:\', fullUrl);\n            console.log(\'Validation mode:\', validationMode);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: formData,\n                processData: false,\n                contentType: false,\n                success: function(response) {\n                    console.log(\'Upload response:\', response);\n                    \n                    // Handle both old and new response formats\n                    if (response.results && response.summary) {\n                        // New format with summary\n                        currentResults = response.results;\n                        currentSummary = response.summary;\n                        // Store original logs for download feature\n                        window.originalLogs = response.original_logs || {};\n                    } else {\n                        // Old format - just results array\n                        currentResults = response;\n                        currentSummary = {\n                            csv_events_count: 0,\n                            log_events_count: 0,\n                            csv_events: [],\n                            log_events: []\n                        };\n                        window.originalLogs = {};\n                    }\n                    \n                    updateEventSummary();\n                    updateFilters();\n                    displayResults(currentResults);\n                    $(\'#filterSection\').show();\n\n                    if (response.fully_valid_events && response.fully_valid_events.length > 0) {\n                        $(\'#fullyValidEventsList\').empty();\n                        response.fully_valid_events.forEach(function(eventName) {\n                            $(\'#fullyValidEventsList\').append(\'<li>\' + eventName + \'</li>\');\n                        });\n                        $(\'#fullyValidEventsSection\').show();\n                    } else {\n                        $(\'#fullyValidEventsSection\').hide();\n                    }\n                },\n                error: function(xhr) {\n                    console.error(\'Upload error:\', xhr);\n                    alert(\'Error uploading files: \' + xhr.responseText);\n                }\n            });\n        });\n\n        // Initialize filter dropdowns\n        $(document).ready(function() {\n            $(\'.filter-header\').click(function(e) {\n                e.stopPropagation();\n                const filterId = $(this).data(\'filter\');\n                console.log(\'Clicked filter:\', filterId);\n                $(`#${filterId}Filter`).toggleClass(\'show\');\n            });\n\n            // Close filter dropdowns when clicking outside\n            $(document).click(function(e) {\n                if (!$(e.target).closest(\'.filter-dropdown\').length) {\n                    $(\'.filter-content\').removeClass(\'show\');\n                }\n            });\n        });\n\n        function updateEventSummary() {\n            // Update event count displays\n            $(\'#csvEventsCount\').text(currentSummary.csv_events_count || 0);\n            $(\'#logEventsCount\').text(currentSummary.log_events_count || 0);\n            \n            // Calculate missing and extra events\n            const csvEvents = new Set(currentSummary.csv_events || []);\n            const logEvents = new Set(currentSummary.log_events || []);\n            \n            const missingEvents = csvEvents.size - new Set([...csvEvents].filter(x => logEvents.has(x))).size;\n            const extraEvents = logEvents.size - new Set([...logEvents].filter(x => csvEvents.has(x))).size;\n            \n            $(\'#missingEventsCount\').text(missingEvents);\n            $(\'#extraEventsCount\').text(extraEvents);\n        }\n\n        function updateFilters() {\n            const eventNames = new Set();\n            const expectedTypes = new Set();\n            const receivedTypes = new Set();\n            const statuses = new Set();\n            \n            currentResults.forEach(result => {\n                if (result.eventName) eventNames.add(result.eventName);\n                if (result.expectedType) expectedTypes.add(result.expectedType);\n                if (result.receivedType) receivedTypes.add(result.receivedType);\n                if (result.validationStatus) statuses.add(result.validationStatus);\n            });\n\n            console.log(\'Available statuses:\', Array.from(statuses));\n\n            updateFilterOptions(\'eventName\', eventNames);\n            updateFilterOptions(\'status\', statuses);\n            updateFilterOptions(\'expectedType\', expectedTypes);\n            updateFilterOptions(\'receivedType\', receivedTypes);\n        }\n\n        function updateFilterOptions(filterId, values) {\n            const container = $(`#${filterId}Options`);\n            container.empty();\n            \n            console.log(`Updating ${filterId} with values:`, Array.from(values));\n            \n            Array.from(values).sort().forEach(value => {\n                if (value) {\n                    const checkboxId = `${filterId}_${value.replace(/[^a-zA-Z0-9]/g, \'_\')}`;\n                    container.append(`\n                        <div class="filter-checkbox">\n                            <input type="checkbox" id="${checkboxId}" value="${value}" checked>\n                            <label for="${checkboxId}">${value}</label>\n                        </div>\n                    `);\n                }\n            });\n\n            // Update select all checkbox\n            $(`#${filterId}SelectAll`).prop(\'checked\', true);\n        }\n\n        function getSelectedValues(filterId) {\n            return $(`#${filterId}Options input:checked`).map(function() {\n                return $(this).val();\n            }).get();\n        }\n\n        function applyFilter(filterId) {\n            activeFilters[filterId] = getSelectedValues(filterId);\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function clearFilter(filterId) {\n            $(`#${filterId}Options input`).prop(\'checked\', false);\n            $(`#${filterId}SelectAll`).prop(\'checked\', false);\n            activeFilters[filterId] = [];\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function applyFilters() {\n            const filters = {\n                eventName: activeFilters.eventName,\n                validationStatus: activeFilters.status,\n                expectedType: activeFilters.expectedType,\n                receivedType: activeFilters.receivedType\n            };\n\n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/filter\';\n\n            console.log(\'Making filter request to:\', fullUrl);\n\n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({\n                    results: currentResults,\n                    filters: filters,\n                    sort_by: currentSort.field,\n                    sort_order: currentSort.order\n                }),\n                contentType: \'application/json\',\n                success: function(response) {\n                    displayResults(response);\n                    window.filteredResults = response;\n                },\n                error: function(xhr) {\n                    console.error(\'Filter error:\', xhr);\n                    alert(\'Error applying filters: \' + xhr.responseText);\n                }\n            });\n        }\n\n        // Handle select all checkboxes\n        $(\'[id$="SelectAll"]\').change(function() {\n            const filterId = this.id.replace(\'SelectAll\', \'\');\n            $(`#${filterId}Options input`).prop(\'checked\', $(this).prop(\'checked\'));\n        });\n\n        // Update select all checkbox when individual checkboxes change\n        $(\'.filter-content\').on(\'change\', \'input[type="checkbox"]:not([id$="SelectAll"])\', function() {\n            const filterId = $(this).closest(\'.filter-content\').attr(\'id\').replace(\'Filter\', \'\');\n            const allChecked = $(`#${filterId}Options input:checked`).length === $(`#${filterId}Options input`).length;\n            $(`#${filterId}SelectAll`).prop(\'checked\', allChecked);\n        });\n\n        $(\'#clearFilters\').click(function() {\n            $(\'.filter-content input[type="checkbox"]\').prop(\'checked\', false);\n            $(\'[id$="SelectAll"]\').prop(\'checked\', false);\n            Object.keys(activeFilters).forEach(key => {\n                activeFilters[key] = [];\n            });\n            applyFilters();\n        });\n\n        $(\'#downloadResults\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download\';\n            \n            console.log(\'Making download request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ results: resultsToDownload }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'validation_results.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download error:\', xhr);\n                    alert(\'Error downloading results: \' + xhr.responseText);\n                }\n            });\n        });\n\n        $(\'#downloadValidEvents\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download-valid-events\';\n            \n            console.log(\'Making download valid events request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ \n                    results: resultsToDownload,\n                    logs_data: window.originalLogs || {}\n                }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'valid_events_report.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download valid events error:\', xhr);\n                    alert(\'Error downloading valid events: \' + xhr.responseText);\n                }\n            });\n        });\n\n        function displayResults(results) {\n            const tbody = $(\'#resultsBody\');\n            tbody.empty();\n            \n            // Debug log to check results being displayed\n            console.log(\'Displaying results:\', results);\n            \n            results.forEach(result => {\n                const statusClass = getStatusClass(result.validationStatus);\n                tbody.append(`\n                    <tr>\n                        <td>${result.eventName}</td>\n                        <td>${result.key}</td>\n                        <td>${result.value}</td>\n                        <td>${result.expectedType}</td>\n                        <td>${result.receivedType}</td>\n                        <td class="validation-status ${statusClass}">${result.validationStatus}</td>\n                    </tr>\n                `);\n            });\n        }\n\n        function getStatusClass(status) {\n            if (status === \'Valid\') return \'status-valid\';\n            if (status === \'Invalid/Wrong datatype/value\') return \'status-invalid\';\n            if (status === \'Payload value is Empty\') return \'status-empty\';\n            if (status === \'Extra key present in the log\') return \'status-extra\';\n            if (status === \'Extra event present in logs\') return \'status-extra-event\';\n            if (status === \'Field from extra event\') return \'status-extra-field\';\n            if (status === \'Event name not present in the logs\') return \'status-notpresent\';\n            return \'\';\n        }\n\n        $(\'.sort-header\').click(function() {\n            const field = $(this).data(\'sort\');\n            if (currentSort.field === field) {\n                currentSort.order = currentSort.order === \'asc\' ? \'desc\' : \'asc\';\n            } else {\n                currentSort.field = field;\n                currentSort.order = \'asc\';\n            }\n            applyFilters();\n        });\n\n        $(\'#eventNameFilter, #statusFilter, #expectedTypeFilter, #receivedTypeFilter\').change(applyFilters);\n    </script>\n</body>\n</html>'
2025-10-10 12:46:23,939 - INFO - 127.0.0.1 - - [10/Oct/2025 12:46:23] "GET / HTTP/1.1" 200 -
2025-10-10 12:46:34,010 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:46:34,011 - INFO - Body: b''
2025-10-10 12:46:34,012 - INFO - URL: http://localhost:10000/download_sample_log/website
2025-10-10 12:46:34,012 - INFO - Method: GET
2025-10-10 12:46:34,012 - INFO - Endpoint: download_sample_log
2025-10-10 12:46:34,033 - INFO - 127.0.0.1 - - [10/Oct/2025 12:46:34] "[35m[1mGET /download_sample_log/website HTTP/1.1[0m" 500 -
2025-10-10 12:46:34,076 - INFO - 127.0.0.1 - - [10/Oct/2025 12:46:34] "GET /download_sample_log/website?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1" 200 -
2025-10-10 12:46:34,077 - INFO - 127.0.0.1 - - [10/Oct/2025 12:46:34] "GET /download_sample_log/website?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1" 200 -
2025-10-10 12:46:34,086 - INFO - 127.0.0.1 - - [10/Oct/2025 12:46:34] "GET /download_sample_log/website?__debugger__=yes&cmd=resource&f=console.png&s=71atxvUl3yaQX0k5wFtk HTTP/1.1" 200 -
2025-10-10 12:46:34,099 - INFO - 127.0.0.1 - - [10/Oct/2025 12:46:34] "GET /download_sample_log/website?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1" 200 -
2025-10-10 12:47:10,000 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:10000
 * Running on http://172.16.20.191:10000
2025-10-10 12:47:10,000 - INFO - [33mPress CTRL+C to quit[0m
2025-10-10 12:47:10,001 - INFO -  * Restarting with stat
2025-10-10 12:47:10,122 - WARNING -  * Debugger is active!
2025-10-10 12:47:10,131 - INFO -  * Debugger PIN: 132-353-793
2025-10-10 12:47:17,738 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Cache-Control: max-age=0
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:47:17,739 - INFO - Body: b''
2025-10-10 12:47:17,739 - INFO - URL: http://localhost:10000/
2025-10-10 12:47:17,739 - INFO - Method: GET
2025-10-10 12:47:17,739 - INFO - Endpoint: index
2025-10-10 12:47:17,749 - INFO - Response: b'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Event Validation Tool</title>\n    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">\n    <link href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" rel="stylesheet">\n    <style>\n        :root {\n            --primary-color: #e35502;\n            --header-bg: #230f2e;\n        }\n        \n        .container { margin-top: 30px; }\n        .table-container { margin-top: 20px; }\n        .filter-container { margin: 20px 0; }\n        .hidden { display: none; }\n        .first-event { color: blue; }\n        \n        /* Header styling */\n        .navbar {\n            background-color: var(--header-bg) !important;\n        }\n        \n        .navbar-brand, .navbar-nav .nav-link {\n            color: white !important;\n        }\n        \n        .navbar-toggler {\n            border-color: rgba(255,255,255,0.5);\n        }\n        \n        .navbar-toggler-icon {\n            background-image: url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 30 30\'%3e%3cpath stroke=\'rgba%28255, 255, 255, 0.75%29\' stroke-linecap=\'round\' stroke-miterlimit=\'10\' stroke-width=\'2\' d=\'M4 7h22M4 15h22M4 23h22\'/%3e%3c/svg%3e");\n        }\n        \n        /* Button styling */\n        .btn-primary {\n            background-color: var(--primary-color) !important;\n            border-color: var(--primary-color) !important;\n        }\n        \n        .btn-primary:hover {\n            background-color: #c64802 !important;\n            border-color: #c64802 !important;\n        }\n        \n        .btn-outline-primary {\n            color: white !important;\n            border-color: white !important;\n        }\n        \n        .btn-outline-primary:hover {\n            background-color: rgba(255,255,255,0.1) !important;\n        }\n        .null-value { background-color: yellow; }\n        .valid-status { color: green; }\n        .invalid-status { color: red; }\n        .empty-status { color: orange; }\n        .not-present { color: darkolivegreen; }\n        .extra-key { color: rgb(24, 214, 185); }\n        .type-mismatch { background-color: #ffe6e6; }\n        .download-section {\n            margin: 20px 0;\n            text-align: right;\n        }\n        /* Status color coding */\n        .status-valid { background-color: #d4edda !important; color: #155724 !important; }\n        .status-invalid { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-empty { background-color: #fff3cd !important; color: #856404 !important; }\n        .status-extra { background-color: #d1ecf1 !important; color: #0c5460 !important; }\n        .status-notpresent { background-color: #042508 !important; color: #7f7b97 !important; }\n        .status-csv { background-color: #e2e3e5 !important; color: #383d41 !important; }\n        .status-extra-event { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-extra-field { background-color: #fff3cd !important; color: #856404 !important; }\n        .validation-status {\n            font-weight: bold;\n        }\n        .status-valid {\n            color: #28a745;\n        }\n        .status-invalid {\n            color: #dc3545;\n        }\n        .status-empty {\n            color: #ffc107;\n        }\n        .status-extra {\n            color: #17a2b8;\n        }\n        .status-extra-event {\n            color: #dc3545;\n        }\n        .status-extra-field {\n            color: #ffc107;\n        }\n        .filter-section {\n            background-color: #f8f9fa;\n            padding: 15px;\n            margin-bottom: 20px;\n            border-radius: 5px;\n        }\n        .sort-header {\n            cursor: pointer;\n        }\n        .sort-header:hover {\n            background-color: #e9ecef;\n        }\n        .sort-icon {\n            margin-left: 5px;\n        }\n        .filter-dropdown {\n            position: relative;\n            display: inline-block;\n        }\n        .filter-content {\n            display: none;\n            position: absolute;\n            background-color: #f9f9f9;\n            min-width: 200px;\n            max-height: 300px;\n            overflow-y: auto;\n            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\n            z-index: 1000;\n            padding: 10px;\n        }\n        .filter-content.show {\n            display: block;\n        }\n        .filter-checkbox {\n            margin: 5px 0;\n        }\n        .filter-checkbox label {\n            display: block;\n            padding: 5px;\n            cursor: pointer;\n        }\n        .filter-checkbox label:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-header {\n            display: flex;\n            align-items: center;\n            cursor: pointer;\n            padding: 5px;\n        }\n        .filter-header:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-icon {\n            margin-left: 5px;\n        }\n        .filter-actions {\n            margin-top: 10px;\n            padding-top: 10px;\n            border-top: 1px solid #ddd;\n        }\n    </style>\n</head>\n<body>\n    <nav class="navbar navbar-expand-lg navbar-light bg-light">\n        <div class="container-fluid">\n            <a class="navbar-brand" href="#">Netcore Event Payload Validator</a>\n            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">\n                <span class="navbar-toggler-icon"></span>\n            </button>\n            <div class="collapse navbar-collapse" id="navbarNav">\n                <ul class="navbar-nav ms-auto">\n                    <li class="nav-item">\n                        <a class="btn btn-primary" href="https://contact-api-netcore-beta-0-16.onrender.com/" target="_blank">Trigger Activity API</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </nav>\n\n    <div class="container">\n        <h2>Event Validation Tool</h2>\n        \n        <div class="card mb-4">\n            <div class="card-body">\n                <div class="mb-3">\n                    <label class="form-label">Validation Mode</label>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="regularMode" value="regular" checked>\n                        <label class="form-check-label" for="regularMode">\n                            Regular Event Validation (Single Event/Event Payload format)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteMode" value="website">\n                        <label class="form-check-label" for="websiteMode">\n                            Website Logs Validation (JSON lines format with eventname and payload)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteV2Mode" value="website-v2">\n                        <label class="form-check-label" for="websiteV2Mode">\n                            Website Logs V2 Validation (JSON lines format with event key and system fields excluded)\n                        </label>\n                    </div>\n                </div>\n                \n                <form id="uploadForm" enctype="multipart/form-data">\n                    <div class="mb-3">\n                        <label for="csvFile" class="form-label">CSV File (Validation Rules)</label>\n                        <input type="file" class="form-control" id="csvFile" name="csv_file" accept=".csv" required>\n                        <div class="mt-2">\n                            <a href="/download_template" class="btn btn-outline-secondary btn-sm">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Sample Template\n                            </a>\n                        </div>\n                    </div>\n                    <div class="mb-3">\n                        <label for="txtFile" class="form-label">TXT File (Event Logs)</label>\n                        <input type="file" class="form-control" id="txtFile" name="txt_file" accept=".txt" required>\n                        <div class="mt-2 sample-downloads">\n                            <!-- Regular mode sample -->\n                            <a href="/download_sample_log/regular" class="btn btn-outline-secondary btn-sm sample-download regular-mode">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Regular Sample Log\n                            </a>\n                            <!-- Website mode sample -->\n                            <a href="/download_sample_log/website" class="btn btn-outline-secondary btn-sm sample-download website-mode" style="display: none;">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Website Sample Log\n                            </a>\n                            <!-- Website V2 mode samples -->\n                            <div class="v2-mode-downloads" style="display: none;">\n                                <a href="/download_sample_log/website-v2" class="btn btn-outline-secondary btn-sm mb-1">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                    </svg>\n                                    Download Website V2 Sample Log\n                                </a>\n                                <a href="/download_sample_log/website-v2?multiline=true" class="btn btn-outline-secondary btn-sm">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                    </svg>\n                                    Download Website V2 Multiline Sample\n                                </a>\n                            </div>\n                        </div>\n                    </div>\n                    <button type="submit" class="btn btn-primary">Validate</button>\n                </form>\n            </div>\n        </div>\n\n        <div class="filter-section" id="filterSection" style="display: none;">\n            <div class="row mb-3">\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Summary</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>CSV Events:</strong></p>\n                                    <p class="text-primary" id="csvEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Log Events:</strong></p>\n                                    <p class="text-success" id="logEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Details</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Missing Events:</strong></p>\n                                    <p class="text-warning" id="missingEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Extra Events:</strong></p>\n                                    <p class="text-info" id="extraEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <h4>Filters</h4>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="eventName">\n                            Event Name <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="eventNameFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="eventNameSelectAll" checked>\n                                <label for="eventNameSelectAll">Select All</label>\n                            </div>\n                            <div id="eventNameOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'eventName\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'eventName\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="status">\n                            Status <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="statusFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="statusSelectAll" checked>\n                                <label for="statusSelectAll">Select All</label>\n                            </div>\n                            <div id="statusOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'status\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'status\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="expectedType">\n                            Expected Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="expectedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="expectedTypeSelectAll" checked>\n                                <label for="expectedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="expectedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'expectedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'expectedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="receivedType">\n                            Received Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="receivedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="receivedTypeSelectAll" checked>\n                                <label for="receivedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="receivedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'receivedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'receivedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-secondary" id="clearFilters">Clear All Filters</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-success" id="downloadResults">Download Results</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-info" id="downloadValidEvents">Download Valid Events</button>\n                </div>\n            </div>\n        </div>\n\n        <div id="fullyValidEventsSection" class="alert alert-success" style="display:none;">\n            <strong>Events with all payloads valid:</strong>\n            <ul id="fullyValidEventsList" style="margin-bottom:0;"></ul>\n        </div>\n\n        <div class="table-container">\n            <table class="table table-striped" id="resultsTable">\n                <thead>\n                    <tr>\n                        <th class="sort-header" data-sort="eventName">Event Name <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="key">Key <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="value">Value <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="expectedType">Expected Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="receivedType">Received Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="validationStatus">Status <span class="sort-icon">\xe2\x86\x95</span></th>\n                    </tr>\n                </thead>\n                <tbody id="resultsBody"></tbody>\n            </table>\n        </div>\n    </div>\n\n    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/moment/moment.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>\n    <script>\n        let currentResults = [];\n        let currentSummary = {};\n        let currentSort = { field: null, order: \'asc\' };\n        let activeFilters = {\n            eventName: [],\n            status: [],\n            expectedType: [],\n            receivedType: []\n        };\n\n        $(\'#dateRange\').daterangepicker({\n            autoUpdateInput: false,\n            locale: {\n                cancelLabel: \'Clear\'\n            }\n        });\n\n        $(\'#dateRange\').on(\'apply.daterangepicker\', function(ev, picker) {\n            $(this).val(picker.startDate.format(\'MM/DD/YYYY\') + \' - \' + picker.endDate.format(\'MM/DD/YYYY\'));\n            applyFilters();\n        });\n\n        $(\'#dateRange\').on(\'cancel.daterangepicker\', function(ev, picker) {\n            $(this).val(\'\');\n            applyFilters();\n        });\n\n        // Handle validation mode changes\n        $(\'input[name="validationMode"]\').change(function() {\n            const mode = $(this).val();\n            // Hide all sample download buttons first\n            $(\'.sample-download, .v2-mode-downloads\').hide();\n            \n            // Show the appropriate download button based on mode\n            if (mode === \'regular\') {\n                $(\'.sample-download.regular-mode\').show();\n            } else if (mode === \'website\') {\n                $(\'.sample-download.website-mode\').show();\n            } else if (mode === \'website-v2\') {\n                $(\'.v2-mode-downloads\').show();\n            }\n        });\n\n        $(\'#uploadForm\').on(\'submit\', function(e) {\n            e.preventDefault();\n            const formData = new FormData(this);\n            \n            // Determine which endpoint to use based on validation mode\n            const validationMode = $(\'input[name="validationMode"]:checked\').val();\n            let endpoint = \'/upload\';\n            if (validationMode === \'website\') {\n                endpoint = \'/validate-website-logs\';\n            } else if (validationMode === \'website-v2\') {\n                endpoint = \'/validate-website-logs-v2\';\n            }\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + endpoint;\n            \n            console.log(\'Making request to:\', fullUrl);\n            console.log(\'Validation mode:\', validationMode);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: formData,\n                processData: false,\n                contentType: false,\n                success: function(response) {\n                    console.log(\'Upload response:\', response);\n                    \n                    // Handle both old and new response formats\n                    if (response.results && response.summary) {\n                        // New format with summary\n                        currentResults = response.results;\n                        currentSummary = response.summary;\n                        // Store original logs for download feature\n                        window.originalLogs = response.original_logs || {};\n                    } else {\n                        // Old format - just results array\n                        currentResults = response;\n                        currentSummary = {\n                            csv_events_count: 0,\n                            log_events_count: 0,\n                            csv_events: [],\n                            log_events: []\n                        };\n                        window.originalLogs = {};\n                    }\n                    \n                    updateEventSummary();\n                    updateFilters();\n                    displayResults(currentResults);\n                    $(\'#filterSection\').show();\n\n                    if (response.fully_valid_events && response.fully_valid_events.length > 0) {\n                        $(\'#fullyValidEventsList\').empty();\n                        response.fully_valid_events.forEach(function(eventName) {\n                            $(\'#fullyValidEventsList\').append(\'<li>\' + eventName + \'</li>\');\n                        });\n                        $(\'#fullyValidEventsSection\').show();\n                    } else {\n                        $(\'#fullyValidEventsSection\').hide();\n                    }\n                },\n                error: function(xhr) {\n                    console.error(\'Upload error:\', xhr);\n                    alert(\'Error uploading files: \' + xhr.responseText);\n                }\n            });\n        });\n\n        // Initialize filter dropdowns\n        $(document).ready(function() {\n            $(\'.filter-header\').click(function(e) {\n                e.stopPropagation();\n                const filterId = $(this).data(\'filter\');\n                console.log(\'Clicked filter:\', filterId);\n                $(`#${filterId}Filter`).toggleClass(\'show\');\n            });\n\n            // Close filter dropdowns when clicking outside\n            $(document).click(function(e) {\n                if (!$(e.target).closest(\'.filter-dropdown\').length) {\n                    $(\'.filter-content\').removeClass(\'show\');\n                }\n            });\n        });\n\n        function updateEventSummary() {\n            // Update event count displays\n            $(\'#csvEventsCount\').text(currentSummary.csv_events_count || 0);\n            $(\'#logEventsCount\').text(currentSummary.log_events_count || 0);\n            \n            // Calculate missing and extra events\n            const csvEvents = new Set(currentSummary.csv_events || []);\n            const logEvents = new Set(currentSummary.log_events || []);\n            \n            const missingEvents = csvEvents.size - new Set([...csvEvents].filter(x => logEvents.has(x))).size;\n            const extraEvents = logEvents.size - new Set([...logEvents].filter(x => csvEvents.has(x))).size;\n            \n            $(\'#missingEventsCount\').text(missingEvents);\n            $(\'#extraEventsCount\').text(extraEvents);\n        }\n\n        function updateFilters() {\n            const eventNames = new Set();\n            const expectedTypes = new Set();\n            const receivedTypes = new Set();\n            const statuses = new Set();\n            \n            currentResults.forEach(result => {\n                if (result.eventName) eventNames.add(result.eventName);\n                if (result.expectedType) expectedTypes.add(result.expectedType);\n                if (result.receivedType) receivedTypes.add(result.receivedType);\n                if (result.validationStatus) statuses.add(result.validationStatus);\n            });\n\n            console.log(\'Available statuses:\', Array.from(statuses));\n\n            updateFilterOptions(\'eventName\', eventNames);\n            updateFilterOptions(\'status\', statuses);\n            updateFilterOptions(\'expectedType\', expectedTypes);\n            updateFilterOptions(\'receivedType\', receivedTypes);\n        }\n\n        function updateFilterOptions(filterId, values) {\n            const container = $(`#${filterId}Options`);\n            container.empty();\n            \n            console.log(`Updating ${filterId} with values:`, Array.from(values));\n            \n            Array.from(values).sort().forEach(value => {\n                if (value) {\n                    const checkboxId = `${filterId}_${value.replace(/[^a-zA-Z0-9]/g, \'_\')}`;\n                    container.append(`\n                        <div class="filter-checkbox">\n                            <input type="checkbox" id="${checkboxId}" value="${value}" checked>\n                            <label for="${checkboxId}">${value}</label>\n                        </div>\n                    `);\n                }\n            });\n\n            // Update select all checkbox\n            $(`#${filterId}SelectAll`).prop(\'checked\', true);\n        }\n\n        function getSelectedValues(filterId) {\n            return $(`#${filterId}Options input:checked`).map(function() {\n                return $(this).val();\n            }).get();\n        }\n\n        function applyFilter(filterId) {\n            activeFilters[filterId] = getSelectedValues(filterId);\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function clearFilter(filterId) {\n            $(`#${filterId}Options input`).prop(\'checked\', false);\n            $(`#${filterId}SelectAll`).prop(\'checked\', false);\n            activeFilters[filterId] = [];\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function applyFilters() {\n            const filters = {\n                eventName: activeFilters.eventName,\n                validationStatus: activeFilters.status,\n                expectedType: activeFilters.expectedType,\n                receivedType: activeFilters.receivedType\n            };\n\n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/filter\';\n\n            console.log(\'Making filter request to:\', fullUrl);\n\n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({\n                    results: currentResults,\n                    filters: filters,\n                    sort_by: currentSort.field,\n                    sort_order: currentSort.order\n                }),\n                contentType: \'application/json\',\n                success: function(response) {\n                    displayResults(response);\n                    window.filteredResults = response;\n                },\n                error: function(xhr) {\n                    console.error(\'Filter error:\', xhr);\n                    alert(\'Error applying filters: \' + xhr.responseText);\n                }\n            });\n        }\n\n        // Handle select all checkboxes\n        $(\'[id$="SelectAll"]\').change(function() {\n            const filterId = this.id.replace(\'SelectAll\', \'\');\n            $(`#${filterId}Options input`).prop(\'checked\', $(this).prop(\'checked\'));\n        });\n\n        // Update select all checkbox when individual checkboxes change\n        $(\'.filter-content\').on(\'change\', \'input[type="checkbox"]:not([id$="SelectAll"])\', function() {\n            const filterId = $(this).closest(\'.filter-content\').attr(\'id\').replace(\'Filter\', \'\');\n            const allChecked = $(`#${filterId}Options input:checked`).length === $(`#${filterId}Options input`).length;\n            $(`#${filterId}SelectAll`).prop(\'checked\', allChecked);\n        });\n\n        $(\'#clearFilters\').click(function() {\n            $(\'.filter-content input[type="checkbox"]\').prop(\'checked\', false);\n            $(\'[id$="SelectAll"]\').prop(\'checked\', false);\n            Object.keys(activeFilters).forEach(key => {\n                activeFilters[key] = [];\n            });\n            applyFilters();\n        });\n\n        $(\'#downloadResults\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download\';\n            \n            console.log(\'Making download request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ results: resultsToDownload }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'validation_results.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download error:\', xhr);\n                    alert(\'Error downloading results: \' + xhr.responseText);\n                }\n            });\n        });\n\n        $(\'#downloadValidEvents\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download-valid-events\';\n            \n            console.log(\'Making download valid events request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ \n                    results: resultsToDownload,\n                    logs_data: window.originalLogs || {}\n                }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'valid_events_report.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download valid events error:\', xhr);\n                    alert(\'Error downloading valid events: \' + xhr.responseText);\n                }\n            });\n        });\n\n        function displayResults(results) {\n            const tbody = $(\'#resultsBody\');\n            tbody.empty();\n            \n            // Debug log to check results being displayed\n            console.log(\'Displaying results:\', results);\n            \n            results.forEach(result => {\n                const statusClass = getStatusClass(result.validationStatus);\n                tbody.append(`\n                    <tr>\n                        <td>${result.eventName}</td>\n                        <td>${result.key}</td>\n                        <td>${result.value}</td>\n                        <td>${result.expectedType}</td>\n                        <td>${result.receivedType}</td>\n                        <td class="validation-status ${statusClass}">${result.validationStatus}</td>\n                    </tr>\n                `);\n            });\n        }\n\n        function getStatusClass(status) {\n            if (status === \'Valid\') return \'status-valid\';\n            if (status === \'Invalid/Wrong datatype/value\') return \'status-invalid\';\n            if (status === \'Payload value is Empty\') return \'status-empty\';\n            if (status === \'Extra key present in the log\') return \'status-extra\';\n            if (status === \'Extra event present in logs\') return \'status-extra-event\';\n            if (status === \'Field from extra event\') return \'status-extra-field\';\n            if (status === \'Event name not present in the logs\') return \'status-notpresent\';\n            return \'\';\n        }\n\n        $(\'.sort-header\').click(function() {\n            const field = $(this).data(\'sort\');\n            if (currentSort.field === field) {\n                currentSort.order = currentSort.order === \'asc\' ? \'desc\' : \'asc\';\n            } else {\n                currentSort.field = field;\n                currentSort.order = \'asc\';\n            }\n            applyFilters();\n        });\n\n        $(\'#eventNameFilter, #statusFilter, #expectedTypeFilter, #receivedTypeFilter\').change(applyFilters);\n    </script>\n</body>\n</html>'
2025-10-10 12:47:17,749 - INFO - 127.0.0.1 - - [10/Oct/2025 12:47:17] "GET / HTTP/1.1" 200 -
2025-10-10 12:47:19,221 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:47:19,222 - INFO - Body: b''
2025-10-10 12:47:19,222 - INFO - URL: http://localhost:10000/download_sample_log/regular
2025-10-10 12:47:19,222 - INFO - Method: GET
2025-10-10 12:47:19,223 - INFO - Endpoint: download_sample_log
2025-10-10 12:47:19,237 - INFO - 127.0.0.1 - - [10/Oct/2025 12:47:19] "[35m[1mGET /download_sample_log/regular HTTP/1.1[0m" 500 -
2025-10-10 12:47:19,271 - INFO - 127.0.0.1 - - [10/Oct/2025 12:47:19] "GET /download_sample_log/regular?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1" 200 -
2025-10-10 12:47:19,272 - INFO - 127.0.0.1 - - [10/Oct/2025 12:47:19] "GET /download_sample_log/regular?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1" 200 -
2025-10-10 12:47:19,285 - INFO - 127.0.0.1 - - [10/Oct/2025 12:47:19] "GET /download_sample_log/regular?__debugger__=yes&cmd=resource&f=console.png&s=Cg9dhGkT1SGQ5cvIcVYm HTTP/1.1" 200 -
2025-10-10 12:47:19,302 - INFO - 127.0.0.1 - - [10/Oct/2025 12:47:19] "GET /download_sample_log/regular?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1" 200 -
2025-10-10 12:48:18,652 - INFO -  * Detected change in '/Users/allen.thomson/Desktop/sampleapp/automation/validation_script_android/beta2.py', reloading
2025-10-10 12:48:18,719 - INFO -  * Restarting with stat
2025-10-10 12:48:18,953 - WARNING -  * Debugger is active!
2025-10-10 12:48:18,964 - INFO -  * Debugger PIN: 132-353-793
2025-10-10 12:48:31,576 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Cache-Control: max-age=0
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:48:31,576 - INFO - Body: b''
2025-10-10 12:48:31,576 - INFO - URL: http://localhost:10000/
2025-10-10 12:48:31,576 - INFO - Method: GET
2025-10-10 12:48:31,576 - INFO - Endpoint: index
2025-10-10 12:48:31,583 - INFO - Response: b'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Event Validation Tool</title>\n    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">\n    <link href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" rel="stylesheet">\n    <style>\n        :root {\n            --primary-color: #e35502;\n            --header-bg: #230f2e;\n        }\n        \n        .container { margin-top: 30px; }\n        .table-container { margin-top: 20px; }\n        .filter-container { margin: 20px 0; }\n        .hidden { display: none; }\n        .first-event { color: blue; }\n        \n        /* Header styling */\n        .navbar {\n            background-color: var(--header-bg) !important;\n        }\n        \n        .navbar-brand, .navbar-nav .nav-link {\n            color: white !important;\n        }\n        \n        .navbar-toggler {\n            border-color: rgba(255,255,255,0.5);\n        }\n        \n        .navbar-toggler-icon {\n            background-image: url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 30 30\'%3e%3cpath stroke=\'rgba%28255, 255, 255, 0.75%29\' stroke-linecap=\'round\' stroke-miterlimit=\'10\' stroke-width=\'2\' d=\'M4 7h22M4 15h22M4 23h22\'/%3e%3c/svg%3e");\n        }\n        \n        /* Button styling */\n        .btn-primary {\n            background-color: var(--primary-color) !important;\n            border-color: var(--primary-color) !important;\n        }\n        \n        .btn-primary:hover {\n            background-color: #c64802 !important;\n            border-color: #c64802 !important;\n        }\n        \n        .btn-outline-primary {\n            color: white !important;\n            border-color: white !important;\n        }\n        \n        .btn-outline-primary:hover {\n            background-color: rgba(255,255,255,0.1) !important;\n        }\n        .null-value { background-color: yellow; }\n        .valid-status { color: green; }\n        .invalid-status { color: red; }\n        .empty-status { color: orange; }\n        .not-present { color: darkolivegreen; }\n        .extra-key { color: rgb(24, 214, 185); }\n        .type-mismatch { background-color: #ffe6e6; }\n        .download-section {\n            margin: 20px 0;\n            text-align: right;\n        }\n        /* Status color coding */\n        .status-valid { background-color: #d4edda !important; color: #155724 !important; }\n        .status-invalid { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-empty { background-color: #fff3cd !important; color: #856404 !important; }\n        .status-extra { background-color: #d1ecf1 !important; color: #0c5460 !important; }\n        .status-notpresent { background-color: #042508 !important; color: #7f7b97 !important; }\n        .status-csv { background-color: #e2e3e5 !important; color: #383d41 !important; }\n        .status-extra-event { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-extra-field { background-color: #fff3cd !important; color: #856404 !important; }\n        .validation-status {\n            font-weight: bold;\n        }\n        .status-valid {\n            color: #28a745;\n        }\n        .status-invalid {\n            color: #dc3545;\n        }\n        .status-empty {\n            color: #ffc107;\n        }\n        .status-extra {\n            color: #17a2b8;\n        }\n        .status-extra-event {\n            color: #dc3545;\n        }\n        .status-extra-field {\n            color: #ffc107;\n        }\n        .filter-section {\n            background-color: #f8f9fa;\n            padding: 15px;\n            margin-bottom: 20px;\n            border-radius: 5px;\n        }\n        .sort-header {\n            cursor: pointer;\n        }\n        .sort-header:hover {\n            background-color: #e9ecef;\n        }\n        .sort-icon {\n            margin-left: 5px;\n        }\n        .filter-dropdown {\n            position: relative;\n            display: inline-block;\n        }\n        .filter-content {\n            display: none;\n            position: absolute;\n            background-color: #f9f9f9;\n            min-width: 200px;\n            max-height: 300px;\n            overflow-y: auto;\n            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\n            z-index: 1000;\n            padding: 10px;\n        }\n        .filter-content.show {\n            display: block;\n        }\n        .filter-checkbox {\n            margin: 5px 0;\n        }\n        .filter-checkbox label {\n            display: block;\n            padding: 5px;\n            cursor: pointer;\n        }\n        .filter-checkbox label:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-header {\n            display: flex;\n            align-items: center;\n            cursor: pointer;\n            padding: 5px;\n        }\n        .filter-header:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-icon {\n            margin-left: 5px;\n        }\n        .filter-actions {\n            margin-top: 10px;\n            padding-top: 10px;\n            border-top: 1px solid #ddd;\n        }\n    </style>\n</head>\n<body>\n    <nav class="navbar navbar-expand-lg navbar-light bg-light">\n        <div class="container-fluid">\n            <a class="navbar-brand" href="#">Netcore Event Payload Validator</a>\n            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">\n                <span class="navbar-toggler-icon"></span>\n            </button>\n            <div class="collapse navbar-collapse" id="navbarNav">\n                <ul class="navbar-nav ms-auto">\n                    <li class="nav-item">\n                        <a class="btn btn-primary" href="https://contact-api-netcore-beta-0-16.onrender.com/" target="_blank">Trigger Activity API</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </nav>\n\n    <div class="container">\n        <h2>Event Validation Tool</h2>\n        \n        <div class="card mb-4">\n            <div class="card-body">\n                <div class="mb-3">\n                    <label class="form-label">Validation Mode</label>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="regularMode" value="regular" checked>\n                        <label class="form-check-label" for="regularMode">\n                            Android and iOS Event (Single Event/Event Payload format)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteMode" value="website">\n                        <label class="form-check-label" for="websiteMode">\n                            Website Logs Validation (JSON lines format with eventname and payload)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteV2Mode" value="website-v2">\n                        <label class="form-check-label" for="websiteV2Mode">\n                            Website Logs V2 Validation (JSON lines format with event key and system fields excluded)\n                        </label>\n                    </div>\n                </div>\n                \n                <form id="uploadForm" enctype="multipart/form-data">\n                    <div class="mb-3">\n                        <label for="csvFile" class="form-label">CSV File (Validation Rules)</label>\n                        <input type="file" class="form-control" id="csvFile" name="csv_file" accept=".csv" required>\n                        <div class="mt-2">\n                            <a href="/download_template" class="btn btn-outline-secondary btn-sm">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Sample Template\n                            </a>\n                        </div>\n                    </div>\n                    <div class="mb-3">\n                        <label for="txtFile" class="form-label">TXT File (Event Logs)</label>\n                        <input type="file" class="form-control" id="txtFile" name="txt_file" accept=".txt" required>\n                        <div class="mt-2 sample-downloads">\n                            <!-- Regular mode sample -->\n                            <a href="/download_sample_log/regular" class="btn btn-outline-secondary btn-sm sample-download regular-mode">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Regular Sample Log\n                            </a>\n                            <!-- Website mode sample -->\n                            <a href="/download_sample_log/website" class="btn btn-outline-secondary btn-sm sample-download website-mode" style="display: none;">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Website Sample Log\n                            </a>\n                            <!-- Website V2 mode samples -->\n                            <div class="v2-mode-downloads" style="display: none;">\n                                <a href="/download_sample_log/website-v2" class="btn btn-outline-secondary btn-sm mb-1">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                    </svg>\n                                    Download Website V2 Sample Log\n                                </a>\n                                <a href="/download_sample_log/website-v2?multiline=true" class="btn btn-outline-secondary btn-sm">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                    </svg>\n                                    Download Website V2 Multiline Sample\n                                </a>\n                            </div>\n                        </div>\n                    </div>\n                    <button type="submit" class="btn btn-primary">Validate</button>\n                </form>\n            </div>\n        </div>\n\n        <div class="filter-section" id="filterSection" style="display: none;">\n            <div class="row mb-3">\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Summary</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>CSV Events:</strong></p>\n                                    <p class="text-primary" id="csvEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Log Events:</strong></p>\n                                    <p class="text-success" id="logEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Details</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Missing Events:</strong></p>\n                                    <p class="text-warning" id="missingEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Extra Events:</strong></p>\n                                    <p class="text-info" id="extraEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <h4>Filters</h4>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="eventName">\n                            Event Name <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="eventNameFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="eventNameSelectAll" checked>\n                                <label for="eventNameSelectAll">Select All</label>\n                            </div>\n                            <div id="eventNameOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'eventName\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'eventName\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="status">\n                            Status <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="statusFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="statusSelectAll" checked>\n                                <label for="statusSelectAll">Select All</label>\n                            </div>\n                            <div id="statusOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'status\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'status\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="expectedType">\n                            Expected Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="expectedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="expectedTypeSelectAll" checked>\n                                <label for="expectedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="expectedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'expectedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'expectedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="receivedType">\n                            Received Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="receivedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="receivedTypeSelectAll" checked>\n                                <label for="receivedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="receivedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'receivedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'receivedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-secondary" id="clearFilters">Clear All Filters</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-success" id="downloadResults">Download Results</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-info" id="downloadValidEvents">Download Valid Events</button>\n                </div>\n            </div>\n        </div>\n\n        <div id="fullyValidEventsSection" class="alert alert-success" style="display:none;">\n            <strong>Events with all payloads valid:</strong>\n            <ul id="fullyValidEventsList" style="margin-bottom:0;"></ul>\n        </div>\n\n        <div class="table-container">\n            <table class="table table-striped" id="resultsTable">\n                <thead>\n                    <tr>\n                        <th class="sort-header" data-sort="eventName">Event Name <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="key">Key <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="value">Value <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="expectedType">Expected Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="receivedType">Received Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="validationStatus">Status <span class="sort-icon">\xe2\x86\x95</span></th>\n                    </tr>\n                </thead>\n                <tbody id="resultsBody"></tbody>\n            </table>\n        </div>\n    </div>\n\n    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/moment/moment.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>\n    <script>\n        let currentResults = [];\n        let currentSummary = {};\n        let currentSort = { field: null, order: \'asc\' };\n        let activeFilters = {\n            eventName: [],\n            status: [],\n            expectedType: [],\n            receivedType: []\n        };\n\n        $(\'#dateRange\').daterangepicker({\n            autoUpdateInput: false,\n            locale: {\n                cancelLabel: \'Clear\'\n            }\n        });\n\n        $(\'#dateRange\').on(\'apply.daterangepicker\', function(ev, picker) {\n            $(this).val(picker.startDate.format(\'MM/DD/YYYY\') + \' - \' + picker.endDate.format(\'MM/DD/YYYY\'));\n            applyFilters();\n        });\n\n        $(\'#dateRange\').on(\'cancel.daterangepicker\', function(ev, picker) {\n            $(this).val(\'\');\n            applyFilters();\n        });\n\n        // Handle validation mode changes\n        $(\'input[name="validationMode"]\').change(function() {\n            const mode = $(this).val();\n            // Hide all sample download buttons first\n            $(\'.sample-download, .v2-mode-downloads\').hide();\n            \n            // Show the appropriate download button based on mode\n            if (mode === \'regular\') {\n                $(\'.sample-download.regular-mode\').show();\n            } else if (mode === \'website\') {\n                $(\'.sample-download.website-mode\').show();\n            } else if (mode === \'website-v2\') {\n                $(\'.v2-mode-downloads\').show();\n            }\n        });\n\n        $(\'#uploadForm\').on(\'submit\', function(e) {\n            e.preventDefault();\n            const formData = new FormData(this);\n            \n            // Determine which endpoint to use based on validation mode\n            const validationMode = $(\'input[name="validationMode"]:checked\').val();\n            let endpoint = \'/upload\';\n            if (validationMode === \'website\') {\n                endpoint = \'/validate-website-logs\';\n            } else if (validationMode === \'website-v2\') {\n                endpoint = \'/validate-website-logs-v2\';\n            }\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + endpoint;\n            \n            console.log(\'Making request to:\', fullUrl);\n            console.log(\'Validation mode:\', validationMode);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: formData,\n                processData: false,\n                contentType: false,\n                success: function(response) {\n                    console.log(\'Upload response:\', response);\n                    \n                    // Handle both old and new response formats\n                    if (response.results && response.summary) {\n                        // New format with summary\n                        currentResults = response.results;\n                        currentSummary = response.summary;\n                        // Store original logs for download feature\n                        window.originalLogs = response.original_logs || {};\n                    } else {\n                        // Old format - just results array\n                        currentResults = response;\n                        currentSummary = {\n                            csv_events_count: 0,\n                            log_events_count: 0,\n                            csv_events: [],\n                            log_events: []\n                        };\n                        window.originalLogs = {};\n                    }\n                    \n                    updateEventSummary();\n                    updateFilters();\n                    displayResults(currentResults);\n                    $(\'#filterSection\').show();\n\n                    if (response.fully_valid_events && response.fully_valid_events.length > 0) {\n                        $(\'#fullyValidEventsList\').empty();\n                        response.fully_valid_events.forEach(function(eventName) {\n                            $(\'#fullyValidEventsList\').append(\'<li>\' + eventName + \'</li>\');\n                        });\n                        $(\'#fullyValidEventsSection\').show();\n                    } else {\n                        $(\'#fullyValidEventsSection\').hide();\n                    }\n                },\n                error: function(xhr) {\n                    console.error(\'Upload error:\', xhr);\n                    alert(\'Error uploading files: \' + xhr.responseText);\n                }\n            });\n        });\n\n        // Initialize filter dropdowns\n        $(document).ready(function() {\n            $(\'.filter-header\').click(function(e) {\n                e.stopPropagation();\n                const filterId = $(this).data(\'filter\');\n                console.log(\'Clicked filter:\', filterId);\n                $(`#${filterId}Filter`).toggleClass(\'show\');\n            });\n\n            // Close filter dropdowns when clicking outside\n            $(document).click(function(e) {\n                if (!$(e.target).closest(\'.filter-dropdown\').length) {\n                    $(\'.filter-content\').removeClass(\'show\');\n                }\n            });\n        });\n\n        function updateEventSummary() {\n            // Update event count displays\n            $(\'#csvEventsCount\').text(currentSummary.csv_events_count || 0);\n            $(\'#logEventsCount\').text(currentSummary.log_events_count || 0);\n            \n            // Calculate missing and extra events\n            const csvEvents = new Set(currentSummary.csv_events || []);\n            const logEvents = new Set(currentSummary.log_events || []);\n            \n            const missingEvents = csvEvents.size - new Set([...csvEvents].filter(x => logEvents.has(x))).size;\n            const extraEvents = logEvents.size - new Set([...logEvents].filter(x => csvEvents.has(x))).size;\n            \n            $(\'#missingEventsCount\').text(missingEvents);\n            $(\'#extraEventsCount\').text(extraEvents);\n        }\n\n        function updateFilters() {\n            const eventNames = new Set();\n            const expectedTypes = new Set();\n            const receivedTypes = new Set();\n            const statuses = new Set();\n            \n            currentResults.forEach(result => {\n                if (result.eventName) eventNames.add(result.eventName);\n                if (result.expectedType) expectedTypes.add(result.expectedType);\n                if (result.receivedType) receivedTypes.add(result.receivedType);\n                if (result.validationStatus) statuses.add(result.validationStatus);\n            });\n\n            console.log(\'Available statuses:\', Array.from(statuses));\n\n            updateFilterOptions(\'eventName\', eventNames);\n            updateFilterOptions(\'status\', statuses);\n            updateFilterOptions(\'expectedType\', expectedTypes);\n            updateFilterOptions(\'receivedType\', receivedTypes);\n        }\n\n        function updateFilterOptions(filterId, values) {\n            const container = $(`#${filterId}Options`);\n            container.empty();\n            \n            console.log(`Updating ${filterId} with values:`, Array.from(values));\n            \n            Array.from(values).sort().forEach(value => {\n                if (value) {\n                    const checkboxId = `${filterId}_${value.replace(/[^a-zA-Z0-9]/g, \'_\')}`;\n                    container.append(`\n                        <div class="filter-checkbox">\n                            <input type="checkbox" id="${checkboxId}" value="${value}" checked>\n                            <label for="${checkboxId}">${value}</label>\n                        </div>\n                    `);\n                }\n            });\n\n            // Update select all checkbox\n            $(`#${filterId}SelectAll`).prop(\'checked\', true);\n        }\n\n        function getSelectedValues(filterId) {\n            return $(`#${filterId}Options input:checked`).map(function() {\n                return $(this).val();\n            }).get();\n        }\n\n        function applyFilter(filterId) {\n            activeFilters[filterId] = getSelectedValues(filterId);\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function clearFilter(filterId) {\n            $(`#${filterId}Options input`).prop(\'checked\', false);\n            $(`#${filterId}SelectAll`).prop(\'checked\', false);\n            activeFilters[filterId] = [];\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function applyFilters() {\n            const filters = {\n                eventName: activeFilters.eventName,\n                validationStatus: activeFilters.status,\n                expectedType: activeFilters.expectedType,\n                receivedType: activeFilters.receivedType\n            };\n\n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/filter\';\n\n            console.log(\'Making filter request to:\', fullUrl);\n\n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({\n                    results: currentResults,\n                    filters: filters,\n                    sort_by: currentSort.field,\n                    sort_order: currentSort.order\n                }),\n                contentType: \'application/json\',\n                success: function(response) {\n                    displayResults(response);\n                    window.filteredResults = response;\n                },\n                error: function(xhr) {\n                    console.error(\'Filter error:\', xhr);\n                    alert(\'Error applying filters: \' + xhr.responseText);\n                }\n            });\n        }\n\n        // Handle select all checkboxes\n        $(\'[id$="SelectAll"]\').change(function() {\n            const filterId = this.id.replace(\'SelectAll\', \'\');\n            $(`#${filterId}Options input`).prop(\'checked\', $(this).prop(\'checked\'));\n        });\n\n        // Update select all checkbox when individual checkboxes change\n        $(\'.filter-content\').on(\'change\', \'input[type="checkbox"]:not([id$="SelectAll"])\', function() {\n            const filterId = $(this).closest(\'.filter-content\').attr(\'id\').replace(\'Filter\', \'\');\n            const allChecked = $(`#${filterId}Options input:checked`).length === $(`#${filterId}Options input`).length;\n            $(`#${filterId}SelectAll`).prop(\'checked\', allChecked);\n        });\n\n        $(\'#clearFilters\').click(function() {\n            $(\'.filter-content input[type="checkbox"]\').prop(\'checked\', false);\n            $(\'[id$="SelectAll"]\').prop(\'checked\', false);\n            Object.keys(activeFilters).forEach(key => {\n                activeFilters[key] = [];\n            });\n            applyFilters();\n        });\n\n        $(\'#downloadResults\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download\';\n            \n            console.log(\'Making download request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ results: resultsToDownload }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'validation_results.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download error:\', xhr);\n                    alert(\'Error downloading results: \' + xhr.responseText);\n                }\n            });\n        });\n\n        $(\'#downloadValidEvents\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download-valid-events\';\n            \n            console.log(\'Making download valid events request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ \n                    results: resultsToDownload,\n                    logs_data: window.originalLogs || {}\n                }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'valid_events_report.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download valid events error:\', xhr);\n                    alert(\'Error downloading valid events: \' + xhr.responseText);\n                }\n            });\n        });\n\n        function displayResults(results) {\n            const tbody = $(\'#resultsBody\');\n            tbody.empty();\n            \n            // Debug log to check results being displayed\n            console.log(\'Displaying results:\', results);\n            \n            results.forEach(result => {\n                const statusClass = getStatusClass(result.validationStatus);\n                tbody.append(`\n                    <tr>\n                        <td>${result.eventName}</td>\n                        <td>${result.key}</td>\n                        <td>${result.value}</td>\n                        <td>${result.expectedType}</td>\n                        <td>${result.receivedType}</td>\n                        <td class="validation-status ${statusClass}">${result.validationStatus}</td>\n                    </tr>\n                `);\n            });\n        }\n\n        function getStatusClass(status) {\n            if (status === \'Valid\') return \'status-valid\';\n            if (status === \'Invalid/Wrong datatype/value\') return \'status-invalid\';\n            if (status === \'Payload value is Empty\') return \'status-empty\';\n            if (status === \'Extra key present in the log\') return \'status-extra\';\n            if (status === \'Extra event present in logs\') return \'status-extra-event\';\n            if (status === \'Field from extra event\') return \'status-extra-field\';\n            if (status === \'Event name not present in the logs\') return \'status-notpresent\';\n            return \'\';\n        }\n\n        $(\'.sort-header\').click(function() {\n            const field = $(this).data(\'sort\');\n            if (currentSort.field === field) {\n                currentSort.order = currentSort.order === \'asc\' ? \'desc\' : \'asc\';\n            } else {\n                currentSort.field = field;\n                currentSort.order = \'asc\';\n            }\n            applyFilters();\n        });\n\n        $(\'#eventNameFilter, #statusFilter, #expectedTypeFilter, #receivedTypeFilter\').change(applyFilters);\n    </script>\n</body>\n</html>'
2025-10-10 12:48:31,583 - INFO - 127.0.0.1 - - [10/Oct/2025 12:48:31] "GET / HTTP/1.1" 200 -
2025-10-10 12:48:41,120 - INFO -  * Detected change in '/Users/allen.thomson/Desktop/sampleapp/automation/validation_script_android/beta2.py', reloading
2025-10-10 12:48:41,188 - INFO -  * Restarting with stat
2025-10-10 12:48:41,399 - WARNING -  * Debugger is active!
2025-10-10 12:48:41,409 - INFO -  * Debugger PIN: 132-353-793
2025-10-10 12:48:42,660 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:48:42,661 - INFO - Body: b''
2025-10-10 12:48:42,661 - INFO - URL: http://localhost:10000/download_template
2025-10-10 12:48:42,662 - INFO - Method: GET
2025-10-10 12:48:42,662 - INFO - Endpoint: download_template
2025-10-10 12:48:42,670 - INFO - 127.0.0.1 - - [10/Oct/2025 12:48:42] "[35m[1mGET /download_template HTTP/1.1[0m" 500 -
2025-10-10 12:48:42,702 - INFO - 127.0.0.1 - - [10/Oct/2025 12:48:42] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 304 -
2025-10-10 12:48:42,703 - INFO - 127.0.0.1 - - [10/Oct/2025 12:48:42] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 304 -
2025-10-10 12:48:42,726 - INFO - 127.0.0.1 - - [10/Oct/2025 12:48:42] "GET /download_template?__debugger__=yes&cmd=resource&f=console.png&s=X8PT8Im89ZdpPeI7gx1o HTTP/1.1" 200 -
2025-10-10 12:48:59,931 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:10000
 * Running on http://172.16.20.191:10000
2025-10-10 12:48:59,931 - INFO - [33mPress CTRL+C to quit[0m
2025-10-10 12:48:59,932 - INFO -  * Restarting with stat
2025-10-10 12:49:00,057 - WARNING -  * Debugger is active!
2025-10-10 12:49:00,062 - INFO -  * Debugger PIN: 132-353-793
2025-10-10 12:49:01,125 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Cache-Control: max-age=0
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:49:01,126 - INFO - Body: b''
2025-10-10 12:49:01,126 - INFO - URL: http://localhost:10000/download_template
2025-10-10 12:49:01,126 - INFO - Method: GET
2025-10-10 12:49:01,126 - INFO - Endpoint: download_template
2025-10-10 12:49:01,146 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:01] "[35m[1mGET /download_template HTTP/1.1[0m" 500 -
2025-10-10 12:49:01,166 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:01] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 304 -
2025-10-10 12:49:01,166 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:01] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 304 -
2025-10-10 12:49:01,176 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:01] "GET /download_template?__debugger__=yes&cmd=resource&f=console.png&s=EL4piAyD3Yp8U9QRbvQw HTTP/1.1" 200 -
2025-10-10 12:49:01,182 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:01] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 304 -
2025-10-10 12:49:02,098 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Cache-Control: max-age=0
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:49:02,099 - INFO - Body: b''
2025-10-10 12:49:02,099 - INFO - URL: http://localhost:10000/download_template
2025-10-10 12:49:02,100 - INFO - Method: GET
2025-10-10 12:49:02,100 - INFO - Endpoint: download_template
2025-10-10 12:49:02,106 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:02] "[35m[1mGET /download_template HTTP/1.1[0m" 500 -
2025-10-10 12:49:02,118 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:02] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 304 -
2025-10-10 12:49:02,120 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:02] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 304 -
2025-10-10 12:49:02,125 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:02] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=console.png&s=EL4piAyD3Yp8U9QRbvQw HTTP/1.1[0m" 304 -
2025-10-10 12:49:02,134 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:02] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 304 -
2025-10-10 12:49:03,307 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Cache-Control: max-age=0
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:49:03,307 - INFO - Body: b''
2025-10-10 12:49:03,307 - INFO - URL: http://localhost:10000/
2025-10-10 12:49:03,307 - INFO - Method: GET
2025-10-10 12:49:03,307 - INFO - Endpoint: index
2025-10-10 12:49:03,316 - INFO - Response: b'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Event Validation Tool</title>\n    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">\n    <link href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" rel="stylesheet">\n    <style>\n        :root {\n            --primary-color: #e35502;\n            --header-bg: #230f2e;\n        }\n        \n        .container { margin-top: 30px; }\n        .table-container { margin-top: 20px; }\n        .filter-container { margin: 20px 0; }\n        .hidden { display: none; }\n        .first-event { color: blue; }\n        \n        /* Header styling */\n        .navbar {\n            background-color: var(--header-bg) !important;\n        }\n        \n        .navbar-brand, .navbar-nav .nav-link {\n            color: white !important;\n        }\n        \n        .navbar-toggler {\n            border-color: rgba(255,255,255,0.5);\n        }\n        \n        .navbar-toggler-icon {\n            background-image: url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 30 30\'%3e%3cpath stroke=\'rgba%28255, 255, 255, 0.75%29\' stroke-linecap=\'round\' stroke-miterlimit=\'10\' stroke-width=\'2\' d=\'M4 7h22M4 15h22M4 23h22\'/%3e%3c/svg%3e");\n        }\n        \n        /* Button styling */\n        .btn-primary {\n            background-color: var(--primary-color) !important;\n            border-color: var(--primary-color) !important;\n        }\n        \n        .btn-primary:hover {\n            background-color: #c64802 !important;\n            border-color: #c64802 !important;\n        }\n        \n        .btn-outline-primary {\n            color: white !important;\n            border-color: white !important;\n        }\n        \n        .btn-outline-primary:hover {\n            background-color: rgba(255,255,255,0.1) !important;\n        }\n        .null-value { background-color: yellow; }\n        .valid-status { color: green; }\n        .invalid-status { color: red; }\n        .empty-status { color: orange; }\n        .not-present { color: darkolivegreen; }\n        .extra-key { color: rgb(24, 214, 185); }\n        .type-mismatch { background-color: #ffe6e6; }\n        .download-section {\n            margin: 20px 0;\n            text-align: right;\n        }\n        /* Status color coding */\n        .status-valid { background-color: #d4edda !important; color: #155724 !important; }\n        .status-invalid { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-empty { background-color: #fff3cd !important; color: #856404 !important; }\n        .status-extra { background-color: #d1ecf1 !important; color: #0c5460 !important; }\n        .status-notpresent { background-color: #042508 !important; color: #7f7b97 !important; }\n        .status-csv { background-color: #e2e3e5 !important; color: #383d41 !important; }\n        .status-extra-event { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-extra-field { background-color: #fff3cd !important; color: #856404 !important; }\n        .validation-status {\n            font-weight: bold;\n        }\n        .status-valid {\n            color: #28a745;\n        }\n        .status-invalid {\n            color: #dc3545;\n        }\n        .status-empty {\n            color: #ffc107;\n        }\n        .status-extra {\n            color: #17a2b8;\n        }\n        .status-extra-event {\n            color: #dc3545;\n        }\n        .status-extra-field {\n            color: #ffc107;\n        }\n        .filter-section {\n            background-color: #f8f9fa;\n            padding: 15px;\n            margin-bottom: 20px;\n            border-radius: 5px;\n        }\n        .sort-header {\n            cursor: pointer;\n        }\n        .sort-header:hover {\n            background-color: #e9ecef;\n        }\n        .sort-icon {\n            margin-left: 5px;\n        }\n        .filter-dropdown {\n            position: relative;\n            display: inline-block;\n        }\n        .filter-content {\n            display: none;\n            position: absolute;\n            background-color: #f9f9f9;\n            min-width: 200px;\n            max-height: 300px;\n            overflow-y: auto;\n            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\n            z-index: 1000;\n            padding: 10px;\n        }\n        .filter-content.show {\n            display: block;\n        }\n        .filter-checkbox {\n            margin: 5px 0;\n        }\n        .filter-checkbox label {\n            display: block;\n            padding: 5px;\n            cursor: pointer;\n        }\n        .filter-checkbox label:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-header {\n            display: flex;\n            align-items: center;\n            cursor: pointer;\n            padding: 5px;\n        }\n        .filter-header:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-icon {\n            margin-left: 5px;\n        }\n        .filter-actions {\n            margin-top: 10px;\n            padding-top: 10px;\n            border-top: 1px solid #ddd;\n        }\n    </style>\n</head>\n<body>\n    <nav class="navbar navbar-expand-lg navbar-light bg-light">\n        <div class="container-fluid">\n            <a class="navbar-brand" href="#">Netcore Event Payload Validator</a>\n            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">\n                <span class="navbar-toggler-icon"></span>\n            </button>\n            <div class="collapse navbar-collapse" id="navbarNav">\n                <ul class="navbar-nav ms-auto">\n                    <li class="nav-item">\n                        <a class="btn btn-primary" href="https://contact-api-netcore-beta-0-16.onrender.com/" target="_blank">Trigger Activity API</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </nav>\n\n    <div class="container">\n        <h2>Event Validation Tool</h2>\n        \n        <div class="card mb-4">\n            <div class="card-body">\n                <div class="mb-3">\n                    <label class="form-label">Validation Mode</label>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="regularMode" value="regular" checked>\n                        <label class="form-check-label" for="regularMode">\n                            Android and iOS Event (Single Event/Event Payload format)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteMode" value="website">\n                        <label class="form-check-label" for="websiteMode">\n                            Website Logs Validation (JSON lines format with eventname and payload)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteV2Mode" value="website-v2">\n                        <label class="form-check-label" for="websiteV2Mode">\n                            Website Logs V2 Validation (JSON lines format with event key and system fields excluded)\n                        </label>\n                    </div>\n                </div>\n                \n                <form id="uploadForm" enctype="multipart/form-data">\n                    <div class="mb-3">\n                        <label for="csvFile" class="form-label">CSV File (Validation Rules)</label>\n                        <input type="file" class="form-control" id="csvFile" name="csv_file" accept=".csv" required>\n                        <div class="mt-2">\n                            <a href="/download_template" class="btn btn-outline-secondary btn-sm">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Sample Template\n                            </a>\n                        </div>\n                    </div>\n                    <div class="mb-3">\n                        <label for="txtFile" class="form-label">TXT File (Event Logs)</label>\n                        <input type="file" class="form-control" id="txtFile" name="txt_file" accept=".txt" required>\n                        <div class="mt-2 sample-downloads">\n                            <!-- Regular mode sample -->\n                            <a href="/download_sample_log/regular" class="btn btn-outline-secondary btn-sm sample-download regular-mode">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Regular Sample Log\n                            </a>\n                            <!-- Website mode sample -->\n                            <a href="/download_sample_log/website" class="btn btn-outline-secondary btn-sm sample-download website-mode" style="display: none;">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Website Sample Log\n                            </a>\n                            <!-- Website V2 mode samples -->\n                            <div class="v2-mode-downloads" style="display: none;">\n                                <a href="/download_sample_log/website-v2" class="btn btn-outline-secondary btn-sm mb-1">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                    </svg>\n                                    Download Website V2 Sample Log\n                                </a>\n                                <a href="/download_sample_log/website-v2?multiline=true" class="btn btn-outline-secondary btn-sm">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                    </svg>\n                                    Download Website V2 Multiline Sample\n                                </a>\n                            </div>\n                        </div>\n                    </div>\n                    <button type="submit" class="btn btn-primary">Validate</button>\n                </form>\n            </div>\n        </div>\n\n        <div class="filter-section" id="filterSection" style="display: none;">\n            <div class="row mb-3">\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Summary</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>CSV Events:</strong></p>\n                                    <p class="text-primary" id="csvEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Log Events:</strong></p>\n                                    <p class="text-success" id="logEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Details</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Missing Events:</strong></p>\n                                    <p class="text-warning" id="missingEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Extra Events:</strong></p>\n                                    <p class="text-info" id="extraEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <h4>Filters</h4>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="eventName">\n                            Event Name <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="eventNameFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="eventNameSelectAll" checked>\n                                <label for="eventNameSelectAll">Select All</label>\n                            </div>\n                            <div id="eventNameOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'eventName\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'eventName\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="status">\n                            Status <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="statusFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="statusSelectAll" checked>\n                                <label for="statusSelectAll">Select All</label>\n                            </div>\n                            <div id="statusOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'status\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'status\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="expectedType">\n                            Expected Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="expectedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="expectedTypeSelectAll" checked>\n                                <label for="expectedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="expectedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'expectedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'expectedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="receivedType">\n                            Received Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="receivedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="receivedTypeSelectAll" checked>\n                                <label for="receivedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="receivedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'receivedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'receivedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-secondary" id="clearFilters">Clear All Filters</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-success" id="downloadResults">Download Results</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-info" id="downloadValidEvents">Download Valid Events</button>\n                </div>\n            </div>\n        </div>\n\n        <div id="fullyValidEventsSection" class="alert alert-success" style="display:none;">\n            <strong>Events with all payloads valid:</strong>\n            <ul id="fullyValidEventsList" style="margin-bottom:0;"></ul>\n        </div>\n\n        <div class="table-container">\n            <table class="table table-striped" id="resultsTable">\n                <thead>\n                    <tr>\n                        <th class="sort-header" data-sort="eventName">Event Name <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="key">Key <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="value">Value <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="expectedType">Expected Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="receivedType">Received Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="validationStatus">Status <span class="sort-icon">\xe2\x86\x95</span></th>\n                    </tr>\n                </thead>\n                <tbody id="resultsBody"></tbody>\n            </table>\n        </div>\n    </div>\n\n    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/moment/moment.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>\n    <script>\n        let currentResults = [];\n        let currentSummary = {};\n        let currentSort = { field: null, order: \'asc\' };\n        let activeFilters = {\n            eventName: [],\n            status: [],\n            expectedType: [],\n            receivedType: []\n        };\n\n        $(\'#dateRange\').daterangepicker({\n            autoUpdateInput: false,\n            locale: {\n                cancelLabel: \'Clear\'\n            }\n        });\n\n        $(\'#dateRange\').on(\'apply.daterangepicker\', function(ev, picker) {\n            $(this).val(picker.startDate.format(\'MM/DD/YYYY\') + \' - \' + picker.endDate.format(\'MM/DD/YYYY\'));\n            applyFilters();\n        });\n\n        $(\'#dateRange\').on(\'cancel.daterangepicker\', function(ev, picker) {\n            $(this).val(\'\');\n            applyFilters();\n        });\n\n        // Handle validation mode changes\n        $(\'input[name="validationMode"]\').change(function() {\n            const mode = $(this).val();\n            // Hide all sample download buttons first\n            $(\'.sample-download, .v2-mode-downloads\').hide();\n            \n            // Show the appropriate download button based on mode\n            if (mode === \'regular\') {\n                $(\'.sample-download.regular-mode\').show();\n            } else if (mode === \'website\') {\n                $(\'.sample-download.website-mode\').show();\n            } else if (mode === \'website-v2\') {\n                $(\'.v2-mode-downloads\').show();\n            }\n        });\n\n        $(\'#uploadForm\').on(\'submit\', function(e) {\n            e.preventDefault();\n            const formData = new FormData(this);\n            \n            // Determine which endpoint to use based on validation mode\n            const validationMode = $(\'input[name="validationMode"]:checked\').val();\n            let endpoint = \'/upload\';\n            if (validationMode === \'website\') {\n                endpoint = \'/validate-website-logs\';\n            } else if (validationMode === \'website-v2\') {\n                endpoint = \'/validate-website-logs-v2\';\n            }\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + endpoint;\n            \n            console.log(\'Making request to:\', fullUrl);\n            console.log(\'Validation mode:\', validationMode);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: formData,\n                processData: false,\n                contentType: false,\n                success: function(response) {\n                    console.log(\'Upload response:\', response);\n                    \n                    // Handle both old and new response formats\n                    if (response.results && response.summary) {\n                        // New format with summary\n                        currentResults = response.results;\n                        currentSummary = response.summary;\n                        // Store original logs for download feature\n                        window.originalLogs = response.original_logs || {};\n                    } else {\n                        // Old format - just results array\n                        currentResults = response;\n                        currentSummary = {\n                            csv_events_count: 0,\n                            log_events_count: 0,\n                            csv_events: [],\n                            log_events: []\n                        };\n                        window.originalLogs = {};\n                    }\n                    \n                    updateEventSummary();\n                    updateFilters();\n                    displayResults(currentResults);\n                    $(\'#filterSection\').show();\n\n                    if (response.fully_valid_events && response.fully_valid_events.length > 0) {\n                        $(\'#fullyValidEventsList\').empty();\n                        response.fully_valid_events.forEach(function(eventName) {\n                            $(\'#fullyValidEventsList\').append(\'<li>\' + eventName + \'</li>\');\n                        });\n                        $(\'#fullyValidEventsSection\').show();\n                    } else {\n                        $(\'#fullyValidEventsSection\').hide();\n                    }\n                },\n                error: function(xhr) {\n                    console.error(\'Upload error:\', xhr);\n                    alert(\'Error uploading files: \' + xhr.responseText);\n                }\n            });\n        });\n\n        // Initialize filter dropdowns\n        $(document).ready(function() {\n            $(\'.filter-header\').click(function(e) {\n                e.stopPropagation();\n                const filterId = $(this).data(\'filter\');\n                console.log(\'Clicked filter:\', filterId);\n                $(`#${filterId}Filter`).toggleClass(\'show\');\n            });\n\n            // Close filter dropdowns when clicking outside\n            $(document).click(function(e) {\n                if (!$(e.target).closest(\'.filter-dropdown\').length) {\n                    $(\'.filter-content\').removeClass(\'show\');\n                }\n            });\n        });\n\n        function updateEventSummary() {\n            // Update event count displays\n            $(\'#csvEventsCount\').text(currentSummary.csv_events_count || 0);\n            $(\'#logEventsCount\').text(currentSummary.log_events_count || 0);\n            \n            // Calculate missing and extra events\n            const csvEvents = new Set(currentSummary.csv_events || []);\n            const logEvents = new Set(currentSummary.log_events || []);\n            \n            const missingEvents = csvEvents.size - new Set([...csvEvents].filter(x => logEvents.has(x))).size;\n            const extraEvents = logEvents.size - new Set([...logEvents].filter(x => csvEvents.has(x))).size;\n            \n            $(\'#missingEventsCount\').text(missingEvents);\n            $(\'#extraEventsCount\').text(extraEvents);\n        }\n\n        function updateFilters() {\n            const eventNames = new Set();\n            const expectedTypes = new Set();\n            const receivedTypes = new Set();\n            const statuses = new Set();\n            \n            currentResults.forEach(result => {\n                if (result.eventName) eventNames.add(result.eventName);\n                if (result.expectedType) expectedTypes.add(result.expectedType);\n                if (result.receivedType) receivedTypes.add(result.receivedType);\n                if (result.validationStatus) statuses.add(result.validationStatus);\n            });\n\n            console.log(\'Available statuses:\', Array.from(statuses));\n\n            updateFilterOptions(\'eventName\', eventNames);\n            updateFilterOptions(\'status\', statuses);\n            updateFilterOptions(\'expectedType\', expectedTypes);\n            updateFilterOptions(\'receivedType\', receivedTypes);\n        }\n\n        function updateFilterOptions(filterId, values) {\n            const container = $(`#${filterId}Options`);\n            container.empty();\n            \n            console.log(`Updating ${filterId} with values:`, Array.from(values));\n            \n            Array.from(values).sort().forEach(value => {\n                if (value) {\n                    const checkboxId = `${filterId}_${value.replace(/[^a-zA-Z0-9]/g, \'_\')}`;\n                    container.append(`\n                        <div class="filter-checkbox">\n                            <input type="checkbox" id="${checkboxId}" value="${value}" checked>\n                            <label for="${checkboxId}">${value}</label>\n                        </div>\n                    `);\n                }\n            });\n\n            // Update select all checkbox\n            $(`#${filterId}SelectAll`).prop(\'checked\', true);\n        }\n\n        function getSelectedValues(filterId) {\n            return $(`#${filterId}Options input:checked`).map(function() {\n                return $(this).val();\n            }).get();\n        }\n\n        function applyFilter(filterId) {\n            activeFilters[filterId] = getSelectedValues(filterId);\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function clearFilter(filterId) {\n            $(`#${filterId}Options input`).prop(\'checked\', false);\n            $(`#${filterId}SelectAll`).prop(\'checked\', false);\n            activeFilters[filterId] = [];\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function applyFilters() {\n            const filters = {\n                eventName: activeFilters.eventName,\n                validationStatus: activeFilters.status,\n                expectedType: activeFilters.expectedType,\n                receivedType: activeFilters.receivedType\n            };\n\n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/filter\';\n\n            console.log(\'Making filter request to:\', fullUrl);\n\n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({\n                    results: currentResults,\n                    filters: filters,\n                    sort_by: currentSort.field,\n                    sort_order: currentSort.order\n                }),\n                contentType: \'application/json\',\n                success: function(response) {\n                    displayResults(response);\n                    window.filteredResults = response;\n                },\n                error: function(xhr) {\n                    console.error(\'Filter error:\', xhr);\n                    alert(\'Error applying filters: \' + xhr.responseText);\n                }\n            });\n        }\n\n        // Handle select all checkboxes\n        $(\'[id$="SelectAll"]\').change(function() {\n            const filterId = this.id.replace(\'SelectAll\', \'\');\n            $(`#${filterId}Options input`).prop(\'checked\', $(this).prop(\'checked\'));\n        });\n\n        // Update select all checkbox when individual checkboxes change\n        $(\'.filter-content\').on(\'change\', \'input[type="checkbox"]:not([id$="SelectAll"])\', function() {\n            const filterId = $(this).closest(\'.filter-content\').attr(\'id\').replace(\'Filter\', \'\');\n            const allChecked = $(`#${filterId}Options input:checked`).length === $(`#${filterId}Options input`).length;\n            $(`#${filterId}SelectAll`).prop(\'checked\', allChecked);\n        });\n\n        $(\'#clearFilters\').click(function() {\n            $(\'.filter-content input[type="checkbox"]\').prop(\'checked\', false);\n            $(\'[id$="SelectAll"]\').prop(\'checked\', false);\n            Object.keys(activeFilters).forEach(key => {\n                activeFilters[key] = [];\n            });\n            applyFilters();\n        });\n\n        $(\'#downloadResults\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download\';\n            \n            console.log(\'Making download request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ results: resultsToDownload }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'validation_results.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download error:\', xhr);\n                    alert(\'Error downloading results: \' + xhr.responseText);\n                }\n            });\n        });\n\n        $(\'#downloadValidEvents\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download-valid-events\';\n            \n            console.log(\'Making download valid events request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ \n                    results: resultsToDownload,\n                    logs_data: window.originalLogs || {}\n                }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'valid_events_report.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download valid events error:\', xhr);\n                    alert(\'Error downloading valid events: \' + xhr.responseText);\n                }\n            });\n        });\n\n        function displayResults(results) {\n            const tbody = $(\'#resultsBody\');\n            tbody.empty();\n            \n            // Debug log to check results being displayed\n            console.log(\'Displaying results:\', results);\n            \n            results.forEach(result => {\n                const statusClass = getStatusClass(result.validationStatus);\n                tbody.append(`\n                    <tr>\n                        <td>${result.eventName}</td>\n                        <td>${result.key}</td>\n                        <td>${result.value}</td>\n                        <td>${result.expectedType}</td>\n                        <td>${result.receivedType}</td>\n                        <td class="validation-status ${statusClass}">${result.validationStatus}</td>\n                    </tr>\n                `);\n            });\n        }\n\n        function getStatusClass(status) {\n            if (status === \'Valid\') return \'status-valid\';\n            if (status === \'Invalid/Wrong datatype/value\') return \'status-invalid\';\n            if (status === \'Payload value is Empty\') return \'status-empty\';\n            if (status === \'Extra key present in the log\') return \'status-extra\';\n            if (status === \'Extra event present in logs\') return \'status-extra-event\';\n            if (status === \'Field from extra event\') return \'status-extra-field\';\n            if (status === \'Event name not present in the logs\') return \'status-notpresent\';\n            return \'\';\n        }\n\n        $(\'.sort-header\').click(function() {\n            const field = $(this).data(\'sort\');\n            if (currentSort.field === field) {\n                currentSort.order = currentSort.order === \'asc\' ? \'desc\' : \'asc\';\n            } else {\n                currentSort.field = field;\n                currentSort.order = \'asc\';\n            }\n            applyFilters();\n        });\n\n        $(\'#eventNameFilter, #statusFilter, #expectedTypeFilter, #receivedTypeFilter\').change(applyFilters);\n    </script>\n</body>\n</html>'
2025-10-10 12:49:03,316 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:03] "GET / HTTP/1.1" 200 -
2025-10-10 12:49:04,145 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:49:04,146 - INFO - Body: b''
2025-10-10 12:49:04,146 - INFO - URL: http://localhost:10000/download_template
2025-10-10 12:49:04,146 - INFO - Method: GET
2025-10-10 12:49:04,146 - INFO - Endpoint: download_template
2025-10-10 12:49:04,153 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:04] "[35m[1mGET /download_template HTTP/1.1[0m" 500 -
2025-10-10 12:49:04,163 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:04] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 304 -
2025-10-10 12:49:04,165 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:04] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 304 -
2025-10-10 12:49:04,174 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:04] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=console.png&s=EL4piAyD3Yp8U9QRbvQw HTTP/1.1[0m" 304 -
2025-10-10 12:49:05,963 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:49:05,964 - INFO - Body: b''
2025-10-10 12:49:05,964 - INFO - URL: http://localhost:10000/download_template
2025-10-10 12:49:05,964 - INFO - Method: GET
2025-10-10 12:49:05,964 - INFO - Endpoint: download_template
2025-10-10 12:49:05,968 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:05] "[35m[1mGET /download_template HTTP/1.1[0m" 500 -
2025-10-10 12:49:05,980 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:05] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 304 -
2025-10-10 12:49:05,983 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:05] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 304 -
2025-10-10 12:49:05,992 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:05] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=console.png&s=EL4piAyD3Yp8U9QRbvQw HTTP/1.1[0m" 304 -
2025-10-10 12:49:17,262 - INFO -  * Detected change in '/Users/allen.thomson/Desktop/sampleapp/automation/validation_script_android/beta2.py', reloading
2025-10-10 12:49:17,322 - INFO -  * Restarting with stat
2025-10-10 12:49:17,495 - WARNING -  * Debugger is active!
2025-10-10 12:49:17,500 - INFO -  * Debugger PIN: 132-353-793
2025-10-10 12:49:26,555 - INFO -  * Detected change in '/Users/allen.thomson/Desktop/sampleapp/automation/validation_script_android/beta2.py', reloading
2025-10-10 12:49:26,609 - INFO -  * Restarting with stat
2025-10-10 12:49:26,776 - WARNING -  * Debugger is active!
2025-10-10 12:49:26,782 - INFO -  * Debugger PIN: 132-353-793
2025-10-10 12:49:30,815 - INFO -  * Detected change in '/Users/allen.thomson/Desktop/sampleapp/automation/validation_script_android/beta2.py', reloading
2025-10-10 12:49:30,849 - INFO -  * Restarting with stat
2025-10-10 12:49:31,035 - WARNING -  * Debugger is active!
2025-10-10 12:49:31,040 - INFO -  * Debugger PIN: 132-353-793
2025-10-10 12:49:36,650 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:10000
 * Running on http://172.16.20.191:10000
2025-10-10 12:49:36,650 - INFO - [33mPress CTRL+C to quit[0m
2025-10-10 12:49:36,651 - INFO -  * Restarting with stat
2025-10-10 12:49:36,777 - WARNING -  * Debugger is active!
2025-10-10 12:49:36,786 - INFO -  * Debugger PIN: 132-353-793
2025-10-10 12:49:37,960 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Cache-Control: max-age=0
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:49:37,961 - INFO - Body: b''
2025-10-10 12:49:37,961 - INFO - URL: http://localhost:10000/
2025-10-10 12:49:37,961 - INFO - Method: GET
2025-10-10 12:49:37,961 - INFO - Endpoint: index
2025-10-10 12:49:37,966 - INFO - Response: b'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Event Validation Tool</title>\n    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">\n    <link href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" rel="stylesheet">\n    <style>\n        :root {\n            --primary-color: #e35502;\n            --header-bg: #230f2e;\n        }\n        \n        .container { margin-top: 30px; }\n        .table-container { margin-top: 20px; }\n        .filter-container { margin: 20px 0; }\n        .hidden { display: none; }\n        .first-event { color: blue; }\n        \n        /* Header styling */\n        .navbar {\n            background-color: var(--header-bg) !important;\n        }\n        \n        .navbar-brand, .navbar-nav .nav-link {\n            color: white !important;\n        }\n        \n        .navbar-toggler {\n            border-color: rgba(255,255,255,0.5);\n        }\n        \n        .navbar-toggler-icon {\n            background-image: url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 30 30\'%3e%3cpath stroke=\'rgba%28255, 255, 255, 0.75%29\' stroke-linecap=\'round\' stroke-miterlimit=\'10\' stroke-width=\'2\' d=\'M4 7h22M4 15h22M4 23h22\'/%3e%3c/svg%3e");\n        }\n        \n        /* Button styling */\n        .btn-primary {\n            background-color: var(--primary-color) !important;\n            border-color: var(--primary-color) !important;\n        }\n        \n        .btn-primary:hover {\n            background-color: #c64802 !important;\n            border-color: #c64802 !important;\n        }\n        \n        .btn-outline-primary {\n            color: white !important;\n            border-color: white !important;\n        }\n        \n        .btn-outline-primary:hover {\n            background-color: rgba(255,255,255,0.1) !important;\n        }\n        .null-value { background-color: yellow; }\n        .valid-status { color: green; }\n        .invalid-status { color: red; }\n        .empty-status { color: orange; }\n        .not-present { color: darkolivegreen; }\n        .extra-key { color: rgb(24, 214, 185); }\n        .type-mismatch { background-color: #ffe6e6; }\n        .download-section {\n            margin: 20px 0;\n            text-align: right;\n        }\n        /* Status color coding */\n        .status-valid { background-color: #d4edda !important; color: #155724 !important; }\n        .status-invalid { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-empty { background-color: #fff3cd !important; color: #856404 !important; }\n        .status-extra { background-color: #d1ecf1 !important; color: #0c5460 !important; }\n        .status-notpresent { background-color: #042508 !important; color: #7f7b97 !important; }\n        .status-csv { background-color: #e2e3e5 !important; color: #383d41 !important; }\n        .status-extra-event { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-extra-field { background-color: #fff3cd !important; color: #856404 !important; }\n        .validation-status {\n            font-weight: bold;\n        }\n        .status-valid {\n            color: #28a745;\n        }\n        .status-invalid {\n            color: #dc3545;\n        }\n        .status-empty {\n            color: #ffc107;\n        }\n        .status-extra {\n            color: #17a2b8;\n        }\n        .status-extra-event {\n            color: #dc3545;\n        }\n        .status-extra-field {\n            color: #ffc107;\n        }\n        .filter-section {\n            background-color: #f8f9fa;\n            padding: 15px;\n            margin-bottom: 20px;\n            border-radius: 5px;\n        }\n        .sort-header {\n            cursor: pointer;\n        }\n        .sort-header:hover {\n            background-color: #e9ecef;\n        }\n        .sort-icon {\n            margin-left: 5px;\n        }\n        .filter-dropdown {\n            position: relative;\n            display: inline-block;\n        }\n        .filter-content {\n            display: none;\n            position: absolute;\n            background-color: #f9f9f9;\n            min-width: 200px;\n            max-height: 300px;\n            overflow-y: auto;\n            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\n            z-index: 1000;\n            padding: 10px;\n        }\n        .filter-content.show {\n            display: block;\n        }\n        .filter-checkbox {\n            margin: 5px 0;\n        }\n        .filter-checkbox label {\n            display: block;\n            padding: 5px;\n            cursor: pointer;\n        }\n        .filter-checkbox label:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-header {\n            display: flex;\n            align-items: center;\n            cursor: pointer;\n            padding: 5px;\n        }\n        .filter-header:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-icon {\n            margin-left: 5px;\n        }\n        .filter-actions {\n            margin-top: 10px;\n            padding-top: 10px;\n            border-top: 1px solid #ddd;\n        }\n    </style>\n</head>\n<body>\n    <nav class="navbar navbar-expand-lg navbar-light bg-light">\n        <div class="container-fluid">\n            <a class="navbar-brand" href="#">Netcore Event Payload Validator</a>\n            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">\n                <span class="navbar-toggler-icon"></span>\n            </button>\n            <div class="collapse navbar-collapse" id="navbarNav">\n                <ul class="navbar-nav ms-auto">\n                    <li class="nav-item">\n                        <a class="btn btn-primary" href="https://contact-api-netcore-beta-0-16.onrender.com/" target="_blank">Trigger Activity API</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </nav>\n\n    <div class="container">\n        <h2>Event Validation Tool</h2>\n        \n        <div class="card mb-4">\n            <div class="card-body">\n                <div class="mb-3">\n                    <label class="form-label">Validation Mode</label>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="regularMode" value="regular" checked>\n                        <label class="form-check-label" for="regularMode">\n                            Android and iOS Event (Single Event/Event Payload format)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteMode" value="website">\n                        <label class="form-check-label" for="websiteMode">\n                            Website Logs Validation (JSON lines format with eventname and payload)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteV2Mode" value="website-v2">\n                        <label class="form-check-label" for="websiteV2Mode">\n                            Website Logs V2 Validation (JSON lines format with event key and system fields excluded)\n                        </label>\n                    </div>\n                </div>\n                \n                <form id="uploadForm" enctype="multipart/form-data">\n                    <div class="mb-3">\n                        <label for="csvFile" class="form-label">CSV File (Validation Rules)</label>\n                        <input type="file" class="form-control" id="csvFile" name="csv_file" accept=".csv" required>\n                        <div class="mt-2">\n                            <a href="/download_template" class="btn btn-outline-secondary btn-sm">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Sample Template\n                            </a>\n                        </div>\n                    </div>\n                    <div class="mb-3">\n                        <label for="txtFile" class="form-label">TXT File (Event Logs)</label>\n                        <input type="file" class="form-control" id="txtFile" name="txt_file" accept=".txt" required>\n                        <div class="mt-2 sample-downloads">\n                            <!-- Regular mode sample -->\n                            <a href="/download_sample_log/regular" class="btn btn-outline-secondary btn-sm sample-download regular-mode">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Regular Sample Log\n                            </a>\n                            <!-- Website mode sample -->\n                            <a href="/download_sample_log/website" class="btn btn-outline-secondary btn-sm sample-download website-mode" style="display: none;">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Website Sample Log\n                            </a>\n                            <!-- Website V2 mode samples -->\n                            <div class="v2-mode-downloads" style="display: none;">\n                                <a href="/download_sample_log/website-v2" class="btn btn-outline-secondary btn-sm mb-1">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                    </svg>\n                                    Download Website V2 Sample Log\n                                </a>\n                                <a href="/download_sample_log/website-v2?multiline=true" class="btn btn-outline-secondary btn-sm">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                    </svg>\n                                    Download Website V2 Multiline Sample\n                                </a>\n                            </div>\n                        </div>\n                    </div>\n                    <button type="submit" class="btn btn-primary">Validate</button>\n                </form>\n            </div>\n        </div>\n\n        <div class="filter-section" id="filterSection" style="display: none;">\n            <div class="row mb-3">\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Summary</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>CSV Events:</strong></p>\n                                    <p class="text-primary" id="csvEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Log Events:</strong></p>\n                                    <p class="text-success" id="logEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Details</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Missing Events:</strong></p>\n                                    <p class="text-warning" id="missingEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Extra Events:</strong></p>\n                                    <p class="text-info" id="extraEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <h4>Filters</h4>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="eventName">\n                            Event Name <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="eventNameFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="eventNameSelectAll" checked>\n                                <label for="eventNameSelectAll">Select All</label>\n                            </div>\n                            <div id="eventNameOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'eventName\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'eventName\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="status">\n                            Status <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="statusFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="statusSelectAll" checked>\n                                <label for="statusSelectAll">Select All</label>\n                            </div>\n                            <div id="statusOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'status\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'status\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="expectedType">\n                            Expected Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="expectedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="expectedTypeSelectAll" checked>\n                                <label for="expectedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="expectedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'expectedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'expectedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="receivedType">\n                            Received Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="receivedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="receivedTypeSelectAll" checked>\n                                <label for="receivedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="receivedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'receivedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'receivedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-secondary" id="clearFilters">Clear All Filters</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-success" id="downloadResults">Download Results</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-info" id="downloadValidEvents">Download Valid Events</button>\n                </div>\n            </div>\n        </div>\n\n        <div id="fullyValidEventsSection" class="alert alert-success" style="display:none;">\n            <strong>Events with all payloads valid:</strong>\n            <ul id="fullyValidEventsList" style="margin-bottom:0;"></ul>\n        </div>\n\n        <div class="table-container">\n            <table class="table table-striped" id="resultsTable">\n                <thead>\n                    <tr>\n                        <th class="sort-header" data-sort="eventName">Event Name <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="key">Key <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="value">Value <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="expectedType">Expected Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="receivedType">Received Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="validationStatus">Status <span class="sort-icon">\xe2\x86\x95</span></th>\n                    </tr>\n                </thead>\n                <tbody id="resultsBody"></tbody>\n            </table>\n        </div>\n    </div>\n\n    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/moment/moment.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>\n    <script>\n        let currentResults = [];\n        let currentSummary = {};\n        let currentSort = { field: null, order: \'asc\' };\n        let activeFilters = {\n            eventName: [],\n            status: [],\n            expectedType: [],\n            receivedType: []\n        };\n\n        $(\'#dateRange\').daterangepicker({\n            autoUpdateInput: false,\n            locale: {\n                cancelLabel: \'Clear\'\n            }\n        });\n\n        $(\'#dateRange\').on(\'apply.daterangepicker\', function(ev, picker) {\n            $(this).val(picker.startDate.format(\'MM/DD/YYYY\') + \' - \' + picker.endDate.format(\'MM/DD/YYYY\'));\n            applyFilters();\n        });\n\n        $(\'#dateRange\').on(\'cancel.daterangepicker\', function(ev, picker) {\n            $(this).val(\'\');\n            applyFilters();\n        });\n\n        // Handle validation mode changes\n        $(\'input[name="validationMode"]\').change(function() {\n            const mode = $(this).val();\n            // Hide all sample download buttons first\n            $(\'.sample-download, .v2-mode-downloads\').hide();\n            \n            // Show the appropriate download button based on mode\n            if (mode === \'regular\') {\n                $(\'.sample-download.regular-mode\').show();\n            } else if (mode === \'website\') {\n                $(\'.sample-download.website-mode\').show();\n            } else if (mode === \'website-v2\') {\n                $(\'.v2-mode-downloads\').show();\n            }\n        });\n\n        $(\'#uploadForm\').on(\'submit\', function(e) {\n            e.preventDefault();\n            const formData = new FormData(this);\n            \n            // Determine which endpoint to use based on validation mode\n            const validationMode = $(\'input[name="validationMode"]:checked\').val();\n            let endpoint = \'/upload\';\n            if (validationMode === \'website\') {\n                endpoint = \'/validate-website-logs\';\n            } else if (validationMode === \'website-v2\') {\n                endpoint = \'/validate-website-logs-v2\';\n            }\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + endpoint;\n            \n            console.log(\'Making request to:\', fullUrl);\n            console.log(\'Validation mode:\', validationMode);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: formData,\n                processData: false,\n                contentType: false,\n                success: function(response) {\n                    console.log(\'Upload response:\', response);\n                    \n                    // Handle both old and new response formats\n                    if (response.results && response.summary) {\n                        // New format with summary\n                        currentResults = response.results;\n                        currentSummary = response.summary;\n                        // Store original logs for download feature\n                        window.originalLogs = response.original_logs || {};\n                    } else {\n                        // Old format - just results array\n                        currentResults = response;\n                        currentSummary = {\n                            csv_events_count: 0,\n                            log_events_count: 0,\n                            csv_events: [],\n                            log_events: []\n                        };\n                        window.originalLogs = {};\n                    }\n                    \n                    updateEventSummary();\n                    updateFilters();\n                    displayResults(currentResults);\n                    $(\'#filterSection\').show();\n\n                    if (response.fully_valid_events && response.fully_valid_events.length > 0) {\n                        $(\'#fullyValidEventsList\').empty();\n                        response.fully_valid_events.forEach(function(eventName) {\n                            $(\'#fullyValidEventsList\').append(\'<li>\' + eventName + \'</li>\');\n                        });\n                        $(\'#fullyValidEventsSection\').show();\n                    } else {\n                        $(\'#fullyValidEventsSection\').hide();\n                    }\n                },\n                error: function(xhr) {\n                    console.error(\'Upload error:\', xhr);\n                    alert(\'Error uploading files: \' + xhr.responseText);\n                }\n            });\n        });\n\n        // Initialize filter dropdowns\n        $(document).ready(function() {\n            $(\'.filter-header\').click(function(e) {\n                e.stopPropagation();\n                const filterId = $(this).data(\'filter\');\n                console.log(\'Clicked filter:\', filterId);\n                $(`#${filterId}Filter`).toggleClass(\'show\');\n            });\n\n            // Close filter dropdowns when clicking outside\n            $(document).click(function(e) {\n                if (!$(e.target).closest(\'.filter-dropdown\').length) {\n                    $(\'.filter-content\').removeClass(\'show\');\n                }\n            });\n        });\n\n        function updateEventSummary() {\n            // Update event count displays\n            $(\'#csvEventsCount\').text(currentSummary.csv_events_count || 0);\n            $(\'#logEventsCount\').text(currentSummary.log_events_count || 0);\n            \n            // Calculate missing and extra events\n            const csvEvents = new Set(currentSummary.csv_events || []);\n            const logEvents = new Set(currentSummary.log_events || []);\n            \n            const missingEvents = csvEvents.size - new Set([...csvEvents].filter(x => logEvents.has(x))).size;\n            const extraEvents = logEvents.size - new Set([...logEvents].filter(x => csvEvents.has(x))).size;\n            \n            $(\'#missingEventsCount\').text(missingEvents);\n            $(\'#extraEventsCount\').text(extraEvents);\n        }\n\n        function updateFilters() {\n            const eventNames = new Set();\n            const expectedTypes = new Set();\n            const receivedTypes = new Set();\n            const statuses = new Set();\n            \n            currentResults.forEach(result => {\n                if (result.eventName) eventNames.add(result.eventName);\n                if (result.expectedType) expectedTypes.add(result.expectedType);\n                if (result.receivedType) receivedTypes.add(result.receivedType);\n                if (result.validationStatus) statuses.add(result.validationStatus);\n            });\n\n            console.log(\'Available statuses:\', Array.from(statuses));\n\n            updateFilterOptions(\'eventName\', eventNames);\n            updateFilterOptions(\'status\', statuses);\n            updateFilterOptions(\'expectedType\', expectedTypes);\n            updateFilterOptions(\'receivedType\', receivedTypes);\n        }\n\n        function updateFilterOptions(filterId, values) {\n            const container = $(`#${filterId}Options`);\n            container.empty();\n            \n            console.log(`Updating ${filterId} with values:`, Array.from(values));\n            \n            Array.from(values).sort().forEach(value => {\n                if (value) {\n                    const checkboxId = `${filterId}_${value.replace(/[^a-zA-Z0-9]/g, \'_\')}`;\n                    container.append(`\n                        <div class="filter-checkbox">\n                            <input type="checkbox" id="${checkboxId}" value="${value}" checked>\n                            <label for="${checkboxId}">${value}</label>\n                        </div>\n                    `);\n                }\n            });\n\n            // Update select all checkbox\n            $(`#${filterId}SelectAll`).prop(\'checked\', true);\n        }\n\n        function getSelectedValues(filterId) {\n            return $(`#${filterId}Options input:checked`).map(function() {\n                return $(this).val();\n            }).get();\n        }\n\n        function applyFilter(filterId) {\n            activeFilters[filterId] = getSelectedValues(filterId);\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function clearFilter(filterId) {\n            $(`#${filterId}Options input`).prop(\'checked\', false);\n            $(`#${filterId}SelectAll`).prop(\'checked\', false);\n            activeFilters[filterId] = [];\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function applyFilters() {\n            const filters = {\n                eventName: activeFilters.eventName,\n                validationStatus: activeFilters.status,\n                expectedType: activeFilters.expectedType,\n                receivedType: activeFilters.receivedType\n            };\n\n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/filter\';\n\n            console.log(\'Making filter request to:\', fullUrl);\n\n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({\n                    results: currentResults,\n                    filters: filters,\n                    sort_by: currentSort.field,\n                    sort_order: currentSort.order\n                }),\n                contentType: \'application/json\',\n                success: function(response) {\n                    displayResults(response);\n                    window.filteredResults = response;\n                },\n                error: function(xhr) {\n                    console.error(\'Filter error:\', xhr);\n                    alert(\'Error applying filters: \' + xhr.responseText);\n                }\n            });\n        }\n\n        // Handle select all checkboxes\n        $(\'[id$="SelectAll"]\').change(function() {\n            const filterId = this.id.replace(\'SelectAll\', \'\');\n            $(`#${filterId}Options input`).prop(\'checked\', $(this).prop(\'checked\'));\n        });\n\n        // Update select all checkbox when individual checkboxes change\n        $(\'.filter-content\').on(\'change\', \'input[type="checkbox"]:not([id$="SelectAll"])\', function() {\n            const filterId = $(this).closest(\'.filter-content\').attr(\'id\').replace(\'Filter\', \'\');\n            const allChecked = $(`#${filterId}Options input:checked`).length === $(`#${filterId}Options input`).length;\n            $(`#${filterId}SelectAll`).prop(\'checked\', allChecked);\n        });\n\n        $(\'#clearFilters\').click(function() {\n            $(\'.filter-content input[type="checkbox"]\').prop(\'checked\', false);\n            $(\'[id$="SelectAll"]\').prop(\'checked\', false);\n            Object.keys(activeFilters).forEach(key => {\n                activeFilters[key] = [];\n            });\n            applyFilters();\n        });\n\n        $(\'#downloadResults\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download\';\n            \n            console.log(\'Making download request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ results: resultsToDownload }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'validation_results.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download error:\', xhr);\n                    alert(\'Error downloading results: \' + xhr.responseText);\n                }\n            });\n        });\n\n        $(\'#downloadValidEvents\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download-valid-events\';\n            \n            console.log(\'Making download valid events request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ \n                    results: resultsToDownload,\n                    logs_data: window.originalLogs || {}\n                }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'valid_events_report.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download valid events error:\', xhr);\n                    alert(\'Error downloading valid events: \' + xhr.responseText);\n                }\n            });\n        });\n\n        function displayResults(results) {\n            const tbody = $(\'#resultsBody\');\n            tbody.empty();\n            \n            // Debug log to check results being displayed\n            console.log(\'Displaying results:\', results);\n            \n            results.forEach(result => {\n                const statusClass = getStatusClass(result.validationStatus);\n                tbody.append(`\n                    <tr>\n                        <td>${result.eventName}</td>\n                        <td>${result.key}</td>\n                        <td>${result.value}</td>\n                        <td>${result.expectedType}</td>\n                        <td>${result.receivedType}</td>\n                        <td class="validation-status ${statusClass}">${result.validationStatus}</td>\n                    </tr>\n                `);\n            });\n        }\n\n        function getStatusClass(status) {\n            if (status === \'Valid\') return \'status-valid\';\n            if (status === \'Invalid/Wrong datatype/value\') return \'status-invalid\';\n            if (status === \'Payload value is Empty\') return \'status-empty\';\n            if (status === \'Extra key present in the log\') return \'status-extra\';\n            if (status === \'Extra event present in logs\') return \'status-extra-event\';\n            if (status === \'Field from extra event\') return \'status-extra-field\';\n            if (status === \'Event name not present in the logs\') return \'status-notpresent\';\n            return \'\';\n        }\n\n        $(\'.sort-header\').click(function() {\n            const field = $(this).data(\'sort\');\n            if (currentSort.field === field) {\n                currentSort.order = currentSort.order === \'asc\' ? \'desc\' : \'asc\';\n            } else {\n                currentSort.field = field;\n                currentSort.order = \'asc\';\n            }\n            applyFilters();\n        });\n\n        $(\'#eventNameFilter, #statusFilter, #expectedTypeFilter, #receivedTypeFilter\').change(applyFilters);\n    </script>\n</body>\n</html>'
2025-10-10 12:49:37,966 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:37] "GET / HTTP/1.1" 200 -
2025-10-10 12:49:38,968 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:49:38,968 - INFO - Body: b''
2025-10-10 12:49:38,969 - INFO - URL: http://localhost:10000/download_template
2025-10-10 12:49:38,969 - INFO - Method: GET
2025-10-10 12:49:38,969 - INFO - Endpoint: download_template
2025-10-10 12:49:38,982 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:38] "[35m[1mGET /download_template HTTP/1.1[0m" 500 -
2025-10-10 12:49:39,006 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:39] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 304 -
2025-10-10 12:49:39,007 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:39] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 304 -
2025-10-10 12:49:39,014 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:39] "GET /download_template?__debugger__=yes&cmd=resource&f=console.png&s=yOcUMQZ3QjdZdaglzAcB HTTP/1.1" 200 -
2025-10-10 12:49:43,935 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:49:43,935 - INFO - Body: b''
2025-10-10 12:49:43,935 - INFO - URL: http://localhost:10000/download_sample_log/regular
2025-10-10 12:49:43,935 - INFO - Method: GET
2025-10-10 12:49:43,935 - INFO - Endpoint: download_sample_log
2025-10-10 12:49:43,943 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:43] "[35m[1mGET /download_sample_log/regular HTTP/1.1[0m" 500 -
2025-10-10 12:49:43,963 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:43] "[36mGET /download_sample_log/regular?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 304 -
2025-10-10 12:49:43,965 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:43] "[36mGET /download_sample_log/regular?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 304 -
2025-10-10 12:49:43,975 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:43] "GET /download_sample_log/regular?__debugger__=yes&cmd=resource&f=console.png&s=yOcUMQZ3QjdZdaglzAcB HTTP/1.1" 200 -
2025-10-10 12:49:57,663 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:49:57,664 - INFO - Body: b''
2025-10-10 12:49:57,664 - INFO - URL: http://localhost:10000/download_template
2025-10-10 12:49:57,664 - INFO - Method: GET
2025-10-10 12:49:57,664 - INFO - Endpoint: download_template
2025-10-10 12:49:57,671 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:57] "[35m[1mGET /download_template HTTP/1.1[0m" 500 -
2025-10-10 12:49:57,688 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:57] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 304 -
2025-10-10 12:49:57,693 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:57] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 304 -
2025-10-10 12:49:57,701 - INFO - 127.0.0.1 - - [10/Oct/2025 12:49:57] "[36mGET /download_template?__debugger__=yes&cmd=resource&f=console.png&s=yOcUMQZ3QjdZdaglzAcB HTTP/1.1[0m" 304 -
2025-10-10 12:50:20,103 - INFO -  * Detected change in '/Users/allen.thomson/Desktop/sampleapp/automation/validation_script_android/beta2.py', reloading
2025-10-10 12:50:20,156 - INFO -  * Restarting with stat
2025-10-10 12:50:20,395 - WARNING -  * Debugger is active!
2025-10-10 12:50:20,404 - INFO -  * Debugger PIN: 132-353-793
2025-10-10 12:50:48,606 - INFO -  * Detected change in '/Users/allen.thomson/Desktop/sampleapp/automation/validation_script_android/beta2.py', reloading
2025-10-10 12:50:48,659 - INFO -  * Restarting with stat
2025-10-10 12:50:48,834 - WARNING -  * Debugger is active!
2025-10-10 12:50:48,840 - INFO -  * Debugger PIN: 132-353-793
2025-10-10 12:50:54,115 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:10000
 * Running on http://172.16.20.191:10000
2025-10-10 12:50:54,115 - INFO - [33mPress CTRL+C to quit[0m
2025-10-10 12:50:54,115 - INFO -  * Restarting with stat
2025-10-10 12:50:54,241 - WARNING -  * Debugger is active!
2025-10-10 12:50:54,247 - INFO -  * Debugger PIN: 132-353-793
2025-10-10 12:50:58,906 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 12:50:58,907 - INFO - Body: b''
2025-10-10 12:50:58,908 - INFO - URL: http://localhost:10000/download_template
2025-10-10 12:50:58,908 - INFO - Method: GET
2025-10-10 12:50:58,908 - INFO - Endpoint: download_template
2025-10-10 12:50:58,910 - INFO - Response: [File Response] Content-Type: text/csv; charset=utf-8, Headers: {'Content-Disposition': 'attachment; filename=sample_template.csv', 'Content-Type': 'text/csv; charset=utf-8', 'Content-Length': '495', 'Last-Modified': 'Thu, 12 Jun 2025 07:13:40 GMT', 'Cache-Control': 'no-cache', 'ETag': '"1749712420.0291362-495-2913214935"', 'Date': 'Fri, 10 Oct 2025 07:20:58 GMT'}
2025-10-10 12:50:58,911 - INFO - 127.0.0.1 - - [10/Oct/2025 12:50:58] "GET /download_template HTTP/1.1" 200 -
2025-10-10 13:00:44,216 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:10000
 * Running on http://172.16.20.191:10000
2025-10-10 13:00:44,217 - INFO - [33mPress CTRL+C to quit[0m
2025-10-10 13:00:44,217 - INFO -  * Restarting with stat
2025-10-10 13:00:44,365 - WARNING -  * Debugger is active!
2025-10-10 13:00:44,374 - INFO -  * Debugger PIN: 132-353-793
2025-10-10 13:00:46,840 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Cache-Control: max-age=0
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 13:00:46,841 - INFO - Body: b''
2025-10-10 13:00:46,841 - INFO - URL: http://localhost:10000/
2025-10-10 13:00:46,841 - INFO - Method: GET
2025-10-10 13:00:46,841 - INFO - Endpoint: index
2025-10-10 13:00:46,848 - INFO - Response: b'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Event Validation Tool</title>\n    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">\n    <link href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" rel="stylesheet">\n    <style>\n        :root {\n            --primary-color: #e35502;\n            --header-bg: #230f2e;\n        }\n        \n        .container { margin-top: 30px; }\n        .table-container { margin-top: 20px; }\n        .filter-container { margin: 20px 0; }\n        .hidden { display: none; }\n        .first-event { color: blue; }\n        \n        /* Header styling */\n        .navbar {\n            background-color: var(--header-bg) !important;\n        }\n        \n        .navbar-brand, .navbar-nav .nav-link {\n            color: white !important;\n        }\n        \n        .navbar-toggler {\n            border-color: rgba(255,255,255,0.5);\n        }\n        \n        .navbar-toggler-icon {\n            background-image: url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 30 30\'%3e%3cpath stroke=\'rgba%28255, 255, 255, 0.75%29\' stroke-linecap=\'round\' stroke-miterlimit=\'10\' stroke-width=\'2\' d=\'M4 7h22M4 15h22M4 23h22\'/%3e%3c/svg%3e");\n        }\n        \n        /* Button styling */\n        .btn-primary {\n            background-color: var(--primary-color) !important;\n            border-color: var(--primary-color) !important;\n        }\n        \n        .btn-primary:hover {\n            background-color: #c64802 !important;\n            border-color: #c64802 !important;\n        }\n        \n        .btn-outline-primary {\n            color: white !important;\n            border-color: white !important;\n        }\n        \n        .btn-outline-primary:hover {\n            background-color: rgba(255,255,255,0.1) !important;\n        }\n        .null-value { background-color: yellow; }\n        .valid-status { color: green; }\n        .invalid-status { color: red; }\n        .empty-status { color: orange; }\n        .not-present { color: darkolivegreen; }\n        .extra-key { color: rgb(24, 214, 185); }\n        .type-mismatch { background-color: #ffe6e6; }\n        .download-section {\n            margin: 20px 0;\n            text-align: right;\n        }\n        /* Status color coding */\n        .status-valid { background-color: #d4edda !important; color: #155724 !important; }\n        .status-invalid { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-empty { background-color: #fff3cd !important; color: #856404 !important; }\n        .status-extra { background-color: #d1ecf1 !important; color: #0c5460 !important; }\n        .status-notpresent { background-color: #042508 !important; color: #7f7b97 !important; }\n        .status-csv { background-color: #e2e3e5 !important; color: #383d41 !important; }\n        .status-extra-event { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-extra-field { background-color: #fff3cd !important; color: #856404 !important; }\n        .validation-status {\n            font-weight: bold;\n        }\n        .status-valid {\n            color: #28a745;\n        }\n        .status-invalid {\n            color: #dc3545;\n        }\n        .status-empty {\n            color: #ffc107;\n        }\n        .status-extra {\n            color: #17a2b8;\n        }\n        .status-extra-event {\n            color: #dc3545;\n        }\n        .status-extra-field {\n            color: #ffc107;\n        }\n        .filter-section {\n            background-color: #f8f9fa;\n            padding: 15px;\n            margin-bottom: 20px;\n            border-radius: 5px;\n        }\n        .sort-header {\n            cursor: pointer;\n        }\n        .sort-header:hover {\n            background-color: #e9ecef;\n        }\n        .sort-icon {\n            margin-left: 5px;\n        }\n        .filter-dropdown {\n            position: relative;\n            display: inline-block;\n        }\n        .filter-content {\n            display: none;\n            position: absolute;\n            background-color: #f9f9f9;\n            min-width: 200px;\n            max-height: 300px;\n            overflow-y: auto;\n            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\n            z-index: 1000;\n            padding: 10px;\n        }\n        .filter-content.show {\n            display: block;\n        }\n        .filter-checkbox {\n            margin: 5px 0;\n        }\n        .filter-checkbox label {\n            display: block;\n            padding: 5px;\n            cursor: pointer;\n        }\n        .filter-checkbox label:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-header {\n            display: flex;\n            align-items: center;\n            cursor: pointer;\n            padding: 5px;\n        }\n        .filter-header:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-icon {\n            margin-left: 5px;\n        }\n        .filter-actions {\n            margin-top: 10px;\n            padding-top: 10px;\n            border-top: 1px solid #ddd;\n        }\n    </style>\n</head>\n<body>\n    <nav class="navbar navbar-expand-lg navbar-light bg-light">\n        <div class="container-fluid">\n            <a class="navbar-brand" href="#">Netcore Event Payload Validator</a>\n            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">\n                <span class="navbar-toggler-icon"></span>\n            </button>\n            <div class="collapse navbar-collapse" id="navbarNav">\n                <ul class="navbar-nav ms-auto">\n                    <li class="nav-item">\n                        <a class="btn btn-primary" href="https://contact-api-via-csv-7e94e.web.app/" target="_blank">Trigger Activity API</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </nav>\n\n    <div class="container">\n        <h2>Event Validation Tool</h2>\n        \n        <div class="card mb-4">\n            <div class="card-body">\n                <div class="mb-3">\n                    <label class="form-label">Validation Mode</label>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="regularMode" value="regular" checked>\n                        <label class="form-check-label" for="regularMode">\n                            Android and iOS Event (Single Event/Event Payload format)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteMode" value="website">\n                        <label class="form-check-label" for="websiteMode">\n                            Website Logs Validation (JSON lines format with eventname and payload)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteV2Mode" value="website-v2">\n                        <label class="form-check-label" for="websiteV2Mode">\n                            Website Logs V2 Validation (JSON lines format with event key and system fields excluded)\n                        </label>\n                    </div>\n                </div>\n                \n                <form id="uploadForm" enctype="multipart/form-data">\n                    <div class="mb-3">\n                        <label for="csvFile" class="form-label">CSV File (Validation Rules)</label>\n                        <input type="file" class="form-control" id="csvFile" name="csv_file" accept=".csv" required>\n                        <div class="mt-2">\n                            <a href="/download_template" class="btn btn-outline-secondary btn-sm">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Sample Template\n                            </a>\n                        </div>\n                    </div>\n                    <div class="mb-3">\n                        <label for="txtFile" class="form-label">TXT File (Event Logs)</label>\n                        <input type="file" class="form-control" id="txtFile" name="txt_file" accept=".txt" required>\n                        <div class="mt-2 sample-downloads">\n                            <!-- Regular mode sample -->\n                            <a href="/download_sample_log/regular" class="btn btn-outline-secondary btn-sm sample-download regular-mode">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Regular Sample Log\n                            </a>\n                            <!-- Website mode sample -->\n                            <a href="/download_sample_log/website" class="btn btn-outline-secondary btn-sm sample-download website-mode" style="display: none;">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Website Sample Log\n                            </a>\n                            <!-- Website V2 mode samples -->\n                            <div class="v2-mode-downloads" style="display: none;">\n                                <a href="/download_sample_log/website-v2" class="btn btn-outline-secondary btn-sm mb-1">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                    </svg>\n                                    Download Website V2 Sample Log\n                                </a>\n                                <a href="/download_sample_log/website-v2?multiline=true" class="btn btn-outline-secondary btn-sm">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                    </svg>\n                                    Download Website V2 Multiline Sample\n                                </a>\n                            </div>\n                        </div>\n                    </div>\n                    <button type="submit" class="btn btn-primary">Validate</button>\n                </form>\n            </div>\n        </div>\n\n        <div class="filter-section" id="filterSection" style="display: none;">\n            <div class="row mb-3">\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Summary</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>CSV Events:</strong></p>\n                                    <p class="text-primary" id="csvEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Log Events:</strong></p>\n                                    <p class="text-success" id="logEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Details</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Missing Events:</strong></p>\n                                    <p class="text-warning" id="missingEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Extra Events:</strong></p>\n                                    <p class="text-info" id="extraEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <h4>Filters</h4>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="eventName">\n                            Event Name <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="eventNameFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="eventNameSelectAll" checked>\n                                <label for="eventNameSelectAll">Select All</label>\n                            </div>\n                            <div id="eventNameOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'eventName\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'eventName\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="status">\n                            Status <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="statusFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="statusSelectAll" checked>\n                                <label for="statusSelectAll">Select All</label>\n                            </div>\n                            <div id="statusOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'status\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'status\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="expectedType">\n                            Expected Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="expectedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="expectedTypeSelectAll" checked>\n                                <label for="expectedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="expectedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'expectedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'expectedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="receivedType">\n                            Received Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="receivedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="receivedTypeSelectAll" checked>\n                                <label for="receivedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="receivedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'receivedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'receivedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-secondary" id="clearFilters">Clear All Filters</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-success" id="downloadResults">Download Results</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-info" id="downloadValidEvents">Download Valid Events</button>\n                </div>\n            </div>\n        </div>\n\n        <div id="fullyValidEventsSection" class="alert alert-success" style="display:none;">\n            <strong>Events with all payloads valid:</strong>\n            <ul id="fullyValidEventsList" style="margin-bottom:0;"></ul>\n        </div>\n\n        <div class="table-container">\n            <table class="table table-striped" id="resultsTable">\n                <thead>\n                    <tr>\n                        <th class="sort-header" data-sort="eventName">Event Name <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="key">Key <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="value">Value <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="expectedType">Expected Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="receivedType">Received Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="validationStatus">Status <span class="sort-icon">\xe2\x86\x95</span></th>\n                    </tr>\n                </thead>\n                <tbody id="resultsBody"></tbody>\n            </table>\n        </div>\n    </div>\n\n    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/moment/moment.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>\n    <script>\n        let currentResults = [];\n        let currentSummary = {};\n        let currentSort = { field: null, order: \'asc\' };\n        let activeFilters = {\n            eventName: [],\n            status: [],\n            expectedType: [],\n            receivedType: []\n        };\n\n        $(\'#dateRange\').daterangepicker({\n            autoUpdateInput: false,\n            locale: {\n                cancelLabel: \'Clear\'\n            }\n        });\n\n        $(\'#dateRange\').on(\'apply.daterangepicker\', function(ev, picker) {\n            $(this).val(picker.startDate.format(\'MM/DD/YYYY\') + \' - \' + picker.endDate.format(\'MM/DD/YYYY\'));\n            applyFilters();\n        });\n\n        $(\'#dateRange\').on(\'cancel.daterangepicker\', function(ev, picker) {\n            $(this).val(\'\');\n            applyFilters();\n        });\n\n        // Handle validation mode changes\n        $(\'input[name="validationMode"]\').change(function() {\n            const mode = $(this).val();\n            // Hide all sample download buttons first\n            $(\'.sample-download, .v2-mode-downloads\').hide();\n            \n            // Show the appropriate download button based on mode\n            if (mode === \'regular\') {\n                $(\'.sample-download.regular-mode\').show();\n            } else if (mode === \'website\') {\n                $(\'.sample-download.website-mode\').show();\n            } else if (mode === \'website-v2\') {\n                $(\'.v2-mode-downloads\').show();\n            }\n        });\n\n        $(\'#uploadForm\').on(\'submit\', function(e) {\n            e.preventDefault();\n            const formData = new FormData(this);\n            \n            // Determine which endpoint to use based on validation mode\n            const validationMode = $(\'input[name="validationMode"]:checked\').val();\n            let endpoint = \'/upload\';\n            if (validationMode === \'website\') {\n                endpoint = \'/validate-website-logs\';\n            } else if (validationMode === \'website-v2\') {\n                endpoint = \'/validate-website-logs-v2\';\n            }\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + endpoint;\n            \n            console.log(\'Making request to:\', fullUrl);\n            console.log(\'Validation mode:\', validationMode);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: formData,\n                processData: false,\n                contentType: false,\n                success: function(response) {\n                    console.log(\'Upload response:\', response);\n                    \n                    // Handle both old and new response formats\n                    if (response.results && response.summary) {\n                        // New format with summary\n                        currentResults = response.results;\n                        currentSummary = response.summary;\n                        // Store original logs for download feature\n                        window.originalLogs = response.original_logs || {};\n                    } else {\n                        // Old format - just results array\n                        currentResults = response;\n                        currentSummary = {\n                            csv_events_count: 0,\n                            log_events_count: 0,\n                            csv_events: [],\n                            log_events: []\n                        };\n                        window.originalLogs = {};\n                    }\n                    \n                    updateEventSummary();\n                    updateFilters();\n                    displayResults(currentResults);\n                    $(\'#filterSection\').show();\n\n                    if (response.fully_valid_events && response.fully_valid_events.length > 0) {\n                        $(\'#fullyValidEventsList\').empty();\n                        response.fully_valid_events.forEach(function(eventName) {\n                            $(\'#fullyValidEventsList\').append(\'<li>\' + eventName + \'</li>\');\n                        });\n                        $(\'#fullyValidEventsSection\').show();\n                    } else {\n                        $(\'#fullyValidEventsSection\').hide();\n                    }\n                },\n                error: function(xhr) {\n                    console.error(\'Upload error:\', xhr);\n                    alert(\'Error uploading files: \' + xhr.responseText);\n                }\n            });\n        });\n\n        // Initialize filter dropdowns\n        $(document).ready(function() {\n            $(\'.filter-header\').click(function(e) {\n                e.stopPropagation();\n                const filterId = $(this).data(\'filter\');\n                console.log(\'Clicked filter:\', filterId);\n                $(`#${filterId}Filter`).toggleClass(\'show\');\n            });\n\n            // Close filter dropdowns when clicking outside\n            $(document).click(function(e) {\n                if (!$(e.target).closest(\'.filter-dropdown\').length) {\n                    $(\'.filter-content\').removeClass(\'show\');\n                }\n            });\n        });\n\n        function updateEventSummary() {\n            // Update event count displays\n            $(\'#csvEventsCount\').text(currentSummary.csv_events_count || 0);\n            $(\'#logEventsCount\').text(currentSummary.log_events_count || 0);\n            \n            // Calculate missing and extra events\n            const csvEvents = new Set(currentSummary.csv_events || []);\n            const logEvents = new Set(currentSummary.log_events || []);\n            \n            const missingEvents = csvEvents.size - new Set([...csvEvents].filter(x => logEvents.has(x))).size;\n            const extraEvents = logEvents.size - new Set([...logEvents].filter(x => csvEvents.has(x))).size;\n            \n            $(\'#missingEventsCount\').text(missingEvents);\n            $(\'#extraEventsCount\').text(extraEvents);\n        }\n\n        function updateFilters() {\n            const eventNames = new Set();\n            const expectedTypes = new Set();\n            const receivedTypes = new Set();\n            const statuses = new Set();\n            \n            currentResults.forEach(result => {\n                if (result.eventName) eventNames.add(result.eventName);\n                if (result.expectedType) expectedTypes.add(result.expectedType);\n                if (result.receivedType) receivedTypes.add(result.receivedType);\n                if (result.validationStatus) statuses.add(result.validationStatus);\n            });\n\n            console.log(\'Available statuses:\', Array.from(statuses));\n\n            updateFilterOptions(\'eventName\', eventNames);\n            updateFilterOptions(\'status\', statuses);\n            updateFilterOptions(\'expectedType\', expectedTypes);\n            updateFilterOptions(\'receivedType\', receivedTypes);\n        }\n\n        function updateFilterOptions(filterId, values) {\n            const container = $(`#${filterId}Options`);\n            container.empty();\n            \n            console.log(`Updating ${filterId} with values:`, Array.from(values));\n            \n            Array.from(values).sort().forEach(value => {\n                if (value) {\n                    const checkboxId = `${filterId}_${value.replace(/[^a-zA-Z0-9]/g, \'_\')}`;\n                    container.append(`\n                        <div class="filter-checkbox">\n                            <input type="checkbox" id="${checkboxId}" value="${value}" checked>\n                            <label for="${checkboxId}">${value}</label>\n                        </div>\n                    `);\n                }\n            });\n\n            // Update select all checkbox\n            $(`#${filterId}SelectAll`).prop(\'checked\', true);\n        }\n\n        function getSelectedValues(filterId) {\n            return $(`#${filterId}Options input:checked`).map(function() {\n                return $(this).val();\n            }).get();\n        }\n\n        function applyFilter(filterId) {\n            activeFilters[filterId] = getSelectedValues(filterId);\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function clearFilter(filterId) {\n            $(`#${filterId}Options input`).prop(\'checked\', false);\n            $(`#${filterId}SelectAll`).prop(\'checked\', false);\n            activeFilters[filterId] = [];\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function applyFilters() {\n            const filters = {\n                eventName: activeFilters.eventName,\n                validationStatus: activeFilters.status,\n                expectedType: activeFilters.expectedType,\n                receivedType: activeFilters.receivedType\n            };\n\n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/filter\';\n\n            console.log(\'Making filter request to:\', fullUrl);\n\n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({\n                    results: currentResults,\n                    filters: filters,\n                    sort_by: currentSort.field,\n                    sort_order: currentSort.order\n                }),\n                contentType: \'application/json\',\n                success: function(response) {\n                    displayResults(response);\n                    window.filteredResults = response;\n                },\n                error: function(xhr) {\n                    console.error(\'Filter error:\', xhr);\n                    alert(\'Error applying filters: \' + xhr.responseText);\n                }\n            });\n        }\n\n        // Handle select all checkboxes\n        $(\'[id$="SelectAll"]\').change(function() {\n            const filterId = this.id.replace(\'SelectAll\', \'\');\n            $(`#${filterId}Options input`).prop(\'checked\', $(this).prop(\'checked\'));\n        });\n\n        // Update select all checkbox when individual checkboxes change\n        $(\'.filter-content\').on(\'change\', \'input[type="checkbox"]:not([id$="SelectAll"])\', function() {\n            const filterId = $(this).closest(\'.filter-content\').attr(\'id\').replace(\'Filter\', \'\');\n            const allChecked = $(`#${filterId}Options input:checked`).length === $(`#${filterId}Options input`).length;\n            $(`#${filterId}SelectAll`).prop(\'checked\', allChecked);\n        });\n\n        $(\'#clearFilters\').click(function() {\n            $(\'.filter-content input[type="checkbox"]\').prop(\'checked\', false);\n            $(\'[id$="SelectAll"]\').prop(\'checked\', false);\n            Object.keys(activeFilters).forEach(key => {\n                activeFilters[key] = [];\n            });\n            applyFilters();\n        });\n\n        $(\'#downloadResults\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download\';\n            \n            console.log(\'Making download request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ results: resultsToDownload }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'validation_results.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download error:\', xhr);\n                    alert(\'Error downloading results: \' + xhr.responseText);\n                }\n            });\n        });\n\n        $(\'#downloadValidEvents\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download-valid-events\';\n            \n            console.log(\'Making download valid events request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ \n                    results: resultsToDownload,\n                    logs_data: window.originalLogs || {}\n                }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'valid_events_report.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download valid events error:\', xhr);\n                    alert(\'Error downloading valid events: \' + xhr.responseText);\n                }\n            });\n        });\n\n        function displayResults(results) {\n            const tbody = $(\'#resultsBody\');\n            tbody.empty();\n            \n            // Debug log to check results being displayed\n            console.log(\'Displaying results:\', results);\n            \n            results.forEach(result => {\n                const statusClass = getStatusClass(result.validationStatus);\n                tbody.append(`\n                    <tr>\n                        <td>${result.eventName}</td>\n                        <td>${result.key}</td>\n                        <td>${result.value}</td>\n                        <td>${result.expectedType}</td>\n                        <td>${result.receivedType}</td>\n                        <td class="validation-status ${statusClass}">${result.validationStatus}</td>\n                    </tr>\n                `);\n            });\n        }\n\n        function getStatusClass(status) {\n            if (status === \'Valid\') return \'status-valid\';\n            if (status === \'Invalid/Wrong datatype/value\') return \'status-invalid\';\n            if (status === \'Payload value is Empty\') return \'status-empty\';\n            if (status === \'Extra key present in the log\') return \'status-extra\';\n            if (status === \'Extra event present in logs\') return \'status-extra-event\';\n            if (status === \'Field from extra event\') return \'status-extra-field\';\n            if (status === \'Event name not present in the logs\') return \'status-notpresent\';\n            return \'\';\n        }\n\n        $(\'.sort-header\').click(function() {\n            const field = $(this).data(\'sort\');\n            if (currentSort.field === field) {\n                currentSort.order = currentSort.order === \'asc\' ? \'desc\' : \'asc\';\n            } else {\n                currentSort.field = field;\n                currentSort.order = \'asc\';\n            }\n            applyFilters();\n        });\n\n        $(\'#eventNameFilter, #statusFilter, #expectedTypeFilter, #receivedTypeFilter\').change(applyFilters);\n    </script>\n</body>\n</html>'
2025-10-10 13:00:46,849 - INFO - 127.0.0.1 - - [10/Oct/2025 13:00:46] "GET / HTTP/1.1" 200 -
2025-10-10 13:00:55,537 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 13:00:55,538 - INFO - Body: b''
2025-10-10 13:00:55,539 - INFO - URL: http://localhost:10000/download_sample_log/website-v2?multiline=true
2025-10-10 13:00:55,539 - INFO - Method: GET
2025-10-10 13:00:55,539 - INFO - Endpoint: download_sample_log
2025-10-10 13:00:55,540 - INFO - Response: [File Response] Content-Type: text/plain; charset=utf-8, Headers: {'Content-Disposition': 'attachment; filename=sample_website_logs_v2_multiline.txt', 'Content-Type': 'text/plain; charset=utf-8', 'Content-Length': '1347', 'Last-Modified': 'Tue, 05 Aug 2025 12:54:42 GMT', 'Cache-Control': 'no-cache', 'ETag': '"1754398482.1795332-1347-2975345802"', 'Date': 'Fri, 10 Oct 2025 07:30:55 GMT'}
2025-10-10 13:00:55,541 - INFO - 127.0.0.1 - - [10/Oct/2025 13:00:55] "GET /download_sample_log/website-v2?multiline=true HTTP/1.1" 200 -
2025-10-10 13:00:56,645 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 13:00:56,645 - INFO - Body: b''
2025-10-10 13:00:56,645 - INFO - URL: http://localhost:10000/download_sample_log/website-v2
2025-10-10 13:00:56,645 - INFO - Method: GET
2025-10-10 13:00:56,645 - INFO - Endpoint: download_sample_log
2025-10-10 13:00:56,646 - INFO - Response: [File Response] Content-Type: text/plain; charset=utf-8, Headers: {'Content-Disposition': 'attachment; filename=sample_website_logs_v2.txt', 'Content-Type': 'text/plain; charset=utf-8', 'Content-Length': '1165', 'Last-Modified': 'Tue, 05 Aug 2025 12:42:18 GMT', 'Cache-Control': 'no-cache', 'ETag': '"1754397738.9556391-1165-92612696"', 'Date': 'Fri, 10 Oct 2025 07:30:56 GMT'}
2025-10-10 13:00:56,647 - INFO - 127.0.0.1 - - [10/Oct/2025 13:00:56] "GET /download_sample_log/website-v2 HTTP/1.1" 200 -
2025-10-10 13:01:02,935 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Content-Length: 2265
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Accept: */*
Sec-Ch-Ua-Platform: "macOS"
X-Requested-With: XMLHttpRequest
Sec-Ch-Ua-Mobile: ?0
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryUMDmH1M6eKOB2djp
Origin: http://localhost:10000
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 13:01:02,936 - INFO - Body: b'------WebKitFormBoundaryUMDmH1M6eKOB2djp\r\nContent-Disposition: form-data; name="csv_file"; filename="sample.csv"\r\nContent-Type: text/csv\r\n\r\neventName,eventPayload,dataType\r\nsign_up,seat_type,text\r\n,seat number,integer\r\n,movie,text\r\n,screen,text\r\n,date,date \r\n,location,text\r\n,experience,text\r\n,amount,float\r\nuser_profile_push,seat_type,text\r\n,seat number,integer\r\n,movie,text\r\n,screen,text\r\n,date,date \r\n,location,text\r\n,experience,text\r\n,amount,float\r\nclicked,revenue,float\r\nproduct_purchase,items[].variant_id,text, NOTE: ARRAY PAYLOAD. PLEASE DONT ADD THIS ROW IN THE ACTUAL SHEET\r\n,items[].prname,text\r\n,items[].price,float\r\n,items[].prid,text\r\n,items[].brand,text\r\nappointment_click,user_type,text\r\n------WebKitFormBoundaryUMDmH1M6eKOB2djp\r\nContent-Disposition: form-data; name="txt_file"; filename="sample_website_logs_v2_multiline.txt"\r\nContent-Type: text/plain\r\n\r\n{\n    "src": "GUWAHATI (GAU)",\n    "des": "NEW DELHI (DEL)",\n    "flight_type": "domestic",\n    "departure_date": "05-08-2025",\n    "return_date": "",\n    "passenger_adult": 1,\n    "passenger_child": 0,\n    "flight_class": "economy",\n    "source": "web",\n    "event": "flight searched",\n    "url": "https://happyfares.in/?rdt=true~in",\n    "purl": "https://happyfares.in/home",\n    "title": "Flight Tickets Booking at HappyFares.in, Cheap Flights Fares.",\n    "npv": 1,\n    "sts": 455,\n    "pts": 322,\n    "timestamp": 1754392679207\n}\n{\n    "product_id": "12345",\n    "product_name": "iPhone 15",\n    "category": "Electronics",\n    "brand": "Apple",\n    "price": 79999,\n    "currency": "INR",\n    "event": "product viewed",\n    "url": "https://example.com/product/12345",\n    "purl": "https://example.com/products",\n    "title": "iPhone 15 - Example Store",\n    "npv": 1,\n    "sts": 300,\n    "pts": 150,\n    "timestamp": 1754392679208\n}\n{\n    "order_id": "ORD789",\n    "total_amount": 79999,\n    "currency": "INR",\n    "payment_method": "credit_card",\n    "shipping_address": "456 Oak St, City, State 54321",\n    "event": "purchase completed",\n    "url": "https://example.com/checkout",\n    "purl": "https://example.com/cart",\n    "title": "Checkout - Example Store",\n    "npv": 1,\n    "sts": 400,\n    "pts": 200,\n    "timestamp": 1754392679209\n} \r\n------WebKitFormBoundaryUMDmH1M6eKOB2djp--\r\n'
2025-10-10 13:01:02,936 - INFO - URL: http://localhost:10000/validate-website-logs-v2
2025-10-10 13:01:02,936 - INFO - Method: POST
2025-10-10 13:01:02,936 - INFO - Endpoint: validate_website_logs_v2
2025-10-10 13:01:02,936 - INFO - Website logs v2 validation endpoint called
2025-10-10 13:01:02,938 - INFO - website_logs_v2_upload: {"csv_file": "sample.csv", "txt_file": "sample_website_logs_v2_multiline.txt", "timestamp": "2025-10-10T13:01:02.938542"}
2025-10-10 13:01:02,944 - INFO - website_logs_v2_validation_complete: {"total_validations": 28, "valid_count": 0, "invalid_count": 28, "csv_events_count": 5, "log_events_count": 3, "extra_events_count": 3, "total_log_entries": 3}
2025-10-10 13:01:02,945 - INFO - Response: b'{\n  "fully_valid_events": [],\n  "original_logs": {\n    "flight searched": "{\\"src\\": \\"GUWAHATI (GAU)\\",\\"des\\": \\"NEW DELHI (DEL)\\",\\"flight_type\\": \\"domestic\\",\\"departure_date\\": \\"05-08-2025\\",\\"return_date\\": \\"\\",\\"passenger_adult\\": 1,\\"passenger_child\\": 0,\\"flight_class\\": \\"economy\\",\\"source\\": \\"web\\",\\"event\\": \\"flight searched\\",\\"url\\": \\"https://happyfares.in/?rdt=true~in\\",\\"purl\\": \\"https://happyfares.in/home\\",\\"title\\": \\"Flight Tickets Booking at HappyFares.in, Cheap Flights Fares.\\",\\"npv\\": 1,\\"sts\\": 455,\\"pts\\": 322,\\"timestamp\\": 1754392679207}",\n    "product viewed": "{\\"product_id\\": \\"12345\\",\\"product_name\\": \\"iPhone 15\\",\\"category\\": \\"Electronics\\",\\"brand\\": \\"Apple\\",\\"price\\": 79999,\\"currency\\": \\"INR\\",\\"event\\": \\"product viewed\\",\\"url\\": \\"https://example.com/product/12345\\",\\"purl\\": \\"https://example.com/products\\",\\"title\\": \\"iPhone 15 - Example Store\\",\\"npv\\": 1,\\"sts\\": 300,\\"pts\\": 150,\\"timestamp\\": 1754392679208}",\n    "purchase completed": "{\\"order_id\\": \\"ORD789\\",\\"total_amount\\": 79999,\\"currency\\": \\"INR\\",\\"payment_method\\": \\"credit_card\\",\\"shipping_address\\": \\"456 Oak St, City, State 54321\\",\\"event\\": \\"purchase completed\\",\\"url\\": \\"https://example.com/checkout\\",\\"purl\\": \\"https://example.com/cart\\",\\"title\\": \\"Checkout - Example Store\\",\\"npv\\": 1,\\"sts\\": 400,\\"pts\\": 200,\\"timestamp\\": 1754392679209}"\n  },\n  "results": [\n    {\n      "comment": "Event \\"sign_up\\" from CSV was not found in the uploaded log file",\n      "eventName": "sign_up",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "sign_up"\n    },\n    {\n      "comment": "Event \\"user_profile_push\\" from CSV was not found in the uploaded log file",\n      "eventName": "user_profile_push",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "user_profile_push"\n    },\n    {\n      "comment": "Event \\"clicked\\" from CSV was not found in the uploaded log file",\n      "eventName": "clicked",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "clicked"\n    },\n    {\n      "comment": "Event \\"product_purchase\\" from CSV was not found in the uploaded log file",\n      "eventName": "product_purchase",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "product_purchase"\n    },\n    {\n      "comment": "Event \\"appointment_click\\" from CSV was not found in the uploaded log file",\n      "eventName": "appointment_click",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "appointment_click"\n    },\n    {\n      "comment": "Event \\"product viewed\\" found in logs but not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "line_number": 35,\n      "receivedType": "extra event in logs",\n      "validationStatus": "Extra event present in logs",\n      "value": "product viewed"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "product_id",\n      "line_number": 35,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "12345"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "product_name",\n      "line_number": 35,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "iPhone 15"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "category",\n      "line_number": 35,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "Electronics"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "brand",\n      "line_number": 35,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "Apple"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "price",\n      "line_number": 35,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 79999\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "currency",\n      "line_number": 35,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "INR"\n    },\n    {\n      "comment": "Event \\"flight searched\\" found in logs but not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "line_number": 19,\n      "receivedType": "extra event in logs",\n      "validationStatus": "Extra event present in logs",\n      "value": "flight searched"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "src",\n      "line_number": 19,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "GUWAHATI (GAU)"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "des",\n      "line_number": 19,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "NEW DELHI (DEL)"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "flight_type",\n      "line_number": 19,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "domestic"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "departure_date",\n      "line_number": 19,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "05-08-2025"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "return_date",\n      "line_number": 19,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": ""\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "passenger_adult",\n      "line_number": 19,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 1\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "passenger_child",\n      "line_number": 19,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 0\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "flight_class",\n      "line_number": 19,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "economy"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "source",\n      "line_number": 19,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "web"\n    },\n    {\n      "comment": "Event \\"purchase completed\\" found in logs but not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "line_number": 50,\n      "receivedType": "extra event in logs",\n      "validationStatus": "Extra event present in logs",\n      "value": "purchase completed"\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "order_id",\n      "line_number": 50,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "ORD789"\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "total_amount",\n      "line_number": 50,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 79999\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "currency",\n      "line_number": 50,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "INR"\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "payment_method",\n      "line_number": 50,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "credit_card"\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "shipping_address",\n      "line_number": 50,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "456 Oak St, City, State 54321"\n    }\n  ],\n  "summary": {\n    "csv_events": [\n      "clicked",\n      "user_profile_push",\n      "product_purchase",\n      "appointment_click",\n      "sign_up"\n    ],\n    "csv_events_count": 5,\n    "extra_events": [\n      "product viewed",\n      "flight searched",\n      "purchase completed"\n    ],\n    "log_events": [\n      "product viewed",\n      "flight searched",\n      "purchase completed"\n    ],\n    "log_events_count": 3,\n    "total_log_entries": 3\n  }\n}\n'
2025-10-10 13:01:02,946 - INFO - 127.0.0.1 - - [10/Oct/2025 13:01:02] "POST /validate-website-logs-v2 HTTP/1.1" 200 -
2025-10-10 13:03:18,880 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Content-Length: 9495
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Accept: */*
Sec-Ch-Ua-Platform: "macOS"
X-Requested-With: XMLHttpRequest
Sec-Ch-Ua-Mobile: ?0
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary3B2xjOyyImOlCu5H
Origin: http://localhost:10000
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 13:03:18,883 - INFO - Body: b'------WebKitFormBoundary3B2xjOyyImOlCu5H\r\nContent-Disposition: form-data; name="csv_file"; filename="eventsheetwsfx_08_10.csv"\r\nContent-Type: text/csv\r\n\r\neventName,eventPayload,dataType\r\nnew_registration,NAME,text\r\n,EMAIL,text\r\n,MOBILE,text\r\n,registration_successful,text\r\n,registration_date_and_time,date\r\n,source,text\r\nlogin,MOBILE,text\r\n,NAME,text\r\n,EMAIL,text\r\n,login_date_and_time,date\r\nprofile_completion,NAME,text\r\n,MOBILE,text\r\n,profile_update_successful,Text\r\nstudent_remittance,currency,text\r\n,MOBILE,text\r\n,currencyamount,float\r\n,remittancecountry,text\r\n,remittancepurpose,Text\r\n,beneficiaryname,text\r\n,a2_form_e-sign,text\r\n,order_booked,text\r\n,payments,text\r\n,document_upload,text\r\n,source,text\r\npayments,book_and_pay,text\r\n,mode_of_payment,text\r\n,source,text\r\nPersonal Remittance,order_started,float\r\n,remittancepurpose,text\r\n,remittance_country,text\r\n,currency,integer\r\n,currency_amount,float\r\n,beneficiary_name,text\r\n,a2_form_resign,text\r\n,order_booked,integer\r\nForex Card,order_started,text\r\n,email,text\r\n,name,text\r\n,mobile,integer\r\n,currency,text\r\n,currency_amount,float\r\n,delivery_branch,text\r\n,travel_subpurpose,text\r\n,order_start_date,date\r\n,a2_form,text\r\n,order_date,date\r\n,order_booked,text\r\nLink card Step1,Link Card - Step 1,text\r\n,link_card_method,text\r\n,link_card_method_status,text\r\nLink card Step2,"Link Card-Step 2, provide DOB and card expiry",\r\n,link_card_method,text\r\n,link_card_method_status,text\r\n,date_of_birth,date\r\n,card_expiry,text\r\nHome Rate calculator,Check rate at home page,text\r\n,email,text\r\n,name,text\r\n,mobile,integer\r\n,rate,float\r\n,currency,integer\r\n,amount,float\r\n,send_money_amount,float\r\n,buy_card_amount,float\r\nRefer and Earn,source,text\r\n,refer_and_earn_type,text\r\nSecurity Settings,enable_fingerprint,text\r\n,set_new_app_pin,text\r\n,forgot_pin,text\r\n,set_login_password,text\r\n,update_successful,text\r\nATM Locator,search_for_any_location,text\r\n,atm_locator_visit,text\r\nNotifications,source,text\r\n,notification_visit,text\r\n,notification_number,integer\r\n,notification_name,text\r\nRates,source,text\r\n,rate_page_visit,text\r\n,rate_watchlist_mark,text\r\nSupport,call,text\r\n,email,text\r\n,service_request,text\r\n,whatsapp,text\r\n,customer_feedback,text\r\nOffers and Rewards,tap_on_exciting_rewards,text\r\n,tap_on_rewards,text\r\n,rewards_refer_and_earn,text\r\n,rewards_claimed_vouchers,text\r\n,rewards_amazon,text\r\n,rewards_flipkart,text\r\n,rewards_myntra,text\r\n,rewards_starbucks,text\r\n,rewards_shoppersstop,text\r\nCurrency Converter,source,text\r\n,from_currency,text\r\n,to_currency,text\r\n,converted_amount,float\r\nRate Alert,source,text\r\n,rate_buy_or_sell,text\r\n,set_alert_for_product,text\r\n,Rate_currency,text\r\n,highest_rate,float\r\n,lowest_rate,float\r\n,set_rate_alert,float\r\nBranch Network,source,text\r\n,branch_page_visit,text\r\nTravel Insurance,source,text\r\n,name_of_the_passenger,text\r\n,destination_name,text\r\n,show_plans,text\r\n,departure_date,date\r\n,arrival_date,date\r\n,buy_plan,text\r\nGIC Account Apply,name,text\r\n,mobile,integer\r\n,email,text\r\n,submit,text\r\n,pan_number,text\r\n,source,text\r\n,passport_number,text\r\nBlocked Account Apply,source,text\r\n,name,text\r\n,mobile,integer\r\n,email,text\r\n,submit,text\r\n,pan_number,text\r\n,passport_number,text\r\n,source,text\r\nForex Card Reload,order_started,text\r\n,email,text\r\n,name,text\r\n,mobile,integer\r\n,currency_amount,float\r\n,delivery_branch,text\r\n,travel_subpurpose,text\r\n,order_start_date_and_time,date\r\n,a2_form,text\r\n,order_booked,text\r\n,source,text\r\n,currency,text\r\n------WebKitFormBoundary3B2xjOyyImOlCu5H\r\nContent-Disposition: form-data; name="txt_file"; filename="logs_08_10.txt"\r\nContent-Type: text/plain\r\n\r\nEvent Payload: {"networkMode":"Unknown","eventId":0,"attrParams":{},"lng":"-122.084","timeZone":"GMT+05:30","sessionId":"1759922362147","td":0,"screenOrientation":"portrait","payload":{"source":"app","profile_update_successful":"Yes","NAME":"NIKHIL SURESH GURAV","MOBILE":"7021328824"},"identity":"917021328824","eventTime":"1759922419259","eventName":"profile_completion","lat":"37.421998333333335","retry":0}\n\nEvent Payload: {"networkMode":"Unknown","eventId":0,"attrParams":{},"lng":"-122.084","timeZone":"GMT+05:30","sessionId":"1759922362147","td":0,"screenOrientation":"portrait","payload":{"remittancepurpose":null,"beneficiaryname":"","currencyamount":"2000.0","a2_form_e-sign":"yes","remittancecountry":"","order_booked":"yes","payments":"","mobile":"7021328824","currency":"USD","source":"app","document_upload":""},"identity":"917021328824","eventTime":"1759922590370","eventName":"student_remittance","lat":"37.421998333333335","retry":0}\n\nEvent Payload: {"networkMode":"Unknown","eventId":0,"attrParams":{},"lng":"-122.084","timeZone":"GMT+05:30","sessionId":"1759922362147","td":0,"screenOrientation":"portrait","payload":{"remittancepurpose":null,"beneficiaryname":"","currencyamount":"2000.0","remittancecountry":"","a2_form_resign":"yes","order_booked":"yes","currency":"USD","source":"app","order_started":0},"identity":"917021328824","eventTime":"1759922839952","eventName":"Personal Remittance","lat":"37.421998333333335","retry":0}\n\nEvent Payload: {"networkMode":"Unknown","eventId":0,"attrParams":{},"lng":"-122.084","timeZone":"GMT+05:30","sessionId":"1759922362147","td":0,"screenOrientation":"portrait","payload":{"book_and_pay":"No","mode_of_payment":"MANUAL","source":"app"},"identity":"917021328824","eventTime":"1759923014680","eventName":"payments","lat":"37.421998333333335","retry":0}\n\nEvent Payload: {"networkMode":"Unknown","eventId":0,"attrParams":{},"lng":"-122.084","timeZone":"GMT+05:30","sessionId":"1759922362147","td":0,"screenOrientation":"portrait","payload":{"currency_amount":"1000.0","travel_subpurpose":"STUDENT TRAVEL","mobile":"917021328824","delivery_branch":"Select","order_start_date":"2025-10-08 17:09:39","a2_form":"signed","source":"app","order_date":"2025-10-08 17:09:39","order_booked":"yes","name":"Nikhil","currency":"USD","email":"nikhil.g@wsfx.in","order_started":"yes"},"identity":"917021328824","eventTime":"1759923581042","eventName":"Forex Card Reload","lat":"37.421998333333335","retry":0}\n\nEvent Payload: {"networkMode":"Unknown","eventId":0,"attrParams":{},"lng":"-122.084","timeZone":"GMT+05:30","sessionId":"1759922362147","td":0,"screenOrientation":"portrait","payload":{"refer_and_earn_type":"WhatsApp","source":"app"},"identity":"917021328824","eventTime":"1759923860131","eventName":"Refer and Earn","lat":"37.421998333333335","retry":0}\n\nEvent Payload: {"networkMode":"Unknown","eventId":0,"attrParams":{},"lng":"-122.084","timeZone":"GMT+05:30","sessionId":"1759922362147","td":0,"screenOrientation":"portrait","payload":{"from_currency":"USD","converted_amount":"0.7785","source":"app","to_currency":"GBP"},"identity":"917021328824","eventTime":"1759923885360","eventName":"Currency Converter","lat":"37.421998333333335","retry":0}\n\nEvent Payload: {"networkMode":"Unknown","eventId":0,"attrParams":{},"lng":"-122.084","timeZone":"GMT+05:30","sessionId":"1759922362147","td":0,"screenOrientation":"portrait","payload":{"search_for_any_location":"https:\\/\\/maps.google.com\\/?q=0.0,0.0","atm_locator_visit":"yes","source":"app"},"identity":"917021328824","eventTime":"1759923908693","eventName":"ATM Locator","lat":"37.421998333333335","retry":0}\n\nEvent Payload: {"networkMode":"Unknown","eventId":0,"attrParams":{},"lng":"-122.084","timeZone":"GMT+05:30","sessionId":"1759922362147","td":0,"screenOrientation":"portrait","payload":{"branch_page_visit":"yes","source":"app"},"identity":"917021328824","eventTime":"1759923925678","eventName":"Branch Network","lat":"37.421998333333335","retry":0}\n\nEvent Payload: {"networkMode":"Unknown","eventId":0,"attrParams":{},"lng":"-122.084","timeZone":"GMT+05:30","sessionId":"1759922362147","td":0,"screenOrientation":"portrait","payload":{"enable_fingerprint":"Yes","set_new_app_pin":"No","forgot_pin":"No","set_login_password":"No","update_successful":"Yes","source":"app"},"identity":"917021328824","eventTime":"1759924113634","eventName":"Security Settings","lat":"37.421998333333335","retry":0}\n\nEvent Payload: {"networkMode":"Unknown","eventId":0,"attrParams":{},"lng":"-122.084","timeZone":"GMT+05:30","sessionId":"1759922362147","td":0,"screenOrientation":"portrait","payload":{"rewards_starbucks":"No","rewards_claimed_vouchers":"No","rewards_amazon":"No","tap_on_exciting_offers":"No","rewards_shoppers_stop":"No","rewards_myntra":"No","tap_on_reward":"No","rewards_refer_and_earn":"No","rewards_flipkart":"No","source":"app"},"identity":"917021328824","eventTime":"1759924478369","eventName":"Offers and Rewards","lat":"37.421998333333335","retry":0}\n\nEvent Payload: {"networkMode":"Unknown","eventId":0,"attrParams":{},"lng":"-122.084","timeZone":"GMT+05:30","sessionId":"1759922362147","td":0,"screenOrientation":"portrait","payload":{"rate_page_visit":"yes","source":"app","rate_watchlist_mark":"No"},"identity":"917021328824","eventTime":"1759924587740","eventName":"Rates","lat":"37.421998333333335","retry":0}\n\nEvent Payload: {"networkMode":"Unknown","eventId":0,"attrParams":{},"lng":"-122.084","timeZone":"GMT+05:30","sessionId":"1759922362147","td":0,"screenOrientation":"portrait","payload":{"show_plans":"yes","name_of_the_passenger":"NIKHIL SURESH GURAV","departure_date":"2025-10-08 00:00:00.000","buy_plan":"Yes","destination_name":"Canada","source":"app","arrival_date":"2025-10-17 00:00:00.000"},"identity":"917021328824","eventTime":"1759924782239","eventName":"Travel Insurance","lat":"37.421998333333335","retry":0}\n\r\n------WebKitFormBoundary3B2xjOyyImOlCu5H--\r\n'
2025-10-10 13:03:18,884 - INFO - URL: http://localhost:10000/upload
2025-10-10 13:03:18,884 - INFO - Method: POST
2025-10-10 13:03:18,884 - INFO - Endpoint: upload
2025-10-10 13:03:18,884 - INFO - Upload endpoint called
2025-10-10 13:03:18,887 - INFO - file_upload: {"csv_file": "eventsheetwsfx_08_10.csv", "txt_file": "logs_08_10.txt", "timestamp": "2025-10-10T13:03:18.886783"}
2025-10-10 13:03:18,891 - INFO - validation_complete: {"total_validations": 95, "valid_count": 48, "invalid_count": 47, "csv_events_count": 24, "log_events_count": 13, "extra_events_count": 0}
2025-10-10 13:03:18,893 - INFO - Response: b'{\n  "fully_valid_events": [\n    "payments",\n    "refer and earn",\n    "rates",\n    "branch network"\n  ],\n  "original_logs": {\n    "atm locator": "Event Payload: {\\"networkMode\\":\\"Unknown\\",\\"eventId\\":0,\\"attrParams\\":{},\\"lng\\":\\"-122.084\\",\\"timeZone\\":\\"GMT+05:30\\",\\"sessionId\\":\\"1759922362147\\",\\"td\\":0,\\"screenOrientation\\":\\"portrait\\",\\"payload\\":{\\"search_for_any_location\\":\\"https:\\\\/\\\\/maps.google.com\\\\/?q=0.0,0.0\\",\\"atm_locator_visit\\":\\"yes\\",\\"source\\":\\"app\\"},\\"identity\\":\\"917021328824\\",\\"eventTime\\":\\"1759923908693\\",\\"eventName\\":\\"ATM Locator\\",\\"lat\\":\\"37.421998333333335\\",\\"retry\\":0}",\n    "branch network": "Event Payload: {\\"networkMode\\":\\"Unknown\\",\\"eventId\\":0,\\"attrParams\\":{},\\"lng\\":\\"-122.084\\",\\"timeZone\\":\\"GMT+05:30\\",\\"sessionId\\":\\"1759922362147\\",\\"td\\":0,\\"screenOrientation\\":\\"portrait\\",\\"payload\\":{\\"branch_page_visit\\":\\"yes\\",\\"source\\":\\"app\\"},\\"identity\\":\\"917021328824\\",\\"eventTime\\":\\"1759923925678\\",\\"eventName\\":\\"Branch Network\\",\\"lat\\":\\"37.421998333333335\\",\\"retry\\":0}",\n    "currency converter": "Event Payload: {\\"networkMode\\":\\"Unknown\\",\\"eventId\\":0,\\"attrParams\\":{},\\"lng\\":\\"-122.084\\",\\"timeZone\\":\\"GMT+05:30\\",\\"sessionId\\":\\"1759922362147\\",\\"td\\":0,\\"screenOrientation\\":\\"portrait\\",\\"payload\\":{\\"from_currency\\":\\"USD\\",\\"converted_amount\\":\\"0.7785\\",\\"source\\":\\"app\\",\\"to_currency\\":\\"GBP\\"},\\"identity\\":\\"917021328824\\",\\"eventTime\\":\\"1759923885360\\",\\"eventName\\":\\"Currency Converter\\",\\"lat\\":\\"37.421998333333335\\",\\"retry\\":0}",\n    "forex card reload": "Event Payload: {\\"networkMode\\":\\"Unknown\\",\\"eventId\\":0,\\"attrParams\\":{},\\"lng\\":\\"-122.084\\",\\"timeZone\\":\\"GMT+05:30\\",\\"sessionId\\":\\"1759922362147\\",\\"td\\":0,\\"screenOrientation\\":\\"portrait\\",\\"payload\\":{\\"currency_amount\\":\\"1000.0\\",\\"travel_subpurpose\\":\\"STUDENT TRAVEL\\",\\"mobile\\":\\"917021328824\\",\\"delivery_branch\\":\\"Select\\",\\"order_start_date\\":\\"2025-10-08 17:09:39\\",\\"a2_form\\":\\"signed\\",\\"source\\":\\"app\\",\\"order_date\\":\\"2025-10-08 17:09:39\\",\\"order_booked\\":\\"yes\\",\\"name\\":\\"Nikhil\\",\\"currency\\":\\"USD\\",\\"email\\":\\"nikhil.g@wsfx.in\\",\\"order_started\\":\\"yes\\"},\\"identity\\":\\"917021328824\\",\\"eventTime\\":\\"1759923581042\\",\\"eventName\\":\\"Forex Card Reload\\",\\"lat\\":\\"37.421998333333335\\",\\"retry\\":0}",\n    "offers and rewards": "Event Payload: {\\"networkMode\\":\\"Unknown\\",\\"eventId\\":0,\\"attrParams\\":{},\\"lng\\":\\"-122.084\\",\\"timeZone\\":\\"GMT+05:30\\",\\"sessionId\\":\\"1759922362147\\",\\"td\\":0,\\"screenOrientation\\":\\"portrait\\",\\"payload\\":{\\"rewards_starbucks\\":\\"No\\",\\"rewards_claimed_vouchers\\":\\"No\\",\\"rewards_amazon\\":\\"No\\",\\"tap_on_exciting_offers\\":\\"No\\",\\"rewards_shoppers_stop\\":\\"No\\",\\"rewards_myntra\\":\\"No\\",\\"tap_on_reward\\":\\"No\\",\\"rewards_refer_and_earn\\":\\"No\\",\\"rewards_flipkart\\":\\"No\\",\\"source\\":\\"app\\"},\\"identity\\":\\"917021328824\\",\\"eventTime\\":\\"1759924478369\\",\\"eventName\\":\\"Offers and Rewards\\",\\"lat\\":\\"37.421998333333335\\",\\"retry\\":0}",\n    "payments": "Event Payload: {\\"networkMode\\":\\"Unknown\\",\\"eventId\\":0,\\"attrParams\\":{},\\"lng\\":\\"-122.084\\",\\"timeZone\\":\\"GMT+05:30\\",\\"sessionId\\":\\"1759922362147\\",\\"td\\":0,\\"screenOrientation\\":\\"portrait\\",\\"payload\\":{\\"book_and_pay\\":\\"No\\",\\"mode_of_payment\\":\\"MANUAL\\",\\"source\\":\\"app\\"},\\"identity\\":\\"917021328824\\",\\"eventTime\\":\\"1759923014680\\",\\"eventName\\":\\"payments\\",\\"lat\\":\\"37.421998333333335\\",\\"retry\\":0}",\n    "personal remittance": "Event Payload: {\\"networkMode\\":\\"Unknown\\",\\"eventId\\":0,\\"attrParams\\":{},\\"lng\\":\\"-122.084\\",\\"timeZone\\":\\"GMT+05:30\\",\\"sessionId\\":\\"1759922362147\\",\\"td\\":0,\\"screenOrientation\\":\\"portrait\\",\\"payload\\":{\\"remittancepurpose\\":null,\\"beneficiaryname\\":\\"\\",\\"currencyamount\\":\\"2000.0\\",\\"remittancecountry\\":\\"\\",\\"a2_form_resign\\":\\"yes\\",\\"order_booked\\":\\"yes\\",\\"currency\\":\\"USD\\",\\"source\\":\\"app\\",\\"order_started\\":0},\\"identity\\":\\"917021328824\\",\\"eventTime\\":\\"1759922839952\\",\\"eventName\\":\\"Personal Remittance\\",\\"lat\\":\\"37.421998333333335\\",\\"retry\\":0}",\n    "profile_completion": "Event Payload: {\\"networkMode\\":\\"Unknown\\",\\"eventId\\":0,\\"attrParams\\":{},\\"lng\\":\\"-122.084\\",\\"timeZone\\":\\"GMT+05:30\\",\\"sessionId\\":\\"1759922362147\\",\\"td\\":0,\\"screenOrientation\\":\\"portrait\\",\\"payload\\":{\\"source\\":\\"app\\",\\"profile_update_successful\\":\\"Yes\\",\\"NAME\\":\\"NIKHIL SURESH GURAV\\",\\"MOBILE\\":\\"7021328824\\"},\\"identity\\":\\"917021328824\\",\\"eventTime\\":\\"1759922419259\\",\\"eventName\\":\\"profile_completion\\",\\"lat\\":\\"37.421998333333335\\",\\"retry\\":0}",\n    "rates": "Event Payload: {\\"networkMode\\":\\"Unknown\\",\\"eventId\\":0,\\"attrParams\\":{},\\"lng\\":\\"-122.084\\",\\"timeZone\\":\\"GMT+05:30\\",\\"sessionId\\":\\"1759922362147\\",\\"td\\":0,\\"screenOrientation\\":\\"portrait\\",\\"payload\\":{\\"rate_page_visit\\":\\"yes\\",\\"source\\":\\"app\\",\\"rate_watchlist_mark\\":\\"No\\"},\\"identity\\":\\"917021328824\\",\\"eventTime\\":\\"1759924587740\\",\\"eventName\\":\\"Rates\\",\\"lat\\":\\"37.421998333333335\\",\\"retry\\":0}",\n    "refer and earn": "Event Payload: {\\"networkMode\\":\\"Unknown\\",\\"eventId\\":0,\\"attrParams\\":{},\\"lng\\":\\"-122.084\\",\\"timeZone\\":\\"GMT+05:30\\",\\"sessionId\\":\\"1759922362147\\",\\"td\\":0,\\"screenOrientation\\":\\"portrait\\",\\"payload\\":{\\"refer_and_earn_type\\":\\"WhatsApp\\",\\"source\\":\\"app\\"},\\"identity\\":\\"917021328824\\",\\"eventTime\\":\\"1759923860131\\",\\"eventName\\":\\"Refer and Earn\\",\\"lat\\":\\"37.421998333333335\\",\\"retry\\":0}",\n    "security settings": "Event Payload: {\\"networkMode\\":\\"Unknown\\",\\"eventId\\":0,\\"attrParams\\":{},\\"lng\\":\\"-122.084\\",\\"timeZone\\":\\"GMT+05:30\\",\\"sessionId\\":\\"1759922362147\\",\\"td\\":0,\\"screenOrientation\\":\\"portrait\\",\\"payload\\":{\\"enable_fingerprint\\":\\"Yes\\",\\"set_new_app_pin\\":\\"No\\",\\"forgot_pin\\":\\"No\\",\\"set_login_password\\":\\"No\\",\\"update_successful\\":\\"Yes\\",\\"source\\":\\"app\\"},\\"identity\\":\\"917021328824\\",\\"eventTime\\":\\"1759924113634\\",\\"eventName\\":\\"Security Settings\\",\\"lat\\":\\"37.421998333333335\\",\\"retry\\":0}",\n    "student_remittance": "Event Payload: {\\"networkMode\\":\\"Unknown\\",\\"eventId\\":0,\\"attrParams\\":{},\\"lng\\":\\"-122.084\\",\\"timeZone\\":\\"GMT+05:30\\",\\"sessionId\\":\\"1759922362147\\",\\"td\\":0,\\"screenOrientation\\":\\"portrait\\",\\"payload\\":{\\"remittancepurpose\\":null,\\"beneficiaryname\\":\\"\\",\\"currencyamount\\":\\"2000.0\\",\\"a2_form_e-sign\\":\\"yes\\",\\"remittancecountry\\":\\"\\",\\"order_booked\\":\\"yes\\",\\"payments\\":\\"\\",\\"mobile\\":\\"7021328824\\",\\"currency\\":\\"USD\\",\\"source\\":\\"app\\",\\"document_upload\\":\\"\\"},\\"identity\\":\\"917021328824\\",\\"eventTime\\":\\"1759922590370\\",\\"eventName\\":\\"student_remittance\\",\\"lat\\":\\"37.421998333333335\\",\\"retry\\":0}",\n    "travel insurance": "Event Payload: {\\"networkMode\\":\\"Unknown\\",\\"eventId\\":0,\\"attrParams\\":{},\\"lng\\":\\"-122.084\\",\\"timeZone\\":\\"GMT+05:30\\",\\"sessionId\\":\\"1759922362147\\",\\"td\\":0,\\"screenOrientation\\":\\"portrait\\",\\"payload\\":{\\"show_plans\\":\\"yes\\",\\"name_of_the_passenger\\":\\"NIKHIL SURESH GURAV\\",\\"departure_date\\":\\"2025-10-08 00:00:00.000\\",\\"buy_plan\\":\\"Yes\\",\\"destination_name\\":\\"Canada\\",\\"source\\":\\"app\\",\\"arrival_date\\":\\"2025-10-17 00:00:00.000\\"},\\"identity\\":\\"917021328824\\",\\"eventTime\\":\\"1759924782239\\",\\"eventName\\":\\"Travel Insurance\\",\\"lat\\":\\"37.421998333333335\\",\\"retry\\":0}"\n  },\n  "results": [\n    {\n      "comment": "Event \\"new_registration\\" from CSV was not found in the uploaded log file",\n      "eventName": "new_registration",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "new_registration"\n    },\n    {\n      "comment": "Event \\"login\\" from CSV was not found in the uploaded log file",\n      "eventName": "login",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "login"\n    },\n    {\n      "eventName": "profile_completion",\n      "expectedType": "EXTRA",\n      "key": "source",\n      "receivedType": "text",\n      "validationStatus": "Extra key present in the log",\n      "value": "app"\n    },\n    {\n      "eventName": "profile_completion",\n      "expectedType": "text",\n      "key": "name",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "NIKHIL SURESH GURAV"\n    },\n    {\n      "eventName": "profile_completion",\n      "expectedType": "text",\n      "key": "mobile",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "7021328824"\n    },\n    {\n      "eventName": "profile_completion",\n      "expectedType": "Text",\n      "key": "profile_update_successful",\n      "receivedType": "text",\n      "validationStatus": "Invalid/Wrong datatype/value",\n      "value": "Yes"\n    },\n    {\n      "eventName": "student_remittance",\n      "expectedType": "text",\n      "key": "currency",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "USD"\n    },\n    {\n      "eventName": "student_remittance",\n      "expectedType": "text",\n      "key": "mobile",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "7021328824"\n    },\n    {\n      "eventName": "student_remittance",\n      "expectedType": "float",\n      "key": "currencyamount",\n      "receivedType": "text",\n      "validationStatus": "Invalid/Wrong datatype/value",\n      "value": "2000.0"\n    },\n    {\n      "eventName": "student_remittance",\n      "expectedType": "text",\n      "key": "remittancecountry",\n      "receivedType": "text",\n      "validationStatus": "Payload value is Empty",\n      "value": ""\n    },\n    {\n      "eventName": "student_remittance",\n      "expectedType": "Text",\n      "key": "remittancepurpose",\n      "receivedType": "null",\n      "validationStatus": "Payload value is Empty",\n      "value": null\n    },\n    {\n      "eventName": "student_remittance",\n      "expectedType": "text",\n      "key": "beneficiaryname",\n      "receivedType": "text",\n      "validationStatus": "Payload value is Empty",\n      "value": ""\n    },\n    {\n      "eventName": "student_remittance",\n      "expectedType": "text",\n      "key": "a2_form_e-sign",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "yes"\n    },\n    {\n      "eventName": "student_remittance",\n      "expectedType": "text",\n      "key": "order_booked",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "yes"\n    },\n    {\n      "eventName": "student_remittance",\n      "expectedType": "text",\n      "key": "payments",\n      "receivedType": "text",\n      "validationStatus": "Payload value is Empty",\n      "value": ""\n    },\n    {\n      "eventName": "student_remittance",\n      "expectedType": "text",\n      "key": "document_upload",\n      "receivedType": "text",\n      "validationStatus": "Payload value is Empty",\n      "value": ""\n    },\n    {\n      "eventName": "student_remittance",\n      "expectedType": "text",\n      "key": "source",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "app"\n    },\n    {\n      "eventName": "payments",\n      "expectedType": "text",\n      "key": "book_and_pay",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "No"\n    },\n    {\n      "eventName": "payments",\n      "expectedType": "text",\n      "key": "mode_of_payment",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "MANUAL"\n    },\n    {\n      "eventName": "payments",\n      "expectedType": "text",\n      "key": "source",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "app"\n    },\n    {\n      "eventName": "personal remittance",\n      "expectedType": "EXTRA",\n      "key": "currencyamount",\n      "receivedType": "text",\n      "validationStatus": "Extra key present in the log",\n      "value": "2000.0"\n    },\n    {\n      "eventName": "personal remittance",\n      "expectedType": "EXTRA",\n      "key": "source",\n      "receivedType": "text",\n      "validationStatus": "Extra key present in the log",\n      "value": "app"\n    },\n    {\n      "eventName": "personal remittance",\n      "expectedType": "EXTRA",\n      "key": "remittancecountry",\n      "receivedType": "text",\n      "validationStatus": "Extra key present in the log",\n      "value": ""\n    },\n    {\n      "eventName": "personal remittance",\n      "expectedType": "EXTRA",\n      "key": "beneficiaryname",\n      "receivedType": "text",\n      "validationStatus": "Extra key present in the log",\n      "value": ""\n    },\n    {\n      "eventName": "personal remittance",\n      "expectedType": "float",\n      "key": "order_started",\n      "receivedType": "integer",\n      "validationStatus": "Invalid/Wrong datatype/value",\n      "value": 0\n    },\n    {\n      "eventName": "personal remittance",\n      "expectedType": "text",\n      "key": "remittancepurpose",\n      "receivedType": "null",\n      "validationStatus": "Payload value is Empty",\n      "value": null\n    },\n    {\n      "eventName": "personal remittance",\n      "expectedType": "text",\n      "key": "remittance_country",\n      "receivedType": "not present",\n      "validationStatus": "Payload not present in the log",\n      "value": null\n    },\n    {\n      "eventName": "personal remittance",\n      "expectedType": "integer",\n      "key": "currency",\n      "receivedType": "text",\n      "validationStatus": "Invalid/Wrong datatype/value",\n      "value": "USD"\n    },\n    {\n      "eventName": "personal remittance",\n      "expectedType": "float",\n      "key": "currency_amount",\n      "receivedType": "not present",\n      "validationStatus": "Payload not present in the log",\n      "value": null\n    },\n    {\n      "eventName": "personal remittance",\n      "expectedType": "text",\n      "key": "beneficiary_name",\n      "receivedType": "not present",\n      "validationStatus": "Payload not present in the log",\n      "value": null\n    },\n    {\n      "eventName": "personal remittance",\n      "expectedType": "text",\n      "key": "a2_form_resign",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "yes"\n    },\n    {\n      "eventName": "personal remittance",\n      "expectedType": "integer",\n      "key": "order_booked",\n      "receivedType": "text",\n      "validationStatus": "Invalid/Wrong datatype/value",\n      "value": "yes"\n    },\n    {\n      "comment": "Event \\"forex card\\" from CSV was not found in the uploaded log file",\n      "eventName": "forex card",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "forex card"\n    },\n    {\n      "comment": "Event \\"link card step1\\" from CSV was not found in the uploaded log file",\n      "eventName": "link card step1",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "link card step1"\n    },\n    {\n      "comment": "Event \\"link card step2\\" from CSV was not found in the uploaded log file",\n      "eventName": "link card step2",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "link card step2"\n    },\n    {\n      "comment": "Event \\"home rate calculator\\" from CSV was not found in the uploaded log file",\n      "eventName": "home rate calculator",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "home rate calculator"\n    },\n    {\n      "eventName": "refer and earn",\n      "expectedType": "text",\n      "key": "source",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "app"\n    },\n    {\n      "eventName": "refer and earn",\n      "expectedType": "text",\n      "key": "refer_and_earn_type",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "WhatsApp"\n    },\n    {\n      "eventName": "security settings",\n      "expectedType": "EXTRA",\n      "key": "source",\n      "receivedType": "text",\n      "validationStatus": "Extra key present in the log",\n      "value": "app"\n    },\n    {\n      "eventName": "security settings",\n      "expectedType": "text",\n      "key": "enable_fingerprint",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "Yes"\n    },\n    {\n      "eventName": "security settings",\n      "expectedType": "text",\n      "key": "set_new_app_pin",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "No"\n    },\n    {\n      "eventName": "security settings",\n      "expectedType": "text",\n      "key": "forgot_pin",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "No"\n    },\n    {\n      "eventName": "security settings",\n      "expectedType": "text",\n      "key": "set_login_password",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "No"\n    },\n    {\n      "eventName": "security settings",\n      "expectedType": "text",\n      "key": "update_successful",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "Yes"\n    },\n    {\n      "eventName": "atm locator",\n      "expectedType": "EXTRA",\n      "key": "source",\n      "receivedType": "text",\n      "validationStatus": "Extra key present in the log",\n      "value": "app"\n    },\n    {\n      "eventName": "atm locator",\n      "expectedType": "text",\n      "key": "search_for_any_location",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "https://maps.google.com/?q=0.0,0.0"\n    },\n    {\n      "eventName": "atm locator",\n      "expectedType": "text",\n      "key": "atm_locator_visit",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "yes"\n    },\n    {\n      "comment": "Event \\"notifications\\" from CSV was not found in the uploaded log file",\n      "eventName": "notifications",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "notifications"\n    },\n    {\n      "eventName": "rates",\n      "expectedType": "text",\n      "key": "source",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "app"\n    },\n    {\n      "eventName": "rates",\n      "expectedType": "text",\n      "key": "rate_page_visit",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "yes"\n    },\n    {\n      "eventName": "rates",\n      "expectedType": "text",\n      "key": "rate_watchlist_mark",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "No"\n    },\n    {\n      "comment": "Event \\"support\\" from CSV was not found in the uploaded log file",\n      "eventName": "support",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "support"\n    },\n    {\n      "eventName": "offers and rewards",\n      "expectedType": "EXTRA",\n      "key": "rewards_shoppers_stop",\n      "receivedType": "text",\n      "validationStatus": "Extra key present in the log",\n      "value": "No"\n    },\n    {\n      "eventName": "offers and rewards",\n      "expectedType": "EXTRA",\n      "key": "tap_on_reward",\n      "receivedType": "text",\n      "validationStatus": "Extra key present in the log",\n      "value": "No"\n    },\n    {\n      "eventName": "offers and rewards",\n      "expectedType": "EXTRA",\n      "key": "source",\n      "receivedType": "text",\n      "validationStatus": "Extra key present in the log",\n      "value": "app"\n    },\n    {\n      "eventName": "offers and rewards",\n      "expectedType": "EXTRA",\n      "key": "tap_on_exciting_offers",\n      "receivedType": "text",\n      "validationStatus": "Extra key present in the log",\n      "value": "No"\n    },\n    {\n      "eventName": "offers and rewards",\n      "expectedType": "text",\n      "key": "tap_on_exciting_rewards",\n      "receivedType": "not present",\n      "validationStatus": "Payload not present in the log",\n      "value": null\n    },\n    {\n      "eventName": "offers and rewards",\n      "expectedType": "text",\n      "key": "tap_on_rewards",\n      "receivedType": "not present",\n      "validationStatus": "Payload not present in the log",\n      "value": null\n    },\n    {\n      "eventName": "offers and rewards",\n      "expectedType": "text",\n      "key": "rewards_refer_and_earn",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "No"\n    },\n    {\n      "eventName": "offers and rewards",\n      "expectedType": "text",\n      "key": "rewards_claimed_vouchers",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "No"\n    },\n    {\n      "eventName": "offers and rewards",\n      "expectedType": "text",\n      "key": "rewards_amazon",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "No"\n    },\n    {\n      "eventName": "offers and rewards",\n      "expectedType": "text",\n      "key": "rewards_flipkart",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "No"\n    },\n    {\n      "eventName": "offers and rewards",\n      "expectedType": "text",\n      "key": "rewards_myntra",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "No"\n    },\n    {\n      "eventName": "offers and rewards",\n      "expectedType": "text",\n      "key": "rewards_starbucks",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "No"\n    },\n    {\n      "eventName": "offers and rewards",\n      "expectedType": "text",\n      "key": "rewards_shoppersstop",\n      "receivedType": "not present",\n      "validationStatus": "Payload not present in the log",\n      "value": null\n    },\n    {\n      "eventName": "currency converter",\n      "expectedType": "text",\n      "key": "source",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "app"\n    },\n    {\n      "eventName": "currency converter",\n      "expectedType": "text",\n      "key": "from_currency",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "USD"\n    },\n    {\n      "eventName": "currency converter",\n      "expectedType": "text",\n      "key": "to_currency",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "GBP"\n    },\n    {\n      "eventName": "currency converter",\n      "expectedType": "float",\n      "key": "converted_amount",\n      "receivedType": "text",\n      "validationStatus": "Invalid/Wrong datatype/value",\n      "value": "0.7785"\n    },\n    {\n      "comment": "Event \\"rate alert\\" from CSV was not found in the uploaded log file",\n      "eventName": "rate alert",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "rate alert"\n    },\n    {\n      "eventName": "branch network",\n      "expectedType": "text",\n      "key": "source",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "app"\n    },\n    {\n      "eventName": "branch network",\n      "expectedType": "text",\n      "key": "branch_page_visit",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "yes"\n    },\n    {\n      "eventName": "travel insurance",\n      "expectedType": "text",\n      "key": "source",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "app"\n    },\n    {\n      "eventName": "travel insurance",\n      "expectedType": "text",\n      "key": "name_of_the_passenger",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "NIKHIL SURESH GURAV"\n    },\n    {\n      "eventName": "travel insurance",\n      "expectedType": "text",\n      "key": "destination_name",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "Canada"\n    },\n    {\n      "eventName": "travel insurance",\n      "expectedType": "text",\n      "key": "show_plans",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "yes"\n    },\n    {\n      "eventName": "travel insurance",\n      "expectedType": "date",\n      "key": "departure_date",\n      "receivedType": "text",\n      "validationStatus": "Invalid/Wrong datatype/value",\n      "value": "2025-10-08 00:00:00.000"\n    },\n    {\n      "eventName": "travel insurance",\n      "expectedType": "date",\n      "key": "arrival_date",\n      "receivedType": "text",\n      "validationStatus": "Invalid/Wrong datatype/value",\n      "value": "2025-10-17 00:00:00.000"\n    },\n    {\n      "eventName": "travel insurance",\n      "expectedType": "text",\n      "key": "buy_plan",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "Yes"\n    },\n    {\n      "comment": "Event \\"gic account apply\\" from CSV was not found in the uploaded log file",\n      "eventName": "gic account apply",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "gic account apply"\n    },\n    {\n      "comment": "Event \\"blocked account apply\\" from CSV was not found in the uploaded log file",\n      "eventName": "blocked account apply",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "blocked account apply"\n    },\n    {\n      "eventName": "forex card reload",\n      "expectedType": "EXTRA",\n      "key": "order_date",\n      "receivedType": "date",\n      "validationStatus": "Extra key present in the log",\n      "value": "2025-10-08 17:09:39"\n    },\n    {\n      "eventName": "forex card reload",\n      "expectedType": "EXTRA",\n      "key": "order_start_date",\n      "receivedType": "date",\n      "validationStatus": "Extra key present in the log",\n      "value": "2025-10-08 17:09:39"\n    },\n    {\n      "eventName": "forex card reload",\n      "expectedType": "text",\n      "key": "order_started",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "yes"\n    },\n    {\n      "eventName": "forex card reload",\n      "expectedType": "text",\n      "key": "email",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "nikhil.g@wsfx.in"\n    },\n    {\n      "eventName": "forex card reload",\n      "expectedType": "text",\n      "key": "name",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "Nikhil"\n    },\n    {\n      "eventName": "forex card reload",\n      "expectedType": "integer",\n      "key": "mobile",\n      "receivedType": "text",\n      "validationStatus": "Invalid/Wrong datatype/value",\n      "value": "917021328824"\n    },\n    {\n      "eventName": "forex card reload",\n      "expectedType": "float",\n      "key": "currency_amount",\n      "receivedType": "text",\n      "validationStatus": "Invalid/Wrong datatype/value",\n      "value": "1000.0"\n    },\n    {\n      "eventName": "forex card reload",\n      "expectedType": "text",\n      "key": "delivery_branch",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "Select"\n    },\n    {\n      "eventName": "forex card reload",\n      "expectedType": "text",\n      "key": "travel_subpurpose",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "STUDENT TRAVEL"\n    },\n    {\n      "eventName": "forex card reload",\n      "expectedType": "date",\n      "key": "order_start_date_and_time",\n      "receivedType": "not present",\n      "validationStatus": "Payload not present in the log",\n      "value": null\n    },\n    {\n      "eventName": "forex card reload",\n      "expectedType": "text",\n      "key": "a2_form",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "signed"\n    },\n    {\n      "eventName": "forex card reload",\n      "expectedType": "text",\n      "key": "order_booked",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "yes"\n    },\n    {\n      "eventName": "forex card reload",\n      "expectedType": "text",\n      "key": "source",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "app"\n    },\n    {\n      "eventName": "forex card reload",\n      "expectedType": "text",\n      "key": "currency",\n      "receivedType": "text",\n      "validationStatus": "Valid",\n      "value": "USD"\n    }\n  ],\n  "summary": {\n    "csv_events": [\n      "home rate calculator",\n      "rates",\n      "new_registration",\n      "student_remittance",\n      "atm locator",\n      "blocked account apply",\n      "payments",\n      "support",\n      "notifications",\n      "profile_completion",\n      "offers and rewards",\n      "refer and earn",\n      "forex card",\n      "link card step2",\n      "security settings",\n      "rate alert",\n      "personal remittance",\n      "travel insurance",\n      "login",\n      "currency converter",\n      "link card step1",\n      "gic account apply",\n      "forex card reload",\n      "branch network"\n    ],\n    "csv_events_count": 24,\n    "extra_events": [],\n    "log_events": [\n      "profile_completion",\n      "offers and rewards",\n      "atm locator",\n      "rates",\n      "refer and earn",\n      "travel insurance",\n      "payments",\n      "currency converter",\n      "security settings",\n      "personal remittance",\n      "student_remittance",\n      "forex card reload",\n      "branch network"\n    ],\n    "log_events_count": 13\n  }\n}\n'
2025-10-10 13:03:18,894 - INFO - 127.0.0.1 - - [10/Oct/2025 13:03:18] "POST /upload HTTP/1.1" 200 -
2025-10-10 13:05:57,828 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Content-Length: 5002
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Accept: */*
Sec-Ch-Ua-Platform: "macOS"
X-Requested-With: XMLHttpRequest
Sec-Ch-Ua-Mobile: ?0
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryxoFI7b8xt14AdAK4
Origin: http://localhost:10000
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 13:05:57,829 - INFO - Body: b'------WebKitFormBoundaryxoFI7b8xt14AdAK4\r\nContent-Disposition: form-data; name="csv_file"; filename="eventsheetwsfx_08_10.csv"\r\nContent-Type: text/csv\r\n\r\neventName,eventPayload,dataType\r\nnew_registration,NAME,text\r\n,EMAIL,text\r\n,MOBILE,text\r\n,registration_successful,text\r\n,registration_date_and_time,date\r\n,source,text\r\nlogin,MOBILE,text\r\n,NAME,text\r\n,EMAIL,text\r\n,login_date_and_time,date\r\nprofile_completion,NAME,text\r\n,MOBILE,text\r\n,profile_update_successful,Text\r\nstudent_remittance,currency,text\r\n,MOBILE,text\r\n,currencyamount,float\r\n,remittancecountry,text\r\n,remittancepurpose,Text\r\n,beneficiaryname,text\r\n,a2_form_e-sign,text\r\n,order_booked,text\r\n,payments,text\r\n,document_upload,text\r\n,source,text\r\npayments,book_and_pay,text\r\n,mode_of_payment,text\r\n,source,text\r\nPersonal Remittance,order_started,float\r\n,remittancepurpose,text\r\n,remittance_country,text\r\n,currency,integer\r\n,currency_amount,float\r\n,beneficiary_name,text\r\n,a2_form_resign,text\r\n,order_booked,integer\r\nForex Card,order_started,text\r\n,email,text\r\n,name,text\r\n,mobile,integer\r\n,currency,text\r\n,currency_amount,float\r\n,delivery_branch,text\r\n,travel_subpurpose,text\r\n,order_start_date,date\r\n,a2_form,text\r\n,order_date,date\r\n,order_booked,text\r\nLink card Step1,Link Card - Step 1,text\r\n,link_card_method,text\r\n,link_card_method_status,text\r\nLink card Step2,"Link Card-Step 2, provide DOB and card expiry",\r\n,link_card_method,text\r\n,link_card_method_status,text\r\n,date_of_birth,date\r\n,card_expiry,text\r\nHome Rate calculator,Check rate at home page,text\r\n,email,text\r\n,name,text\r\n,mobile,integer\r\n,rate,float\r\n,currency,integer\r\n,amount,float\r\n,send_money_amount,float\r\n,buy_card_amount,float\r\nRefer and Earn,source,text\r\n,refer_and_earn_type,text\r\nSecurity Settings,enable_fingerprint,text\r\n,set_new_app_pin,text\r\n,forgot_pin,text\r\n,set_login_password,text\r\n,update_successful,text\r\nATM Locator,search_for_any_location,text\r\n,atm_locator_visit,text\r\nNotifications,source,text\r\n,notification_visit,text\r\n,notification_number,integer\r\n,notification_name,text\r\nRates,source,text\r\n,rate_page_visit,text\r\n,rate_watchlist_mark,text\r\nSupport,call,text\r\n,email,text\r\n,service_request,text\r\n,whatsapp,text\r\n,customer_feedback,text\r\nOffers and Rewards,tap_on_exciting_rewards,text\r\n,tap_on_rewards,text\r\n,rewards_refer_and_earn,text\r\n,rewards_claimed_vouchers,text\r\n,rewards_amazon,text\r\n,rewards_flipkart,text\r\n,rewards_myntra,text\r\n,rewards_starbucks,text\r\n,rewards_shoppersstop,text\r\nCurrency Converter,source,text\r\n,from_currency,text\r\n,to_currency,text\r\n,converted_amount,float\r\nRate Alert,source,text\r\n,rate_buy_or_sell,text\r\n,set_alert_for_product,text\r\n,Rate_currency,text\r\n,highest_rate,float\r\n,lowest_rate,float\r\n,set_rate_alert,float\r\nBranch Network,source,text\r\n,branch_page_visit,text\r\nTravel Insurance,source,text\r\n,name_of_the_passenger,text\r\n,destination_name,text\r\n,show_plans,text\r\n,departure_date,date\r\n,arrival_date,date\r\n,buy_plan,text\r\nGIC Account Apply,name,text\r\n,mobile,integer\r\n,email,text\r\n,submit,text\r\n,pan_number,text\r\n,source,text\r\n,passport_number,text\r\nBlocked Account Apply,source,text\r\n,name,text\r\n,mobile,integer\r\n,email,text\r\n,submit,text\r\n,pan_number,text\r\n,passport_number,text\r\n,source,text\r\nForex Card Reload,order_started,text\r\n,email,text\r\n,name,text\r\n,mobile,integer\r\n,currency_amount,float\r\n,delivery_branch,text\r\n,travel_subpurpose,text\r\n,order_start_date_and_time,date\r\n,a2_form,text\r\n,order_booked,text\r\n,source,text\r\n,currency,text\r\n------WebKitFormBoundaryxoFI7b8xt14AdAK4\r\nContent-Disposition: form-data; name="txt_file"; filename="sample_website_logs_v2_multiline.txt"\r\nContent-Type: text/plain\r\n\r\n{\n    "src": "GUWAHATI (GAU)",\n    "des": "NEW DELHI (DEL)",\n    "flight_type": "domestic",\n    "departure_date": "05-08-2025",\n    "return_date": "",\n    "passenger_adult": 1,\n    "passenger_child": 0,\n    "flight_class": "economy",\n    "source": "web",\n    "event": "flight searched",\n    "url": "https://happyfares.in/?rdt=true~in",\n    "purl": "https://happyfares.in/home",\n    "title": "Flight Tickets Booking at HappyFares.in, Cheap Flights Fares.",\n    "npv": 1,\n    "sts": 455,\n    "pts": 322,\n    "timestamp": 1754392679207\n}\n{\n    "product_id": "12345",\n    "product_name": "iPhone 15",\n    "category": "Electronics",\n    "brand": "Apple",\n    "price": 79999,\n    "currency": "INR",\n    "event": "product viewed",\n    "url": "https://example.com/product/12345",\n    "purl": "https://example.com/products",\n    "title": "iPhone 15 - Example Store",\n    "npv": 1,\n    "sts": 300,\n    "pts": 150,\n    "timestamp": 1754392679208\n}\n{\n    "order_id": "ORD789",\n    "total_amount": 79999,\n    "currency": "INR",\n    "payment_method": "credit_card",\n    "shipping_address": "456 Oak St, City, State 54321",\n    "event": "purchase completed",\n    "url": "https://example.com/checkout",\n    "purl": "https://example.com/cart",\n    "title": "Checkout - Example Store",\n    "npv": 1,\n    "sts": 400,\n    "pts": 200,\n    "timestamp": 1754392679209\n} \r\n------WebKitFormBoundaryxoFI7b8xt14AdAK4--\r\n'
2025-10-10 13:05:57,829 - INFO - URL: http://localhost:10000/validate-website-logs-v2
2025-10-10 13:05:57,829 - INFO - Method: POST
2025-10-10 13:05:57,829 - INFO - Endpoint: validate_website_logs_v2
2025-10-10 13:05:57,829 - INFO - Website logs v2 validation endpoint called
2025-10-10 13:05:57,831 - INFO - website_logs_v2_upload: {"csv_file": "eventsheetwsfx_08_10.csv", "txt_file": "sample_website_logs_v2_multiline.txt", "timestamp": "2025-10-10T13:05:57.831183"}
2025-10-10 13:05:57,833 - INFO - website_logs_v2_validation_complete: {"total_validations": 47, "valid_count": 0, "invalid_count": 47, "csv_events_count": 24, "log_events_count": 3, "extra_events_count": 3, "total_log_entries": 3}
2025-10-10 13:05:57,833 - INFO - Response: b'{\n  "fully_valid_events": [],\n  "original_logs": {\n    "flight searched": "{\\"src\\": \\"GUWAHATI (GAU)\\",\\"des\\": \\"NEW DELHI (DEL)\\",\\"flight_type\\": \\"domestic\\",\\"departure_date\\": \\"05-08-2025\\",\\"return_date\\": \\"\\",\\"passenger_adult\\": 1,\\"passenger_child\\": 0,\\"flight_class\\": \\"economy\\",\\"source\\": \\"web\\",\\"event\\": \\"flight searched\\",\\"url\\": \\"https://happyfares.in/?rdt=true~in\\",\\"purl\\": \\"https://happyfares.in/home\\",\\"title\\": \\"Flight Tickets Booking at HappyFares.in, Cheap Flights Fares.\\",\\"npv\\": 1,\\"sts\\": 455,\\"pts\\": 322,\\"timestamp\\": 1754392679207}",\n    "product viewed": "{\\"product_id\\": \\"12345\\",\\"product_name\\": \\"iPhone 15\\",\\"category\\": \\"Electronics\\",\\"brand\\": \\"Apple\\",\\"price\\": 79999,\\"currency\\": \\"INR\\",\\"event\\": \\"product viewed\\",\\"url\\": \\"https://example.com/product/12345\\",\\"purl\\": \\"https://example.com/products\\",\\"title\\": \\"iPhone 15 - Example Store\\",\\"npv\\": 1,\\"sts\\": 300,\\"pts\\": 150,\\"timestamp\\": 1754392679208}",\n    "purchase completed": "{\\"order_id\\": \\"ORD789\\",\\"total_amount\\": 79999,\\"currency\\": \\"INR\\",\\"payment_method\\": \\"credit_card\\",\\"shipping_address\\": \\"456 Oak St, City, State 54321\\",\\"event\\": \\"purchase completed\\",\\"url\\": \\"https://example.com/checkout\\",\\"purl\\": \\"https://example.com/cart\\",\\"title\\": \\"Checkout - Example Store\\",\\"npv\\": 1,\\"sts\\": 400,\\"pts\\": 200,\\"timestamp\\": 1754392679209}"\n  },\n  "results": [\n    {\n      "comment": "Event \\"new_registration\\" from CSV was not found in the uploaded log file",\n      "eventName": "new_registration",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "new_registration"\n    },\n    {\n      "comment": "Event \\"login\\" from CSV was not found in the uploaded log file",\n      "eventName": "login",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "login"\n    },\n    {\n      "comment": "Event \\"profile_completion\\" from CSV was not found in the uploaded log file",\n      "eventName": "profile_completion",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "profile_completion"\n    },\n    {\n      "comment": "Event \\"student_remittance\\" from CSV was not found in the uploaded log file",\n      "eventName": "student_remittance",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "student_remittance"\n    },\n    {\n      "comment": "Event \\"payments\\" from CSV was not found in the uploaded log file",\n      "eventName": "payments",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "payments"\n    },\n    {\n      "comment": "Event \\"personal remittance\\" from CSV was not found in the uploaded log file",\n      "eventName": "personal remittance",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "personal remittance"\n    },\n    {\n      "comment": "Event \\"forex card\\" from CSV was not found in the uploaded log file",\n      "eventName": "forex card",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "forex card"\n    },\n    {\n      "comment": "Event \\"link card step1\\" from CSV was not found in the uploaded log file",\n      "eventName": "link card step1",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "link card step1"\n    },\n    {\n      "comment": "Event \\"link card step2\\" from CSV was not found in the uploaded log file",\n      "eventName": "link card step2",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "link card step2"\n    },\n    {\n      "comment": "Event \\"home rate calculator\\" from CSV was not found in the uploaded log file",\n      "eventName": "home rate calculator",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "home rate calculator"\n    },\n    {\n      "comment": "Event \\"refer and earn\\" from CSV was not found in the uploaded log file",\n      "eventName": "refer and earn",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "refer and earn"\n    },\n    {\n      "comment": "Event \\"security settings\\" from CSV was not found in the uploaded log file",\n      "eventName": "security settings",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "security settings"\n    },\n    {\n      "comment": "Event \\"atm locator\\" from CSV was not found in the uploaded log file",\n      "eventName": "atm locator",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "atm locator"\n    },\n    {\n      "comment": "Event \\"notifications\\" from CSV was not found in the uploaded log file",\n      "eventName": "notifications",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "notifications"\n    },\n    {\n      "comment": "Event \\"rates\\" from CSV was not found in the uploaded log file",\n      "eventName": "rates",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "rates"\n    },\n    {\n      "comment": "Event \\"support\\" from CSV was not found in the uploaded log file",\n      "eventName": "support",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "support"\n    },\n    {\n      "comment": "Event \\"offers and rewards\\" from CSV was not found in the uploaded log file",\n      "eventName": "offers and rewards",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "offers and rewards"\n    },\n    {\n      "comment": "Event \\"currency converter\\" from CSV was not found in the uploaded log file",\n      "eventName": "currency converter",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "currency converter"\n    },\n    {\n      "comment": "Event \\"rate alert\\" from CSV was not found in the uploaded log file",\n      "eventName": "rate alert",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "rate alert"\n    },\n    {\n      "comment": "Event \\"branch network\\" from CSV was not found in the uploaded log file",\n      "eventName": "branch network",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "branch network"\n    },\n    {\n      "comment": "Event \\"travel insurance\\" from CSV was not found in the uploaded log file",\n      "eventName": "travel insurance",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "travel insurance"\n    },\n    {\n      "comment": "Event \\"gic account apply\\" from CSV was not found in the uploaded log file",\n      "eventName": "gic account apply",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "gic account apply"\n    },\n    {\n      "comment": "Event \\"blocked account apply\\" from CSV was not found in the uploaded log file",\n      "eventName": "blocked account apply",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "blocked account apply"\n    },\n    {\n      "comment": "Event \\"forex card reload\\" from CSV was not found in the uploaded log file",\n      "eventName": "forex card reload",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "forex card reload"\n    },\n    {\n      "comment": "Event \\"product viewed\\" found in logs but not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "line_number": 35,\n      "receivedType": "extra event in logs",\n      "validationStatus": "Extra event present in logs",\n      "value": "product viewed"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "product_id",\n      "line_number": 35,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "12345"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "product_name",\n      "line_number": 35,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "iPhone 15"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "category",\n      "line_number": 35,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "Electronics"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "brand",\n      "line_number": 35,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "Apple"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "price",\n      "line_number": 35,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 79999\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "currency",\n      "line_number": 35,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "INR"\n    },\n    {\n      "comment": "Event \\"flight searched\\" found in logs but not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "line_number": 19,\n      "receivedType": "extra event in logs",\n      "validationStatus": "Extra event present in logs",\n      "value": "flight searched"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "src",\n      "line_number": 19,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "GUWAHATI (GAU)"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "des",\n      "line_number": 19,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "NEW DELHI (DEL)"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "flight_type",\n      "line_number": 19,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "domestic"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "departure_date",\n      "line_number": 19,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "05-08-2025"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "return_date",\n      "line_number": 19,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": ""\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "passenger_adult",\n      "line_number": 19,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 1\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "passenger_child",\n      "line_number": 19,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 0\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "flight_class",\n      "line_number": 19,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "economy"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "source",\n      "line_number": 19,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "web"\n    },\n    {\n      "comment": "Event \\"purchase completed\\" found in logs but not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "line_number": 50,\n      "receivedType": "extra event in logs",\n      "validationStatus": "Extra event present in logs",\n      "value": "purchase completed"\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "order_id",\n      "line_number": 50,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "ORD789"\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "total_amount",\n      "line_number": 50,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 79999\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "currency",\n      "line_number": 50,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "INR"\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "payment_method",\n      "line_number": 50,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "credit_card"\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "shipping_address",\n      "line_number": 50,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "456 Oak St, City, State 54321"\n    }\n  ],\n  "summary": {\n    "csv_events": [\n      "home rate calculator",\n      "rates",\n      "new_registration",\n      "student_remittance",\n      "atm locator",\n      "blocked account apply",\n      "payments",\n      "support",\n      "notifications",\n      "profile_completion",\n      "offers and rewards",\n      "refer and earn",\n      "forex card",\n      "link card step2",\n      "security settings",\n      "rate alert",\n      "personal remittance",\n      "travel insurance",\n      "login",\n      "currency converter",\n      "link card step1",\n      "gic account apply",\n      "forex card reload",\n      "branch network"\n    ],\n    "csv_events_count": 24,\n    "extra_events": [\n      "product viewed",\n      "flight searched",\n      "purchase completed"\n    ],\n    "log_events": [\n      "product viewed",\n      "flight searched",\n      "purchase completed"\n    ],\n    "log_events_count": 3,\n    "total_log_entries": 3\n  }\n}\n'
2025-10-10 13:05:57,833 - INFO - 127.0.0.1 - - [10/Oct/2025 13:05:57] "POST /validate-website-logs-v2 HTTP/1.1" 200 -
2025-10-10 13:07:19,414 - INFO -  * Detected change in '/Users/allen.thomson/Desktop/sampleapp/automation/validation_script_android/beta2.py', reloading
2025-10-10 13:07:19,509 - INFO -  * Restarting with stat
2025-10-10 13:07:19,778 - WARNING -  * Debugger is active!
2025-10-10 13:07:19,786 - INFO -  * Debugger PIN: 132-353-793
2025-10-10 13:07:53,045 - INFO -  * Detected change in '/Users/allen.thomson/Desktop/sampleapp/automation/validation_script_android/beta2.py', reloading
2025-10-10 13:07:53,092 - INFO -  * Restarting with stat
2025-10-10 13:07:53,322 - WARNING -  * Debugger is active!
2025-10-10 13:07:53,365 - INFO -  * Debugger PIN: 132-353-793
2025-10-10 13:08:56,336 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:10000
 * Running on http://172.16.20.191:10000
2025-10-10 13:08:56,336 - INFO - [33mPress CTRL+C to quit[0m
2025-10-10 13:08:56,336 - INFO -  * Restarting with stat
2025-10-10 13:08:56,459 - WARNING -  * Debugger is active!
2025-10-10 13:08:56,466 - INFO -  * Debugger PIN: 132-353-793
2025-10-10 13:09:00,997 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Cache-Control: max-age=0
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 13:09:00,997 - INFO - Body: b''
2025-10-10 13:09:00,998 - INFO - URL: http://localhost:10000/
2025-10-10 13:09:00,998 - INFO - Method: GET
2025-10-10 13:09:00,998 - INFO - Endpoint: index
2025-10-10 13:09:01,004 - INFO - Response: b'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Event Validation Tool</title>\n    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">\n    <link href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" rel="stylesheet">\n    <style>\n        :root {\n            --primary-color: #e35502;\n            --header-bg: #230f2e;\n        }\n        \n        .container { margin-top: 30px; }\n        .table-container { margin-top: 20px; }\n        .filter-container { margin: 20px 0; }\n        .hidden { display: none; }\n        .first-event { color: blue; }\n        \n        /* Header styling */\n        .navbar {\n            background-color: var(--header-bg) !important;\n        }\n        \n        .navbar-brand, .navbar-nav .nav-link {\n            color: white !important;\n        }\n        \n        .navbar-toggler {\n            border-color: rgba(255,255,255,0.5);\n        }\n        \n        .navbar-toggler-icon {\n            background-image: url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 30 30\'%3e%3cpath stroke=\'rgba%28255, 255, 255, 0.75%29\' stroke-linecap=\'round\' stroke-miterlimit=\'10\' stroke-width=\'2\' d=\'M4 7h22M4 15h22M4 23h22\'/%3e%3c/svg%3e");\n        }\n        \n        /* Button styling */\n        .btn-primary {\n            background-color: var(--primary-color) !important;\n            border-color: var(--primary-color) !important;\n        }\n        \n        .btn-primary:hover {\n            background-color: #c64802 !important;\n            border-color: #c64802 !important;\n        }\n        \n        .btn-outline-primary {\n            color: white !important;\n            border-color: white !important;\n        }\n        \n        .btn-outline-primary:hover {\n            background-color: rgba(255,255,255,0.1) !important;\n        }\n        .null-value { background-color: yellow; }\n        .valid-status { color: green; }\n        .invalid-status { color: red; }\n        .empty-status { color: orange; }\n        .not-present { color: darkolivegreen; }\n        .extra-key { color: rgb(24, 214, 185); }\n        .type-mismatch { background-color: #ffe6e6; }\n        .download-section {\n            margin: 20px 0;\n            text-align: right;\n        }\n        /* Status color coding */\n        .status-valid { background-color: #d4edda !important; color: #155724 !important; }\n        .status-invalid { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-empty { background-color: #fff3cd !important; color: #856404 !important; }\n        .status-extra { background-color: #d1ecf1 !important; color: #0c5460 !important; }\n        .status-notpresent { background-color: #042508 !important; color: #7f7b97 !important; }\n        .status-csv { background-color: #e2e3e5 !important; color: #383d41 !important; }\n        .status-extra-event { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-extra-field { background-color: #fff3cd !important; color: #856404 !important; }\n        .validation-status {\n            font-weight: bold;\n        }\n        .status-valid {\n            color: #28a745;\n        }\n        .status-invalid {\n            color: #dc3545;\n        }\n        .status-empty {\n            color: #ffc107;\n        }\n        .status-extra {\n            color: #17a2b8;\n        }\n        .status-extra-event {\n            color: #dc3545;\n        }\n        .status-extra-field {\n            color: #ffc107;\n        }\n        .filter-section {\n            background-color: #f8f9fa;\n            padding: 15px;\n            margin-bottom: 20px;\n            border-radius: 5px;\n        }\n        .sort-header {\n            cursor: pointer;\n        }\n        .sort-header:hover {\n            background-color: #e9ecef;\n        }\n        .sort-icon {\n            margin-left: 5px;\n        }\n        .filter-dropdown {\n            position: relative;\n            display: inline-block;\n        }\n        .filter-content {\n            display: none;\n            position: absolute;\n            background-color: #f9f9f9;\n            min-width: 200px;\n            max-height: 300px;\n            overflow-y: auto;\n            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\n            z-index: 1000;\n            padding: 10px;\n        }\n        .filter-content.show {\n            display: block;\n        }\n        .filter-checkbox {\n            margin: 5px 0;\n        }\n        .filter-checkbox label {\n            display: block;\n            padding: 5px;\n            cursor: pointer;\n        }\n        .filter-checkbox label:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-header {\n            display: flex;\n            align-items: center;\n            cursor: pointer;\n            padding: 5px;\n        }\n        .filter-header:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-icon {\n            margin-left: 5px;\n        }\n        .filter-actions {\n            margin-top: 10px;\n            padding-top: 10px;\n            border-top: 1px solid #ddd;\n        }\n    </style>\n</head>\n<body>\n    <nav class="navbar navbar-expand-lg navbar-light bg-light">\n        <div class="container-fluid">\n            <a class="navbar-brand" href="#">Netcore Event Payload Validator</a>\n            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">\n                <span class="navbar-toggler-icon"></span>\n            </button>\n            <div class="collapse navbar-collapse" id="navbarNav">\n                <ul class="navbar-nav ms-auto">\n                    <li class="nav-item">\n                        <a class="btn btn-primary" href="https://contact-api-via-csv-7e94e.web.app/" target="_blank">Trigger Activity API</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </nav>\n\n    <div class="container">\n        <h2>Event Validation Tool</h2>\n        \n        <div class="card mb-4">\n            <div class="card-body">\n                <div class="mb-3">\n                    <label class="form-label">Validation Mode</label>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="regularMode" value="regular" checked>\n                        <label class="form-check-label" for="regularMode">\n                            Android and iOS Event (Single Event/Event Payload format)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteMode" value="website">\n                        <label class="form-check-label" for="websiteMode">\n                            Website Logs Validation (JSON lines format with eventname and payload)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteV2Mode" value="website-v2">\n                        <label class="form-check-label" for="websiteV2Mode">\n                            Website Logs V2 Validation (JSON lines format with event key and system fields excluded)\n                        </label>\n                    </div>\n                </div>\n                \n                <form id="uploadForm" enctype="multipart/form-data">\n                    <div class="mb-3">\n                        <label for="csvFile" class="form-label">CSV File (Validation Rules)</label>\n                        <input type="file" class="form-control" id="csvFile" name="csv_file" accept=".csv" required>\n                        <div class="mt-2">\n                            <a href="/download_template" class="btn btn-outline-secondary btn-sm">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Sample Template\n                            </a>\n                        </div>\n                    </div>\n                    <div class="mb-3">\n                        <label for="txtFile" class="form-label">TXT File (Event Logs)</label>\n                        <input type="file" class="form-control" id="txtFile" name="txt_file" accept=".txt" required>\n                        <div class="mt-2 sample-downloads">\n                            <!-- Regular mode sample -->\n                            <button class="btn btn-outline-secondary btn-sm sample-download regular-mode download-btn" data-mode="regular">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Regular Sample Log\n                            </button>\n                            <!-- Website mode sample -->\n                            <button class="btn btn-outline-secondary btn-sm sample-download website-mode download-btn" data-mode="website" style="display: none;">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Website Sample Log\n                            </button>\n                            <!-- Website V2 mode samples -->\n                            <div class="v2-mode-downloads" style="display: none;">\n                                <button class="btn btn-outline-secondary btn-sm mb-1 download-btn" data-mode="website-v2" data-multiline="false">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                    </svg>\n                                    Download Website V2 Sample Log\n                                </button>\n                                <br>\n                                <button class="btn btn-outline-secondary btn-sm download-btn" data-mode="website-v2" data-multiline="true">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                    </svg>\n                                    Download Website V2 Multiline Sample\n                                </button>\n                            </div>\n                            <div id="downloadError" class="alert alert-danger mt-2" style="display: none;"></div>\n                        </div>\n                    </div>\n                    <button type="submit" class="btn btn-primary">Validate</button>\n                </form>\n            </div>\n        </div>\n\n        <div class="filter-section" id="filterSection" style="display: none;">\n            <div class="row mb-3">\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Summary</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>CSV Events:</strong></p>\n                                    <p class="text-primary" id="csvEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Log Events:</strong></p>\n                                    <p class="text-success" id="logEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Details</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Missing Events:</strong></p>\n                                    <p class="text-warning" id="missingEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Extra Events:</strong></p>\n                                    <p class="text-info" id="extraEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <h4>Filters</h4>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="eventName">\n                            Event Name <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="eventNameFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="eventNameSelectAll" checked>\n                                <label for="eventNameSelectAll">Select All</label>\n                            </div>\n                            <div id="eventNameOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'eventName\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'eventName\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="status">\n                            Status <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="statusFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="statusSelectAll" checked>\n                                <label for="statusSelectAll">Select All</label>\n                            </div>\n                            <div id="statusOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'status\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'status\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="expectedType">\n                            Expected Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="expectedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="expectedTypeSelectAll" checked>\n                                <label for="expectedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="expectedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'expectedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'expectedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="receivedType">\n                            Received Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="receivedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="receivedTypeSelectAll" checked>\n                                <label for="receivedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="receivedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'receivedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'receivedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-secondary" id="clearFilters">Clear All Filters</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-success" id="downloadResults">Download Results</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-info" id="downloadValidEvents">Download Valid Events</button>\n                </div>\n            </div>\n        </div>\n\n        <div id="fullyValidEventsSection" class="alert alert-success" style="display:none;">\n            <strong>Events with all payloads valid:</strong>\n            <ul id="fullyValidEventsList" style="margin-bottom:0;"></ul>\n        </div>\n\n        <div class="table-container">\n            <table class="table table-striped" id="resultsTable">\n                <thead>\n                    <tr>\n                        <th class="sort-header" data-sort="eventName">Event Name <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="key">Key <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="value">Value <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="expectedType">Expected Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="receivedType">Received Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="validationStatus">Status <span class="sort-icon">\xe2\x86\x95</span></th>\n                    </tr>\n                </thead>\n                <tbody id="resultsBody"></tbody>\n            </table>\n        </div>\n    </div>\n\n    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/moment/moment.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>\n    <script>\n        let currentResults = [];\n        let currentSummary = {};\n        let currentSort = { field: null, order: \'asc\' };\n        let activeFilters = {\n            eventName: [],\n            status: [],\n            expectedType: [],\n            receivedType: []\n        };\n\n        $(\'#dateRange\').daterangepicker({\n            autoUpdateInput: false,\n            locale: {\n                cancelLabel: \'Clear\'\n            }\n        });\n\n        $(\'#dateRange\').on(\'apply.daterangepicker\', function(ev, picker) {\n            $(this).val(picker.startDate.format(\'MM/DD/YYYY\') + \' - \' + picker.endDate.format(\'MM/DD/YYYY\'));\n            applyFilters();\n        });\n\n        $(\'#dateRange\').on(\'cancel.daterangepicker\', function(ev, picker) {\n            $(this).val(\'\');\n            applyFilters();\n        });\n\n        // Handle validation mode changes\n        $(\'input[name="validationMode"]\').change(function() {\n            const mode = $(this).val();\n            // Hide all sample download buttons first\n            $(\'.sample-download, .v2-mode-downloads\').hide();\n            \n            // Show the appropriate download button based on mode\n            if (mode === \'regular\') {\n                $(\'.sample-download.regular-mode\').show();\n            } else if (mode === \'website\') {\n                $(\'.sample-download.website-mode\').show();\n            } else if (mode === \'website-v2\') {\n                $(\'.v2-mode-downloads\').show();\n            }\n        });\n\n        $(\'#uploadForm\').on(\'submit\', function(e) {\n            e.preventDefault();\n            const formData = new FormData(this);\n            \n            // Determine which endpoint to use based on validation mode\n            const validationMode = $(\'input[name="validationMode"]:checked\').val();\n            let endpoint = \'/upload\';\n            if (validationMode === \'website\') {\n                endpoint = \'/validate-website-logs\';\n            } else if (validationMode === \'website-v2\') {\n                endpoint = \'/validate-website-logs-v2\';\n            }\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + endpoint;\n            \n            console.log(\'Making request to:\', fullUrl);\n            console.log(\'Validation mode:\', validationMode);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: formData,\n                processData: false,\n                contentType: false,\n                success: function(response) {\n                    console.log(\'Upload response:\', response);\n                    \n                    // Ensure response is properly initialized\n                    currentResults = [];\n                    currentSummary = {\n                        csv_events_count: 0,\n                        log_events_count: 0,\n                        csv_events: [],\n                        log_events: []\n                    };\n                    window.originalLogs = {};\n                    \n                    // Handle both old and new response formats\n                    if (response && response.results && Array.isArray(response.results)) {\n                        // New format with summary\n                        currentResults = response.results;\n                        if (response.summary) {\n                            currentSummary = response.summary;\n                        }\n                        if (response.original_logs) {\n                            window.originalLogs = response.original_logs;\n                        }\n                    } else if (Array.isArray(response)) {\n                        // Old format - just results array\n                        currentResults = response;\n                    } else {\n                        console.error(\'Invalid response format:\', response);\n                    }\n                    \n                    updateEventSummary();\n                    updateFilters();\n                    displayResults(currentResults);\n                    $(\'#filterSection\').show();\n\n                    if (response.fully_valid_events && response.fully_valid_events.length > 0) {\n                        $(\'#fullyValidEventsList\').empty();\n                        response.fully_valid_events.forEach(function(eventName) {\n                            $(\'#fullyValidEventsList\').append(\'<li>\' + eventName + \'</li>\');\n                        });\n                        $(\'#fullyValidEventsSection\').show();\n                    } else {\n                        $(\'#fullyValidEventsSection\').hide();\n                    }\n                },\n                error: function(xhr) {\n                    console.error(\'Upload error:\', xhr);\n                    alert(\'Error uploading files: \' + xhr.responseText);\n                }\n            });\n        });\n\n        // Initialize filter dropdowns\n        $(document).ready(function() {\n            $(\'.filter-header\').click(function(e) {\n                e.stopPropagation();\n                const filterId = $(this).data(\'filter\');\n                console.log(\'Clicked filter:\', filterId);\n                $(`#${filterId}Filter`).toggleClass(\'show\');\n            });\n\n            // Close filter dropdowns when clicking outside\n            $(document).click(function(e) {\n                if (!$(e.target).closest(\'.filter-dropdown\').length) {\n                    $(\'.filter-content\').removeClass(\'show\');\n                }\n            });\n        });\n\n        function updateEventSummary() {\n            // Update event count displays\n            $(\'#csvEventsCount\').text(currentSummary.csv_events_count || 0);\n            $(\'#logEventsCount\').text(currentSummary.log_events_count || 0);\n            \n            // Calculate missing and extra events\n            const csvEvents = new Set(currentSummary.csv_events || []);\n            const logEvents = new Set(currentSummary.log_events || []);\n            \n            const missingEvents = csvEvents.size - new Set([...csvEvents].filter(x => logEvents.has(x))).size;\n            const extraEvents = logEvents.size - new Set([...logEvents].filter(x => csvEvents.has(x))).size;\n            \n            $(\'#missingEventsCount\').text(missingEvents);\n            $(\'#extraEventsCount\').text(extraEvents);\n        }\n\n        function updateFilters() {\n            const eventNames = new Set();\n            const expectedTypes = new Set();\n            const receivedTypes = new Set();\n            const statuses = new Set();\n            \n            currentResults.forEach(result => {\n                if (result.eventName) eventNames.add(result.eventName);\n                if (result.expectedType) expectedTypes.add(result.expectedType);\n                if (result.receivedType) receivedTypes.add(result.receivedType);\n                if (result.validationStatus) statuses.add(result.validationStatus);\n            });\n\n            console.log(\'Available statuses:\', Array.from(statuses));\n\n            updateFilterOptions(\'eventName\', eventNames);\n            updateFilterOptions(\'status\', statuses);\n            updateFilterOptions(\'expectedType\', expectedTypes);\n            updateFilterOptions(\'receivedType\', receivedTypes);\n        }\n\n        function updateFilterOptions(filterId, values) {\n            const container = $(`#${filterId}Options`);\n            container.empty();\n            \n            console.log(`Updating ${filterId} with values:`, Array.from(values));\n            \n            Array.from(values).sort().forEach(value => {\n                if (value) {\n                    const checkboxId = `${filterId}_${value.replace(/[^a-zA-Z0-9]/g, \'_\')}`;\n                    container.append(`\n                        <div class="filter-checkbox">\n                            <input type="checkbox" id="${checkboxId}" value="${value}" checked>\n                            <label for="${checkboxId}">${value}</label>\n                        </div>\n                    `);\n                }\n            });\n\n            // Update select all checkbox\n            $(`#${filterId}SelectAll`).prop(\'checked\', true);\n        }\n\n        function getSelectedValues(filterId) {\n            return $(`#${filterId}Options input:checked`).map(function() {\n                return $(this).val();\n            }).get();\n        }\n\n        function applyFilter(filterId) {\n            activeFilters[filterId] = getSelectedValues(filterId);\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function clearFilter(filterId) {\n            $(`#${filterId}Options input`).prop(\'checked\', false);\n            $(`#${filterId}SelectAll`).prop(\'checked\', false);\n            activeFilters[filterId] = [];\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function applyFilters() {\n            const filters = {\n                eventName: activeFilters.eventName,\n                validationStatus: activeFilters.status,\n                expectedType: activeFilters.expectedType,\n                receivedType: activeFilters.receivedType\n            };\n\n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/filter\';\n\n            console.log(\'Making filter request to:\', fullUrl);\n\n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({\n                    results: currentResults,\n                    filters: filters,\n                    sort_by: currentSort.field,\n                    sort_order: currentSort.order\n                }),\n                contentType: \'application/json\',\n                success: function(response) {\n                    displayResults(response);\n                    window.filteredResults = response;\n                },\n                error: function(xhr) {\n                    console.error(\'Filter error:\', xhr);\n                    alert(\'Error applying filters: \' + xhr.responseText);\n                }\n            });\n        }\n\n        // Handle select all checkboxes\n        $(\'[id$="SelectAll"]\').change(function() {\n            const filterId = this.id.replace(\'SelectAll\', \'\');\n            $(`#${filterId}Options input`).prop(\'checked\', $(this).prop(\'checked\'));\n        });\n\n        // Update select all checkbox when individual checkboxes change\n        $(\'.filter-content\').on(\'change\', \'input[type="checkbox"]:not([id$="SelectAll"])\', function() {\n            const filterId = $(this).closest(\'.filter-content\').attr(\'id\').replace(\'Filter\', \'\');\n            const allChecked = $(`#${filterId}Options input:checked`).length === $(`#${filterId}Options input`).length;\n            $(`#${filterId}SelectAll`).prop(\'checked\', allChecked);\n        });\n\n        $(\'#clearFilters\').click(function() {\n            $(\'.filter-content input[type="checkbox"]\').prop(\'checked\', false);\n            $(\'[id$="SelectAll"]\').prop(\'checked\', false);\n            Object.keys(activeFilters).forEach(key => {\n                activeFilters[key] = [];\n            });\n            applyFilters();\n        });\n\n        $(\'#downloadResults\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download\';\n            \n            console.log(\'Making download request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ results: resultsToDownload }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'validation_results.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download error:\', xhr);\n                    alert(\'Error downloading results: \' + xhr.responseText);\n                }\n            });\n        });\n\n        $(\'#downloadValidEvents\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download-valid-events\';\n            \n            console.log(\'Making download valid events request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ \n                    results: resultsToDownload,\n                    logs_data: window.originalLogs || {}\n                }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'valid_events_report.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download valid events error:\', xhr);\n                    alert(\'Error downloading valid events: \' + xhr.responseText);\n                }\n            });\n        });\n\n        function displayResults(results) {\n            const tbody = $(\'#resultsBody\');\n            tbody.empty();\n            \n            // Debug log to check results being displayed\n            console.log(\'Displaying results:\', results);\n            \n            results.forEach(result => {\n                const statusClass = getStatusClass(result.validationStatus);\n                tbody.append(`\n                    <tr>\n                        <td>${result.eventName}</td>\n                        <td>${result.key}</td>\n                        <td>${result.value}</td>\n                        <td>${result.expectedType}</td>\n                        <td>${result.receivedType}</td>\n                        <td class="validation-status ${statusClass}">${result.validationStatus}</td>\n                    </tr>\n                `);\n            });\n        }\n\n        function getStatusClass(status) {\n            if (status === \'Valid\') return \'status-valid\';\n            if (status === \'Invalid/Wrong datatype/value\') return \'status-invalid\';\n            if (status === \'Payload value is Empty\') return \'status-empty\';\n            if (status === \'Extra key present in the log\') return \'status-extra\';\n            if (status === \'Extra event present in logs\') return \'status-extra-event\';\n            if (status === \'Field from extra event\') return \'status-extra-field\';\n            if (status === \'Event name not present in the logs\') return \'status-notpresent\';\n            return \'\';\n        }\n\n        $(\'.sort-header\').click(function() {\n            const field = $(this).data(\'sort\');\n            if (currentSort.field === field) {\n                currentSort.order = currentSort.order === \'asc\' ? \'desc\' : \'asc\';\n            } else {\n                currentSort.field = field;\n                currentSort.order = \'asc\';\n            }\n            applyFilters();\n        });\n\n        $(\'#eventNameFilter, #statusFilter, #expectedTypeFilter, #receivedTypeFilter\').change(applyFilters);\n    </script>\n</body>\n</html>'
2025-10-10 13:09:01,004 - INFO - 127.0.0.1 - - [10/Oct/2025 13:09:01] "GET / HTTP/1.1" 200 -
2025-10-10 13:09:10,127 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
If-None-Match: "1749712420.0291362-495-2913214935"
If-Modified-Since: Thu, 12 Jun 2025 07:13:40 GMT


2025-10-10 13:09:10,128 - INFO - Body: b''
2025-10-10 13:09:10,128 - INFO - URL: http://localhost:10000/download_template
2025-10-10 13:09:10,128 - INFO - Method: GET
2025-10-10 13:09:10,128 - INFO - Endpoint: download_template
2025-10-10 13:09:10,130 - INFO - Response: [File Response] Content-Type: text/csv; charset=utf-8, Headers: {'Content-Disposition': 'attachment; filename=sample_template.csv', 'Content-Type': 'text/csv; charset=utf-8', 'Content-Length': '562', 'Last-Modified': 'Fri, 10 Oct 2025 07:22:38 GMT', 'Cache-Control': 'no-cache', 'ETag': '"1760080958.9658263-562-2913214935"', 'Date': 'Fri, 10 Oct 2025 07:39:10 GMT'}
2025-10-10 13:09:10,131 - INFO - 127.0.0.1 - - [10/Oct/2025 13:09:10] "GET /download_template HTTP/1.1" 200 -
2025-10-10 13:09:22,363 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Content-Length: 2073
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Accept: */*
Sec-Ch-Ua-Platform: "macOS"
X-Requested-With: XMLHttpRequest
Sec-Ch-Ua-Mobile: ?0
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryMWu9oQp6nW9qhUXr
Origin: http://localhost:10000
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 13:09:22,365 - INFO - Body: b'------WebKitFormBoundaryMWu9oQp6nW9qhUXr\r\nContent-Disposition: form-data; name="csv_file"; filename="sample.csv"\r\nContent-Type: text/csv\r\n\r\neventName,eventPayload,dataType\r\nsign_up,seat_type,text\r\n,seat number,integer\r\n,movie,text\r\n,screen,text\r\n,date,date \r\n,location,text\r\n,experience,text\r\n,amount,float\r\nuser_profile_push,seat_type,text\r\n,seat number,integer\r\n,movie,text\r\n,screen,text\r\n,date,date \r\n,location,text\r\n,experience,text\r\n,amount,float\r\nclicked,revenue,float\r\nproduct_purchase,items[].variant_id,text, NOTE: ARRAY PAYLOAD. PLEASE DONT ADD THIS ROW IN THE ACTUAL SHEET\r\n,items[].prname,text\r\n,items[].price,float\r\n,items[].prid,text\r\n,items[].brand,text\r\nappointment_click,user_type,text\r\n------WebKitFormBoundaryMWu9oQp6nW9qhUXr\r\nContent-Disposition: form-data; name="txt_file"; filename="sample_website_logs_v2.txt"\r\nContent-Type: text/plain\r\n\r\n{"src": "GUWAHATI (GAU)", "des": "NEW DELHI (DEL)", "flight_type": "domestic", "departure_date": "05-08-2025", "return_date": "", "passenger_adult": 1, "passenger_child": 0, "flight_class": "economy", "source": "web", "event": "flight searched", "url": "https://happyfares.in/?rdt=true~in", "purl": "https://happyfares.in/home", "title": "Flight Tickets Booking at HappyFares.in, Cheap Flights Fares.", "npv": 1, "sts": 455, "pts": 322, "timestamp": 1754392679207}\n{"product_id": "12345", "product_name": "iPhone 15", "category": "Electronics", "brand": "Apple", "price": 79999, "currency": "INR", "event": "product viewed", "url": "https://example.com/product/12345", "purl": "https://example.com/products", "title": "iPhone 15 - Example Store", "npv": 1, "sts": 300, "pts": 150, "timestamp": 1754392679208}\n{"order_id": "ORD789", "total_amount": 79999, "currency": "INR", "payment_method": "credit_card", "shipping_address": "456 Oak St, City, State 54321", "event": "purchase completed", "url": "https://example.com/checkout", "purl": "https://example.com/cart", "title": "Checkout - Example Store", "npv": 1, "sts": 400, "pts": 200, "timestamp": 1754392679209} \r\n------WebKitFormBoundaryMWu9oQp6nW9qhUXr--\r\n'
2025-10-10 13:09:22,365 - INFO - URL: http://localhost:10000/validate-website-logs-v2
2025-10-10 13:09:22,365 - INFO - Method: POST
2025-10-10 13:09:22,365 - INFO - Endpoint: validate_website_logs_v2
2025-10-10 13:09:22,365 - INFO - Website logs v2 validation endpoint called
2025-10-10 13:09:22,368 - INFO - website_logs_v2_upload: {"csv_file": "sample.csv", "txt_file": "sample_website_logs_v2.txt", "timestamp": "2025-10-10T13:09:22.367029"}
2025-10-10 13:09:22,373 - INFO - website_logs_v2_validation_complete: {"total_validations": 28, "valid_count": 0, "invalid_count": 28, "csv_events_count": 5, "log_events_count": 3, "extra_events_count": 3, "total_log_entries": 3}
2025-10-10 13:09:22,374 - INFO - Response: b'{\n  "fully_valid_events": [],\n  "original_logs": {\n    "flight searched": "{\\"src\\": \\"GUWAHATI (GAU)\\", \\"des\\": \\"NEW DELHI (DEL)\\", \\"flight_type\\": \\"domestic\\", \\"departure_date\\": \\"05-08-2025\\", \\"return_date\\": \\"\\", \\"passenger_adult\\": 1, \\"passenger_child\\": 0, \\"flight_class\\": \\"economy\\", \\"source\\": \\"web\\", \\"event\\": \\"flight searched\\", \\"url\\": \\"https://happyfares.in/?rdt=true~in\\", \\"purl\\": \\"https://happyfares.in/home\\", \\"title\\": \\"Flight Tickets Booking at HappyFares.in, Cheap Flights Fares.\\", \\"npv\\": 1, \\"sts\\": 455, \\"pts\\": 322, \\"timestamp\\": 1754392679207}",\n    "product viewed": "{\\"product_id\\": \\"12345\\", \\"product_name\\": \\"iPhone 15\\", \\"category\\": \\"Electronics\\", \\"brand\\": \\"Apple\\", \\"price\\": 79999, \\"currency\\": \\"INR\\", \\"event\\": \\"product viewed\\", \\"url\\": \\"https://example.com/product/12345\\", \\"purl\\": \\"https://example.com/products\\", \\"title\\": \\"iPhone 15 - Example Store\\", \\"npv\\": 1, \\"sts\\": 300, \\"pts\\": 150, \\"timestamp\\": 1754392679208}",\n    "purchase completed": "{\\"order_id\\": \\"ORD789\\", \\"total_amount\\": 79999, \\"currency\\": \\"INR\\", \\"payment_method\\": \\"credit_card\\", \\"shipping_address\\": \\"456 Oak St, City, State 54321\\", \\"event\\": \\"purchase completed\\", \\"url\\": \\"https://example.com/checkout\\", \\"purl\\": \\"https://example.com/cart\\", \\"title\\": \\"Checkout - Example Store\\", \\"npv\\": 1, \\"sts\\": 400, \\"pts\\": 200, \\"timestamp\\": 1754392679209}"\n  },\n  "results": [\n    {\n      "comment": "Event \\"sign_up\\" from CSV was not found in the uploaded log file",\n      "eventName": "sign_up",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "sign_up"\n    },\n    {\n      "comment": "Event \\"user_profile_push\\" from CSV was not found in the uploaded log file",\n      "eventName": "user_profile_push",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "user_profile_push"\n    },\n    {\n      "comment": "Event \\"clicked\\" from CSV was not found in the uploaded log file",\n      "eventName": "clicked",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "clicked"\n    },\n    {\n      "comment": "Event \\"product_purchase\\" from CSV was not found in the uploaded log file",\n      "eventName": "product_purchase",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "product_purchase"\n    },\n    {\n      "comment": "Event \\"appointment_click\\" from CSV was not found in the uploaded log file",\n      "eventName": "appointment_click",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "appointment_click"\n    },\n    {\n      "comment": "Event \\"flight searched\\" found in logs but not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "line_number": 1,\n      "receivedType": "extra event in logs",\n      "validationStatus": "Extra event present in logs",\n      "value": "flight searched"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "src",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "GUWAHATI (GAU)"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "des",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "NEW DELHI (DEL)"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "flight_type",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "domestic"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "departure_date",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "05-08-2025"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "return_date",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": ""\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "passenger_adult",\n      "line_number": 1,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 1\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "passenger_child",\n      "line_number": 1,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 0\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "flight_class",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "economy"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "source",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "web"\n    },\n    {\n      "comment": "Event \\"purchase completed\\" found in logs but not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "line_number": 3,\n      "receivedType": "extra event in logs",\n      "validationStatus": "Extra event present in logs",\n      "value": "purchase completed"\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "order_id",\n      "line_number": 3,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "ORD789"\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "total_amount",\n      "line_number": 3,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 79999\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "currency",\n      "line_number": 3,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "INR"\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "payment_method",\n      "line_number": 3,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "credit_card"\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "shipping_address",\n      "line_number": 3,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "456 Oak St, City, State 54321"\n    },\n    {\n      "comment": "Event \\"product viewed\\" found in logs but not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "line_number": 2,\n      "receivedType": "extra event in logs",\n      "validationStatus": "Extra event present in logs",\n      "value": "product viewed"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "product_id",\n      "line_number": 2,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "12345"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "product_name",\n      "line_number": 2,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "iPhone 15"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "category",\n      "line_number": 2,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "Electronics"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "brand",\n      "line_number": 2,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "Apple"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "price",\n      "line_number": 2,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 79999\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "currency",\n      "line_number": 2,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "INR"\n    }\n  ],\n  "summary": {\n    "csv_events": [\n      "product_purchase",\n      "appointment_click",\n      "sign_up",\n      "user_profile_push",\n      "clicked"\n    ],\n    "csv_events_count": 5,\n    "extra_events": [\n      "flight searched",\n      "purchase completed",\n      "product viewed"\n    ],\n    "log_events": [\n      "flight searched",\n      "purchase completed",\n      "product viewed"\n    ],\n    "log_events_count": 3,\n    "total_log_entries": 3\n  }\n}\n'
2025-10-10 13:09:22,374 - INFO - 127.0.0.1 - - [10/Oct/2025 13:09:22] "POST /validate-website-logs-v2 HTTP/1.1" 200 -
2025-10-10 13:09:23,617 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Content-Length: 2073
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Accept: */*
Sec-Ch-Ua-Platform: "macOS"
X-Requested-With: XMLHttpRequest
Sec-Ch-Ua-Mobile: ?0
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryaR3RU9pnRTyAxPkO
Origin: http://localhost:10000
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 13:09:23,617 - INFO - Body: b'------WebKitFormBoundaryaR3RU9pnRTyAxPkO\r\nContent-Disposition: form-data; name="csv_file"; filename="sample.csv"\r\nContent-Type: text/csv\r\n\r\neventName,eventPayload,dataType\r\nsign_up,seat_type,text\r\n,seat number,integer\r\n,movie,text\r\n,screen,text\r\n,date,date \r\n,location,text\r\n,experience,text\r\n,amount,float\r\nuser_profile_push,seat_type,text\r\n,seat number,integer\r\n,movie,text\r\n,screen,text\r\n,date,date \r\n,location,text\r\n,experience,text\r\n,amount,float\r\nclicked,revenue,float\r\nproduct_purchase,items[].variant_id,text, NOTE: ARRAY PAYLOAD. PLEASE DONT ADD THIS ROW IN THE ACTUAL SHEET\r\n,items[].prname,text\r\n,items[].price,float\r\n,items[].prid,text\r\n,items[].brand,text\r\nappointment_click,user_type,text\r\n------WebKitFormBoundaryaR3RU9pnRTyAxPkO\r\nContent-Disposition: form-data; name="txt_file"; filename="sample_website_logs_v2.txt"\r\nContent-Type: text/plain\r\n\r\n{"src": "GUWAHATI (GAU)", "des": "NEW DELHI (DEL)", "flight_type": "domestic", "departure_date": "05-08-2025", "return_date": "", "passenger_adult": 1, "passenger_child": 0, "flight_class": "economy", "source": "web", "event": "flight searched", "url": "https://happyfares.in/?rdt=true~in", "purl": "https://happyfares.in/home", "title": "Flight Tickets Booking at HappyFares.in, Cheap Flights Fares.", "npv": 1, "sts": 455, "pts": 322, "timestamp": 1754392679207}\n{"product_id": "12345", "product_name": "iPhone 15", "category": "Electronics", "brand": "Apple", "price": 79999, "currency": "INR", "event": "product viewed", "url": "https://example.com/product/12345", "purl": "https://example.com/products", "title": "iPhone 15 - Example Store", "npv": 1, "sts": 300, "pts": 150, "timestamp": 1754392679208}\n{"order_id": "ORD789", "total_amount": 79999, "currency": "INR", "payment_method": "credit_card", "shipping_address": "456 Oak St, City, State 54321", "event": "purchase completed", "url": "https://example.com/checkout", "purl": "https://example.com/cart", "title": "Checkout - Example Store", "npv": 1, "sts": 400, "pts": 200, "timestamp": 1754392679209} \r\n------WebKitFormBoundaryaR3RU9pnRTyAxPkO--\r\n'
2025-10-10 13:09:23,617 - INFO - URL: http://localhost:10000/validate-website-logs-v2
2025-10-10 13:09:23,617 - INFO - Method: POST
2025-10-10 13:09:23,617 - INFO - Endpoint: validate_website_logs_v2
2025-10-10 13:09:23,617 - INFO - Website logs v2 validation endpoint called
2025-10-10 13:09:23,619 - INFO - website_logs_v2_upload: {"csv_file": "sample.csv", "txt_file": "sample_website_logs_v2.txt", "timestamp": "2025-10-10T13:09:23.619042"}
2025-10-10 13:09:23,619 - INFO - website_logs_v2_validation_complete: {"total_validations": 28, "valid_count": 0, "invalid_count": 28, "csv_events_count": 5, "log_events_count": 3, "extra_events_count": 3, "total_log_entries": 3}
2025-10-10 13:09:23,620 - INFO - Response: b'{\n  "fully_valid_events": [],\n  "original_logs": {\n    "flight searched": "{\\"src\\": \\"GUWAHATI (GAU)\\", \\"des\\": \\"NEW DELHI (DEL)\\", \\"flight_type\\": \\"domestic\\", \\"departure_date\\": \\"05-08-2025\\", \\"return_date\\": \\"\\", \\"passenger_adult\\": 1, \\"passenger_child\\": 0, \\"flight_class\\": \\"economy\\", \\"source\\": \\"web\\", \\"event\\": \\"flight searched\\", \\"url\\": \\"https://happyfares.in/?rdt=true~in\\", \\"purl\\": \\"https://happyfares.in/home\\", \\"title\\": \\"Flight Tickets Booking at HappyFares.in, Cheap Flights Fares.\\", \\"npv\\": 1, \\"sts\\": 455, \\"pts\\": 322, \\"timestamp\\": 1754392679207}",\n    "product viewed": "{\\"product_id\\": \\"12345\\", \\"product_name\\": \\"iPhone 15\\", \\"category\\": \\"Electronics\\", \\"brand\\": \\"Apple\\", \\"price\\": 79999, \\"currency\\": \\"INR\\", \\"event\\": \\"product viewed\\", \\"url\\": \\"https://example.com/product/12345\\", \\"purl\\": \\"https://example.com/products\\", \\"title\\": \\"iPhone 15 - Example Store\\", \\"npv\\": 1, \\"sts\\": 300, \\"pts\\": 150, \\"timestamp\\": 1754392679208}",\n    "purchase completed": "{\\"order_id\\": \\"ORD789\\", \\"total_amount\\": 79999, \\"currency\\": \\"INR\\", \\"payment_method\\": \\"credit_card\\", \\"shipping_address\\": \\"456 Oak St, City, State 54321\\", \\"event\\": \\"purchase completed\\", \\"url\\": \\"https://example.com/checkout\\", \\"purl\\": \\"https://example.com/cart\\", \\"title\\": \\"Checkout - Example Store\\", \\"npv\\": 1, \\"sts\\": 400, \\"pts\\": 200, \\"timestamp\\": 1754392679209}"\n  },\n  "results": [\n    {\n      "comment": "Event \\"sign_up\\" from CSV was not found in the uploaded log file",\n      "eventName": "sign_up",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "sign_up"\n    },\n    {\n      "comment": "Event \\"user_profile_push\\" from CSV was not found in the uploaded log file",\n      "eventName": "user_profile_push",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "user_profile_push"\n    },\n    {\n      "comment": "Event \\"clicked\\" from CSV was not found in the uploaded log file",\n      "eventName": "clicked",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "clicked"\n    },\n    {\n      "comment": "Event \\"product_purchase\\" from CSV was not found in the uploaded log file",\n      "eventName": "product_purchase",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "product_purchase"\n    },\n    {\n      "comment": "Event \\"appointment_click\\" from CSV was not found in the uploaded log file",\n      "eventName": "appointment_click",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "appointment_click"\n    },\n    {\n      "comment": "Event \\"flight searched\\" found in logs but not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "line_number": 1,\n      "receivedType": "extra event in logs",\n      "validationStatus": "Extra event present in logs",\n      "value": "flight searched"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "src",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "GUWAHATI (GAU)"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "des",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "NEW DELHI (DEL)"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "flight_type",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "domestic"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "departure_date",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "05-08-2025"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "return_date",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": ""\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "passenger_adult",\n      "line_number": 1,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 1\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "passenger_child",\n      "line_number": 1,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 0\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "flight_class",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "economy"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "source",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "web"\n    },\n    {\n      "comment": "Event \\"purchase completed\\" found in logs but not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "line_number": 3,\n      "receivedType": "extra event in logs",\n      "validationStatus": "Extra event present in logs",\n      "value": "purchase completed"\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "order_id",\n      "line_number": 3,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "ORD789"\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "total_amount",\n      "line_number": 3,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 79999\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "currency",\n      "line_number": 3,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "INR"\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "payment_method",\n      "line_number": 3,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "credit_card"\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "shipping_address",\n      "line_number": 3,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "456 Oak St, City, State 54321"\n    },\n    {\n      "comment": "Event \\"product viewed\\" found in logs but not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "line_number": 2,\n      "receivedType": "extra event in logs",\n      "validationStatus": "Extra event present in logs",\n      "value": "product viewed"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "product_id",\n      "line_number": 2,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "12345"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "product_name",\n      "line_number": 2,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "iPhone 15"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "category",\n      "line_number": 2,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "Electronics"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "brand",\n      "line_number": 2,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "Apple"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "price",\n      "line_number": 2,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 79999\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "currency",\n      "line_number": 2,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "INR"\n    }\n  ],\n  "summary": {\n    "csv_events": [\n      "product_purchase",\n      "appointment_click",\n      "sign_up",\n      "user_profile_push",\n      "clicked"\n    ],\n    "csv_events_count": 5,\n    "extra_events": [\n      "flight searched",\n      "purchase completed",\n      "product viewed"\n    ],\n    "log_events": [\n      "flight searched",\n      "purchase completed",\n      "product viewed"\n    ],\n    "log_events_count": 3,\n    "total_log_entries": 3\n  }\n}\n'
2025-10-10 13:09:23,620 - INFO - 127.0.0.1 - - [10/Oct/2025 13:09:23] "POST /validate-website-logs-v2 HTTP/1.1" 200 -
2025-10-10 13:09:24,264 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Content-Length: 2073
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Accept: */*
Sec-Ch-Ua-Platform: "macOS"
X-Requested-With: XMLHttpRequest
Sec-Ch-Ua-Mobile: ?0
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary0EFpxoKryYGiqn3a
Origin: http://localhost:10000
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 13:09:24,264 - INFO - Body: b'------WebKitFormBoundary0EFpxoKryYGiqn3a\r\nContent-Disposition: form-data; name="csv_file"; filename="sample.csv"\r\nContent-Type: text/csv\r\n\r\neventName,eventPayload,dataType\r\nsign_up,seat_type,text\r\n,seat number,integer\r\n,movie,text\r\n,screen,text\r\n,date,date \r\n,location,text\r\n,experience,text\r\n,amount,float\r\nuser_profile_push,seat_type,text\r\n,seat number,integer\r\n,movie,text\r\n,screen,text\r\n,date,date \r\n,location,text\r\n,experience,text\r\n,amount,float\r\nclicked,revenue,float\r\nproduct_purchase,items[].variant_id,text, NOTE: ARRAY PAYLOAD. PLEASE DONT ADD THIS ROW IN THE ACTUAL SHEET\r\n,items[].prname,text\r\n,items[].price,float\r\n,items[].prid,text\r\n,items[].brand,text\r\nappointment_click,user_type,text\r\n------WebKitFormBoundary0EFpxoKryYGiqn3a\r\nContent-Disposition: form-data; name="txt_file"; filename="sample_website_logs_v2.txt"\r\nContent-Type: text/plain\r\n\r\n{"src": "GUWAHATI (GAU)", "des": "NEW DELHI (DEL)", "flight_type": "domestic", "departure_date": "05-08-2025", "return_date": "", "passenger_adult": 1, "passenger_child": 0, "flight_class": "economy", "source": "web", "event": "flight searched", "url": "https://happyfares.in/?rdt=true~in", "purl": "https://happyfares.in/home", "title": "Flight Tickets Booking at HappyFares.in, Cheap Flights Fares.", "npv": 1, "sts": 455, "pts": 322, "timestamp": 1754392679207}\n{"product_id": "12345", "product_name": "iPhone 15", "category": "Electronics", "brand": "Apple", "price": 79999, "currency": "INR", "event": "product viewed", "url": "https://example.com/product/12345", "purl": "https://example.com/products", "title": "iPhone 15 - Example Store", "npv": 1, "sts": 300, "pts": 150, "timestamp": 1754392679208}\n{"order_id": "ORD789", "total_amount": 79999, "currency": "INR", "payment_method": "credit_card", "shipping_address": "456 Oak St, City, State 54321", "event": "purchase completed", "url": "https://example.com/checkout", "purl": "https://example.com/cart", "title": "Checkout - Example Store", "npv": 1, "sts": 400, "pts": 200, "timestamp": 1754392679209} \r\n------WebKitFormBoundary0EFpxoKryYGiqn3a--\r\n'
2025-10-10 13:09:24,264 - INFO - URL: http://localhost:10000/validate-website-logs-v2
2025-10-10 13:09:24,264 - INFO - Method: POST
2025-10-10 13:09:24,264 - INFO - Endpoint: validate_website_logs_v2
2025-10-10 13:09:24,264 - INFO - Website logs v2 validation endpoint called
2025-10-10 13:09:24,265 - INFO - website_logs_v2_upload: {"csv_file": "sample.csv", "txt_file": "sample_website_logs_v2.txt", "timestamp": "2025-10-10T13:09:24.265949"}
2025-10-10 13:09:24,266 - INFO - website_logs_v2_validation_complete: {"total_validations": 28, "valid_count": 0, "invalid_count": 28, "csv_events_count": 5, "log_events_count": 3, "extra_events_count": 3, "total_log_entries": 3}
2025-10-10 13:09:24,266 - INFO - Response: b'{\n  "fully_valid_events": [],\n  "original_logs": {\n    "flight searched": "{\\"src\\": \\"GUWAHATI (GAU)\\", \\"des\\": \\"NEW DELHI (DEL)\\", \\"flight_type\\": \\"domestic\\", \\"departure_date\\": \\"05-08-2025\\", \\"return_date\\": \\"\\", \\"passenger_adult\\": 1, \\"passenger_child\\": 0, \\"flight_class\\": \\"economy\\", \\"source\\": \\"web\\", \\"event\\": \\"flight searched\\", \\"url\\": \\"https://happyfares.in/?rdt=true~in\\", \\"purl\\": \\"https://happyfares.in/home\\", \\"title\\": \\"Flight Tickets Booking at HappyFares.in, Cheap Flights Fares.\\", \\"npv\\": 1, \\"sts\\": 455, \\"pts\\": 322, \\"timestamp\\": 1754392679207}",\n    "product viewed": "{\\"product_id\\": \\"12345\\", \\"product_name\\": \\"iPhone 15\\", \\"category\\": \\"Electronics\\", \\"brand\\": \\"Apple\\", \\"price\\": 79999, \\"currency\\": \\"INR\\", \\"event\\": \\"product viewed\\", \\"url\\": \\"https://example.com/product/12345\\", \\"purl\\": \\"https://example.com/products\\", \\"title\\": \\"iPhone 15 - Example Store\\", \\"npv\\": 1, \\"sts\\": 300, \\"pts\\": 150, \\"timestamp\\": 1754392679208}",\n    "purchase completed": "{\\"order_id\\": \\"ORD789\\", \\"total_amount\\": 79999, \\"currency\\": \\"INR\\", \\"payment_method\\": \\"credit_card\\", \\"shipping_address\\": \\"456 Oak St, City, State 54321\\", \\"event\\": \\"purchase completed\\", \\"url\\": \\"https://example.com/checkout\\", \\"purl\\": \\"https://example.com/cart\\", \\"title\\": \\"Checkout - Example Store\\", \\"npv\\": 1, \\"sts\\": 400, \\"pts\\": 200, \\"timestamp\\": 1754392679209}"\n  },\n  "results": [\n    {\n      "comment": "Event \\"sign_up\\" from CSV was not found in the uploaded log file",\n      "eventName": "sign_up",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "sign_up"\n    },\n    {\n      "comment": "Event \\"user_profile_push\\" from CSV was not found in the uploaded log file",\n      "eventName": "user_profile_push",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "user_profile_push"\n    },\n    {\n      "comment": "Event \\"clicked\\" from CSV was not found in the uploaded log file",\n      "eventName": "clicked",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "clicked"\n    },\n    {\n      "comment": "Event \\"product_purchase\\" from CSV was not found in the uploaded log file",\n      "eventName": "product_purchase",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "product_purchase"\n    },\n    {\n      "comment": "Event \\"appointment_click\\" from CSV was not found in the uploaded log file",\n      "eventName": "appointment_click",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "appointment_click"\n    },\n    {\n      "comment": "Event \\"flight searched\\" found in logs but not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "line_number": 1,\n      "receivedType": "extra event in logs",\n      "validationStatus": "Extra event present in logs",\n      "value": "flight searched"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "src",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "GUWAHATI (GAU)"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "des",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "NEW DELHI (DEL)"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "flight_type",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "domestic"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "departure_date",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "05-08-2025"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "return_date",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": ""\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "passenger_adult",\n      "line_number": 1,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 1\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "passenger_child",\n      "line_number": 1,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 0\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "flight_class",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "economy"\n    },\n    {\n      "comment": "Field from event \\"flight searched\\" which is not defined in CSV validation rules",\n      "eventName": "flight searched",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "source",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "web"\n    },\n    {\n      "comment": "Event \\"purchase completed\\" found in logs but not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "line_number": 3,\n      "receivedType": "extra event in logs",\n      "validationStatus": "Extra event present in logs",\n      "value": "purchase completed"\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "order_id",\n      "line_number": 3,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "ORD789"\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "total_amount",\n      "line_number": 3,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 79999\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "currency",\n      "line_number": 3,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "INR"\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "payment_method",\n      "line_number": 3,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "credit_card"\n    },\n    {\n      "comment": "Field from event \\"purchase completed\\" which is not defined in CSV validation rules",\n      "eventName": "purchase completed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "shipping_address",\n      "line_number": 3,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "456 Oak St, City, State 54321"\n    },\n    {\n      "comment": "Event \\"product viewed\\" found in logs but not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "line_number": 2,\n      "receivedType": "extra event in logs",\n      "validationStatus": "Extra event present in logs",\n      "value": "product viewed"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "product_id",\n      "line_number": 2,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "12345"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "product_name",\n      "line_number": 2,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "iPhone 15"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "category",\n      "line_number": 2,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "Electronics"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "brand",\n      "line_number": 2,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "Apple"\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "price",\n      "line_number": 2,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 79999\n    },\n    {\n      "comment": "Field from event \\"product viewed\\" which is not defined in CSV validation rules",\n      "eventName": "product viewed",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "currency",\n      "line_number": 2,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "INR"\n    }\n  ],\n  "summary": {\n    "csv_events": [\n      "product_purchase",\n      "appointment_click",\n      "sign_up",\n      "user_profile_push",\n      "clicked"\n    ],\n    "csv_events_count": 5,\n    "extra_events": [\n      "flight searched",\n      "purchase completed",\n      "product viewed"\n    ],\n    "log_events": [\n      "flight searched",\n      "purchase completed",\n      "product viewed"\n    ],\n    "log_events_count": 3,\n    "total_log_entries": 3\n  }\n}\n'
2025-10-10 13:09:24,267 - INFO - 127.0.0.1 - - [10/Oct/2025 13:09:24] "POST /validate-website-logs-v2 HTTP/1.1" 200 -
2025-10-10 13:09:38,334 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Cache-Control: max-age=0
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 13:09:38,335 - INFO - Body: b''
2025-10-10 13:09:38,335 - INFO - URL: http://localhost:10000/
2025-10-10 13:09:38,335 - INFO - Method: GET
2025-10-10 13:09:38,335 - INFO - Endpoint: index
2025-10-10 13:09:38,346 - INFO - Response: b'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Event Validation Tool</title>\n    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">\n    <link href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" rel="stylesheet">\n    <style>\n        :root {\n            --primary-color: #e35502;\n            --header-bg: #230f2e;\n        }\n        \n        .container { margin-top: 30px; }\n        .table-container { margin-top: 20px; }\n        .filter-container { margin: 20px 0; }\n        .hidden { display: none; }\n        .first-event { color: blue; }\n        \n        /* Header styling */\n        .navbar {\n            background-color: var(--header-bg) !important;\n        }\n        \n        .navbar-brand, .navbar-nav .nav-link {\n            color: white !important;\n        }\n        \n        .navbar-toggler {\n            border-color: rgba(255,255,255,0.5);\n        }\n        \n        .navbar-toggler-icon {\n            background-image: url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 30 30\'%3e%3cpath stroke=\'rgba%28255, 255, 255, 0.75%29\' stroke-linecap=\'round\' stroke-miterlimit=\'10\' stroke-width=\'2\' d=\'M4 7h22M4 15h22M4 23h22\'/%3e%3c/svg%3e");\n        }\n        \n        /* Button styling */\n        .btn-primary {\n            background-color: var(--primary-color) !important;\n            border-color: var(--primary-color) !important;\n        }\n        \n        .btn-primary:hover {\n            background-color: #c64802 !important;\n            border-color: #c64802 !important;\n        }\n        \n        .btn-outline-primary {\n            color: white !important;\n            border-color: white !important;\n        }\n        \n        .btn-outline-primary:hover {\n            background-color: rgba(255,255,255,0.1) !important;\n        }\n        .null-value { background-color: yellow; }\n        .valid-status { color: green; }\n        .invalid-status { color: red; }\n        .empty-status { color: orange; }\n        .not-present { color: darkolivegreen; }\n        .extra-key { color: rgb(24, 214, 185); }\n        .type-mismatch { background-color: #ffe6e6; }\n        .download-section {\n            margin: 20px 0;\n            text-align: right;\n        }\n        /* Status color coding */\n        .status-valid { background-color: #d4edda !important; color: #155724 !important; }\n        .status-invalid { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-empty { background-color: #fff3cd !important; color: #856404 !important; }\n        .status-extra { background-color: #d1ecf1 !important; color: #0c5460 !important; }\n        .status-notpresent { background-color: #042508 !important; color: #7f7b97 !important; }\n        .status-csv { background-color: #e2e3e5 !important; color: #383d41 !important; }\n        .status-extra-event { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-extra-field { background-color: #fff3cd !important; color: #856404 !important; }\n        .validation-status {\n            font-weight: bold;\n        }\n        .status-valid {\n            color: #28a745;\n        }\n        .status-invalid {\n            color: #dc3545;\n        }\n        .status-empty {\n            color: #ffc107;\n        }\n        .status-extra {\n            color: #17a2b8;\n        }\n        .status-extra-event {\n            color: #dc3545;\n        }\n        .status-extra-field {\n            color: #ffc107;\n        }\n        .filter-section {\n            background-color: #f8f9fa;\n            padding: 15px;\n            margin-bottom: 20px;\n            border-radius: 5px;\n        }\n        .sort-header {\n            cursor: pointer;\n        }\n        .sort-header:hover {\n            background-color: #e9ecef;\n        }\n        .sort-icon {\n            margin-left: 5px;\n        }\n        .filter-dropdown {\n            position: relative;\n            display: inline-block;\n        }\n        .filter-content {\n            display: none;\n            position: absolute;\n            background-color: #f9f9f9;\n            min-width: 200px;\n            max-height: 300px;\n            overflow-y: auto;\n            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\n            z-index: 1000;\n            padding: 10px;\n        }\n        .filter-content.show {\n            display: block;\n        }\n        .filter-checkbox {\n            margin: 5px 0;\n        }\n        .filter-checkbox label {\n            display: block;\n            padding: 5px;\n            cursor: pointer;\n        }\n        .filter-checkbox label:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-header {\n            display: flex;\n            align-items: center;\n            cursor: pointer;\n            padding: 5px;\n        }\n        .filter-header:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-icon {\n            margin-left: 5px;\n        }\n        .filter-actions {\n            margin-top: 10px;\n            padding-top: 10px;\n            border-top: 1px solid #ddd;\n        }\n    </style>\n</head>\n<body>\n    <nav class="navbar navbar-expand-lg navbar-light bg-light">\n        <div class="container-fluid">\n            <a class="navbar-brand" href="#">Netcore Event Payload Validator</a>\n            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">\n                <span class="navbar-toggler-icon"></span>\n            </button>\n            <div class="collapse navbar-collapse" id="navbarNav">\n                <ul class="navbar-nav ms-auto">\n                    <li class="nav-item">\n                        <a class="btn btn-primary" href="https://contact-api-via-csv-7e94e.web.app/" target="_blank">Trigger Activity API</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </nav>\n\n    <div class="container">\n        <h2>Event Validation Tool</h2>\n        \n        <div class="card mb-4">\n            <div class="card-body">\n                <div class="mb-3">\n                    <label class="form-label">Validation Mode</label>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="regularMode" value="regular" checked>\n                        <label class="form-check-label" for="regularMode">\n                            Android and iOS Event (Single Event/Event Payload format)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteMode" value="website">\n                        <label class="form-check-label" for="websiteMode">\n                            Website Logs Validation (JSON lines format with eventname and payload)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteV2Mode" value="website-v2">\n                        <label class="form-check-label" for="websiteV2Mode">\n                            Website Logs V2 Validation (JSON lines format with event key and system fields excluded)\n                        </label>\n                    </div>\n                </div>\n                \n                <form id="uploadForm" enctype="multipart/form-data">\n                    <div class="mb-3">\n                        <label for="csvFile" class="form-label">CSV File (Validation Rules)</label>\n                        <input type="file" class="form-control" id="csvFile" name="csv_file" accept=".csv" required>\n                        <div class="mt-2">\n                            <a href="/download_template" class="btn btn-outline-secondary btn-sm">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Sample Template\n                            </a>\n                        </div>\n                    </div>\n                    <div class="mb-3">\n                        <label for="txtFile" class="form-label">TXT File (Event Logs)</label>\n                        <input type="file" class="form-control" id="txtFile" name="txt_file" accept=".txt" required>\n                        <div class="mt-2 sample-downloads">\n                            <!-- Regular mode sample -->\n                            <button class="btn btn-outline-secondary btn-sm sample-download regular-mode download-btn" data-mode="regular">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Regular Sample Log\n                            </button>\n                            <!-- Website mode sample -->\n                            <button class="btn btn-outline-secondary btn-sm sample-download website-mode download-btn" data-mode="website" style="display: none;">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Website Sample Log\n                            </button>\n                            <!-- Website V2 mode samples -->\n                            <div class="v2-mode-downloads" style="display: none;">\n                                <button class="btn btn-outline-secondary btn-sm mb-1 download-btn" data-mode="website-v2" data-multiline="false">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                    </svg>\n                                    Download Website V2 Sample Log\n                                </button>\n                                <br>\n                                <button class="btn btn-outline-secondary btn-sm download-btn" data-mode="website-v2" data-multiline="true">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                    </svg>\n                                    Download Website V2 Multiline Sample\n                                </button>\n                            </div>\n                            <div id="downloadError" class="alert alert-danger mt-2" style="display: none;"></div>\n                        </div>\n                    </div>\n                    <button type="submit" class="btn btn-primary">Validate</button>\n                </form>\n            </div>\n        </div>\n\n        <div class="filter-section" id="filterSection" style="display: none;">\n            <div class="row mb-3">\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Summary</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>CSV Events:</strong></p>\n                                    <p class="text-primary" id="csvEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Log Events:</strong></p>\n                                    <p class="text-success" id="logEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Details</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Missing Events:</strong></p>\n                                    <p class="text-warning" id="missingEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Extra Events:</strong></p>\n                                    <p class="text-info" id="extraEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <h4>Filters</h4>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="eventName">\n                            Event Name <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="eventNameFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="eventNameSelectAll" checked>\n                                <label for="eventNameSelectAll">Select All</label>\n                            </div>\n                            <div id="eventNameOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'eventName\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'eventName\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="status">\n                            Status <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="statusFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="statusSelectAll" checked>\n                                <label for="statusSelectAll">Select All</label>\n                            </div>\n                            <div id="statusOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'status\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'status\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="expectedType">\n                            Expected Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="expectedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="expectedTypeSelectAll" checked>\n                                <label for="expectedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="expectedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'expectedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'expectedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="receivedType">\n                            Received Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="receivedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="receivedTypeSelectAll" checked>\n                                <label for="receivedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="receivedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'receivedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'receivedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-secondary" id="clearFilters">Clear All Filters</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-success" id="downloadResults">Download Results</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-info" id="downloadValidEvents">Download Valid Events</button>\n                </div>\n            </div>\n        </div>\n\n        <div id="fullyValidEventsSection" class="alert alert-success" style="display:none;">\n            <strong>Events with all payloads valid:</strong>\n            <ul id="fullyValidEventsList" style="margin-bottom:0;"></ul>\n        </div>\n\n        <div class="table-container">\n            <table class="table table-striped" id="resultsTable">\n                <thead>\n                    <tr>\n                        <th class="sort-header" data-sort="eventName">Event Name <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="key">Key <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="value">Value <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="expectedType">Expected Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="receivedType">Received Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="validationStatus">Status <span class="sort-icon">\xe2\x86\x95</span></th>\n                    </tr>\n                </thead>\n                <tbody id="resultsBody"></tbody>\n            </table>\n        </div>\n    </div>\n\n    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/moment/moment.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>\n    <script>\n        let currentResults = [];\n        let currentSummary = {};\n        let currentSort = { field: null, order: \'asc\' };\n        let activeFilters = {\n            eventName: [],\n            status: [],\n            expectedType: [],\n            receivedType: []\n        };\n\n        $(\'#dateRange\').daterangepicker({\n            autoUpdateInput: false,\n            locale: {\n                cancelLabel: \'Clear\'\n            }\n        });\n\n        $(\'#dateRange\').on(\'apply.daterangepicker\', function(ev, picker) {\n            $(this).val(picker.startDate.format(\'MM/DD/YYYY\') + \' - \' + picker.endDate.format(\'MM/DD/YYYY\'));\n            applyFilters();\n        });\n\n        $(\'#dateRange\').on(\'cancel.daterangepicker\', function(ev, picker) {\n            $(this).val(\'\');\n            applyFilters();\n        });\n\n        // Handle validation mode changes\n        $(\'input[name="validationMode"]\').change(function() {\n            const mode = $(this).val();\n            // Hide all sample download buttons first\n            $(\'.sample-download, .v2-mode-downloads\').hide();\n            \n            // Show the appropriate download button based on mode\n            if (mode === \'regular\') {\n                $(\'.sample-download.regular-mode\').show();\n            } else if (mode === \'website\') {\n                $(\'.sample-download.website-mode\').show();\n            } else if (mode === \'website-v2\') {\n                $(\'.v2-mode-downloads\').show();\n            }\n        });\n\n        $(\'#uploadForm\').on(\'submit\', function(e) {\n            e.preventDefault();\n            const formData = new FormData(this);\n            \n            // Determine which endpoint to use based on validation mode\n            const validationMode = $(\'input[name="validationMode"]:checked\').val();\n            let endpoint = \'/upload\';\n            if (validationMode === \'website\') {\n                endpoint = \'/validate-website-logs\';\n            } else if (validationMode === \'website-v2\') {\n                endpoint = \'/validate-website-logs-v2\';\n            }\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + endpoint;\n            \n            console.log(\'Making request to:\', fullUrl);\n            console.log(\'Validation mode:\', validationMode);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: formData,\n                processData: false,\n                contentType: false,\n                success: function(response) {\n                    console.log(\'Upload response:\', response);\n                    \n                    // Ensure response is properly initialized\n                    currentResults = [];\n                    currentSummary = {\n                        csv_events_count: 0,\n                        log_events_count: 0,\n                        csv_events: [],\n                        log_events: []\n                    };\n                    window.originalLogs = {};\n                    \n                    // Handle both old and new response formats\n                    if (response && response.results && Array.isArray(response.results)) {\n                        // New format with summary\n                        currentResults = response.results;\n                        if (response.summary) {\n                            currentSummary = response.summary;\n                        }\n                        if (response.original_logs) {\n                            window.originalLogs = response.original_logs;\n                        }\n                    } else if (Array.isArray(response)) {\n                        // Old format - just results array\n                        currentResults = response;\n                    } else {\n                        console.error(\'Invalid response format:\', response);\n                    }\n                    \n                    updateEventSummary();\n                    updateFilters();\n                    displayResults(currentResults);\n                    $(\'#filterSection\').show();\n\n                    if (response.fully_valid_events && response.fully_valid_events.length > 0) {\n                        $(\'#fullyValidEventsList\').empty();\n                        response.fully_valid_events.forEach(function(eventName) {\n                            $(\'#fullyValidEventsList\').append(\'<li>\' + eventName + \'</li>\');\n                        });\n                        $(\'#fullyValidEventsSection\').show();\n                    } else {\n                        $(\'#fullyValidEventsSection\').hide();\n                    }\n                },\n                error: function(xhr) {\n                    console.error(\'Upload error:\', xhr);\n                    alert(\'Error uploading files: \' + xhr.responseText);\n                }\n            });\n        });\n\n        // Initialize filter dropdowns\n        // Handle sample file downloads\n        $(\'.download-btn\').click(function() {\n            const mode = $(this).data(\'mode\');\n            const multiline = $(this).data(\'multiline\') || false;\n            let url = `/download_sample_log/${mode}`;\n            if (mode === \'website-v2\' && multiline) {\n                url += \'?multiline=true\';\n            }\n\n            // Show loading state\n            $(this).prop(\'disabled\', true);\n            $(this).html(\'<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Downloading...\');\n            const button = $(this);\n\n            fetch(url)\n                .then(response => {\n                    if (!response.ok) {\n                        return response.json().then(err => Promise.reject(err));\n                    }\n                    return response.blob();\n                })\n                .then(blob => {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    let filename = \'sample_log.txt\';\n                    if (mode === \'website\') {\n                        filename = \'sample_website_logs.txt\';\n                    } else if (mode === \'website-v2\') {\n                        filename = multiline ? \'sample_website_logs_v2_multiline.txt\' : \'sample_website_logs_v2.txt\';\n                    }\n                    a.href = url;\n                    a.download = filename;\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                    $(\'#downloadError\').hide();\n                })\n                .catch(error => {\n                    console.error(\'Download error:\', error);\n                    $(\'#downloadError\').text(error.error || \'Error downloading file. Please try again.\').show();\n                })\n                .finally(() => {\n                    // Restore button state\n                    button.prop(\'disabled\', false);\n                    const svg = button.find(\'svg\').prop(\'outerHTML\');\n                    button.html(svg + \' Download \' + (mode === \'website-v2\' ? \n                        (multiline ? \'Website V2 Multiline Sample\' : \'Website V2 Sample Log\') : \n                        (mode === \'website\' ? \'Website Sample Log\' : \'Regular Sample Log\')));\n                });\n        });\n\n        $(document).ready(function() {\n            $(\'.filter-header\').click(function(e) {\n                e.stopPropagation();\n                const filterId = $(this).data(\'filter\');\n                console.log(\'Clicked filter:\', filterId);\n                $(`#${filterId}Filter`).toggleClass(\'show\');\n            });\n\n            // Close filter dropdowns when clicking outside\n            $(document).click(function(e) {\n                if (!$(e.target).closest(\'.filter-dropdown\').length) {\n                    $(\'.filter-content\').removeClass(\'show\');\n                }\n            });\n        });\n\n        function updateEventSummary() {\n            // Update event count displays\n            $(\'#csvEventsCount\').text(currentSummary.csv_events_count || 0);\n            $(\'#logEventsCount\').text(currentSummary.log_events_count || 0);\n            \n            // Calculate missing and extra events\n            const csvEvents = new Set(currentSummary.csv_events || []);\n            const logEvents = new Set(currentSummary.log_events || []);\n            \n            const missingEvents = csvEvents.size - new Set([...csvEvents].filter(x => logEvents.has(x))).size;\n            const extraEvents = logEvents.size - new Set([...logEvents].filter(x => csvEvents.has(x))).size;\n            \n            $(\'#missingEventsCount\').text(missingEvents);\n            $(\'#extraEventsCount\').text(extraEvents);\n        }\n\n        function updateFilters() {\n            const eventNames = new Set();\n            const expectedTypes = new Set();\n            const receivedTypes = new Set();\n            const statuses = new Set();\n            \n            currentResults.forEach(result => {\n                if (result.eventName) eventNames.add(result.eventName);\n                if (result.expectedType) expectedTypes.add(result.expectedType);\n                if (result.receivedType) receivedTypes.add(result.receivedType);\n                if (result.validationStatus) statuses.add(result.validationStatus);\n            });\n\n            console.log(\'Available statuses:\', Array.from(statuses));\n\n            updateFilterOptions(\'eventName\', eventNames);\n            updateFilterOptions(\'status\', statuses);\n            updateFilterOptions(\'expectedType\', expectedTypes);\n            updateFilterOptions(\'receivedType\', receivedTypes);\n        }\n\n        function updateFilterOptions(filterId, values) {\n            const container = $(`#${filterId}Options`);\n            container.empty();\n            \n            console.log(`Updating ${filterId} with values:`, Array.from(values));\n            \n            Array.from(values).sort().forEach(value => {\n                if (value) {\n                    const checkboxId = `${filterId}_${value.replace(/[^a-zA-Z0-9]/g, \'_\')}`;\n                    container.append(`\n                        <div class="filter-checkbox">\n                            <input type="checkbox" id="${checkboxId}" value="${value}" checked>\n                            <label for="${checkboxId}">${value}</label>\n                        </div>\n                    `);\n                }\n            });\n\n            // Update select all checkbox\n            $(`#${filterId}SelectAll`).prop(\'checked\', true);\n        }\n\n        function getSelectedValues(filterId) {\n            return $(`#${filterId}Options input:checked`).map(function() {\n                return $(this).val();\n            }).get();\n        }\n\n        function applyFilter(filterId) {\n            activeFilters[filterId] = getSelectedValues(filterId);\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function clearFilter(filterId) {\n            $(`#${filterId}Options input`).prop(\'checked\', false);\n            $(`#${filterId}SelectAll`).prop(\'checked\', false);\n            activeFilters[filterId] = [];\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function applyFilters() {\n            const filters = {\n                eventName: activeFilters.eventName,\n                validationStatus: activeFilters.status,\n                expectedType: activeFilters.expectedType,\n                receivedType: activeFilters.receivedType\n            };\n\n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/filter\';\n\n            console.log(\'Making filter request to:\', fullUrl);\n\n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({\n                    results: currentResults,\n                    filters: filters,\n                    sort_by: currentSort.field,\n                    sort_order: currentSort.order\n                }),\n                contentType: \'application/json\',\n                success: function(response) {\n                    displayResults(response);\n                    window.filteredResults = response;\n                },\n                error: function(xhr) {\n                    console.error(\'Filter error:\', xhr);\n                    alert(\'Error applying filters: \' + xhr.responseText);\n                }\n            });\n        }\n\n        // Handle select all checkboxes\n        $(\'[id$="SelectAll"]\').change(function() {\n            const filterId = this.id.replace(\'SelectAll\', \'\');\n            $(`#${filterId}Options input`).prop(\'checked\', $(this).prop(\'checked\'));\n        });\n\n        // Update select all checkbox when individual checkboxes change\n        $(\'.filter-content\').on(\'change\', \'input[type="checkbox"]:not([id$="SelectAll"])\', function() {\n            const filterId = $(this).closest(\'.filter-content\').attr(\'id\').replace(\'Filter\', \'\');\n            const allChecked = $(`#${filterId}Options input:checked`).length === $(`#${filterId}Options input`).length;\n            $(`#${filterId}SelectAll`).prop(\'checked\', allChecked);\n        });\n\n        $(\'#clearFilters\').click(function() {\n            $(\'.filter-content input[type="checkbox"]\').prop(\'checked\', false);\n            $(\'[id$="SelectAll"]\').prop(\'checked\', false);\n            Object.keys(activeFilters).forEach(key => {\n                activeFilters[key] = [];\n            });\n            applyFilters();\n        });\n\n        $(\'#downloadResults\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download\';\n            \n            console.log(\'Making download request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ results: resultsToDownload }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'validation_results.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download error:\', xhr);\n                    alert(\'Error downloading results: \' + xhr.responseText);\n                }\n            });\n        });\n\n        $(\'#downloadValidEvents\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download-valid-events\';\n            \n            console.log(\'Making download valid events request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ \n                    results: resultsToDownload,\n                    logs_data: window.originalLogs || {}\n                }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'valid_events_report.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download valid events error:\', xhr);\n                    alert(\'Error downloading valid events: \' + xhr.responseText);\n                }\n            });\n        });\n\n        function displayResults(results) {\n            const tbody = $(\'#resultsBody\');\n            tbody.empty();\n            \n            // Debug log to check results being displayed\n            console.log(\'Displaying results:\', results);\n            \n            results.forEach(result => {\n                const statusClass = getStatusClass(result.validationStatus);\n                tbody.append(`\n                    <tr>\n                        <td>${result.eventName}</td>\n                        <td>${result.key}</td>\n                        <td>${result.value}</td>\n                        <td>${result.expectedType}</td>\n                        <td>${result.receivedType}</td>\n                        <td class="validation-status ${statusClass}">${result.validationStatus}</td>\n                    </tr>\n                `);\n            });\n        }\n\n        function getStatusClass(status) {\n            if (status === \'Valid\') return \'status-valid\';\n            if (status === \'Invalid/Wrong datatype/value\') return \'status-invalid\';\n            if (status === \'Payload value is Empty\') return \'status-empty\';\n            if (status === \'Extra key present in the log\') return \'status-extra\';\n            if (status === \'Extra event present in logs\') return \'status-extra-event\';\n            if (status === \'Field from extra event\') return \'status-extra-field\';\n            if (status === \'Event name not present in the logs\') return \'status-notpresent\';\n            return \'\';\n        }\n\n        $(\'.sort-header\').click(function() {\n            const field = $(this).data(\'sort\');\n            if (currentSort.field === field) {\n                currentSort.order = currentSort.order === \'asc\' ? \'desc\' : \'asc\';\n            } else {\n                currentSort.field = field;\n                currentSort.order = \'asc\';\n            }\n            applyFilters();\n        });\n\n        $(\'#eventNameFilter, #statusFilter, #expectedTypeFilter, #receivedTypeFilter\').change(applyFilters);\n    </script>\n</body>\n</html>'
2025-10-10 13:09:38,346 - INFO - 127.0.0.1 - - [10/Oct/2025 13:09:38] "GET / HTTP/1.1" 200 -
2025-10-10 13:09:39,448 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Sec-Ch-Ua-Platform: "macOS"
Accept: */*
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 13:09:39,449 - INFO - Body: b''
2025-10-10 13:09:39,449 - INFO - URL: http://localhost:10000/download_sample_log/regular
2025-10-10 13:09:39,449 - INFO - Method: GET
2025-10-10 13:09:39,449 - INFO - Endpoint: download_sample_log
2025-10-10 13:09:39,449 - INFO - Sending sample file: /Users/allen.thomson/Desktop/sampleapp/automation/validation_script_android/samplelog_android.txt
2025-10-10 13:09:39,452 - INFO - Response: [File Response] Content-Type: text/plain; charset=utf-8, Headers: {'Content-Disposition': 'attachment; filename=samplelog_android.txt', 'Content-Type': 'text/plain; charset=utf-8', 'Content-Length': '4025', 'Last-Modified': 'Thu, 12 Jun 2025 07:13:40 GMT', 'Cache-Control': 'no-cache', 'ETag': '"1749712420.029259-4025-1057957485"', 'Date': 'Fri, 10 Oct 2025 07:39:39 GMT'}
2025-10-10 13:09:39,453 - INFO - 127.0.0.1 - - [10/Oct/2025 13:09:39] "GET /download_sample_log/regular HTTP/1.1" 200 -
2025-10-10 13:09:41,946 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Sec-Ch-Ua-Platform: "macOS"
Accept: */*
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
If-None-Match: "1754397738.9556391-1165-92612696"
If-Modified-Since: Tue, 05 Aug 2025 12:42:18 GMT


2025-10-10 13:09:41,946 - INFO - Body: b''
2025-10-10 13:09:41,947 - INFO - URL: http://localhost:10000/download_sample_log/website-v2
2025-10-10 13:09:41,947 - INFO - Method: GET
2025-10-10 13:09:41,947 - INFO - Endpoint: download_sample_log
2025-10-10 13:09:41,947 - INFO - Sending sample file: /Users/allen.thomson/Desktop/sampleapp/automation/validation_script_android/sample_website_logs_v2.txt
2025-10-10 13:09:41,947 - INFO - Response: [File Response] Content-Type: text/plain; charset=utf-8, Headers: {'Content-Disposition': 'attachment; filename=sample_website_logs_v2.txt', 'Content-Type': 'text/plain; charset=utf-8', 'Content-Length': '1165', 'Last-Modified': 'Tue, 05 Aug 2025 12:42:18 GMT', 'Cache-Control': 'no-cache', 'ETag': '"1754397738.9556391-1165-92612696"', 'Date': 'Fri, 10 Oct 2025 07:39:41 GMT'}
2025-10-10 13:09:41,948 - INFO - 127.0.0.1 - - [10/Oct/2025 13:09:41] "[36mGET /download_sample_log/website-v2 HTTP/1.1[0m" 304 -
2025-10-10 13:09:42,713 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Sec-Ch-Ua-Platform: "macOS"
Accept: */*
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
If-None-Match: "1754398482.1795332-1347-2975345802"
If-Modified-Since: Tue, 05 Aug 2025 12:54:42 GMT


2025-10-10 13:09:42,713 - INFO - Body: b''
2025-10-10 13:09:42,714 - INFO - URL: http://localhost:10000/download_sample_log/website-v2?multiline=true
2025-10-10 13:09:42,714 - INFO - Method: GET
2025-10-10 13:09:42,714 - INFO - Endpoint: download_sample_log
2025-10-10 13:09:42,714 - INFO - Sending sample file: /Users/allen.thomson/Desktop/sampleapp/automation/validation_script_android/sample_website_logs_v2_multiline.txt
2025-10-10 13:09:42,714 - INFO - Response: [File Response] Content-Type: text/plain; charset=utf-8, Headers: {'Content-Disposition': 'attachment; filename=sample_website_logs_v2_multiline.txt', 'Content-Type': 'text/plain; charset=utf-8', 'Content-Length': '1347', 'Last-Modified': 'Tue, 05 Aug 2025 12:54:42 GMT', 'Cache-Control': 'no-cache', 'ETag': '"1754398482.1795332-1347-2975345802"', 'Date': 'Fri, 10 Oct 2025 07:39:42 GMT'}
2025-10-10 13:09:42,715 - INFO - 127.0.0.1 - - [10/Oct/2025 13:09:42] "[36mGET /download_sample_log/website-v2?multiline=true HTTP/1.1[0m" 304 -
2025-10-10 13:09:49,100 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Sec-Ch-Ua-Platform: "macOS"
Accept: */*
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 13:09:49,101 - INFO - Body: b''
2025-10-10 13:09:49,101 - INFO - URL: http://localhost:10000/download_sample_log/website
2025-10-10 13:09:49,101 - INFO - Method: GET
2025-10-10 13:09:49,101 - INFO - Endpoint: download_sample_log
2025-10-10 13:09:49,102 - INFO - Sending sample file: /Users/allen.thomson/Desktop/sampleapp/automation/validation_script_android/sample_website_logs.txt
2025-10-10 13:09:49,103 - INFO - Response: [File Response] Content-Type: text/plain; charset=utf-8, Headers: {'Content-Disposition': 'attachment; filename=sample_website_logs.txt', 'Content-Type': 'text/plain; charset=utf-8', 'Content-Length': '2541', 'Last-Modified': 'Tue, 05 Aug 2025 11:39:47 GMT', 'Cache-Control': 'no-cache', 'ETag': '"1754393987.2720704-2541-2379622225"', 'Date': 'Fri, 10 Oct 2025 07:39:49 GMT'}
2025-10-10 13:09:49,104 - INFO - 127.0.0.1 - - [10/Oct/2025 13:09:49] "GET /download_sample_log/website HTTP/1.1" 200 -
2025-10-10 13:10:01,571 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Content-Length: 3446
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Accept: */*
Sec-Ch-Ua-Platform: "macOS"
X-Requested-With: XMLHttpRequest
Sec-Ch-Ua-Mobile: ?0
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryBoXMS1B3vMiUrB8Q
Origin: http://localhost:10000
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 13:10:01,573 - INFO - Body: b'------WebKitFormBoundaryBoXMS1B3vMiUrB8Q\r\nContent-Disposition: form-data; name="csv_file"; filename="sample.csv"\r\nContent-Type: text/csv\r\n\r\neventName,eventPayload,dataType\r\nsign_up,seat_type,text\r\n,seat number,integer\r\n,movie,text\r\n,screen,text\r\n,date,date \r\n,location,text\r\n,experience,text\r\n,amount,float\r\nuser_profile_push,seat_type,text\r\n,seat number,integer\r\n,movie,text\r\n,screen,text\r\n,date,date \r\n,location,text\r\n,experience,text\r\n,amount,float\r\nclicked,revenue,float\r\nproduct_purchase,items[].variant_id,text, NOTE: ARRAY PAYLOAD. PLEASE DONT ADD THIS ROW IN THE ACTUAL SHEET\r\n,items[].prname,text\r\n,items[].price,float\r\n,items[].prid,text\r\n,items[].brand,text\r\nappointment_click,user_type,text\r\n------WebKitFormBoundaryBoXMS1B3vMiUrB8Q\r\nContent-Disposition: form-data; name="txt_file"; filename="sample_website_logs.txt"\r\nContent-Type: text/plain\r\n\r\n{"user_key": "ADGMOT35CHFLVDHBJNIG50K969JBBF7D7BUO2C2MMATUNNAMNCAG", "customer_key": "", "uuid": "5805fba6-b6fe-4d04-a8e2-b6d14169d435", "siteid": "b4866def4961e1956c0a2b7d192374e9", "browser": "chrome", "sid": 1754392864987, "visit": "new", "pts": 26, "sts": 45, "url": "https://www.vegnonveg.com/?utm_source=google&utm_medium=cpc&utm_campaign=VM_Search_Brand_22July%2721&utm_term=Brand_Exact&gad_source=1&gad_campaignid=13987172062&gbraid=0AAAAABQITHKDgE0SNLnvY5e0E4qyXdwzz&gclid=Cj0KCQjw18bEBhCBARIsAKuAFEbS2kpy_2pwlh0XZnhn7ERm7VSsbDadFNK0EYNqP0wkr2asM0Zc6foaAq0fEALw_wcB", "tx": 1754392883660, "ptx": 1754392883407, "purl": "https://www.vegnonveg.com/products/new-balance-9060-linen", "npv": 1, "title": "New Balance - 9060 - VegNonVeg", "usertimings": 1754392910195, "eventname": "add_to_cart", "payload": {"prid": "13680", "prqt": 1, "image": "https://images.vegnonveg.com/media/13680/new-balance-9060-linen-68909a7b8ef52.jpg?format=webp", "product_name": "9060", "category": "Footwear", "brand": "New Balance", "selling_price": 17999, "discounted_price": 17999, "stock_availability": 1, "product_url": "https://www.vegnonveg.com/products/new-balance-9060-linen"}}\n{"user_key": "ADGMOT35CHFLVDHBJNIG50K969JBBF7D7BUO2C2MMATUNNAMNCAG", "customer_key": "", "uuid": "5805fba6-b6fe-4d04-a8e2-b6d14169d435", "siteid": "b4866def4961e1956c0a2b7d192374e9", "browser": "chrome", "sid": 1754392864987, "visit": "new", "pts": 26, "sts": 45, "url": "https://www.vegnonveg.com/checkout", "tx": 1754392883660, "ptx": 1754392883407, "purl": "https://www.vegnonveg.com/checkout", "npv": 1, "title": "Checkout - VegNonVeg", "usertimings": 1754392910195, "eventname": "purchase", "payload": {"order_id": "ORD123456", "total_amount": 17999, "currency": "INR", "payment_method": "credit_card", "shipping_address": "123 Main St, City, State 12345", "items": [{"product_id": "13680", "quantity": 1, "price": 17999}]}}\n{"user_key": "ADGMOT35CHFLVDHBJNIG50K969JBBF7D7BUO2C2MMATUNNAMNCAG", "customer_key": "", "uuid": "5805fba6-b6fe-4d04-a8e2-b6d14169d435", "siteid": "b4866def4961e1956c0a2b7d192374e9", "browser": "chrome", "sid": 1754392864987, "visit": "new", "pts": 26, "sts": 45, "url": "https://www.vegnonveg.com/products", "tx": 1754392883660, "ptx": 1754392883407, "purl": "https://www.vegnonveg.com/products", "npv": 1, "title": "Products - VegNonVeg", "usertimings": 1754392910195, "eventname": "view_item", "payload": {"product_id": "13680", "product_name": "9060", "category": "Footwear", "brand": "New Balance", "price": 17999, "currency": "INR"}} \r\n------WebKitFormBoundaryBoXMS1B3vMiUrB8Q--\r\n'
2025-10-10 13:10:01,573 - INFO - URL: http://localhost:10000/validate-website-logs
2025-10-10 13:10:01,573 - INFO - Method: POST
2025-10-10 13:10:01,573 - INFO - Endpoint: validate_website_logs
2025-10-10 13:10:01,573 - INFO - Website logs validation endpoint called
2025-10-10 13:10:01,575 - INFO - website_logs_upload: {"csv_file": "sample.csv", "txt_file": "sample_website_logs.txt", "timestamp": "2025-10-10T13:10:01.575359"}
2025-10-10 13:10:01,577 - INFO - website_logs_validation_complete: {"total_validations": 30, "valid_count": 0, "invalid_count": 30, "csv_events_count": 5, "log_events_count": 3, "extra_events_count": 3, "total_log_entries": 3}
2025-10-10 13:10:01,577 - INFO - Response: b'{\n  "fully_valid_events": [],\n  "original_logs": {\n    "add_to_cart": "{\\"user_key\\": \\"ADGMOT35CHFLVDHBJNIG50K969JBBF7D7BUO2C2MMATUNNAMNCAG\\", \\"customer_key\\": \\"\\", \\"uuid\\": \\"5805fba6-b6fe-4d04-a8e2-b6d14169d435\\", \\"siteid\\": \\"b4866def4961e1956c0a2b7d192374e9\\", \\"browser\\": \\"chrome\\", \\"sid\\": 1754392864987, \\"visit\\": \\"new\\", \\"pts\\": 26, \\"sts\\": 45, \\"url\\": \\"https://www.vegnonveg.com/?utm_source=google&utm_medium=cpc&utm_campaign=VM_Search_Brand_22July%2721&utm_term=Brand_Exact&gad_source=1&gad_campaignid=13987172062&gbraid=0AAAAABQITHKDgE0SNLnvY5e0E4qyXdwzz&gclid=Cj0KCQjw18bEBhCBARIsAKuAFEbS2kpy_2pwlh0XZnhn7ERm7VSsbDadFNK0EYNqP0wkr2asM0Zc6foaAq0fEALw_wcB\\", \\"tx\\": 1754392883660, \\"ptx\\": 1754392883407, \\"purl\\": \\"https://www.vegnonveg.com/products/new-balance-9060-linen\\", \\"npv\\": 1, \\"title\\": \\"New Balance - 9060 - VegNonVeg\\", \\"usertimings\\": 1754392910195, \\"eventname\\": \\"add_to_cart\\", \\"payload\\": {\\"prid\\": \\"13680\\", \\"prqt\\": 1, \\"image\\": \\"https://images.vegnonveg.com/media/13680/new-balance-9060-linen-68909a7b8ef52.jpg?format=webp\\", \\"product_name\\": \\"9060\\", \\"category\\": \\"Footwear\\", \\"brand\\": \\"New Balance\\", \\"selling_price\\": 17999, \\"discounted_price\\": 17999, \\"stock_availability\\": 1, \\"product_url\\": \\"https://www.vegnonveg.com/products/new-balance-9060-linen\\"}}",\n    "purchase": "{\\"user_key\\": \\"ADGMOT35CHFLVDHBJNIG50K969JBBF7D7BUO2C2MMATUNNAMNCAG\\", \\"customer_key\\": \\"\\", \\"uuid\\": \\"5805fba6-b6fe-4d04-a8e2-b6d14169d435\\", \\"siteid\\": \\"b4866def4961e1956c0a2b7d192374e9\\", \\"browser\\": \\"chrome\\", \\"sid\\": 1754392864987, \\"visit\\": \\"new\\", \\"pts\\": 26, \\"sts\\": 45, \\"url\\": \\"https://www.vegnonveg.com/checkout\\", \\"tx\\": 1754392883660, \\"ptx\\": 1754392883407, \\"purl\\": \\"https://www.vegnonveg.com/checkout\\", \\"npv\\": 1, \\"title\\": \\"Checkout - VegNonVeg\\", \\"usertimings\\": 1754392910195, \\"eventname\\": \\"purchase\\", \\"payload\\": {\\"order_id\\": \\"ORD123456\\", \\"total_amount\\": 17999, \\"currency\\": \\"INR\\", \\"payment_method\\": \\"credit_card\\", \\"shipping_address\\": \\"123 Main St, City, State 12345\\", \\"items\\": [{\\"product_id\\": \\"13680\\", \\"quantity\\": 1, \\"price\\": 17999}]}}",\n    "view_item": "{\\"user_key\\": \\"ADGMOT35CHFLVDHBJNIG50K969JBBF7D7BUO2C2MMATUNNAMNCAG\\", \\"customer_key\\": \\"\\", \\"uuid\\": \\"5805fba6-b6fe-4d04-a8e2-b6d14169d435\\", \\"siteid\\": \\"b4866def4961e1956c0a2b7d192374e9\\", \\"browser\\": \\"chrome\\", \\"sid\\": 1754392864987, \\"visit\\": \\"new\\", \\"pts\\": 26, \\"sts\\": 45, \\"url\\": \\"https://www.vegnonveg.com/products\\", \\"tx\\": 1754392883660, \\"ptx\\": 1754392883407, \\"purl\\": \\"https://www.vegnonveg.com/products\\", \\"npv\\": 1, \\"title\\": \\"Products - VegNonVeg\\", \\"usertimings\\": 1754392910195, \\"eventname\\": \\"view_item\\", \\"payload\\": {\\"product_id\\": \\"13680\\", \\"product_name\\": \\"9060\\", \\"category\\": \\"Footwear\\", \\"brand\\": \\"New Balance\\", \\"price\\": 17999, \\"currency\\": \\"INR\\"}}"\n  },\n  "results": [\n    {\n      "comment": "Event \\"sign_up\\" from CSV was not found in the uploaded log file",\n      "eventName": "sign_up",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "sign_up"\n    },\n    {\n      "comment": "Event \\"user_profile_push\\" from CSV was not found in the uploaded log file",\n      "eventName": "user_profile_push",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "user_profile_push"\n    },\n    {\n      "comment": "Event \\"clicked\\" from CSV was not found in the uploaded log file",\n      "eventName": "clicked",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "clicked"\n    },\n    {\n      "comment": "Event \\"product_purchase\\" from CSV was not found in the uploaded log file",\n      "eventName": "product_purchase",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "product_purchase"\n    },\n    {\n      "comment": "Event \\"appointment_click\\" from CSV was not found in the uploaded log file",\n      "eventName": "appointment_click",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "receivedType": "not present in logs",\n      "validationStatus": "Event name not present in the logs",\n      "value": "appointment_click"\n    },\n    {\n      "comment": "Event \\"purchase\\" found in logs but not defined in CSV validation rules",\n      "eventName": "purchase",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "line_number": 2,\n      "receivedType": "extra event in logs",\n      "validationStatus": "Extra event present in logs",\n      "value": "purchase"\n    },\n    {\n      "comment": "Field from event \\"purchase\\" which is not defined in CSV validation rules",\n      "eventName": "purchase",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "order_id",\n      "line_number": 2,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "ORD123456"\n    },\n    {\n      "comment": "Field from event \\"purchase\\" which is not defined in CSV validation rules",\n      "eventName": "purchase",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "total_amount",\n      "line_number": 2,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 17999\n    },\n    {\n      "comment": "Field from event \\"purchase\\" which is not defined in CSV validation rules",\n      "eventName": "purchase",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "currency",\n      "line_number": 2,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "INR"\n    },\n    {\n      "comment": "Field from event \\"purchase\\" which is not defined in CSV validation rules",\n      "eventName": "purchase",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "payment_method",\n      "line_number": 2,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "credit_card"\n    },\n    {\n      "comment": "Field from event \\"purchase\\" which is not defined in CSV validation rules",\n      "eventName": "purchase",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "shipping_address",\n      "line_number": 2,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "123 Main St, City, State 12345"\n    },\n    {\n      "comment": "Field from event \\"purchase\\" which is not defined in CSV validation rules",\n      "eventName": "purchase",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "items",\n      "line_number": 2,\n      "receivedType": "array",\n      "validationStatus": "Field from extra event",\n      "value": [\n        {\n          "price": 17999,\n          "product_id": "13680",\n          "quantity": 1\n        }\n      ]\n    },\n    {\n      "comment": "Event \\"add_to_cart\\" found in logs but not defined in CSV validation rules",\n      "eventName": "add_to_cart",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "line_number": 1,\n      "receivedType": "extra event in logs",\n      "validationStatus": "Extra event present in logs",\n      "value": "add_to_cart"\n    },\n    {\n      "comment": "Field from event \\"add_to_cart\\" which is not defined in CSV validation rules",\n      "eventName": "add_to_cart",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "prid",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "13680"\n    },\n    {\n      "comment": "Field from event \\"add_to_cart\\" which is not defined in CSV validation rules",\n      "eventName": "add_to_cart",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "prqt",\n      "line_number": 1,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 1\n    },\n    {\n      "comment": "Field from event \\"add_to_cart\\" which is not defined in CSV validation rules",\n      "eventName": "add_to_cart",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "image",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "https://images.vegnonveg.com/media/13680/new-balance-9060-linen-68909a7b8ef52.jpg?format=webp"\n    },\n    {\n      "comment": "Field from event \\"add_to_cart\\" which is not defined in CSV validation rules",\n      "eventName": "add_to_cart",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "product_name",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "9060"\n    },\n    {\n      "comment": "Field from event \\"add_to_cart\\" which is not defined in CSV validation rules",\n      "eventName": "add_to_cart",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "category",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "Footwear"\n    },\n    {\n      "comment": "Field from event \\"add_to_cart\\" which is not defined in CSV validation rules",\n      "eventName": "add_to_cart",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "brand",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "New Balance"\n    },\n    {\n      "comment": "Field from event \\"add_to_cart\\" which is not defined in CSV validation rules",\n      "eventName": "add_to_cart",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "selling_price",\n      "line_number": 1,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 17999\n    },\n    {\n      "comment": "Field from event \\"add_to_cart\\" which is not defined in CSV validation rules",\n      "eventName": "add_to_cart",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "discounted_price",\n      "line_number": 1,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 17999\n    },\n    {\n      "comment": "Field from event \\"add_to_cart\\" which is not defined in CSV validation rules",\n      "eventName": "add_to_cart",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "stock_availability",\n      "line_number": 1,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 1\n    },\n    {\n      "comment": "Field from event \\"add_to_cart\\" which is not defined in CSV validation rules",\n      "eventName": "add_to_cart",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "product_url",\n      "line_number": 1,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "https://www.vegnonveg.com/products/new-balance-9060-linen"\n    },\n    {\n      "comment": "Event \\"view_item\\" found in logs but not defined in CSV validation rules",\n      "eventName": "view_item",\n      "expectedType": "event",\n      "key": "EVENT_NAME",\n      "line_number": 3,\n      "receivedType": "extra event in logs",\n      "validationStatus": "Extra event present in logs",\n      "value": "view_item"\n    },\n    {\n      "comment": "Field from event \\"view_item\\" which is not defined in CSV validation rules",\n      "eventName": "view_item",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "product_id",\n      "line_number": 3,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "13680"\n    },\n    {\n      "comment": "Field from event \\"view_item\\" which is not defined in CSV validation rules",\n      "eventName": "view_item",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "product_name",\n      "line_number": 3,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "9060"\n    },\n    {\n      "comment": "Field from event \\"view_item\\" which is not defined in CSV validation rules",\n      "eventName": "view_item",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "category",\n      "line_number": 3,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "Footwear"\n    },\n    {\n      "comment": "Field from event \\"view_item\\" which is not defined in CSV validation rules",\n      "eventName": "view_item",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "brand",\n      "line_number": 3,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "New Balance"\n    },\n    {\n      "comment": "Field from event \\"view_item\\" which is not defined in CSV validation rules",\n      "eventName": "view_item",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "price",\n      "line_number": 3,\n      "receivedType": "integer",\n      "validationStatus": "Field from extra event",\n      "value": 17999\n    },\n    {\n      "comment": "Field from event \\"view_item\\" which is not defined in CSV validation rules",\n      "eventName": "view_item",\n      "expectedType": "EXTRA_EVENT_FIELD",\n      "key": "currency",\n      "line_number": 3,\n      "receivedType": "text",\n      "validationStatus": "Field from extra event",\n      "value": "INR"\n    }\n  ],\n  "summary": {\n    "csv_events": [\n      "product_purchase",\n      "appointment_click",\n      "sign_up",\n      "user_profile_push",\n      "clicked"\n    ],\n    "csv_events_count": 5,\n    "extra_events": [\n      "purchase",\n      "add_to_cart",\n      "view_item"\n    ],\n    "log_events": [\n      "purchase",\n      "add_to_cart",\n      "view_item"\n    ],\n    "log_events_count": 3,\n    "total_log_entries": 3\n  }\n}\n'
2025-10-10 13:10:01,578 - INFO - 127.0.0.1 - - [10/Oct/2025 13:10:01] "POST /validate-website-logs HTTP/1.1" 200 -
2025-10-10 13:10:32,450 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Sec-Ch-Ua-Platform: "macOS"
Accept: */*
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
If-None-Match: "1754393987.2720704-2541-2379622225"
If-Modified-Since: Tue, 05 Aug 2025 11:39:47 GMT


2025-10-10 13:10:32,451 - INFO - Body: b''
2025-10-10 13:10:32,451 - INFO - URL: http://localhost:10000/download_sample_log/website
2025-10-10 13:10:32,451 - INFO - Method: GET
2025-10-10 13:10:32,451 - INFO - Endpoint: download_sample_log
2025-10-10 13:10:32,451 - INFO - Sending sample file: /Users/allen.thomson/Desktop/sampleapp/automation/validation_script_android/sample_website_logs.txt
2025-10-10 13:10:32,456 - INFO - Response: [File Response] Content-Type: text/plain; charset=utf-8, Headers: {'Content-Disposition': 'attachment; filename=sample_website_logs.txt', 'Content-Type': 'text/plain; charset=utf-8', 'Content-Length': '2541', 'Last-Modified': 'Tue, 05 Aug 2025 11:39:47 GMT', 'Cache-Control': 'no-cache', 'ETag': '"1754393987.2720704-2541-2379622225"', 'Date': 'Fri, 10 Oct 2025 07:40:32 GMT'}
2025-10-10 13:10:32,457 - INFO - 127.0.0.1 - - [10/Oct/2025 13:10:32] "[36mGET /download_sample_log/website HTTP/1.1[0m" 304 -
2025-10-10 13:10:34,647 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Cache-Control: max-age=0
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8


2025-10-10 13:10:34,647 - INFO - Body: b''
2025-10-10 13:10:34,647 - INFO - URL: http://localhost:10000/
2025-10-10 13:10:34,648 - INFO - Method: GET
2025-10-10 13:10:34,648 - INFO - Endpoint: index
2025-10-10 13:10:34,649 - INFO - Response: b'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Event Validation Tool</title>\n    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">\n    <link href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" rel="stylesheet">\n    <style>\n        :root {\n            --primary-color: #e35502;\n            --header-bg: #230f2e;\n        }\n        \n        .container { margin-top: 30px; }\n        .table-container { margin-top: 20px; }\n        .filter-container { margin: 20px 0; }\n        .hidden { display: none; }\n        .first-event { color: blue; }\n        \n        /* Header styling */\n        .navbar {\n            background-color: var(--header-bg) !important;\n        }\n        \n        .navbar-brand, .navbar-nav .nav-link {\n            color: white !important;\n        }\n        \n        .navbar-toggler {\n            border-color: rgba(255,255,255,0.5);\n        }\n        \n        .navbar-toggler-icon {\n            background-image: url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 30 30\'%3e%3cpath stroke=\'rgba%28255, 255, 255, 0.75%29\' stroke-linecap=\'round\' stroke-miterlimit=\'10\' stroke-width=\'2\' d=\'M4 7h22M4 15h22M4 23h22\'/%3e%3c/svg%3e");\n        }\n        \n        /* Button styling */\n        .btn-primary {\n            background-color: var(--primary-color) !important;\n            border-color: var(--primary-color) !important;\n        }\n        \n        .btn-primary:hover {\n            background-color: #c64802 !important;\n            border-color: #c64802 !important;\n        }\n        \n        .btn-outline-primary {\n            color: white !important;\n            border-color: white !important;\n        }\n        \n        .btn-outline-primary:hover {\n            background-color: rgba(255,255,255,0.1) !important;\n        }\n        .null-value { background-color: yellow; }\n        .valid-status { color: green; }\n        .invalid-status { color: red; }\n        .empty-status { color: orange; }\n        .not-present { color: darkolivegreen; }\n        .extra-key { color: rgb(24, 214, 185); }\n        .type-mismatch { background-color: #ffe6e6; }\n        .download-section {\n            margin: 20px 0;\n            text-align: right;\n        }\n        /* Status color coding */\n        .status-valid { background-color: #d4edda !important; color: #155724 !important; }\n        .status-invalid { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-empty { background-color: #fff3cd !important; color: #856404 !important; }\n        .status-extra { background-color: #d1ecf1 !important; color: #0c5460 !important; }\n        .status-notpresent { background-color: #042508 !important; color: #7f7b97 !important; }\n        .status-csv { background-color: #e2e3e5 !important; color: #383d41 !important; }\n        .status-extra-event { background-color: #f8d7da !important; color: #721c24 !important; }\n        .status-extra-field { background-color: #fff3cd !important; color: #856404 !important; }\n        .validation-status {\n            font-weight: bold;\n        }\n        .status-valid {\n            color: #28a745;\n        }\n        .status-invalid {\n            color: #dc3545;\n        }\n        .status-empty {\n            color: #ffc107;\n        }\n        .status-extra {\n            color: #17a2b8;\n        }\n        .status-extra-event {\n            color: #dc3545;\n        }\n        .status-extra-field {\n            color: #ffc107;\n        }\n        .filter-section {\n            background-color: #f8f9fa;\n            padding: 15px;\n            margin-bottom: 20px;\n            border-radius: 5px;\n        }\n        .sort-header {\n            cursor: pointer;\n        }\n        .sort-header:hover {\n            background-color: #e9ecef;\n        }\n        .sort-icon {\n            margin-left: 5px;\n        }\n        .filter-dropdown {\n            position: relative;\n            display: inline-block;\n        }\n        .filter-content {\n            display: none;\n            position: absolute;\n            background-color: #f9f9f9;\n            min-width: 200px;\n            max-height: 300px;\n            overflow-y: auto;\n            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\n            z-index: 1000;\n            padding: 10px;\n        }\n        .filter-content.show {\n            display: block;\n        }\n        .filter-checkbox {\n            margin: 5px 0;\n        }\n        .filter-checkbox label {\n            display: block;\n            padding: 5px;\n            cursor: pointer;\n        }\n        .filter-checkbox label:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-header {\n            display: flex;\n            align-items: center;\n            cursor: pointer;\n            padding: 5px;\n        }\n        .filter-header:hover {\n            background-color: #f1f1f1;\n        }\n        .filter-icon {\n            margin-left: 5px;\n        }\n        .filter-actions {\n            margin-top: 10px;\n            padding-top: 10px;\n            border-top: 1px solid #ddd;\n        }\n    </style>\n</head>\n<body>\n    <nav class="navbar navbar-expand-lg navbar-light bg-light">\n        <div class="container-fluid">\n            <a class="navbar-brand" href="#">Netcore Event Payload Validator</a>\n            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">\n                <span class="navbar-toggler-icon"></span>\n            </button>\n            <div class="collapse navbar-collapse" id="navbarNav">\n                <ul class="navbar-nav ms-auto">\n                    <li class="nav-item">\n                        <a class="btn btn-primary" href="https://contact-api-via-csv-7e94e.web.app/" target="_blank">Trigger Activity API</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </nav>\n\n    <div class="container">\n        <h2>Event Validation Tool</h2>\n        \n        <div class="card mb-4">\n            <div class="card-body">\n                <div class="mb-3">\n                    <label class="form-label">Validation Mode</label>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="regularMode" value="regular" checked>\n                        <label class="form-check-label" for="regularMode">\n                            Android and iOS Event (Single Event/Event Payload format)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteMode" value="website">\n                        <label class="form-check-label" for="websiteMode">\n                            Website Logs Validation (JSON lines format with eventname and payload)\n                        </label>\n                    </div>\n                    <div class="form-check">\n                        <input class="form-check-input" type="radio" name="validationMode" id="websiteV2Mode" value="website-v2">\n                        <label class="form-check-label" for="websiteV2Mode">\n                            Website Logs V2 Validation (JSON lines format with event key and system fields excluded)\n                        </label>\n                    </div>\n                </div>\n                \n                <form id="uploadForm" enctype="multipart/form-data">\n                    <div class="mb-3">\n                        <label for="csvFile" class="form-label">CSV File (Validation Rules)</label>\n                        <input type="file" class="form-control" id="csvFile" name="csv_file" accept=".csv" required>\n                        <div class="mt-2">\n                            <a href="/download_template" class="btn btn-outline-secondary btn-sm">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Sample Template\n                            </a>\n                        </div>\n                    </div>\n                    <div class="mb-3">\n                        <label for="txtFile" class="form-label">TXT File (Event Logs)</label>\n                        <input type="file" class="form-control" id="txtFile" name="txt_file" accept=".txt" required>\n                        <div class="mt-2 sample-downloads">\n                            <!-- Regular mode sample -->\n                            <button class="btn btn-outline-secondary btn-sm sample-download regular-mode download-btn" data-mode="regular">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Regular Sample Log\n                            </button>\n                            <!-- Website mode sample -->\n                            <button class="btn btn-outline-secondary btn-sm sample-download website-mode download-btn" data-mode="website" style="display: none;">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                </svg>\n                                Download Website Sample Log\n                            </button>\n                            <!-- Website V2 mode samples -->\n                            <div class="v2-mode-downloads" style="display: none;">\n                                <button class="btn btn-outline-secondary btn-sm mb-1 download-btn" data-mode="website-v2" data-multiline="false">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                    </svg>\n                                    Download Website V2 Sample Log\n                                </button>\n                                <br>\n                                <button class="btn btn-outline-secondary btn-sm download-btn" data-mode="website-v2" data-multiline="true">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">\n                                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>\n                                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>\n                                    </svg>\n                                    Download Website V2 Multiline Sample\n                                </button>\n                            </div>\n                            <div id="downloadError" class="alert alert-danger mt-2" style="display: none;"></div>\n                        </div>\n                    </div>\n                    <button type="submit" class="btn btn-primary">Validate</button>\n                </form>\n            </div>\n        </div>\n\n        <div class="filter-section" id="filterSection" style="display: none;">\n            <div class="row mb-3">\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Summary</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>CSV Events:</strong></p>\n                                    <p class="text-primary" id="csvEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Log Events:</strong></p>\n                                    <p class="text-success" id="logEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-6">\n                    <div class="card">\n                        <div class="card-body">\n                            <h5 class="card-title">Event Details</h5>\n                            <div class="row">\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Missing Events:</strong></p>\n                                    <p class="text-warning" id="missingEventsCount">0</p>\n                                </div>\n                                <div class="col-6">\n                                    <p class="mb-1"><strong>Extra Events:</strong></p>\n                                    <p class="text-info" id="extraEventsCount">0</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <h4>Filters</h4>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="eventName">\n                            Event Name <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="eventNameFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="eventNameSelectAll" checked>\n                                <label for="eventNameSelectAll">Select All</label>\n                            </div>\n                            <div id="eventNameOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'eventName\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'eventName\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="status">\n                            Status <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="statusFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="statusSelectAll" checked>\n                                <label for="statusSelectAll">Select All</label>\n                            </div>\n                            <div id="statusOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'status\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'status\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="expectedType">\n                            Expected Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="expectedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="expectedTypeSelectAll" checked>\n                                <label for="expectedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="expectedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'expectedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'expectedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="col-md-4 mb-3">\n                    <div class="filter-dropdown">\n                        <div class="filter-header" data-filter="receivedType">\n                            Received Type <span class="filter-icon">\xe2\x96\xbc</span>\n                        </div>\n                        <div class="filter-content" id="receivedTypeFilter">\n                            <div class="filter-checkbox">\n                                <input type="checkbox" id="receivedTypeSelectAll" checked>\n                                <label for="receivedTypeSelectAll">Select All</label>\n                            </div>\n                            <div id="receivedTypeOptions"></div>\n                            <div class="filter-actions">\n                                <button class="btn btn-sm btn-primary" onclick="applyFilter(\'receivedType\')">Apply</button>\n                                <button class="btn btn-sm btn-secondary" onclick="clearFilter(\'receivedType\')">Clear</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-secondary" id="clearFilters">Clear All Filters</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-success" id="downloadResults">Download Results</button>\n                </div>\n                <div class="col-md-4 mb-3">\n                    <button class="btn btn-info" id="downloadValidEvents">Download Valid Events</button>\n                </div>\n            </div>\n        </div>\n\n        <div id="fullyValidEventsSection" class="alert alert-success" style="display:none;">\n            <strong>Events with all payloads valid:</strong>\n            <ul id="fullyValidEventsList" style="margin-bottom:0;"></ul>\n        </div>\n\n        <div class="table-container">\n            <table class="table table-striped" id="resultsTable">\n                <thead>\n                    <tr>\n                        <th class="sort-header" data-sort="eventName">Event Name <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="key">Key <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="value">Value <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="expectedType">Expected Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="receivedType">Received Type <span class="sort-icon">\xe2\x86\x95</span></th>\n                        <th class="sort-header" data-sort="validationStatus">Status <span class="sort-icon">\xe2\x86\x95</span></th>\n                    </tr>\n                </thead>\n                <tbody id="resultsBody"></tbody>\n            </table>\n        </div>\n    </div>\n\n    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/moment/moment.min.js"></script>\n    <script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>\n    <script>\n        let currentResults = [];\n        let currentSummary = {};\n        let currentSort = { field: null, order: \'asc\' };\n        let activeFilters = {\n            eventName: [],\n            status: [],\n            expectedType: [],\n            receivedType: []\n        };\n\n        $(\'#dateRange\').daterangepicker({\n            autoUpdateInput: false,\n            locale: {\n                cancelLabel: \'Clear\'\n            }\n        });\n\n        $(\'#dateRange\').on(\'apply.daterangepicker\', function(ev, picker) {\n            $(this).val(picker.startDate.format(\'MM/DD/YYYY\') + \' - \' + picker.endDate.format(\'MM/DD/YYYY\'));\n            applyFilters();\n        });\n\n        $(\'#dateRange\').on(\'cancel.daterangepicker\', function(ev, picker) {\n            $(this).val(\'\');\n            applyFilters();\n        });\n\n        // Handle validation mode changes\n        $(\'input[name="validationMode"]\').change(function() {\n            const mode = $(this).val();\n            // Hide all sample download buttons first\n            $(\'.sample-download, .v2-mode-downloads\').hide();\n            \n            // Show the appropriate download button based on mode\n            if (mode === \'regular\') {\n                $(\'.sample-download.regular-mode\').show();\n            } else if (mode === \'website\') {\n                $(\'.sample-download.website-mode\').show();\n            } else if (mode === \'website-v2\') {\n                $(\'.v2-mode-downloads\').show();\n            }\n        });\n\n        $(\'#uploadForm\').on(\'submit\', function(e) {\n            e.preventDefault();\n            const formData = new FormData(this);\n            \n            // Determine which endpoint to use based on validation mode\n            const validationMode = $(\'input[name="validationMode"]:checked\').val();\n            let endpoint = \'/upload\';\n            if (validationMode === \'website\') {\n                endpoint = \'/validate-website-logs\';\n            } else if (validationMode === \'website-v2\') {\n                endpoint = \'/validate-website-logs-v2\';\n            }\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + endpoint;\n            \n            console.log(\'Making request to:\', fullUrl);\n            console.log(\'Validation mode:\', validationMode);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: formData,\n                processData: false,\n                contentType: false,\n                success: function(response) {\n                    console.log(\'Upload response:\', response);\n                    \n                    // Ensure response is properly initialized\n                    currentResults = [];\n                    currentSummary = {\n                        csv_events_count: 0,\n                        log_events_count: 0,\n                        csv_events: [],\n                        log_events: []\n                    };\n                    window.originalLogs = {};\n                    \n                    // Handle both old and new response formats\n                    if (response && response.results && Array.isArray(response.results)) {\n                        // New format with summary\n                        currentResults = response.results;\n                        if (response.summary) {\n                            currentSummary = response.summary;\n                        }\n                        if (response.original_logs) {\n                            window.originalLogs = response.original_logs;\n                        }\n                    } else if (Array.isArray(response)) {\n                        // Old format - just results array\n                        currentResults = response;\n                    } else {\n                        console.error(\'Invalid response format:\', response);\n                    }\n                    \n                    updateEventSummary();\n                    updateFilters();\n                    displayResults(currentResults);\n                    $(\'#filterSection\').show();\n\n                    if (response.fully_valid_events && response.fully_valid_events.length > 0) {\n                        $(\'#fullyValidEventsList\').empty();\n                        response.fully_valid_events.forEach(function(eventName) {\n                            $(\'#fullyValidEventsList\').append(\'<li>\' + eventName + \'</li>\');\n                        });\n                        $(\'#fullyValidEventsSection\').show();\n                    } else {\n                        $(\'#fullyValidEventsSection\').hide();\n                    }\n                },\n                error: function(xhr) {\n                    console.error(\'Upload error:\', xhr);\n                    alert(\'Error uploading files: \' + xhr.responseText);\n                }\n            });\n        });\n\n        // Initialize filter dropdowns\n        // Handle sample file downloads\n        $(\'.download-btn\').click(function() {\n            const mode = $(this).data(\'mode\');\n            const multiline = $(this).data(\'multiline\') || false;\n            let url = `/download_sample_log/${mode}`;\n            if (mode === \'website-v2\' && multiline) {\n                url += \'?multiline=true\';\n            }\n\n            // Show loading state\n            $(this).prop(\'disabled\', true);\n            $(this).html(\'<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Downloading...\');\n            const button = $(this);\n\n            fetch(url)\n                .then(response => {\n                    if (!response.ok) {\n                        return response.json().then(err => Promise.reject(err));\n                    }\n                    return response.blob();\n                })\n                .then(blob => {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    let filename = \'sample_log.txt\';\n                    if (mode === \'website\') {\n                        filename = \'sample_website_logs.txt\';\n                    } else if (mode === \'website-v2\') {\n                        filename = multiline ? \'sample_website_logs_v2_multiline.txt\' : \'sample_website_logs_v2.txt\';\n                    }\n                    a.href = url;\n                    a.download = filename;\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                    $(\'#downloadError\').hide();\n                })\n                .catch(error => {\n                    console.error(\'Download error:\', error);\n                    $(\'#downloadError\').text(error.error || \'Error downloading file. Please try again.\').show();\n                })\n                .finally(() => {\n                    // Restore button state\n                    button.prop(\'disabled\', false);\n                    const svg = button.find(\'svg\').prop(\'outerHTML\');\n                    button.html(svg + \' Download \' + (mode === \'website-v2\' ? \n                        (multiline ? \'Website V2 Multiline Sample\' : \'Website V2 Sample Log\') : \n                        (mode === \'website\' ? \'Website Sample Log\' : \'Regular Sample Log\')));\n                });\n        });\n\n        $(document).ready(function() {\n            $(\'.filter-header\').click(function(e) {\n                e.stopPropagation();\n                const filterId = $(this).data(\'filter\');\n                console.log(\'Clicked filter:\', filterId);\n                $(`#${filterId}Filter`).toggleClass(\'show\');\n            });\n\n            // Close filter dropdowns when clicking outside\n            $(document).click(function(e) {\n                if (!$(e.target).closest(\'.filter-dropdown\').length) {\n                    $(\'.filter-content\').removeClass(\'show\');\n                }\n            });\n        });\n\n        function updateEventSummary() {\n            // Update event count displays\n            $(\'#csvEventsCount\').text(currentSummary.csv_events_count || 0);\n            $(\'#logEventsCount\').text(currentSummary.log_events_count || 0);\n            \n            // Calculate missing and extra events\n            const csvEvents = new Set(currentSummary.csv_events || []);\n            const logEvents = new Set(currentSummary.log_events || []);\n            \n            const missingEvents = csvEvents.size - new Set([...csvEvents].filter(x => logEvents.has(x))).size;\n            const extraEvents = logEvents.size - new Set([...logEvents].filter(x => csvEvents.has(x))).size;\n            \n            $(\'#missingEventsCount\').text(missingEvents);\n            $(\'#extraEventsCount\').text(extraEvents);\n        }\n\n        function updateFilters() {\n            const eventNames = new Set();\n            const expectedTypes = new Set();\n            const receivedTypes = new Set();\n            const statuses = new Set();\n            \n            currentResults.forEach(result => {\n                if (result.eventName) eventNames.add(result.eventName);\n                if (result.expectedType) expectedTypes.add(result.expectedType);\n                if (result.receivedType) receivedTypes.add(result.receivedType);\n                if (result.validationStatus) statuses.add(result.validationStatus);\n            });\n\n            console.log(\'Available statuses:\', Array.from(statuses));\n\n            updateFilterOptions(\'eventName\', eventNames);\n            updateFilterOptions(\'status\', statuses);\n            updateFilterOptions(\'expectedType\', expectedTypes);\n            updateFilterOptions(\'receivedType\', receivedTypes);\n        }\n\n        function updateFilterOptions(filterId, values) {\n            const container = $(`#${filterId}Options`);\n            container.empty();\n            \n            console.log(`Updating ${filterId} with values:`, Array.from(values));\n            \n            Array.from(values).sort().forEach(value => {\n                if (value) {\n                    const checkboxId = `${filterId}_${value.replace(/[^a-zA-Z0-9]/g, \'_\')}`;\n                    container.append(`\n                        <div class="filter-checkbox">\n                            <input type="checkbox" id="${checkboxId}" value="${value}" checked>\n                            <label for="${checkboxId}">${value}</label>\n                        </div>\n                    `);\n                }\n            });\n\n            // Update select all checkbox\n            $(`#${filterId}SelectAll`).prop(\'checked\', true);\n        }\n\n        function getSelectedValues(filterId) {\n            return $(`#${filterId}Options input:checked`).map(function() {\n                return $(this).val();\n            }).get();\n        }\n\n        function applyFilter(filterId) {\n            activeFilters[filterId] = getSelectedValues(filterId);\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function clearFilter(filterId) {\n            $(`#${filterId}Options input`).prop(\'checked\', false);\n            $(`#${filterId}SelectAll`).prop(\'checked\', false);\n            activeFilters[filterId] = [];\n            applyFilters();\n            $(`#${filterId}Filter`).removeClass(\'show\');\n        }\n\n        function applyFilters() {\n            const filters = {\n                eventName: activeFilters.eventName,\n                validationStatus: activeFilters.status,\n                expectedType: activeFilters.expectedType,\n                receivedType: activeFilters.receivedType\n            };\n\n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/filter\';\n\n            console.log(\'Making filter request to:\', fullUrl);\n\n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({\n                    results: currentResults,\n                    filters: filters,\n                    sort_by: currentSort.field,\n                    sort_order: currentSort.order\n                }),\n                contentType: \'application/json\',\n                success: function(response) {\n                    displayResults(response);\n                    window.filteredResults = response;\n                },\n                error: function(xhr) {\n                    console.error(\'Filter error:\', xhr);\n                    alert(\'Error applying filters: \' + xhr.responseText);\n                }\n            });\n        }\n\n        // Handle select all checkboxes\n        $(\'[id$="SelectAll"]\').change(function() {\n            const filterId = this.id.replace(\'SelectAll\', \'\');\n            $(`#${filterId}Options input`).prop(\'checked\', $(this).prop(\'checked\'));\n        });\n\n        // Update select all checkbox when individual checkboxes change\n        $(\'.filter-content\').on(\'change\', \'input[type="checkbox"]:not([id$="SelectAll"])\', function() {\n            const filterId = $(this).closest(\'.filter-content\').attr(\'id\').replace(\'Filter\', \'\');\n            const allChecked = $(`#${filterId}Options input:checked`).length === $(`#${filterId}Options input`).length;\n            $(`#${filterId}SelectAll`).prop(\'checked\', allChecked);\n        });\n\n        $(\'#clearFilters\').click(function() {\n            $(\'.filter-content input[type="checkbox"]\').prop(\'checked\', false);\n            $(\'[id$="SelectAll"]\').prop(\'checked\', false);\n            Object.keys(activeFilters).forEach(key => {\n                activeFilters[key] = [];\n            });\n            applyFilters();\n        });\n\n        $(\'#downloadResults\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download\';\n            \n            console.log(\'Making download request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ results: resultsToDownload }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'validation_results.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download error:\', xhr);\n                    alert(\'Error downloading results: \' + xhr.responseText);\n                }\n            });\n        });\n\n        $(\'#downloadValidEvents\').click(function() {\n            // Use filtered results if available, otherwise use all results\n            const resultsToDownload = window.filteredResults || currentResults;\n            \n            // Get the current domain to ensure we\'re hitting the right server\n            const baseUrl = window.location.origin;\n            const fullUrl = baseUrl + \'/download-valid-events\';\n            \n            console.log(\'Making download valid events request to:\', fullUrl);\n            \n            $.ajax({\n                url: fullUrl,\n                type: \'POST\',\n                data: JSON.stringify({ \n                    results: resultsToDownload,\n                    logs_data: window.originalLogs || {}\n                }),\n                contentType: \'application/json\',\n                xhrFields: {\n                    responseType: \'blob\'\n                },\n                success: function(blob) {\n                    const url = window.URL.createObjectURL(blob);\n                    const a = document.createElement(\'a\');\n                    a.href = url;\n                    a.download = \'valid_events_report.csv\';\n                    document.body.appendChild(a);\n                    a.click();\n                    window.URL.revokeObjectURL(url);\n                    a.remove();\n                },\n                error: function(xhr) {\n                    console.error(\'Download valid events error:\', xhr);\n                    alert(\'Error downloading valid events: \' + xhr.responseText);\n                }\n            });\n        });\n\n        function displayResults(results) {\n            const tbody = $(\'#resultsBody\');\n            tbody.empty();\n            \n            // Debug log to check results being displayed\n            console.log(\'Displaying results:\', results);\n            \n            results.forEach(result => {\n                const statusClass = getStatusClass(result.validationStatus);\n                tbody.append(`\n                    <tr>\n                        <td>${result.eventName}</td>\n                        <td>${result.key}</td>\n                        <td>${result.value}</td>\n                        <td>${result.expectedType}</td>\n                        <td>${result.receivedType}</td>\n                        <td class="validation-status ${statusClass}">${result.validationStatus}</td>\n                    </tr>\n                `);\n            });\n        }\n\n        function getStatusClass(status) {\n            if (status === \'Valid\') return \'status-valid\';\n            if (status === \'Invalid/Wrong datatype/value\') return \'status-invalid\';\n            if (status === \'Payload value is Empty\') return \'status-empty\';\n            if (status === \'Extra key present in the log\') return \'status-extra\';\n            if (status === \'Extra event present in logs\') return \'status-extra-event\';\n            if (status === \'Field from extra event\') return \'status-extra-field\';\n            if (status === \'Event name not present in the logs\') return \'status-notpresent\';\n            return \'\';\n        }\n\n        $(\'.sort-header\').click(function() {\n            const field = $(this).data(\'sort\');\n            if (currentSort.field === field) {\n                currentSort.order = currentSort.order === \'asc\' ? \'desc\' : \'asc\';\n            } else {\n                currentSort.field = field;\n                currentSort.order = \'asc\';\n            }\n            applyFilters();\n        });\n\n        $(\'#eventNameFilter, #statusFilter, #expectedTypeFilter, #receivedTypeFilter\').change(applyFilters);\n    </script>\n</body>\n</html>'
2025-10-10 13:10:34,649 - INFO - 127.0.0.1 - - [10/Oct/2025 13:10:34] "GET / HTTP/1.1" 200 -
2025-10-10 13:10:36,137 - INFO - Headers: Host: localhost:10000
Connection: keep-alive
Sec-Ch-Ua: "Not)A;Brand";v="99", "Google Chrome";v="127", "Chromium";v="127"
Sec-Ch-Ua-Mobile: ?0
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Sec-Ch-Ua-Platform: "macOS"
Accept: */*
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:10000/
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
If-None-Match: "1749712420.029259-4025-1057957485"
If-Modified-Since: Thu, 12 Jun 2025 07:13:40 GMT


2025-10-10 13:10:36,138 - INFO - Body: b''
2025-10-10 13:10:36,138 - INFO - URL: http://localhost:10000/download_sample_log/regular
2025-10-10 13:10:36,138 - INFO - Method: GET
2025-10-10 13:10:36,138 - INFO - Endpoint: download_sample_log
2025-10-10 13:10:36,138 - INFO - Sending sample file: /Users/allen.thomson/Desktop/sampleapp/automation/validation_script_android/samplelog_android.txt
2025-10-10 13:10:36,139 - INFO - Response: [File Response] Content-Type: text/plain; charset=utf-8, Headers: {'Content-Disposition': 'attachment; filename=samplelog_android.txt', 'Content-Type': 'text/plain; charset=utf-8', 'Content-Length': '4025', 'Last-Modified': 'Thu, 12 Jun 2025 07:13:40 GMT', 'Cache-Control': 'no-cache', 'ETag': '"1749712420.029259-4025-1057957485"', 'Date': 'Fri, 10 Oct 2025 07:40:36 GMT'}
2025-10-10 13:10:36,139 - INFO - 127.0.0.1 - - [10/Oct/2025 13:10:36] "[36mGET /download_sample_log/regular HTTP/1.1[0m" 304 -
2025-10-10 13:11:32,609 - INFO -  * Detected change in '/Users/allen.thomson/Desktop/sampleapp/automation/validation_script_android/beta2.py', reloading
2025-10-10 13:11:32,703 - INFO -  * Restarting with stat
2025-10-10 13:11:32,978 - WARNING -  * Debugger is active!
2025-10-10 13:11:32,989 - INFO -  * Debugger PIN: 132-353-793
